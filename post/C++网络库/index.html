<!DOCTYPE html>
<html lang="en">

  <head>
    <!--æ¯ä¸ªé¡µé¢éƒ½éœ€è¦ head linkç­‰  -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>
  C++ç½‘ç»œåº“ - Unique&#39;s Blog
</title>
<link rel="shortcut icon" href="https://blog.qxxiao.eu.org/favicon.ico">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.2.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css">
<link rel="stylesheet" href="https://blog.qxxiao.eu.org/media/css/tailwind.css">
<link rel="stylesheet" href="https://blog.qxxiao.eu.org/media/css/ldbutton.css">

<link rel="stylesheet" href="https://blog.qxxiao.eu.org/styles/main.css">
<script src="https://blog.qxxiao.eu.org/media/scripts/initTheme.js"></script>
<link rel="stylesheet" href="https://blog.qxxiao.eu.org/media/css/light-dark.css">

<link rel="alternate" type="application/atom+xml" title="C++ç½‘ç»œåº“ - Unique&#39;s Blog - Atom Feed"
  href="https://blog.qxxiao.eu.org/atom.xml">


      <meta name="description" content="


libcurlï¼šé«˜å¯ç§»æ¤ã€åŠŸèƒ½ä¸°å¯Œçš„é€šä¿¡åº“
cprï¼šæ›´ç°ä»£ã€æ›´æ˜“ç”¨çš„é€šä¿¡åº“

å®‰è£…


ZMQï¼šé«˜æ•ˆã€å¤šåŠŸèƒ½çš„é€šä¿¡åº“
sockpp
å°ç»“





è½¬è½½å’Œæ¥æºäºï¼šç½—å‰‘é”‹çš„ C++ å®æˆ˜ç¬”è®°

libcurlï¼šé«˜å¯ç§»æ¤ã€åŠŸèƒ½ä¸°å¯Œçš„é€šä¿¡åº“..." />
      <meta property="og:title" content="C++ç½‘ç»œåº“ - Unique&#39;s Blog" />
      <meta property="og:description" content="


libcurlï¼šé«˜å¯ç§»æ¤ã€åŠŸèƒ½ä¸°å¯Œçš„é€šä¿¡åº“
cprï¼šæ›´ç°ä»£ã€æ›´æ˜“ç”¨çš„é€šä¿¡åº“

å®‰è£…


ZMQï¼šé«˜æ•ˆã€å¤šåŠŸèƒ½çš„é€šä¿¡åº“
sockpp
å°ç»“





è½¬è½½å’Œæ¥æºäºï¼šç½—å‰‘é”‹çš„ C++ å®æˆ˜ç¬”è®°

libcurlï¼šé«˜å¯ç§»æ¤ã€åŠŸèƒ½ä¸°å¯Œçš„é€šä¿¡åº“..." />
      <meta property="og:type" content="articles" />
      <meta property="og:url" content="https://blog.qxxiao.eu.org/post/C++ç½‘ç»œåº“/" />
      <meta property="og:image"
        content="https://pic.qxxiao.cn/cpp-logo.png" />
      <meta property="og:image:height" content="630" />
      <meta property="og:image:width" content="1200" />
      <meta name="twitter:title" content="C++ç½‘ç»œåº“ - Unique&#39;s Blog" />
      <meta name="twitter:description" content="


libcurlï¼šé«˜å¯ç§»æ¤ã€åŠŸèƒ½ä¸°å¯Œçš„é€šä¿¡åº“
cprï¼šæ›´ç°ä»£ã€æ›´æ˜“ç”¨çš„é€šä¿¡åº“

å®‰è£…


ZMQï¼šé«˜æ•ˆã€å¤šåŠŸèƒ½çš„é€šä¿¡åº“
sockpp
å°ç»“





è½¬è½½å’Œæ¥æºäºï¼šç½—å‰‘é”‹çš„ C++ å®æˆ˜ç¬”è®°

libcurlï¼šé«˜å¯ç§»æ¤ã€åŠŸèƒ½ä¸°å¯Œçš„é€šä¿¡åº“..." />
      <meta name="twitter:card" content="summary_large_image" />
      <link rel="canonical" href="https://blog.qxxiao.eu.org/post/C++ç½‘ç»œåº“/" />

      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css" />
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css" />

      
        <link rel="stylesheet"
          href="https://blog.qxxiao.eu.org/media/css/prism-vs-dark.css" />
        <link href="https://cdn.bootcdn.net/ajax/libs/prism/1.19.0/plugins/line-numbers/prism-line-numbers.min.css"
          rel="stylesheet" />
        <link href="https://cdn.bootcdn.net/ajax/libs/prism/1.19.0/plugins/toolbar/prism-toolbar.min.css"
          rel="stylesheet" />
        
          
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" />
            
  </head>

  <body>
    <div class="antialiased flex flex-col min-h-screen" id="app">
      <!-- æ ‡é¢˜èœå• -->
<div class="nav py-3 md:py-8 fixed w-full z-10 bg-gray-50 dark:bg-gray-700 transition-all duration-300"
  :class="{ 'scroll': scrolled }">
  <div class="flex justify-end px-4">
    <div class="w-8 h-8 flex justify-center items-center rounded-full md:hidden" @click="showMenu = !showMenu">
      <i class="ri-close-line" v-show="showMenu"></i>
      <i class="ri-menu-3-line" v-show="!showMenu"></i>
    </div>
  </div>
  <nav cloak class="max-w-4xl w-full mx-auto text-right flex flex-col md:flex-row justify-between items-center md:flex"
    :class="`${ showMenu ? 'flex' : 'hidden' }`">
    
      <!-- å¦‚æœ menu æ˜¯ "æ—¶å…‰"ï¼Œ æ¸²æŸ“ä¸ºä¸€ä¸ªhoveræ˜¾ç¤ºä¸‹æ‹‰æ¡†ç»„ä»¶-->
      
          <a href="/" target=""
            class="py-2 md:py-1 px-4 mx-4 inline-flex transition font-semibold rounded dark:hover:bg-gray-600 hover:bg-gray-200">
            é¦–é¡µ
          </a>
          
            
      <!-- å¦‚æœ menu æ˜¯ "æ—¶å…‰"ï¼Œ æ¸²æŸ“ä¸ºä¸€ä¸ªhoveræ˜¾ç¤ºä¸‹æ‹‰æ¡†ç»„ä»¶-->
      
          <a href="/archives" target=""
            class="py-2 md:py-1 px-4 mx-4 inline-flex transition font-semibold rounded dark:hover:bg-gray-600 hover:bg-gray-200">
            å½’æ¡£
          </a>
          
            
      <!-- å¦‚æœ menu æ˜¯ "æ—¶å…‰"ï¼Œ æ¸²æŸ“ä¸ºä¸€ä¸ªhoveræ˜¾ç¤ºä¸‹æ‹‰æ¡†ç»„ä»¶-->
      
          <a href="/tags" target=""
            class="py-2 md:py-1 px-4 mx-4 inline-flex transition font-semibold rounded dark:hover:bg-gray-600 hover:bg-gray-200">
            æ ‡ç­¾
          </a>
          
            
      <!-- å¦‚æœ menu æ˜¯ "æ—¶å…‰"ï¼Œ æ¸²æŸ“ä¸ºä¸€ä¸ªhoveræ˜¾ç¤ºä¸‹æ‹‰æ¡†ç»„ä»¶-->
      
          <a href="https://gh.qxxiao.cn/nav" target=""
            class="py-2 md:py-1 px-4 mx-4 inline-flex transition font-semibold rounded dark:hover:bg-gray-600 hover:bg-gray-200">
            å¯¼èˆª
          </a>
          
            
      <!-- å¦‚æœ menu æ˜¯ "æ—¶å…‰"ï¼Œ æ¸²æŸ“ä¸ºä¸€ä¸ªhoveræ˜¾ç¤ºä¸‹æ‹‰æ¡†ç»„ä»¶-->
      
        <div
          class="py-2 md:py-1 px-4 mx-4 inline-flex transition font-semibold dark:hover:bg-gray-600 hover:bg-gray-200 nav-time1">
          æ—¶å…‰
            <div class="transition font-semibold nav-time2">
              
                <a href="https://blog.qxxiao.eu.org/diary/" class="">
                  è¯´è¯´
                </a>
                
                <a href="https://blog.qxxiao.eu.org/gallery/" class="">
                  ç›¸å†Œ
                </a>
                
                <a href="https://blog.qxxiao.eu.org/post/book/" class="">
                  ä¹¦å•
                </a>
                
            </div>
        </div>
        
            
      <!-- å¦‚æœ menu æ˜¯ "æ—¶å…‰"ï¼Œ æ¸²æŸ“ä¸ºä¸€ä¸ªhoveræ˜¾ç¤ºä¸‹æ‹‰æ¡†ç»„ä»¶-->
      
          <a href="/post/about" target=""
            class="py-2 md:py-1 px-4 mx-4 inline-flex transition font-semibold rounded dark:hover:bg-gray-600 hover:bg-gray-200">
            å…³äº
          </a>
          
            
              <!-- <a href="https://blog.qxxiao.eu.org/atom.xml" target="_blank" class="py-2 md:py-1 px-4 mx-4 inline-flex transition font-semibold rounded dark:hover:bg-gray-600 hover:bg-gray-200">
      RSS
    </a> -->
              <!-- é»‘è‰²æ¨¡å¼ï¼Œå’Œäº®è‰²æ¨¡å¼å¼€å…³-->
<div class="py-2 md:py-1 inline-flex transition font-semibold rounded dark:hover:bg-gray-600 hover:bg-gray-200">
  <label for="night-light-checkbox" class="night-light-label">
    <input type="checkbox" id="night-light-checkbox" @change="toggleDarkMode" />
    <span v-cloak class="night-light-ball" id="night-light-ball"></span>
    <svg viewBox="0 0 512 512" class="sun-svg">
      <path id="sun-svg"
        d="M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z">
      </path>
    </svg>
    <svg viewBox="0 0 512 512" class="moon-svg">
      <path id="moon-svg"
        d="M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z">
      </path>
    </svg>
  </label>
</div>
                <form id="gridea-search-form" class="inline-flex mx-4 px-4" action="https://blog.qxxiao.eu.org/search/">
                  <input type="search" autocomplete='off' spellcheck='false' name="q" />
                </form>
  </nav>

</div>
        <a href="https://blog.qxxiao.eu.org"
          class="fixed top-0 left-0 mt-4 bg-black text-white dark:text-gray-700 dark:bg-yellow-50 dark:hover:bg-black dark:hover:text-white inline-flex p-2 pl-8 hover:text-gray-700 hover:bg-yellow-50 font-bold z-10">
          Unique&#39;s Blog
        </a>
        <div class="max-w-4xl w-full mx-auto">
          <div class="shadow-box bg-white dark:bg-gray-600 rounded-lg pt-32 px-4 md:px-8 pb-8 mb-8">
            <h1 class="text-5xl font-semibold leading-normal pb-8 mb-8 border-b-8 border-gray-700">
              C++ç½‘ç»œåº“
            </h1>
            <!-- ä¸æ˜¾ç¤º Post ä¸­çš„å°é¢å›¾ç‰‡ -->
            
                <div class="mb-8 flex flex-wrap">
                  <div class="text-gray-400 text-sm mr-4">
                    <i class="ri-calendar-2-line" style="vertical-align: middle;"></i>
                    2022-10-23 Â·
                      <i class="ri-file-word-line" style="vertical-align: middle;"></i>
                      3072å­— Â·
                        <i class="ri-timer-line" style="vertical-align: middle;"></i>
                        14 min read
                  </div>
                  ğŸ·ï¸&nbsp;
                      
                        <a href="https://blog.qxxiao.eu.org/tag/c/"
                          class="text-indigo-500 text-sm border-b-2 border-solid border-indigo-500 hover:border-gray-600 transition-all duration-100 inline-flex mr-2">
                          <i class="ri-hashtag" style="vertical-align: middle;"></i>
                          C++
                        </a>
                        
                </div>
                <div class="markdown mb-8" v-pre><p><ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#libcurl%E9%AB%98%E5%8F%AF%E7%A7%BB%E6%A4%8D-%E5%8A%9F%E8%83%BD%E4%B8%B0%E5%AF%8C%E7%9A%84%E9%80%9A%E4%BF%A1%E5%BA%93">libcurlï¼šé«˜å¯ç§»æ¤ã€åŠŸèƒ½ä¸°å¯Œçš„é€šä¿¡åº“</a></li>
<li><a href="#font-colord44c47cpr%E6%9B%B4%E7%8E%B0%E4%BB%A3-%E6%9B%B4%E6%98%93%E7%94%A8%E7%9A%84%E9%80%9A%E4%BF%A1%E5%BA%93font"><font color='#d44c47'>cprï¼šæ›´ç°ä»£ã€æ›´æ˜“ç”¨çš„é€šä¿¡åº“</font></a>
<ul>
<li><a href="#%E5%AE%89%E8%A3%85">å®‰è£…</a></li>
</ul>
</li>
<li><a href="#zmq%E9%AB%98%E6%95%88-%E5%A4%9A%E5%8A%9F%E8%83%BD%E7%9A%84%E9%80%9A%E4%BF%A1%E5%BA%93">ZMQï¼šé«˜æ•ˆã€å¤šåŠŸèƒ½çš„é€šä¿¡åº“</a></li>
<li><a href="#sockpp">sockpp</a></li>
<li><a href="#%E5%B0%8F%E7%BB%93">å°ç»“</a></li>
</ul>
</li>
</ul>
</p>
<blockquote>
<p>è½¬è½½å’Œæ¥æºäºï¼š<a href="https://time.geekbang.org/column/intro/100051801?utm_source=gold_browser_extension"><strong>ç½—å‰‘é”‹çš„ C++ å®æˆ˜ç¬”è®°</strong></a></p>
</blockquote>
<h2 id="libcurlé«˜å¯ç§»æ¤-åŠŸèƒ½ä¸°å¯Œçš„é€šä¿¡åº“">libcurlï¼šé«˜å¯ç§»æ¤ã€åŠŸèƒ½ä¸°å¯Œçš„é€šä¿¡åº“</h2>
<p><a href="https://curl.se/libcurl/c/">libcurl</a>ï¼Œæ¥æºäºè‘—åçš„curl é¡¹ç›®ï¼Œä¹Ÿæ˜¯ curl çš„åº•å±‚æ ¸å¿ƒã€‚</p>
<p>å®ƒæœ€æ—©åªæ”¯æŒ HTTP åè®®ï¼Œä½†ç°åœ¨å·²ç»æ‰©å±•åˆ°æ”¯æŒæ‰€æœ‰çš„åº”ç”¨å±‚åè®®ï¼Œæ¯”å¦‚ HTTPSã€FTPã€LDAPã€SMTP ç­‰ï¼ŒåŠŸèƒ½å¼ºå¤§ã€‚</p>
<p>libcurl ä½¿ç”¨çº¯ C è¯­è¨€å¼€å‘ï¼Œå…¼å®¹æ€§ã€å¯ç§»æ¤æ€§éå¸¸å¥½ï¼ŒåŸºäº C æ¥å£å¯ä»¥å¾ˆå®¹æ˜“å†™å‡ºå„ç§è¯­è¨€çš„å°è£…ï¼Œæ‰€ä»¥ Pythonã€PHP ç­‰è¯­è¨€éƒ½æœ‰ libcurl ç›¸å…³çš„åº“ã€‚</p>
<p>ubuntu ä¸‹å®‰è£…ï¼š</p>
<pre><code class="language-bash">apt-get install libcurl4-openssl-dev
</code></pre>
<p><code>libcurl</code> çš„æ¥å£å¯ä»¥ç²—ç•¥åœ°åˆ†æˆä¸¤å¤§ç±»ï¼šeasy ç³»åˆ—å’Œ multi ç³»åˆ—ã€‚å…¶ä¸­ï¼Œeasy ç³»åˆ—æ˜¯åŒæ­¥è°ƒç”¨ï¼Œæ¯”è¾ƒç®€å•ï¼›multi ç³»åˆ—æ˜¯å¼‚æ­¥çš„å¤šçº¿ç¨‹è°ƒç”¨ã€‚</p>
<p>ä½¿ç”¨ <code>libcurl</code> æ”¶å‘ HTTP æ•°æ®çš„åŸºæœ¬æ­¥éª¤æœ‰ 4 ä¸ªï¼š</p>
<ol>
<li>
<p>ä½¿ç”¨ <code>curl_easy_init()</code> åˆ›å»ºä¸€ä¸ªå¥æŸ„ï¼Œç±»å‹æ˜¯ <code>CURL*</code>ã€‚ä½†æˆ‘ä»¬å®Œå…¨æ²¡æœ‰å¿…è¦å…³å¿ƒå¥æŸ„çš„ç±»å‹ï¼Œç›´æ¥ç”¨ auto æ¨å¯¼å°±è¡Œã€‚</p>
</li>
<li>
<p>ä½¿ç”¨ <code>curl_easy_setopt()</code> è®¾ç½®è¯·æ±‚çš„å„ç§å‚æ•°ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•ã€URLã€header/body æ•°æ®ã€è¶…æ—¶ã€å›è°ƒå‡½æ•°ç­‰ã€‚è¿™æ˜¯æœ€å…³é”®çš„æ“ä½œã€‚</p>
</li>
<li>
<p>ä½¿ç”¨ <code>curl_easy_perform()</code> å‘é€æ•°æ®ï¼Œè¿”å›çš„æ•°æ®ä¼šç”±å›è°ƒå‡½æ•°å¤„ç†ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨ <code>curl_easy_cleanup()</code> æ¸…ç†å¥æŸ„ç›¸å…³çš„èµ„æºï¼Œç»“æŸä¼šè¯ã€‚</p>
</li>
</ol>
<details class="markdown">
<summary><b><font color='#da720f'>Codeç¤ºä¾‹</font></b></summary>
<pre><code class="language-c++">#include &lt;assert.h&gt;
#include &lt;curl/curl.h&gt;
#include &lt;iostream&gt;

using namespace std;

// å›è°ƒå‡½æ•°çš„åŸå‹
// å›è°ƒä¼šè¢«å¤šæ¬¡è°ƒç”¨ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½ä¼šä¼ é€’ä¸€å—æ•°æ®;ptræŒ‡å‘ä¼ é€’çš„æ•°æ®ï¼Œè¯¥æ•°æ®çš„å¤§å°ä¸ºnmembï¼›sizeå§‹ç»ˆä¸º1
// size * nmemb æ˜¯ç¼“å†²åŒºçš„å¤§å°
// ptr æ˜¯ç¼“å†²åŒºçš„åœ°å€
// userdata æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„æ•°æ®
size_t write_callback(char*, size_t, size_t, void*);

int main() {
    auto curl = curl_easy_init(); // åˆ›å»ºCURLå¥æŸ„
    assert(curl);

    curl_easy_setopt(curl, CURLOPT_URL, &quot;http://nginx.org&quot;); // è®¾ç½®è¯·æ±‚URI
    // é¿å…ä»£ç†è®¾ç½®ä¸ºé•¿è¿æ¥ Proxy-Connection:closeæˆ–è€…ä¸ä½¿ç”¨ä»£ç†
    curl_easy_setopt(curl, CURLOPT_PROXY, &quot;&quot;);
    curl_easy_setopt(curl, CURLOPT_VERBOSE, 1L);

    // æ²¡æœ‰è®¾ç½®å›è°ƒå‡½æ•°æ—¶ï¼Œå†…éƒ¨çš„é»˜è®¤å›è°ƒï¼ŒæŠŠå¾—åˆ°çš„ HTTP å“åº”æ•°æ®è¾“å‡ºåˆ°æ ‡å‡†æµ
    // c++11, æ— æ•è·çš„ lambda è¡¨è¾¾å¼å¯ä»¥æ˜¾å¼è½¬æ¢æˆä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ=&gt;Cä½¿ç”¨
    curl_easy_setopt(
        curl, CURLOPT_WRITEFUNCTION, // è®¾ç½®å›è°ƒå‡½æ•°
        (decltype(&amp;write_callback))  // decltypeè·å–å‡½æ•°æŒ‡é’ˆç±»å‹ï¼Œæ˜¾å¼è½¬æ¢
            [](char* ptr, size_t size, size_t nmemb, void* userdata) {
                cout &lt;&lt; &quot;size = &quot; &lt;&lt; size &lt;&lt; &quot;*&quot; &lt;&lt; nmemb &lt;&lt; &quot;=&quot; &lt;&lt; size * nmemb &lt;&lt; endl; // ç®€å•çš„å¤„ç†
                return size * nmemb;                                                      // è¿”å›æ¥æ”¶çš„å­—èŠ‚æ•°
            });

    auto res = curl_easy_perform(curl); // å‘é€æ•°æ®
    if (res != CURLE_OK) {              // æ£€æŸ¥æ˜¯å¦æ‰§è¡ŒæˆåŠŸ
        cout &lt;&lt; curl_easy_strerror(res) &lt;&lt; endl;
    }
    curl_easy_cleanup(curl); // æ¸…ç†å¥æŸ„ç›¸å…³çš„èµ„æº
    return 0;
}
</code></pre>
</details>
<p><font color='#d44c47'>æ¨èä½¿ç”¨cprä»£æ›¿å®ƒ</font></p>
<h2 id="font-colord44c47cpræ›´ç°ä»£-æ›´æ˜“ç”¨çš„é€šä¿¡åº“font"><font color='#d44c47'>cprï¼šæ›´ç°ä»£ã€æ›´æ˜“ç”¨çš„é€šä¿¡åº“</font></h2>
<p><a href="https://docs.libcpr.org">cpr</a> æ˜¯å¯¹ <code>libcurl</code> çš„ä¸€ä¸ª C++11 å°è£…ï¼Œä½¿ç”¨äº†å¾ˆå¤šç°ä»£ C++ çš„é«˜çº§ç‰¹æ€§ï¼Œå¯¹å¤–çš„æ¥å£æ¨¡ä»¿äº† Python çš„ <code>requests</code> åº“ï¼Œéå¸¸ç®€å•æ˜“ç”¨ã€‚</p>
<h3 id="å®‰è£…">å®‰è£…</h3>
<p>ä¸‹è½½æºç ï¼Œç”¨ cmake ç¼–è¯‘å®‰è£…</p>
<pre><code class="language-bash">git clone git@github.com:whoshuu/cpr.git
cmake . -DUSE_SYSTEM_CURL=ON -DBUILD_CPR_TESTS=OFF
make &amp;&amp; make install
</code></pre>
<p>æˆ–è€…åœ¨ <code>cmake</code> é¡¹ç›®ä¸­ç›´æ¥ä½¿ç”¨[CMakeLists.txt]ï¼š</p>
<pre><code class="language-makefile">include(FetchContent)
FetchContent_Declare(cpr GIT_REPOSITORY https://github.com/libcpr/cpr.git
                         GIT_TAG 871ed52d350214a034f6ef8a3b8f51c5ce1bd400) # The commit hash for 1.9.0. Replace with the latest from: https://github.com/libcpr/cpr/releases
FetchContent_MakeAvailable(cpr)

target_link_libraries(cpr_example PRIVATE cpr::cpr)
</code></pre>
<p><font color='#458361'><strong>è¯´æ˜</strong></font>ï¼š<font color='#458361'>macos ä¸‹æŒ‡å®š clang++/clang ç¼–è¯‘å™¨ç”Ÿæˆé¡¹ç›®ï¼›gcc ç¼–è¯‘ä¼šå¤±è´¥</font>ï¼›</p>
<p>åœ¨ <code>cpr</code> é‡Œï¼ŒHTTP åè®®çš„æ¦‚å¿µéƒ½è¢«å®ç°ä¸ºç›¸åº”çš„å‡½æ•°æˆ–è€…ç±»ï¼Œå†…éƒ¨å†è½¬åŒ–ä¸º libcurl æ“ä½œï¼Œä¸»è¦çš„æœ‰ï¼š</p>
<ul>
<li>
<p>GET/HEAD/POST ç­‰è¯·æ±‚æ–¹æ³•ï¼Œä½¿ç”¨åŒåçš„ Get/Head/Post å‡½æ•°ï¼›</p>
</li>
<li>
<p>URL ä½¿ç”¨ Url ç±»ï¼Œå®ƒæ˜¯ string çš„å°è£…ï¼›</p>
</li>
<li>
<p>URL å‚æ•°ä½¿ç”¨ Parameters ç±»ï¼ŒKV ç»“æ„ï¼Œè¿‘ä¼¼ mapï¼›</p>
</li>
<li>
<p>è¯·æ±‚å¤´å­—æ®µä½¿ç”¨ Header ç±»ï¼Œå®ƒå…¶å®æ˜¯ map çš„åˆ«åï¼Œä½¿ç”¨å®šåˆ¶çš„å‡½æ•°å®ç°äº†å¤§å°å†™æ— å…³æ¯”è¾ƒï¼›</p>
</li>
<li>
<p>Cookie ä½¿ç”¨ Cookies ç±»ï¼Œä¹Ÿæ˜¯ KV ç»“æ„ï¼Œè¿‘ä¼¼ mapï¼›</p>
</li>
<li>
<p>è¯·æ±‚ä½“ä½¿ç”¨ Body ç±»ï¼›è¶…æ—¶è®¾ç½®ä½¿ç”¨ Timeout ç±»ã€‚</p>
</li>
</ul>
<p><code>cpr</code> ä¹Ÿæ”¯æŒå¼‚æ­¥å¤„ç†ï¼Œä½†å®ƒå†…éƒ¨æ²¡æœ‰ä½¿ç”¨ libcurl çš„ <code>multi</code> æ¥å£ï¼Œè€Œæ˜¯ä½¿ç”¨äº†æ ‡å‡†åº“é‡Œçš„ future å’Œ asyncã€‚</p>
<details class="markdown">
<summary><b><font color='#da720f'>Codeç¤ºä¾‹</font></b></summary>
<pre><code class="language-c++">#include &lt;cpr/cpr.h&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;

int main(int argc, char** argv) {
    cpr::Response r = cpr::Get(cpr::Url{&quot;https://api.github.com/repos/whoshuu/cpr/contributors&quot;},
                               cpr::Authentication{&quot;user&quot;, &quot;pass&quot;, cpr::AuthMode::BASIC},
                               cpr::Parameters{{&quot;anon&quot;, &quot;true&quot;}, {&quot;key&quot;, &quot;value&quot;}});
    std::cout &lt;&lt; &quot;Status code: &quot; &lt;&lt; r.status_code &lt;&lt; '\n';
    std::cout &lt;&lt; &quot;Header:\n&quot;;
    for (const std::pair&lt;const std::basic_string&lt;char&gt;, std::basic_string&lt;char&gt;&gt;&amp; kv : r.header) {
        std::cout &lt;&lt; '\t' &lt;&lt; kv.first &lt;&lt; ':' &lt;&lt; kv.second &lt;&lt; '\n';
    }
    std::cout &lt;&lt; &quot;Text: &quot; &lt;&lt; r.text &lt;&lt; '\n';
    return 0;
}
</code></pre>
</details>
<h2 id="zmqé«˜æ•ˆ-å¤šåŠŸèƒ½çš„é€šä¿¡åº“">ZMQï¼šé«˜æ•ˆã€å¤šåŠŸèƒ½çš„é€šä¿¡åº“</h2>
<p><code>libcurl</code> å’Œ <code>cpr</code> å¤„ç†çš„éƒ½æ˜¯ HTTP åè®®ï¼Œæ–¹ä¾¿ä½†åè®®è‡ªèº«ä¹Ÿæœ‰ä¸€äº›é™åˆ¶ï¼Œæ¯”å¦‚å¿…é¡»è¦ä¸€æ¥ä¸€å›ï¼Œå¿…é¡»ç‚¹å¯¹ç‚¹ç›´è¿ï¼Œåœ¨è¶…å¤§æ•°æ®é‡é€šä¿¡çš„æ—¶å€™å°±ä¸æ˜¯å¤ªåˆé€‚ã€‚<u>å¹¶ä¸” </u><u><code>libcurl</code></u><u> å’Œ </u><u><code>cpr</code></u><u> åªèƒ½å……å½“ HTTP çš„å®¢æˆ·ç«¯</u>ã€‚</p>
<p>ZMQ ä¸ä»…æ˜¯ä¸€ä¸ªå•çº¯çš„ç½‘ç»œé€šä¿¡åº“ï¼Œæ›´åƒæ˜¯ä¸€ä¸ªé«˜çº§çš„å¼‚æ­¥å¹¶å‘æ¡†æ¶ã€‚</p>
<p><a href="https://zeromq.org/get-started/">https://zeromq.org/get-started/</a></p>
<p>Zero Message Queueâ€”â€”é›¶å»¶è¿Ÿçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ„å‘³ç€å®ƒé™¤äº†å¯ä»¥æ”¶å‘æ•°æ®å¤–ï¼Œè¿˜å¯ä»¥ç”¨ä½œæ¶ˆæ¯ä¸­é—´ä»¶ï¼Œè§£è€¦å¤šä¸ªåº”ç”¨æœåŠ¡ä¹‹é—´çš„å¼ºä¾èµ–å…³ç³»ï¼Œæ­å»ºé«˜æ•ˆã€æœ‰å¼¹æ€§çš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œä»è€Œè¶…è¶ŠåŸç”Ÿçš„ Socketã€‚</p>
<p>ubuntu ä¸‹å®‰è£…</p>
<pre><code class="language-bash">apt-get install libzmq3-dev
</code></pre>
<p>ZMQ æ˜¯ç”¨ C++ å¼€å‘çš„ï¼Œä½†å‡ºäºå…¼å®¹çš„è€ƒè™‘ï¼Œå¯¹å¤–æä¾›çš„æ˜¯çº¯ C æ¥å£ã€‚å®ƒä¹Ÿæœ‰å¾ˆå¤š<font color='#c04d8a'> C++ å°è£…ï¼Œå¯ä»¥ä½¿ç”¨</font> <a href="https://github.com/zeromq/cppzmq">cppzmq</a>ï¼Œåªæœ‰å¤´æ–‡ä»¶çš„å°è£…ï¼Œç®€å•ä½¿ç”¨ã€‚</p>
<p>ZMQ æŠŠè‡ªèº«å®šä½äºæ›´é«˜å±‚æ¬¡çš„â€œå¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—â€ï¼Œå®šä¹‰äº† 5 ç§ä¸åŒçš„å·¥ä½œæ¨¡å¼ï¼Œæ¥é€‚åº”å®é™…ä¸­å¸¸è§çš„ç½‘ç»œé€šä¿¡åœºæ™¯ã€‚</p>
<ul>
<li>
<p>åŸç”Ÿæ¨¡å¼ï¼ˆRAWï¼‰ï¼Œæ²¡æœ‰æ¶ˆæ¯é˜Ÿåˆ—åŠŸèƒ½ï¼Œç›¸å½“äºåº•å±‚ Socket çš„ç®€å•å°è£…ï¼›</p>
</li>
<li>
<p>ç»“å¯¹æ¨¡å¼ï¼ˆPAIRï¼‰ï¼Œä¸¤ä¸ªç«¯ç‚¹ä¸€å¯¹ä¸€é€šä¿¡ï¼›</p>
</li>
<li>
<p>è¯·æ±‚å“åº”æ¨¡å¼ï¼ˆREQ-REPï¼‰ï¼Œä¹Ÿæ˜¯ä¸¤ä¸ªç«¯ç‚¹ä¸€å¯¹ä¸€é€šä¿¡ï¼Œä½†è¯·æ±‚å¿…é¡»æœ‰å“åº”ï¼›</p>
</li>
<li>
<p>å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼ˆPUB-SUBï¼‰ï¼Œä¸€å¯¹å¤šé€šä¿¡ï¼Œä¸€ä¸ªç«¯ç‚¹å‘å¸ƒæ¶ˆæ¯ï¼Œå¤šä¸ªç«¯ç‚¹æ¥æ”¶å¤„ç†ï¼›</p>
</li>
<li>
<p>ç®¡é“æ¨¡å¼ï¼ˆ<strong>PUSH-PULL</strong>ï¼‰ï¼Œæˆ–è€…å«æµæ°´çº¿ï¼Œå¯ä»¥ä¸€å¯¹å¤šï¼Œä¹Ÿå¯ä»¥å¤šå¯¹ä¸€ï¼›</p>
</li>
</ul>
<p>å‰å››ç§æ¨¡å¼ç±»ä¼¼ HTTP åè®®ã€Client-Server æ¶æ„ï¼Œ<strong>ç®¡é“æ¨¡å¼</strong>éå¸¸é€‚åˆ<font color='#d44c47'>è¿›ç¨‹é—´æ— é˜»å¡ä¼ é€æµ·é‡æ•°æ®</font>ã€‚ç®¡é“æ¨¡å¼ä»‹ç»ç¤ºæ„ï¼š</p>
<figure data-type="image" tabindex="1"><img src="https://static001.geekbang.org/resource/image/8b/2d/8b868214b032aebfcee1e0e97a8a1e2d.png?wh=360*480" alt="" loading="lazy"></figure>
<p>åœ¨ ZMQ é‡Œæœ‰ä¸¤ä¸ªåŸºæœ¬çš„ç±»ã€‚</p>
<ul>
<li>
<p>ç¬¬ä¸€ä¸ªæ˜¯ <code>context_t</code>ï¼Œå®ƒæ˜¯ ZMQ çš„è¿è¡Œç¯å¢ƒã€‚ä½¿ç”¨ ZMQ çš„ä»»ä½•åŠŸèƒ½å‰ï¼Œå¿…é¡»è¦å…ˆåˆ›å»ºå®ƒã€‚</p>
</li>
<li>
<p>ç¬¬äºŒä¸ªæ˜¯ <code>socket_t</code>ï¼Œè¡¨ç¤º ZMQ çš„å¥—æ¥å­—ï¼Œéœ€è¦<u>æŒ‡å®šåˆšæ‰è¯´çš„é‚£ 5 ç§å·¥ä½œæ¨¡å¼</u>ã€‚æ³¨æ„å®ƒä¸åŸç”Ÿ Socket æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œåªæ˜¯å€Ÿç”¨äº†åå­—æ¥æ–¹ä¾¿ç†è§£ã€‚</p>
</li>
</ul>
<p>ZMQ å¥—æ¥å­—æ”¯æŒ TCP/IPï¼Œè¿˜æ”¯æŒè¿›ç¨‹å†…å’Œè¿›ç¨‹é—´é€šä¿¡ï¼Œè¿™åœ¨æœ¬æœºäº¤æ¢æ•°æ®æ—¶ä¼šæ›´é«˜æ•ˆï¼š</p>
<ul>
<li>
<p><font color='#c04d8a'>TCP é€šä¿¡</font>åœ°å€çš„å½¢å¼æ˜¯ <code>tcp://â€¦</code>ï¼ŒæŒ‡å®š IP åœ°å€å’Œç«¯å£å·ï¼›</p>
</li>
<li>
<p><font color='#c04d8a'>è¿›ç¨‹å†…é€šä¿¡</font>åœ°å€çš„å½¢å¼æ˜¯ <code>inproc://â€¦</code>ï¼ŒæŒ‡å®šä¸€ä¸ªæœ¬åœ°å¯è®¿é—®çš„è·¯å¾„ï¼›</p>
</li>
<li>
<p><font color='#c04d8a'>è¿›ç¨‹é—´é€šä¿¡</font>åœ°å€çš„å½¢å¼æ˜¯ <code>ipc://â€¦</code>ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæœ¬åœ°å¯è®¿é—®çš„è·¯å¾„ã€‚</p>
</li>
</ul>
<p>ç”¨ bind()/connect() è¿™ä¸¤ä¸ªå‡½æ•°æŠŠ ZMQ å¥—æ¥å­—è¿æ¥èµ·æ¥ä¹‹åï¼Œå°±å¯ä»¥ç”¨ send()/recv() æ¥æ”¶å‘æ•°æ®äº†ï¼š</p>
<details class="markdown">
<summary><b><font color='#da720f'>Codeç¤ºä¾‹</font></b></summary>
<pre><code class="language-c++">#include &quot;zmq.hpp&quot;

#include &lt;iostream&gt;
#include &lt;memory&gt;
#include &lt;string&gt;
#include &lt;thread&gt;

using namespace std;

int main() {
    const auto thread_num = 1;               // å¹¶å‘çº¿ç¨‹æ•°z
    zmq::context_t context(thread_num);      // ZMQç¯å¢ƒå˜é‡
    auto make_sock = [&amp;](auto mode) {        // å®šä¹‰ä¸€ä¸ªlambdaè¡¨è¾¾å¼
        return zmq::socket_t(context, mode); // åˆ›å»ºZMQå¥—æ¥å­—
    };

    const auto addr = &quot;ipc:///tmp/shm/zmq.sock&quot;s; // é€šä¿¡åœ°å€

    auto receiver = [=]() {              //  lambdaè¡¨è¾¾å¼æ¥æ”¶æ•°æ®
        auto sock = make_sock(ZMQ_PULL); // åˆ›å»ºZMQå¥—æ¥å­—ï¼Œæ‹‰æ•°æ®

        sock.bind(addr);                  // ç»‘å®šå¥—æ¥å­—
        assert(sock.handle() != nullptr); // æ–­è¨€å¥—æ¥å­—æœ‰æ•ˆ

        auto buf = make_unique&lt;char[]&gt;(1024);     // åˆ›å»ºä¸€ä¸ª1024å­—èŠ‚çš„ç¼“å†²åŒº
        zmq::mutable_buffer msg(buf.get(), 1024); // åˆ›å»ºZMQæ¶ˆæ¯
        sock.recv(msg, zmq::recv_flags::none);    // æ¥æ”¶æ•°æ®
        cout &lt;&lt; (char*)msg.data() &lt;&lt; endl;
    };

    auto sender = [=]() {                // lambdaè¡¨è¾¾å¼å‘é€æ•°æ®
        auto sock = make_sock(ZMQ_PUSH); // åˆ›å»ºZMQå¥—æ¥å­—ï¼Œæ¨æ•°æ®

        sock.connect(addr); // è¿æ¥åˆ°å¯¹ç«¯
        assert(sock.handle() != nullptr);

        string s = &quot;hello zmq&quot;;
        sock.send(zmq::const_buffer{s.data(), s.length()}); // å‘é€æ¶ˆæ¯
    };

    thread t1(sender);
    thread t2(receiver);

    t1.join();
    t2.join();
}
</code></pre>
</details>
<p>ä½¿ç”¨ ZMQ å®Œå…¨ä¸éœ€è¦è€ƒè™‘åº•å±‚çš„ TCP/IP é€šä¿¡ç»†èŠ‚ï¼Œå®ƒä¼šä¿è¯æ¶ˆæ¯å¼‚æ­¥ã€å®‰å…¨ã€å®Œæ•´åœ°åˆ°è¾¾æœåŠ¡å™¨ï¼Œè®©ä½ å…³æ³¨ç½‘ç»œé€šä¿¡ä¹‹ä¸Šçš„ä¸šåŠ¡é€»è¾‘ã€‚</p>
<hr>
<p>å…¶ä»–è¯´æ˜</p>
<ul>
<li>
<p>ZMQ ç¯å¢ƒçš„çº¿ç¨‹æ•°ã€‚å®ƒçš„é»˜è®¤å€¼æ˜¯ 1ï¼Œé€‚å½“å¢å¤§ä¸€äº›å°±å¯ä»¥æé«˜ ZMQ çš„å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚</p>
</li>
<li>
<p>æ”¶å‘æ¶ˆæ¯æ—¶çš„æœ¬åœ°ç¼“å­˜æ•°é‡ï¼ŒZMQ çš„æœ¯è¯­å« High Water Markã€‚å¦‚æœæ”¶å‘çš„æ•°æ®è¿‡å¤šï¼Œæ•°é‡è¶…è¿‡ HWMï¼ŒZMQ è¦ä¹ˆé˜»å¡ï¼Œè¦ä¹ˆä¸¢å¼ƒæ¶ˆæ¯ã€‚</p>
</li>
</ul>
<p>HWM éœ€è¦è°ƒç”¨å¥—æ¥å­—çš„æˆå‘˜å‡½æ•° setsockopt() æ¥è®¾ç½®ï¼Œæ³¨æ„æ”¶å‘ä½¿ç”¨çš„æ˜¯ä¸¤ä¸ªä¸åŒçš„æ ‡å¿—ï¼š</p>
<pre><code class="language-c++">sock.setsockopt(ZMQ_RCVHWM, 1000); // æ¥æ”¶æ¶ˆæ¯æœ€å¤šç¼“å­˜1000æ¡
sock.setsockopt(ZMQ_SNDHWM, 100); // å‘é€æ¶ˆæ¯æœ€å¤šç¼“å­˜100æ¡
</code></pre>
<p>å³ä½¿è®¾ç½® 100 ä¸‡ä»¥ä¸Šçš„å€¼ï¼ŒZMQ ä¼šæŠŠä¸€åˆ‡éƒ½å¤„ç†å¾—å¾ˆå¥½ã€‚</p>
<hr>
<h2 id="sockpp">sockpp</h2>
<p>ç®€å•æ˜“ç”¨çš„C++ Socket åº“ï¼Œè¿™æ˜¯ä¸€ä¸ª<font color='#d44c47'>ä½å±‚çº§çš„ socket åŒ…è£…åº“</font>ï¼Œæä¾› <code>socket</code>, <code>connector</code>, <code>acceptor</code> ç­‰ç›¸å…³æ¥å£ã€‚</p>
<p><strong>ä¸‹è½½å¹¶å®‰è£…</strong></p>
<p><a href="https://github.com/fpagliughi/sockpp">https://github.com/fpagliughi/sockpp</a></p>
<pre><code class="language-shell">git clone https://github.com/fpagliughi/sockpp
cd sockpp
mkdir build &amp;&amp; cd build
cmake .. # é»˜è®¤ä½¿ç”¨ -DSOCKPP_BUILD_SHARED=ON
cmake --build . --target install
</code></pre>
<p><font color='#d44c47'>MacOS ä¸‹å¦‚æœä½¿ç”¨ gcc/g++ï¼Œåˆ™ä½¿ç”¨ gcc/g++ toolchain ç¼–è¯‘å®‰è£…</font></p>
<p>ä½¿ç”¨æ–¹å¼éå¸¸ç®€å•ï¼Œä¾‹å¦‚ TCP ç¼–ç¨‹ï¼š</p>
<details class="markdown">
<summary><b><font color='#da720f'>TCP Server</font></b></summary>
<pre><code class="language-c++">#include &lt;iostream&gt;
#include &lt;thread&gt;
#include &quot;sockpp/tcp_acceptor.h&quot;
#include &quot;sockpp/version.h&quot;

using namespace std;
// The thread function. 
void run_echo(sockpp::tcp_socket sock)
{
	ssize_t n;
	char buf[512];
	
	while ((n = sock.read(buf, sizeof(buf))) &gt; 0)
		sock.write_n(buf, n);
	cout &lt;&lt; &quot;Connection closed from &quot; &lt;&lt; sock.peer_address() &lt;&lt; endl;
}

int main(int argc, char* argv[])
{
	cout &lt;&lt; &quot;Sample TCP echo server for 'sockpp' &quot;
		&lt;&lt; sockpp::SOCKPP_VERSION &lt;&lt; '\n' &lt;&lt; endl;

	in_port_t port = (argc &gt; 1) ? atoi(argv[1]) : 12345;

	sockpp::socket_initializer sockInit;
	sockpp::tcp_acceptor acc(port);

	if (!acc) {
		cerr &lt;&lt; &quot;Error creating the acceptor: &quot; &lt;&lt; acc.last_error_str() &lt;&lt; endl;
		return 1;
	}
	cout &lt;&lt; &quot;Awaiting connections on port &quot; &lt;&lt; port &lt;&lt; &quot;...&quot; &lt;&lt; endl;

	while (true) {
		sockpp::inet_address peer;

		// Accept a new client connection
		sockpp::tcp_socket sock = acc.accept(&amp;peer);
		cout &lt;&lt; &quot;Received a connection request from &quot; &lt;&lt; peer &lt;&lt; endl;

		if (!sock) {
			cerr &lt;&lt; &quot;Error accepting incoming connection: &quot; 
				&lt;&lt; acc.last_error_str() &lt;&lt; endl;
		}
		else {
			// Create a thread and transfer the new stream to it.
			thread thr(run_echo, std::move(sock));
			thr.detach();
		}
	}
	return 0;
}
</code></pre>
</details>
<details class="markdown">
<summary><b><font color='#da720f'>TCP Client</font></b></summary>
<pre><code class="language-c++">#include &lt;iostream&gt;
#include &lt;string&gt;
#include &quot;sockpp/tcp_connector.h&quot;
#include &quot;sockpp/version.h&quot;

using namespace std;
using namespace std::chrono;

int main(int argc, char* argv[])
{
	cout &lt;&lt; &quot;Sample TCP echo client for 'sockpp' &quot;
		&lt;&lt; sockpp::SOCKPP_VERSION &lt;&lt; '\n' &lt;&lt; endl;

	string host = (argc &gt; 1) ? argv[1] : &quot;localhost&quot;;
	in_port_t port = (argc &gt; 2) ? atoi(argv[2]) : 12345;

	sockpp::socket_initializer sockInit;
	sockpp::tcp_connector conn({host, port});
	if (!conn) {
		cerr &lt;&lt; &quot;Error connecting to server at &quot;
			&lt;&lt; sockpp::inet_address(host, port)
			&lt;&lt; &quot;\n\t&quot; &lt;&lt; conn.last_error_str() &lt;&lt; endl;
		return 1;
	}

	cout &lt;&lt; &quot;Created a connection from &quot; &lt;&lt; conn.address() &lt;&lt; endl;

	// Set a timeout for the responses
	if (!conn.read_timeout(seconds(5))) {
	    cerr &lt;&lt; &quot;Error setting timeout on TCP stream: &quot;
	            &lt;&lt; conn.last_error_str() &lt;&lt; endl;
	}

	string s, sret;
	while (getline(cin, s) &amp;&amp; !s.empty()) {
		if (conn.write(s) != ssize_t(s.length())) {
			cerr &lt;&lt; &quot;Error writing to the TCP stream: &quot;
				&lt;&lt; conn.last_error_str() &lt;&lt; endl;
			break;
		}

		sret.resize(s.length());
		ssize_t n = conn.read_n(&amp;sret[0], s.length());

		if (n != ssize_t(s.length())) {
			cerr &lt;&lt; &quot;Error reading from TCP stream: &quot;
				&lt;&lt; conn.last_error_str() &lt;&lt; endl;
			break;
		}
		cout &lt;&lt; sret &lt;&lt; endl;
	}
	return (!conn) ? 1 : 0;
}
</code></pre>
</details>
<h2 id="å°ç»“">å°ç»“</h2>
<ol>
<li>
<p>libcurl æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå–„ã€ç¨³å®šå¯é çš„åº”ç”¨å±‚é€šä¿¡åº“ï¼Œæœ€å¸¸ç”¨çš„å°±æ˜¯ HTTP åè®®ï¼›</p>
</li>
<li>
<p>cpr æ˜¯å¯¹ libcurl çš„ C++ å°è£…ï¼Œæ¥å£ç®€å•æ˜“ç”¨ï¼›libcurl å’Œ cpr éƒ½åªèƒ½ä½œä¸ºå®¢æˆ·ç«¯æ¥ä½¿ç”¨ï¼Œä¸èƒ½ç¼–å†™æœåŠ¡å™¨ç«¯åº”ç”¨ï¼›</p>
</li>
<li>
<p>ZMQ æ˜¯ä¸€ä¸ªé«˜çº§çš„ç½‘ç»œé€šä¿¡åº“ï¼Œæ”¯æŒå¤šç§é€šä¿¡æ¨¡å¼ï¼Œå¯ä»¥æŠŠæ¶ˆæ¯é˜Ÿåˆ—åŠŸèƒ½ç›´æ¥åµŒå…¥åº”ç”¨ç¨‹åºï¼Œæ­å»ºå‡ºé«˜æ•ˆã€çµæ´»ã€å…ç®¡ç†çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚</p>
</li>
<li>
<p>sockpp æ˜¯ä¸€ä¸ªç®€å•æ˜“ç”¨çš„åº•å±‚sockå°è£…åº“ã€‚</p>
</li>
</ol>
<p>æœ€åï¼Œ C++20ï¼ŒåŸæœ¬é¢„è®¡ä¼šåŠ å…¥æœŸå¾…å·²ä¹…çš„ networking åº“ï¼Œä½†ç°åœ¨å·²ç»è¢«æ¨è¿Ÿåˆ°äº†ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼ˆC++23ï¼‰</p>
<p>networking åº“åŸºäºå·²æœ‰å¤šå¹´å®è·µçš„ <code>boost.asio</code>ï¼Œé‡‡ç”¨å‰æ‘„å™¨æ¨¡å¼ï¼ˆProactorï¼‰ç»Ÿä¸€å°è£…äº†æ“ä½œç³»ç»Ÿçš„å„ç§å¼‚æ­¥æœºåˆ¶ï¼ˆ<code>epoll</code>ã€<code>kqueue</code>ã€<code>IOCP</code>ï¼‰ï¼Œè€Œä¸”æ”¯æŒåç¨‹ã€‚</p>
</div>

                <!-- æ–°åŠ çš„æ¨¡å—çš„ï¼Œåº”è¯¥ä½¿ç”¨æ¨¡ç‰ˆ-->
                <!-- ç‰ˆæƒå£°æ˜ -->
                
                  <div class="jumbotron">
                    <div class="container">
                      <p>
                        <i class="ri-article-line"></i>
                        <b>æœ¬æ–‡é“¾æ¥:</b>
                        <a href="https://blog.qxxiao.eu.org/post/C++ç½‘ç»œåº“/" target="_blank">
                          C++ç½‘ç»œåº“
                        </a>
                      </p>
                      <p>
                        <i class="ri-creative-commons-line"></i>
                        <b>ç‰ˆæƒå£°æ˜:</b>
                        æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨
                        <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">CC
                          BY-NC-SA
                          4.0</a>
                        è®¸å¯åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚
                      </p>
                      <p>
                        <i class="ri-time-line"></i>
                        <b>å‘å¸ƒæ—¥æœŸ:</b>
                        2022-10-23
                      </p>
                      <p>
                        <i class="ri-time-line"></i>
                        <b>æœ€æ–°æ„å»º:</b>
                        2024-07-02
                          <!-- ä½¿ç”¨ themeConfig.dateFormat æ ¼å¼å¯¹æ—¥æœŸæ ¼å¼åŒ–ï¼Œä¾‹å¦‚YY-MM-DD -->
                          <!-- {
  &#34;content&#34;: &#34;&lt;!-- more --&gt;\n&lt;h2 id=\&#34;2024-06-10\&#34;&gt;2024-06-10&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;æ·»åŠ äº†ç›¸å†Œçš„æ—¶é—´çº¿æ ·å¼&lt;/li&gt;\n&lt;li&gt;æ·»åŠ äº†ä¹¦å•é¡µé¢&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;2024-06-09\&#34;&gt;2024-06-09&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;ä¿®æ”¹äº†éƒ¨åˆ†æ ·å¼ï¼Œå»é™¤äº†å¤šä¸ªé¡µé¢ä¸­çš„ css class: animated fadeInï¼Œé¿å…é¡µé¢åˆ·æ–°æ—¶æŠ–åŠ¨&lt;/li&gt;\n&lt;li&gt;ä¿®æ”¹äº†æ–‡ç«  TOC ç›®å½•çš„å®½åº¦æ ·å¼, åªé™åˆ¶æœ€å°/æœ€å¤§å®½åº¦ï¼Œä½¿å…¶èƒ½å¤Ÿè‡ªé€‚åº”å†…å®¹å®½åº¦&lt;/li&gt;\n&lt;li&gt;ç»Ÿä¸€ post æ–‡ç« å’Œ diary/gallary é¡µé¢çš„å›åˆ°é¡¶éƒ¨/åº•éƒ¨æŒ‰é’®æ ·å¼å’Œä½ç½®&lt;/li&gt;\n&lt;li&gt;ç®€åŒ–äº† æ˜äº®/é»‘æš—æ¨¡å¼åˆ‡æ¢ä»£ç ï¼Œåˆ é™¤äº† &lt;code&gt;ldbutton.js&lt;/code&gt;ï¼Œä½¿ç”¨ Vue æ¥æ§åˆ¶æ ·å¼åˆ‡æ¢ã€‚ä½†åˆ·æ–°ä¼šå¯¼è‡´é¡µé¢é—ªå±ï¼Œå› ä¸º Vue æ‰§è¡Œå®Œ mounted åæ‰ä¼šæ­£ç¡®è®¡ç®—å½“å‰æ¨¡å¼ï¼›è§£å†³ï¼šä½¿ç”¨ js å‡½æ•°æ¥æå‰å®Œæˆæ¨¡å¼çš„åˆå§‹åŒ–ï¼Œé¿å…é—ªå±&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;2023-12-20\&#34;&gt;2023-12-20&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;æ·»åŠ &lt;code&gt;æ—¶å…‰/è¯´è¯´&lt;/code&gt;åŠŸèƒ½ï¼Œæ•°æ®æ¥æºäº Memos\n&lt;ul&gt;\n&lt;li&gt;ç”±äºè¯„è®ºéƒ¨ç½²åœ¨ vercelï¼ŒåŠ è½½æ…¢ï¼Œè¯´è¯´è¯„è®ºéœ€è¦åœ¨&lt;a href=\&#34;https://memos.qxxiao.eu.org\&#34;&gt;åŸå§‹ Memos é¡µé¢&lt;/a&gt;æ‰“å¼€è¯„è®º (æ›´æ–°ï¼šæ·»åŠ äº†é¡µé¢è¯„è®ºï¼Œå¯ä»¥ç›´æ¥åœ¨å½“å‰é¡µé¢è®¿é—®)&lt;/li&gt;\n&lt;li&gt;è¯´è¯´æœåŠ¡å™¨éƒ¨ç½²åœ¨ Azureï¼Œå¯èƒ½éœ€è¦ä»£ç†æ‰èƒ½æ­£å¸¸è®¿é—®&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;å°†ä»“åº“åŒæ­¥åˆ° githubï¼Œåˆ©ç”¨ github actions è¿›è¡Œåšå®¢åŒæ­¥\n&lt;ul&gt;\n&lt;li&gt;ä¹‹å‰ä½¿ç”¨ Mac ç›‘æ§è„šæœ¬åŒæ­¥åšå®¢ï¼Œgridea æ¯æ¬¡é¢„è§ˆå¯èƒ½ä¼šè§¦å‘å¯¼è‡´ç«™ç‚¹ url æ˜¯ localhostï¼Œå¹¶ä¸”æœ‰æ—¶ä»»åŠ¡è§¦å‘ä¸åŠæ—¶&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;æ·»åŠ  &lt;a href=\&#34;https://github.com/kytrun/gridea-search\&#34;&gt;gridea-search æ’ä»¶&lt;/a&gt;ï¼Œå¯¹åº”æ·»åŠ äº†æœç´¢æ¡†ï¼Œè°ƒæ•´äº†ä¸€ä¸‹èœå•ç•Œé¢&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;2023-12-12\&#34;&gt;2023-12-12&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;æ›´æ–°è¯„è®ºç³»ç»Ÿ twikoo ç‰ˆæœ¬åˆ° 1.6.27&lt;/li&gt;\n&lt;li&gt;æ›´æ–°æ ·å¼ï¼Œåˆ é™¤å‹é“¾èœå•ï¼Œç›´æ¥åœ¨&lt;a href=\&#34;/post/about\&#34;&gt;å…³äºé¡µé¢&lt;/a&gt;æ·»åŠ ï¼Œä¿ç•™äº†éƒ¨åˆ† css æ ·å¼&lt;/li&gt;\n&lt;li&gt;ä¼˜åŒ–ï¼Œä½¿ç”¨ &lt;code&gt;v-cloak&lt;/code&gt; é¿å…å‡ºç° post é¡µé¢çš„æ–‡ç« ç›®å½•é—ªçƒé—®é¢˜&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;2022-07-06\&#34;&gt;2022-07-06&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;ä¿®æ”¹æ ·å¼ï¼Œæ·»åŠ æš—äº®æ¨¡å¼åˆ‡æ¢&lt;/li&gt;\n&lt;li&gt;ä¿®æ”¹é»˜è®¤æ ·å¼æŸ¥è¯¢æ–¹å¼ï¼Œç®€å•æ ·å¼é€‚é…&lt;/li&gt;\n&lt;li&gt;ä¿®æ”¹ä»£ç ä¸»é¢˜ä¸º &lt;code&gt;vs-dark&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;2022-03-20\&#34;&gt;2022-03-20&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;æ·»åŠ æ–‡ç« åˆ—è¡¨ä¸­çš„æ ‡ç­¾çš„æ˜¾ç¤ºï¼Œè®¾ç½®æ ‡ç­¾æ ·å¼(é»˜è®¤æ²¡æœ‰ border-indigo-500 ç­‰æ ·å¼)&lt;/li&gt;\n&lt;li&gt;ä¼˜åŒ–å¸ƒå±€&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;2022-02-27\&#34;&gt;2022-02-27&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;æ·»åŠ ä»£ç æ ·å¼ï¼Œå¢åŠ è¡Œå·å’Œå¤åˆ¶é€‰é¡¹&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;2022-02-25\&#34;&gt;2022-02-25&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;ä¿®æ”¹ä¸»é¢˜é…ç½®ï¼Œæ·»åŠ å‹é“¾èœå•ï¼Œä¼˜åŒ–äº†é¡µé¢æ•ˆæœ&lt;/li&gt;\n&lt;li&gt;æ·»åŠ å¯¼èˆªèœå•&lt;/li&gt;\n&lt;li&gt;é¡µé¢æ ·å¼ç§»åŠ¨å’Œä¿®æ”¹&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;2022-02-20\&#34;&gt;2022-02-20&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;æ›´æ–°é¡µé¢æ ·å¼ï¼Œæ·»åŠ ç‰ˆæƒå’Œè¯´æ˜ï¼ˆæ”¹å˜å­—ä½“å¯èƒ½ä¼šå¯¼è‡´ä¸­æ–‡ç›®å½•ä¸èƒ½æ­£ç¡®è·³è½¬ï¼‰&lt;/li&gt;\n&lt;li&gt;æ›´æ–°å½’æ¡£é¡µé¢ï¼Œæ·»åŠ æ—¥æœŸä¿¡æ¯å’Œæ¯ç¯‡æ–‡ç« çš„ç›¸å…³æè¿°&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&#34;2022-02-10\&#34;&gt;2022-02-10&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;ç®€å•ä½¿ç”¨ Rocky ä¸»é¢˜&lt;/li&gt;\n&lt;li&gt;ä¿®æ”¹ä¸»é¡µä¿¡æ¯çš„æè¿°ä»¥åŠ footer ä¿¡æ¯&lt;/li&gt;\n&lt;li&gt;ä½¿ç”¨ Twikoo è¯„è®º&lt;/li&gt;\n&lt;/ul&gt;\n&#34;,
  &#34;fileName&#34;: &#34;log&#34;,
  &#34;abstract&#34;: &#34;&#34;,
  &#34;title&#34;: &#34;æ›´æ–°æ—¥å¿—&#34;,
  &#34;tags&#34;: [],
  &#34;date&#34;: &#34;2020-01-05 00:37:45&#34;,
  &#34;dateFormat&#34;: &#34;2020-01-05&#34;,
  &#34;feature&#34;: &#34;&#34;,
  &#34;link&#34;: &#34;https://blog.qxxiao.eu.org/post/log/&#34;,
  &#34;hideInList&#34;: true,
  &#34;isTop&#34;: false,
  &#34;stats&#34;: {
    &#34;text&#34;: &#34;3 min read&#34;,
    &#34;time&#34;: 139000,
    &#34;words&#34;: 636,
    &#34;minutes&#34;: 3
  },
  &#34;description&#34;: &#34;\n2024-06-10\n\næ·»åŠ äº†ç›¸å†Œçš„æ—¶é—´çº¿æ ·å¼\næ·»åŠ äº†ä¹¦å•é¡µé¢\n\n2024-06-09\n\nä¿®æ”¹äº†éƒ¨åˆ†æ ·å¼ï¼Œå»é™¤äº†å¤šä¸ªé¡µé¢ä¸­çš„ css class: animated fadeInï¼Œé¿å…é¡µé¢åˆ·æ–°æ—¶æŠ–åŠ¨\nä¿®æ”¹äº†æ–‡ç«  TOC ç›®å½•çš„å®½åº¦æ ·å¼, ...&#34;,
  &#34;toc&#34;: &#34;&lt;ul class=\&#34;markdownIt-TOC\&#34;&gt;\n&lt;li&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&#34;#2024-06-10\&#34;&gt;2024-06-10&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#2024-06-09\&#34;&gt;2024-06-09&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#2023-12-20\&#34;&gt;2023-12-20&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#2023-12-12\&#34;&gt;2023-12-12&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#2022-07-06\&#34;&gt;2022-07-06&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#2022-03-20\&#34;&gt;2022-03-20&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#2022-02-27\&#34;&gt;2022-02-27&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#2022-02-25\&#34;&gt;2022-02-25&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#2022-02-20\&#34;&gt;2022-02-20&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&#34;#2022-02-10\&#34;&gt;2022-02-10&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&#34;
}
                            
                                  2022-10-23
                                     -->
                      </p>
                    </div>
                  </div>
                  
                    <!-- æ–°åŠ çš„æ¨¡å—çš„ï¼Œåº”è¯¥ä½¿ç”¨æ¨¡ç‰ˆ-->
                    <!--é˜…è¯»æ¬¡æ•°-->
                    <div class="text-center text-gray-400">
                      <i class="ri-eye-line"></i>
                      æœ¬æ–‡å·²è¢«é˜…è¯»
                      <span id="twikoo_visitors">0</span>
                      æ¬¡ï¼Œè¯¥æ•°æ®ä»…ä¾›å‚è€ƒ
                    </div>

                    <!-- Share to Twitter, Weibo, Telegram -->
                    <div class="flex items-center">
                      <div class="mr-4 flex items-center">
                        <i class="ri-share-forward-line text-gray-500"></i>
                      </div>
                      <div
                        class="px-4 cursor-pointer text-blue-500 hover:bg-blue-100 dark:hover:bg-gray-600 inline-flex"
                        @click="shareToTwitter">
                        <i class="ri-twitter-line"></i>
                      </div>
                      <div class="px-4 cursor-pointer text-red-500 hover:bg-red-100 dark:hover:bg-gray-600 inline-flex"
                        @click="shareToWeibo">
                        <i class="ri-weibo-line"></i>
                      </div>
                      <div
                        class="px-4 cursor-pointer text-indigo-500 hover:bg-indigo-100 dark:hover:bg-gray-600 inline-flex"
                        @click="shareToTelegram">
                        <i class="ri-telegram-line"></i>
                      </div>
                    </div>
          </div>

          <!-- æ–°åŠ çš„æ¨¡å—çš„ï¼Œåº”è¯¥ä½¿ç”¨æ¨¡ç‰ˆ-->
          <!-- è¯„è®ºè¯´æ˜-->
          <div class="jumbotron-comment">
            <div class="container">
              <p>
                <i class="ri-message-3-line"></i>
                æ¬¢è¿ä»»ä½•ä¸æ–‡ç« å†…å®¹ç›¸å…³å¹¶ä¿æŒå°Šé‡çš„è¯„è®ºğŸ˜Š !
              </p>
            </div>
          </div>

          
                        
                            
                              <div id="tcomment"></div>
                               <footer class="py-12 text-center px-4 md:px-0" v-pre>
  å…± 43 ç¯‡æ–‡ç«  | Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <i class="ri-rss-line"></i><a href="https://blog.qxxiao.eu.org/atom.xml" target="_blank" target="_blank">RSS</a></br>
Â©2020-2024 <a href="https://blog.qxxiao.eu.org/index.html" target="_blank">Nuo</a>. All rights reserved.
</footer>

<!--æ²¡æœ‰æ·»åŠ /ç”¨åˆ°app ä¸­çš„ä¸»é¢˜footeré…ç½®æ¶ˆæ¯ï¼Œå¦‚æœä½¿ç”¨ï¼Œå°†ä¸Šé¢çš„ href æ›¿æ¢ä¸ºåŸåœ°å€-->
<!---->

        </div>

        <!-- TOC Container -->
        <div
          class="fixed right-0 bottom-0 mb-40 mr-4 shadow w-10 h-10 rounded-full flex justify-center items-center z-10 cursor-pointer bg-white dark:bg-gray-500 dark:text-gray-200 hover:shadow-lg transition-all"
          @click="showToc = true">
          <i class="ri-file-list-line"></i>
        </div>

        <div v-cloak
          class="fixed right-0 top-0 bottom-0 overflow-y-auto w-16-24 bg-white dark:bg-gray-800 p-4 border-l border-gray-100 dark:border-gray-600 z-10 transition-fast"
          :class="{ '-mr-64': !showToc }">
          <div class="flex mb-4 justify-end">
            <div
              class="w-8 h-8 inline-flex justify-center items-center rounded-full cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 transition-fast"
              @click="showToc = false">
              <i class="ri-close-line text-lg"></i>
            </div>
          </div>
          <div class="post-toc-container"><ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#libcurl%E9%AB%98%E5%8F%AF%E7%A7%BB%E6%A4%8D-%E5%8A%9F%E8%83%BD%E4%B8%B0%E5%AF%8C%E7%9A%84%E9%80%9A%E4%BF%A1%E5%BA%93">libcurlï¼šé«˜å¯ç§»æ¤ã€åŠŸèƒ½ä¸°å¯Œçš„é€šä¿¡åº“</a></li>
<li><a href="#font-colord44c47cpr%E6%9B%B4%E7%8E%B0%E4%BB%A3-%E6%9B%B4%E6%98%93%E7%94%A8%E7%9A%84%E9%80%9A%E4%BF%A1%E5%BA%93font"><font color='#d44c47'>cprï¼šæ›´ç°ä»£ã€æ›´æ˜“ç”¨çš„é€šä¿¡åº“</font></a>
<ul>
<li><a href="#%E5%AE%89%E8%A3%85">å®‰è£…</a></li>
</ul>
</li>
<li><a href="#zmq%E9%AB%98%E6%95%88-%E5%A4%9A%E5%8A%9F%E8%83%BD%E7%9A%84%E9%80%9A%E4%BF%A1%E5%BA%93">ZMQï¼šé«˜æ•ˆã€å¤šåŠŸèƒ½çš„é€šä¿¡åº“</a></li>
<li><a href="#sockpp">sockpp</a></li>
<li><a href="#%E5%B0%8F%E7%BB%93">å°ç»“</a></li>
</ul>
</li>
</ul>
</div>
        </div>

        <!-- Back to top -->
        <div v-cloak
          class="fixed right-0 bottom-0 mb-20 mr-4 shadow w-10 h-10 rounded-full flex justify-center items-center z-10 cursor-pointer bg-white hover:shadow-lg dark:bg-gray-500 dark:text-gray-200"
          @click="backToUp" v-show="scrolled">
          <i class="ri-arrow-up-line"></i>
        </div>
        <!-- Back to bottom -->
        <div v-cloak
          class="fixed right-0 bottom-0 mb-4 mr-4 shadow w-10 h-10 rounded-full flex justify-center items-center z-10 cursor-pointer bg-white hover:shadow-lg dark:bg-gray-500 dark:text-gray-200"
          @click="backToBottom" v-show="!atBottom">
          <i class="ri-arrow-down-line"></i>
        </div>
    </div>

    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
  <!-- Background of PhotoSwipe. 
        It's a separate element as animating opacity is faster than rgba(). -->
  <div class="pswp__bg">
  </div>
  <!-- Slides wrapper with overflow:hidden. -->
  <div class="pswp__scroll-wrap">
    <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
    <div class="pswp__container">
      <div class="pswp__item">
      </div>
      <div class="pswp__item">
      </div>
      <div class="pswp__item">
      </div>
    </div>
    <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
    <div class="pswp__ui pswp__ui--hidden">
      <div class="pswp__top-bar">
        <!--  Controls are self-explanatory. Order can be changed. -->
        <div class="pswp__counter">
        </div>
        <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
        <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
        <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
        <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
        <!-- element will get class pswp__preloader--active when preloader is running -->
        <div class="pswp__preloader">
          <div class="pswp__preloader__icn">
            <div class="pswp__preloader__cut">
              <div class="pswp__preloader__donut">
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
        <div class="pswp__share-tooltip">
        </div>
      </div>
      <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
      </button>
      <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
      </button>
      <div class="pswp__caption">
        <div class="pswp__caption__center">
        </div>
      </div>
    </div>
  </div>
</div>

      <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
      <script src="https://blog.qxxiao.eu.org/media/scripts/main.js"></script>

      <!-- Code Highlight -->
      
        <script src="https://blog.qxxiao.eu.org/media/prism.js"></script>
        <script>
          Prism.highlightAll();
        </script>
        <script defer
          src="https://cdn.bootcdn.net/ajax/libs/prism/1.19.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
        <script defer
          src="https://cdn.bootcdn.net/ajax/libs/prism/1.19.0/plugins/toolbar/prism-toolbar.min.js"></script>
        <script defer
          src="https://cdn.bootcdn.net/ajax/libs/prism/1.19.0/plugins/show-language/prism-show-language.min.js"></script>
        <script defer
          src="https://cdn.bootcdn.net/ajax/libs/prism/1.19.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
        

          <script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
          <script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>
          <script>
            //æ‹¿åˆ°é¢„è§ˆæ¡†æ¶ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„htmlä»£ç 
            var pswpElement = document.querySelectorAll('.pswp')[0]
            //å®šä¹‰å›¾ç‰‡æ•°ç»„å˜é‡
            var imgitems
            /**
             * ç”¨äºæ˜¾ç¤ºé¢„è§ˆç•Œé¢
             * @param index å›¾ç‰‡æ•°ç»„ä¸‹æ ‡
             */
            function viewImg(index) {
              var pswpoptions = {
                index: parseInt(index, 10), // å¼€å§‹å¹»ç¯ç‰‡ç´¢å¼•ã€‚0æ˜¯ç¬¬ä¸€å¼ å¹»ç¯ç‰‡ã€‚å¿…é¡»æ˜¯æ•´æ•°ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²ã€‚
                bgOpacity: 0.7, // èƒŒæ™¯é€æ˜åº¦ï¼Œ0-1
                maxSpreadZoom: 3, // ç¼©æ”¾çº§åˆ«ï¼Œä¸è¦å¤ªå¤§
              }
              //åˆå§‹åŒ–å¹¶æ‰“å¼€PhotoSwipeï¼ŒpswpElementå¯¹åº”ä¸Šé¢é¢„è§ˆæ¡†æ¶ï¼ŒPhotoSwipeUI_Defaultä¸ºçš®è‚¤ï¼Œimgitemsä¸ºå›¾ç‰‡æ•°ç»„ï¼Œpswpoptionsä¸ºé€‰é¡¹
              var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, imgitems, pswpoptions)
              gallery.init()
            }
            /**
             * ç”¨äºæ·»åŠ å›¾ç‰‡ç‚¹å‡»äº‹ä»¶
             * @param img å›¾ç‰‡å…ƒç´ 
             * @param index æ‰€å±ä¸‹æ ‡ï¼ˆåœ¨imgitemsä¸­çš„ä½ç½®ï¼‰
             */
            function addImgClick(img, index) {
              img.onclick = function () {
                viewImg(index)
              }
            }
            /**
             * è½®è¯¢æ‰€æœ‰å›¾ç‰‡ï¼Œè·å–srcã€widthã€heightç­‰æ•°æ®ï¼ŒåŠ å…¥imgitemsï¼Œå¹¶ç»™å›¾ç‰‡å…ƒç´ æ·»åŠ äº‹ä»¶
             * æœ€å¥½åœ¨onloadä¸­æ‰§è¡Œè¯¥æ–¹æ³•ï¼Œæœ¬ç«™å› æ”¾åœ¨æœ€åº•éƒ¨ï¼Œæ‰€ä»¥ç›´æ¥åˆå§‹åŒ–
             * å¼‚æ­¥åŠ è½½å›¾ç‰‡å¯åœ¨å›¾ç‰‡å…ƒç´ åˆ›å»ºå®Œæˆåè°ƒç”¨æ­¤æ–¹æ³•
             */
            function initImg() {
              //é‡ç½®å›¾ç‰‡æ•°ç»„
              imgitems = []
              //æŸ¥æ‰¾class:markdown ä¸‹çš„æ‰€æœ‰imgå…ƒç´ å¹¶éå†
              var imgs = document.querySelectorAll('.markdown img')
              for (var i = 0; i < imgs.length; i++) {
                var img = imgs[i]
                //æœ¬ç«™ç›¸å†Œåˆå§‹ä¸ºloadingå›¾ç‰‡ï¼ŒçœŸå®å›¾ç‰‡æ”¾åœ¨data-src
                var ds = img.getAttribute('data-src')
                //åˆ›å»ºimageå¯¹è±¡ï¼Œç”¨äºè·å–å›¾ç‰‡å®½é«˜
                var imgtemp = new Image()
                //åˆ¤æ–­æ˜¯å¦å­˜åœ¨data-src
                if (ds != null && ds.length > 0) {
                  imgtemp.src = ds
                } else {
                  imgtemp.src = img.src
                }
                //åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç¼“å­˜
                if (imgtemp.complete) {
                  var imgobj = {
                    src: imgtemp.src,
                    w: imgtemp.width,
                    h: imgtemp.height,
                  }
                  imgitems[i] = imgobj
                  addImgClick(img, i)
                } else {
                  imgtemp.index = i
                  imgtemp.img = img
                  imgtemp.onload = function () {
                    var imgobj = {
                      src: this.src,
                      w: this.width,
                      h: this.height,
                    }
                    //ä¸è¦ä½¿ç”¨pushï¼Œå› ä¸ºonloadå‰åé¡ºåºä¼šä¸åŒ
                    imgitems[this.index] = imgobj
                    //æ·»åŠ ç‚¹å‡»äº‹ä»¶
                    addImgClick(this.img, this.index)
                  }
                }
              }
            }
            //åˆå§‹åŒ–
            initImg();
          </script>
          
                
                          
                            <script src="https://cdn.jsdelivr.net/npm/twikoo@1.6.36/dist/twikoo.all.min.js"></script>
                            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
                              integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X"
                              crossorigin="anonymous" />
                            <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"
                              integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4"
                              crossorigin="anonymous"></script>
                            <script defer
                              src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"
                              integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa"
                              crossorigin="anonymous"></script>
                            <script>
                              twikoo.init({
                                envId: 'https://twikoo.qxxiao.eu.org/',
                                el: '#tcomment',
                                katex: {
                                  delimiters: [
                                    { left: '$$', right: '$$', display: true },
                                    { left: '$', right: '$', display: false },
                                    { left: '\\(', right: '\\)', display: false },
                                    { left: '\\[', right: '\\]', display: true },
                                  ],
                                  throwOnError: false,
                                },
                                // region: 'ap-guangzhou', // ç¯å¢ƒåœ°åŸŸï¼Œé»˜è®¤ä¸º ap-shanghaiï¼Œå¦‚æœæ‚¨çš„ç¯å¢ƒåœ°åŸŸä¸æ˜¯ä¸Šæµ·ï¼Œéœ€ä¼ æ­¤å‚æ•°
                                // path: 'window.location.pathname', // ç”¨äºåŒºåˆ†ä¸åŒæ–‡ç« çš„è‡ªå®šä¹‰ js è·¯å¾„ï¼Œå¦‚æœæ‚¨çš„æ–‡ç« è·¯å¾„ä¸æ˜¯ location.pathnameï¼Œéœ€ä¼ æ­¤å‚æ•°
                              });
                            </script>
                            

                              <!-- line number for code block -->
                              <script>
                                var pres = document.getElementsByTagName('pre')
                                for (var i = 0; i < pres.length; i++) {
                                  var pre = pres[i]
                                  if (pre.childNodes[0].nodeName == 'CODE') {
                                    pre.setAttribute('class', 'line-numbers')
                                  }
                                }
                              </script>
                              

  </body>

</html>