{"themeConfig":{"themeName":"rocky","postPageSize":12,"archivesPageSize":60,"siteName":"Nuo's Blog","siteDescription":"æ¸©æ•…è€ŒçŸ¥æ–° <h1>console.log(ğŸ˜Š);</h1>","footerInfo":"","showFeatureImage":true,"domain":"https://blog.qxxiao.eu.org","postUrlFormat":"SLUG","tagUrlFormat":"SLUG","dateFormat":"YYYY-MM-DD","feedFullText":true,"feedCount":30,"archivesPath":"archives","postPath":"post","tagPath":"tag"},"posts":[{"content":"å›é¡¾å’Œæ€»ç»“ä¸€äº›ç®—æ³•é¢˜ Leetcode æ•°ç»„å’Œå­—ç¬¦ä¸² 189. è½®è½¬æ•°ç»„ ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ numsï¼Œå°†æ•°ç»„ä¸­çš„å…ƒç´ å‘å³è½®è½¬ k ä¸ªä½ç½®ï¼Œå…¶ä¸­ k æ˜¯éè´Ÿæ•°ã€‚ è§£æ³• 1ï¼Œåˆ©ç”¨å¤šæ¬¡ç¿»è½¬å®ç° å®¹æ˜“ç†è§£çš„åšæ³•ã€‚ä½¿ç”¨ä¸€ä¸ªå…·ä½“æ•°ç»„è¿›è¡Œæ¨¡æ‹Ÿï¼Œå…³æ³¨æœ€å (kmod n)(k \\mod n)(kmodn) ä¸ªå…ƒç´ çš„ä½ç½®ç§»åŠ¨åçš„ä½ç½®ï¼Œåˆ©ç”¨æ•°ç»„ç¿»è½¬æ¥æ”¹å˜å…ƒç´ çš„ä½ç½®å…³ç³»ã€‚ å…ˆå°†æ‰€æœ‰å…ƒç´ ç¿»è½¬ï¼Œè¿™æ ·å°¾éƒ¨çš„ (kmod n)(k \\mod n)(kmodn) ä¸ªå…ƒç´ å°±è¢«ç§»è‡³æ•°ç»„å¤´éƒ¨ ç„¶åå†ç¿»è½¬åŒºé—´ [0,(kmod n)âˆ’1][0, (k \\mod n) - 1][0,(kmodn)âˆ’1] å’ŒåŒºé—´ [kmod n,nâˆ’1][k \\mod n, n-1][kmodn,nâˆ’1] å³å¯ Codeç¤ºä¾‹ class Solution { public: void rotate(vector&lt;int&gt;&amp; nums, int k) { int n = nums.size(); k = k%n; // ç¿»è½¬ä¸€æ¬¡ for(int i=0, j=n-1; i&lt;j; i++, j--) swap(nums[i], nums[j]); // å†æ¬¡ç¿»è½¬ï¼Œè°ƒæ•´å±€éƒ¨é¡ºåº for(int i=0, j=k-1; i&lt;j; i++, j--) swap(nums[i], nums[j]); for(int i=k, j=n-1; i&lt;j; i++, j--) swap(nums[i], nums[j]); } }; è§£æ³• 2ï¼Œç¯å½¢æ›¿æ¢ å°†æ¯ä¸ªæ•°å­—æ”¾è‡³å®ƒæœ€åçš„ä½ç½®ï¼Œä¸ºäº†é¿å…æ”¾ç½®ä½ç½®çš„å…ƒç´ è¢«è¦†ç›–ï¼Œä½¿ç”¨ä¸´æ—¶å˜é‡ temptemptemp æ¥ä¿å­˜ã€‚ä¾‹å¦‚ä»ä½ç½® 0 å¼€å§‹ï¼Œæœ€åˆä»¤ temp=nums[0]temp=nums[0]temp=nums[0]ã€‚æ ¹æ®è§„åˆ™ï¼Œä½ç½® 0 çš„å…ƒç´ ä¼šæ”¾è‡³ (0+k) mod n(0+k) \\mod n(0+k) mod n çš„ä½ç½®ï¼Œä»¤ j=(0+k) mod nj=(0+k) \\mod nj=(0+k) mod nï¼Œæ­¤æ—¶äº¤æ¢ temptemptemp å’Œ nums[j]nums[j]nums[j]ï¼Œå®Œæˆä½ç½® j çš„æ›´æ–°ã€‚ç„¶åï¼Œæˆ‘ä»¬è€ƒå¯Ÿä½ç½® jï¼Œå¹¶äº¤æ¢ temp å’Œ nums[(j+k)mod n]nums[(j+k) \\mod n]nums[(j+k)modn]ï¼Œä»è€Œå®Œæˆä¸‹ä¸€ä¸ªä½ç½®çš„æ›´æ–°ã€‚ä¸æ–­è¿›è¡Œä¸Šè¿°è¿‡ç¨‹ï¼Œç›´è‡³å›åˆ°åˆå§‹ä½ç½® 0ã€‚ æ³¨æ„ï¼šä¸€æ¬¡å¾ªç¯ï¼Œå¯èƒ½æ²¡æœ‰éå†å®Œæ•°ç»„ä¸­çš„æ‰€æœ‰çš„å…ƒç´ ï¼Œä¸ºäº†æ±‚å‡ºéœ€è¦éå†çš„æ¬¡æ•°ï¼Œéœ€è¦å…ˆè€ƒè™‘è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šä»ç´¢å¼• 0 å¼€å§‹ä¸æ–­éå†ï¼Œæœ€ç»ˆå›åˆ°èµ·ç‚¹ 0 çš„è¿‡ç¨‹ä¸­ï¼Œ(å³ä¸€æ¬¡å¾ªç¯)éå†äº†å¤šå°‘ä¸ªå…ƒç´ ï¼Ÿ ç”±äºæœ€ç»ˆå›åˆ°äº†èµ·ç‚¹ï¼Œè¯¥è¿‡ç¨‹æ°å¥½èµ°äº†æ•´æ•°æ•°é‡çš„åœˆï¼Œè®¾ä¸º a åœˆï¼Œå†è®¾è¯¥è¿‡ç¨‹æ€»å…±éå†äº† b ä¸ªå…ƒç´ ã€‚å› æ­¤ï¼Œå¾—åˆ° an=bkan=bkan=bkï¼Œå³ ananan ä¸€å®šæ˜¯ n,kn,kn,k çš„å…¬å€æ•°ï¼Œåˆå› ä¸ºæ˜¯ç¬¬ä¸€æ¬¡å›åˆ°èµ·ç‚¹å°±ç»“æŸï¼Œæ‰€æœ‰ a å°½å¯èƒ½å°ï¼Œæ•… ananan å°±æ˜¯ n,kn,kn,k çš„æœ€å°å…¬å€æ•° lcm(n,k)lcm(n,k)lcm(n,k)ï¼Œå› æ­¤ b=lcm(n,k)kb=\\frac{lcm(n,k)}{k}b=klcm(n,k)â€‹ å•æ¬¡éå†åªèƒ½è®¿é—® b ä¸ªå…ƒç´ ï¼Œä¸ºäº†è®¿é—®åˆ°æ‰€æœ‰å…ƒç´ ï¼Œå› æ­¤éœ€è¦éå†çš„æ¬¡æ•°ä¸ºï¼š nb=nklcm(n,k)=gcd(n,k)\\frac{n}{b} = \\frac{nk}{lcm(n,k)} = gcd(n,k) bnâ€‹=lcm(n,k)nkâ€‹=gcd(n,k) ç»“æœå°±æ˜¯ï¼Œéœ€è¦éå† n,kn,kn,k æœ€å¤§å…¬çº¦æ•° gcd(n,k)gcd(n,k)gcd(n,k) æ¬¡ã€‚ ä»¥å…ƒç´  n=6,arr=[1,2,3,4,5,6],k=4n=6, arr = [1,2,3,4,5,6], k=4n=6,arr=[1,2,3,4,5,6],k=4 ä¸ºä¾‹ï¼Œä¸¤æ¬¡éå†çš„è¿‡ç¨‹ä¸ºï¼š Codeç¤ºä¾‹ class Solution { public: void rotate(vector&lt;int&gt; &amp;nums, int k) { int n = nums.size(); k = k % n; int count = gcd(k, n); for (int start = 0; start &lt; count; ++start) { int current = start; int prev = nums[start]; do { int next = (current + k) % n; swap(nums[next], prev); current = next; } while (start != current); } } int gcd(int a, int b) { return b == 0 ? a : gcd(b, a % b); } }; æ€»ç»“ï¼š å¦‚æœ(n,k)äº’è´¨ï¼Œä»ä¸€ä¸ªåˆå§‹ä½ç½®å¼€å§‹ï¼Œéå†æ—¶æ¯æ¬¡å‘åç§»åŠ¨ k ä¸ªä½ç½®ï¼Œå¯ä»¥é€šè¿‡ä¸€æ¬¡å¾ªç¯éå†å®Œæ•´ä¸ªæ•°ç»„å…ƒç´ ã€‚ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ç®—æ³•ç”Ÿæˆå…ƒç´ åœºæ™¯ä¸­ï¼Œæ¯æ¬¡å¯ä»¥ç”Ÿæˆé—´éš”ä¸º k çš„å…ƒç´ ï¼Œé‚£ä¹ˆæœ€ç»ˆå¯ä»¥ç”Ÿæˆå‡åŒ€çš„æ‰€æœ‰ n ä¸ªå…ƒç´ ï¼‰ 45. è·³è·ƒæ¸¸æˆ â…¡ ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º n çš„ 0 ç´¢å¼•æ•´æ•°æ•°ç»„ numsã€‚åˆå§‹ä½ç½®ä¸º nums[0]ã€‚æ¯ä¸ªå…ƒç´  nums[i] è¡¨ç¤ºä»ç´¢å¼• i å‘å‰è·³è½¬çš„æœ€å¤§é•¿åº¦ã€‚ è¿”å›åˆ°è¾¾ nums[n - 1] çš„æœ€å°è·³è·ƒæ¬¡æ•°ã€‚ç”Ÿæˆçš„æµ‹è¯•ç”¨ä¾‹ä¿è¯å¯ä»¥åˆ°è¾¾ nums[n - 1]ã€‚ å¦‚æœç”¨ f[i]f[i]f[i] è¡¨ç¤ºä»ä½ç½® 0 è·³åˆ°ä½ç½® iii éœ€è¦çš„æœ€å°è·³è·ƒæ¬¡æ•°ï¼Œæœ‰æ€§è´¨ï¼š f[i]f[i]f[i] æ˜¯åˆ†æ®µï¼ˆè¿ç»­ï¼‰é€’å¢çš„ï¼Œåè¯æ³•ï¼šå¦‚æœå­˜åœ¨ç›¸é‚» i&lt;j,j=i+1i&lt;j, j=i+1i&lt;j,j=i+1ï¼Œæœ‰ f[i]&gt;f[j]f[i]&gt;f[j]f[i]&gt;f[j]ï¼Œé‚£ä¹ˆå­˜åœ¨ l&lt;il&lt;il&lt;i å¯åˆ°è¾¾ jjjï¼Œå› æ­¤ lll è¾¾åˆ° iii æœ€å°æ¬¡æ•°ä¸º f[j]f[j]f[j]ï¼Œä¸å‡è®¾çŸ›ç›¾ã€‚å…¶ä»–æƒ…å†µï¼Œf[i]&lt;f[j]âˆ’1f[i]&lt;f[j]-1f[i]&lt;f[j]âˆ’1 ä¹Ÿç±»ä¼¼ã€‚æ‰€ä»¥ f[i]f[i]f[i] åªèƒ½æ˜¯ [0,1...1,2...2,3...3,...][0,1...1,2...2,3...3,...][0,1...1,2...2,3...3,...] åœ¨éå†æ‰€æœ‰å…ƒç´ è¿‡ç¨‹ä¸­ï¼Œæ ¹æ®åˆ†æ®µæ€§ï¼Œæ›´æ–°æ¯ä¸€æ­¥çš„æœ€è¿œä½ç½®ï¼Œå¹¶è®°å½•å½“å‰å…ƒç´ éœ€è¦çš„æœ€å°æ¬¡æ•°ã€‚ Codeç¤ºä¾‹ class Solution { public: int jump(vector&lt;int&gt;&amp; nums) { int max_far = 0;// ç›®å‰èƒ½è·³åˆ°çš„æœ€è¿œä½ç½® int step = 0; // è·³è·ƒæ¬¡æ•° int end = 0; // è·³è·ƒå¯è¾¾èŒƒå›´å³è¾¹ç•Œ for (int i = 0; i &lt; nums.size() - 1; i++) { max_far = std::max(max_far, i + nums[i]); // åˆ°è¾¾ä¸Šæ¬¡è·³è·ƒèƒ½åˆ°è¾¾çš„å³è¾¹ç•Œäº† if (i == end) { end = max_far; // ç›®å‰èƒ½è·³åˆ°çš„æœ€è¿œä½ç½®å˜æˆäº†ä¸‹æ¬¡èµ·è·³ä½ç½®çš„å³è¾¹ç•Œ step++; // è¿›å…¥ä¸‹ä¸€æ¬¡è·³è·ƒ } } return step; } }; ä»£ç ä¼˜åŒ–ï¼Œå¯ä»¥è¾¹éå† iii çš„åŒæ—¶ï¼ŒåŒæ—¶æ‰¾åˆ°å‰ä¸€æ®µä¸­ä½ç½® jjj å¯ä»¥æ›´æ–°/ä¸€æ­¥è·³åˆ° iii (å…¶è¿‡ç¨‹ç±»ä¼¼åŒæŒ‡é’ˆé—®é¢˜)ã€‚ äº‹å®ï¼š åé¢ä¸€æ®µ(éœ€è¦ n+1 æ­¥èµ°åˆ°)çš„æ‰€æœ‰ä½ç½®å¿…å®šèƒ½å¤Ÿåœ¨å‰é¢ä¸€æ®µ(éœ€è¦ n æ­¥)çš„æŸä¸ªä½ç½® (å¯èƒ½ä¸éƒ½æ˜¯åŒä¸€ä¸ªä¸‹æ ‡)è·³ä¸€æ­¥æ›´æ–°åˆ°ã€‚ Codeç¤ºä¾‹ class Solution { public: int jump(vector&lt;int&gt;&amp; nums) { int n = nums.size(); vector&lt;int&gt; f(n); for(int i=1, j=0; i&lt;n; i++){ while(j + nums[j] &lt; i) j++; f[i] = f[j]+1; } return f[n-1]; } }; 134. åŠ æ²¹ç«™ åœ¨ä¸€æ¡ç¯è·¯ä¸Šæœ‰ n ä¸ªåŠ æ²¹ç«™ï¼Œå…¶ä¸­ç¬¬ i ä¸ªåŠ æ²¹ç«™æœ‰æ±½æ²¹ gas[i] å‡ã€‚ ä½ æœ‰ä¸€è¾†æ²¹ç®±å®¹é‡æ— é™çš„çš„æ±½è½¦ï¼Œä»ç¬¬ i ä¸ªåŠ æ²¹ç«™å¼€å¾€ç¬¬ i+1 ä¸ªåŠ æ²¹ç«™éœ€è¦æ¶ˆè€—æ±½æ²¹ cost[i] å‡ã€‚ä½ ä»å…¶ä¸­çš„ä¸€ä¸ªåŠ æ²¹ç«™å‡ºå‘ï¼Œå¼€å§‹æ—¶æ²¹ç®±ä¸ºç©ºã€‚ ç»™å®šä¸¤ä¸ªæ•´æ•°æ•°ç»„ gas å’Œ cost ï¼Œå¦‚æœä½ å¯ä»¥æŒ‰é¡ºåºç»•ç¯è·¯è¡Œé©¶ä¸€å‘¨ï¼Œåˆ™è¿”å›å‡ºå‘æ—¶åŠ æ²¹ç«™çš„ç¼–å·ï¼Œå¦åˆ™è¿”å› -1 ã€‚å¦‚æœå­˜åœ¨è§£ï¼Œåˆ™ä¿è¯å®ƒæ˜¯å”¯ä¸€çš„ã€‚ è§£æ³• 1ï¼Œæšä¸¾+è´ªå¿ƒä¼˜åŒ– æ€è·¯ï¼šå…ˆæšä¸¾æ‰€æœ‰çš„èµ·ç‚¹ï¼Œç„¶åæ¯æ¬¡éå†åç»­çš„æ‰€æœ‰ç‚¹ã€‚ä¼˜åŒ–ï¼šå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå‡è®¾ä»èµ·ç‚¹ä½ç½® iii å¼€å§‹å‡ºå‘ï¼Œå¯ä»¥è¡Œé©¶åˆ°ä½ç½® jjjï¼Œä½†æ˜¯æ— æ³•åˆ°è¾¾ä¸‹ä¸€ä¸ªä½ç½® j+1j+1j+1ï¼Œæ ¹æ®è¦æ±‚å‘ç°ï¼š å¦‚æœä»¥ä¸­é—´çš„ä½ç½® [i+1,j][i+1,j][i+1,j] ä½œä¸ºèµ·ç‚¹ï¼ŒåŒæ ·æ— æ³•åˆ°è¾¾ä½ç½® j+1j+1j+1ï¼ˆå³æ— æ³•è½¬å®Œä¸€åœˆï¼‰ï¼Œåè¯æ³•ã€‚å› æ­¤å¦‚æœä» iii å¯ä»¥åˆ°è¾¾ jjjï¼Œä½†æ˜¯æ— æ³•åˆ°è¾¾ j+1j+1j+1ï¼Œåˆ™ä¸‹ä¸€æ¬¡èµ·ç‚¹ç›´æ¥å¯ä»¥ä»ä½ç½® j+1j+1j+1 å¼€å§‹ã€‚ è¾¹ç•Œï¼Œèµ·ç‚¹ä½ç½®åªä½äº [0,nâˆ’1][0,n-1][0,nâˆ’1] Codeç¤ºä¾‹ class Solution { public: int canCompleteCircuit(vector&lt;int&gt;&amp; gas, vector&lt;int&gt;&amp; cost) { int n = gas.size(); for (int i = 0, j; i &lt; n;) { // æšä¸¾èµ·ç‚¹ int left = 0; for (j = 0; j &lt; n; j++) { // æšä¸¾å½“å‰çš„ç»ˆç‚¹ int t = (i + j) % n; left = left + gas[t] - cost[t]; if (left &lt; 0) break; } if (j == n) return i; i = i + j + 1; // è·³è¿‡ } return -1; } }; è§£æ³• 2ï¼Œé€šç”¨åšæ³•ï¼Œå•è°ƒé˜Ÿåˆ—ä¼˜åŒ– ç›´æ¥çœ‹è¿™ä¸€é“é¢˜ï¼šæé«˜è¯¾ DP-1088. æ—…è¡Œé—®é¢˜ æ€è·¯ï¼šå°†æ¯ä¸€ä¸ªç‚¹ iii çš„æ²¹é‡ä¸æ¥ä¸‹æ¥çš„æ¶ˆè€—é‡çš„å·®å€¼ p[i]âˆ’d[i]p[i] - d[i]p[i]âˆ’d[i] ä½œä¸ºè¯¥ç‚¹çš„å€¼ï¼Œåˆ¤æ–­è¯¥ç‚¹é¡ºæ—¶é’ˆèƒ½å¤Ÿå›åˆ°è¯¥ç‚¹ï¼Œç­‰ä»·äºé•¿åº¦ä¸º nnn çš„(å¤„ç†åçš„æ•°ç»„)æ‰€æœ‰å‰ç¼€å’Œ &gt;=0&gt;=0&gt;=0ã€‚æ±‚è§£è¯¥æ•°ç»„çš„å‰ç¼€å’Œæ•°ç»„ SSS åï¼Œç­‰ä»·äº S[j]âˆ’S[iâˆ’1]&gt;=0,jâˆˆ[i,i+nâˆ’1]S[j]-S[i-1]&gt;=0, j\\in[i,i+n-1]S[j]âˆ’S[iâˆ’1]&gt;=0,jâˆˆ[i,i+nâˆ’1]ï¼Œå³å›ºå®šä½ç½® iii åï¼Œåˆ¤æ–­å…¶åè¿ç»­çš„ nnn ä¸ªå‰ç¼€å’Œçš„æœ€å°å€¼ S[jâ€²]S[j&#x27;]S[jâ€²] æ˜¯å¦æ»¡è¶³è¯¥æ¡ä»¶å³å¯ã€‚å½’ç»“äºï¼Œæ±‚è§£æ»‘åŠ¨çª—å£ä¸­çš„æœ€å€¼é—®é¢˜ æ€»ç»“ï¼š å¦‚æœéœ€è¦æšä¸¾ç¯å½¢ä¸Šçš„ç‚¹ï¼Œå¯ä»¥å±•å¼€ä¸ºçº¿æ€§ï¼Œåšæ³•æ˜¯å°†å…ƒç´ å¤åˆ¶ä¸€éåˆ°æœ«å°¾ï¼› å¯¹äºé€†æ—¶é’ˆï¼Œå°±æ˜¯æ”¹å˜æ±‚å’Œçš„æ–¹å‘ï¼Œç­‰ä»·äºå›ºå®šå‰ç¼€å’Œçª—å£çš„å³è¾¹ç•Œï¼› Codeç¤ºä¾‹ #include &lt;iostream&gt; #include &lt;algorithm&gt; #include &lt;cstring&gt; using namespace std; using LL = long long; const int N = 2e6 + 10; int n, p[N], d[N]; LL s[N]; // å‰ç¼€å’Œ int q[N], hh, tt; // å•è°ƒé˜Ÿåˆ— bool st[N]; // ç­”æ¡ˆæ•°ç»„ int main() { cin &gt;&gt; n; for (int i = 1; i &lt;= n; i++) cin &gt;&gt; p[i] &gt;&gt; d[i]; // é¡ºæ—¶é’ˆ, å›ºå®šå·¦ç«¯ç‚¹ï¼Œæ±‚å³çª—å£ä¸­çš„æœ€å°å€¼ for (int i = 1; i &lt;= n; i++) s[i] = s[i + n] = p[i] - d[i]; // å±•å¼€ä¸º2*nçš„æ•°ç»„ for (int i = 1; i &lt;= 2 * n; i++) s[i] += s[i - 1]; // å‰ç¼€å’Œ hh = 0, tt = -1; for (int i = 2 * n; i; i--) { // ä»å·¦å¾€å³ä¹Ÿå¯ä»¥ if (hh &lt;= tt &amp;&amp; q[hh] - i &gt;= n) hh++; while (hh &lt;= tt &amp;&amp; s[i] &lt;= s[q[tt]]) tt--; q[++tt] = i; // æ·»åŠ iå…±nä¸ª if (i &lt;= n &amp;&amp; s[q[hh]] &gt;= s[i - 1]) st[i] = true; } // é€†æ—¶é’ˆ, å›ºå®šå³ç«¯ç‚¹ï¼Œæ±‚å·¦çª—å£ä¸­çš„æœ€å¤§å€¼ d[0] = d[n]; for (int i = 1; i &lt;= n; i++) s[i] = s[i + n] = p[i] - d[i - 1]; for (int i = 1; i &lt;= 2 * n; i++) s[i] += s[i - 1]; hh = 0, tt = -1; for (int i = 1; i &lt;= 2 * n; i++) { // æ³¨æ„æœªåŠ å…¥iä¹‹å‰ï¼Œçª—å£æœ€å¤šæœ‰nä¸ªå€¼ if (hh &lt;= tt &amp;&amp; i - q[hh] &gt; n) hh++; // å½“ i=[n+1...2n] åˆ¤æ–­ç»“æœ // è¿™é‡Œéœ€è¦åˆ¤æ–­ a[i],å…ˆåˆ¤æ–­ååŠ å…¥i if (i &gt; n &amp;&amp; s[i] &gt;= s[q[hh]]) st[i - n] = true; while (hh &lt;= tt &amp;&amp; s[i] &gt;= s[q[tt]]) tt--; q[++tt] = i; } for (int i = 1; i &lt;= n; i++) if (st[i]) cout &lt;&lt; &quot;TAK&quot; &lt;&lt; endl; else cout &lt;&lt; &quot;NIE&quot; &lt;&lt; endl; } åŠ¨æ€è§„åˆ’ 119. æ¨è¾‰ä¸‰è§’ â…¡ ç»™å®šä¸€ä¸ªéè´Ÿç´¢å¼• rowIndexï¼Œè¿”å›ã€Œæ¨è¾‰ä¸‰è§’ã€çš„ç¬¬ rowIndex è¡Œã€‚ åœ¨ã€Œæ¨è¾‰ä¸‰è§’ã€ä¸­ï¼Œæ¯ä¸ªæ•°æ˜¯å®ƒå·¦ä¸Šæ–¹å’Œå³ä¸Šæ–¹çš„æ•°çš„å’Œã€‚ å¯¹åŠ¨æ€è§„åˆ’ä¸­ç©ºé—´ä¼˜åŒ–çš„æ€»ç»“ï¼š å¦‚æœå¯ä»¥ä½¿ç”¨æ»šåŠ¨æ•°ç»„æ¥ä¼˜åŒ–å­˜å‚¨ç©ºé—´æ—¶ï¼Œä½¿ç”¨ row &amp; 1 æ¥ç¡®å®šå½“å‰è¡Œä½ç½®ï¼ˆåˆ©ç”¨ 2 è¡Œçš„æ•°ç»„è¿›è¡Œæ»šåŠ¨è®¡ç®—ï¼‰ï¼Œå…¶ä¸­ &amp; è¿ç®—ç¬¦ä¼˜å…ˆçº§ä½äº +, - ç®—æ³•é¢˜ä¸­ï¼Œå¯ä»¥å…ˆä½¿ç”¨å¸¸è§„äºŒç»´æ•°ç»„è¿›è¡Œè§£é¢˜å’Œè®¡ç®—ï¼Œæœ€åå°†åŸçŠ¶æ€æ•°ç»„æ”¹æˆ 2 è¡Œçš„æ»šåŠ¨æ•°ç»„ï¼Œå¹¶æœºæ¢°åŒ–åœ°å°†ä½¿ç”¨åˆ°çš„çŠ¶æ€è¡Œ row å…¨éƒ¨ç”¨ row &amp; 1 æ›¿æ¢å³å¯ Codeç¤ºä¾‹ class Solution { public: //* è¿™é‡Œå€’åºè®¡ç®—ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€ç»´æ•°ç»„ // vector&lt;int&gt; getRow(int rowIndex) { // // å€’åºä¸ä¼šè¦†ç›–å…ƒç´  // vector&lt;int&gt; f(rowIndex + 1); // for (int i = 0; i &lt;= rowIndex; i++) { // f[0] = f[i] = 1; // for (int j = i - 1; j &gt; 0; j--) // f[j] = f[j - 1] + f[j]; // } // return f; // } //* ä¸€èˆ¬çš„æ»šåŠ¨æ•°ç»„ä¼˜åŒ–æ–¹æ³• vector&lt;int&gt; getRow(int rowIndex) { vector &lt; vector &gt;&gt; f(2, vector&lt;int&gt;(rowIndex + 1)); for (int i = 0; i &lt;= rowIndex; i++) { f[i &amp; 1][0] = f[i &amp; 1][i] = 1; for (int j = 1; j &lt; i; j++) f[i &amp; 1][j] = f[i - 1 &amp; 1][j - 1] + f[i - 1 &amp; 1][j]; } return f[rowIndex &amp; 1]; } }; ","tags":[{"name":"Algorithm","slug":"algorithm","used":true,"link":"https://blog.qxxiao.eu.org/tag/algorithm/"}],"title":"Leetcode","feature":"https://pic.qxxiao.cn/algorithm.png","link":"https://blog.qxxiao.eu.org/post/Leetcode/","stats":{"text":"14 min read","time":789000,"words":2907,"minutes":14},"date":"2024-05-19 16:30:22","dateFormat":"2024-05-19","isTop":false},{"content":"pcbå¯†ç å­¦åº“çš„ç®€å•ä»‹ç»å’Œç¤ºä¾‹ä½¿ç”¨ å®˜ç½‘ï¼š https://crypto.stanford.edu/pbc/ https://crysp.uwaterloo.ca/software/PBCWrapper/ å®‰è£…å’Œä»‹ç» å‚è€ƒè¿™ä¸¤ç¯‡æ–‡ç«  https://jeza-chen.com/2020/06/04/PBC-Library/ https://jeza-chen.com/2020/06/05/PBC-Cpp-Wrapper/ ç¤ºä¾‹ BLSç­¾åå’ŒéªŒè¯ //* BLSç­¾å: https://crypto.stanford.edu/pbc/manual/ch02.html #include &quot;PBC.h&quot; int main() { //åˆå§‹åŒ–é…å¯¹å˜é‡e char param[1024]; FILE* file = fopen(&quot;a.param&quot;, &quot;r&quot;); size_t count = fread(param, 1, 1024, file); fclose(file); if (!count) pbc_die(&quot;input error&quot;); // åˆå§‹åŒ–é…å¯¹å˜é‡e Pairing e(param, count); // ç”Ÿæˆç³»ç»Ÿå‚æ•°g G2 g(e, false); // TODO éšæœºåˆå§‹åŒ–ä¸€ä¸ªç³»ç»Ÿå‚æ•°g(è®ºæ–‡ä¸­é€šå¸¸ä½¿ç”¨ç”Ÿæˆå…ƒ) g.dump(stdout, &quot;system parameter g&quot;, 16); // ç”Ÿæˆç§é’¥å’Œå…¬é’¥ Zr secret_key(e, true); // ç”Ÿæˆä¸€ä¸ªZrç±»å‹çš„secret_key secret_key.dump(stdout, &quot;secret key&quot;); G2 public_key = g ^ secret_key; // æŒ‡æ•°è¿ç®— public_key.dump(stdout, &quot;public key&quot;); // å‡è®¾æ¶ˆæ¯mçš„hashå€¼ä¸º &quot;hashofmessage&quot; G1 h(e, (void*)&quot;hashofmessage&quot;, 13); // å°†æ¶ˆæ¯hashå€¼æ˜ å°„åˆ°G1å…ƒç´ h h.dump(stdout, &quot;message hash&quot;); // å¯¹æ¶ˆæ¯mè¿›è¡Œç­¾å(å¯¹å…ƒç´ hç­¾å) G1 sig = h ^ secret_key; sig.dump(stdout, &quot;signature&quot;); // å®é™…ä¸­ï¼Œå¯ä»¥åªè¾“å‡ºç¬¬ä¸€ä¸ªåæ ‡(ä½†æ˜¯xåæ ‡å¯¹åº”2ä¸ªå…ƒç´ -æ¤­åœ†æ›²çº¿å¯¹ç§°æ€§ï¼Œé…å¯¹æµ‹è¯•éœ€è¦2æ¬¡) // éªŒè¯ç­¾å GT temp1 = e(sig, g); // é…å¯¹è¿ç®— GT temp2 = e(h, public_key); cout &lt;&lt; endl; temp1.dump(stdout, &quot;e(sig, g)&quot;); temp2.dump(stdout, &quot;e(h, public_key)&quot;); if (temp1 == temp2) cout &lt;&lt; &quot;signature verifies&quot; &lt;&lt; endl; else cout &lt;&lt; &quot;signature does not verify&quot; &lt;&lt; endl; } https://crypto.stanford.edu/pbc/manual/ch02s02.htmléƒ¨åˆ†è¿˜ä»‹ç»äº†å¦‚ä½•å°†ç­¾åè¿›è¡Œå‹ç¼©(æˆ–åªå­˜å‚¨ç­¾åçš„xåæ ‡)ä¾¿äºå­˜å‚¨å’Œä¼ è¾“ã€‚ å¤‡æ³¨ Pythonã€Javaå’ŒGoä¹Ÿæœ‰å¯¹åº”çš„åŒ…è£…ç‰ˆæœ¬ ","tags":[{"name":"Crypto","slug":"crypto","used":true,"link":"https://blog.qxxiao.eu.org/tag/crypto/"},{"name":"C++","slug":"c","used":true,"link":"https://blog.qxxiao.eu.org/tag/c/"}],"title":"PBCï½œPBCWrapper å¯†ç å­¦åº“","feature":"","link":"https://blog.qxxiao.eu.org/post/PBCï½œPBCWrapper å¯†ç å­¦åº“/","stats":{"text":"3 min read","time":125000,"words":434,"minutes":3},"date":"2024-03-06 14:23:23","dateFormat":"2024-03-06","isTop":false},{"content":"åŒæ­¥ä¸€äº›æœ‰ç”¨çš„åšå®¢ï¼Œå¦‚æœæœ‰RSSé“¾æ¥ä¹Ÿä¼šé™„åœ¨åé¢ã€‚ åšå®¢ é˜®ä¸€å³°çš„åšå®¢ http://feeds.feedburner.com/ruanyifeng Eli Bendersky's website github ä»‹ç»ï¼šGo by Example ä½œè€… laike9m's blog http://laike9m.com/blog/rss ä»‹ç»ï¼šFounder of æ•è›‡è€…è¯´ podcast TonyBai's blog http://tonybai.com/feed/ ä»‹ç»ï¼šGoè¯­è¨€ Tw93's blog/weekly https://tw93.fun/feed.xml ä»‹ç»ï¼šå‰ç«¯å·¥ç¨‹å¸ˆ Switch-Router's blog Mrcroxx's blog æŠ€æœ¯æ‰«ç›²-quic åè®®ã€ç½‘ç»œã€‘ RSAåŠ å¯† Notion C++ ç³»åˆ— Mac ä¸‹çš„ C++å·¥å…·é“¾ CheatSheet QuickRef.ME Vim Cheat Sheet Rust Language Cheat Sheet IPFS https://share.ipfs.io https://webui.ipfs.io https://cid.ipfs.tech https://explore.ipld.io https://dag.ipfs.tech https://car.ipfs.io https://pl-diagnose.on.fleek.co https://ipfs.github.io/public-gateway-checker èµ„æº Web: Networking 101 https://calendar.perfplanet.com/2020/head-of-line-blocking-in-quic-and-http-3-the-details/ PDF: C++17 in detail PDF: openssl cookbook ","tags":[{"name":"Article","slug":"article","used":true,"link":"https://blog.qxxiao.eu.org/tag/article/"}],"title":"åšå®¢é“¾æ¥","feature":"","link":"https://blog.qxxiao.eu.org/post/åšå®¢é“¾æ¥/","stats":{"text":"2 min read","time":62000,"words":198,"minutes":2},"date":"2023-06-10 09:37:44","dateFormat":"2023-06-10","isTop":true},{"content":"å¯èƒ½ä¼šé‡åˆ°æƒ³è¦æ‰§è¡Œå®šæ—¶ä»»åŠ¡æˆ–è€…ç›‘æµ‹ä»»åŠ¡ï¼Œä½¿ç”¨ launchdï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ‰§è¡Œã€‚ [man launchd.plist] scheduling timed jobs-Apple ç›‘æµ‹æ–‡ä»¶å¤¹å˜åŠ¨ å¯¹æ–‡ä»¶å¤¹è¿›è¡Œç›‘æµ‹ï¼Œå¦‚æœæ›´æ–°äº†æ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œå¯¹åº”çš„è„šæœ¬ä»»åŠ¡ï¼Œç®€å•æ­¥éª¤ï¼š åˆ›å»ºä¸€ä¸ªplist æœåŠ¡é…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚åç§°ä¸º com.example.watchfolder.plistï¼Œå†…å®¹å¯ä»¥æ ¹æ®ä¸‹é¢çš„ç¤ºä¾‹æ›´æ”¹ï¼› å°†è¯¥æ–‡ä»¶ç§»åŠ¨åˆ° /Library/LaunchAgents ä¸‹ï¼Œè¯¥ç›®å½•ä¸ºç”¨æˆ·çº§åˆ«çš„æœåŠ¡é…ç½®æ–‡ä»¶å¤¹ï¼› åŠ è½½è¯¥æœåŠ¡ launchctl load /Library/LaunchAgents/com.example.watchfolder.plist # sudo launchctl bootstrap system /Library/LaunchAgents/com.example.watchfolder.plist å¦‚æœæƒ³è¦å¸è½½è¯¥æœåŠ¡ï¼Œæ‰§è¡Œï¼š # launchctl list | grep watchfolder # æŸ¥è¯¢æœåŠ¡ launchctl stop com.example.watchfolder launchctl unload /Library/LaunchAgents/com.example.watchfolder.plist æ³¨æ„ï¼Œå¦‚æœä¸èƒ½åœæ­¢å¯¹åº”çš„å¼‚å¸¸çš„æœåŠ¡ï¼Œä½¿ç”¨ sudo æ‰§è¡Œä¸€æ¬¡ã€‚ ä¸€ä¸ªç®€å•çš„ç›‘æµ‹ç¤ºä¾‹ï¼š &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt; &lt;plist version=&quot;1.0&quot;&gt; &lt;dict&gt; &lt;key&gt;Label&lt;/key&gt; &lt;string&gt;com.example.watchfolder&lt;/string&gt; &lt;key&gt;EnvironmentVariables&lt;/key&gt; &lt;dict&gt; &lt;key&gt;PATH&lt;/key&gt; &lt;string&gt;/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin&lt;/string&gt; &lt;/dict&gt; &lt;key&gt;ProgramArguments&lt;/key&gt; &lt;array&gt; &lt;string&gt;/usr/local/bin/slt&lt;/string&gt; &lt;string&gt;deploy&lt;/string&gt; &lt;/array&gt; &lt;key&gt;WatchPaths&lt;/key&gt; &lt;array&gt; &lt;string&gt;/Users/xiao/.gridea/output/&lt;/string&gt; &lt;/array&gt; &lt;key&gt;RunAtLoad&lt;/key&gt; &lt;false/&gt; &lt;key&gt;KeepAlive&lt;/key&gt; &lt;false/&gt; &lt;key&gt;StandardOutPath&lt;/key&gt; &lt;string&gt;/dev/null&lt;/string&gt; &lt;key&gt;StandardErrorPath&lt;/key&gt; &lt;string&gt;/tmp/watchfolder.log&lt;/string&gt; &lt;key&gt;StartInterval&lt;/key&gt; &lt;integer&gt;-1&lt;/integer&gt; &lt;key&gt;ThrottleInterval&lt;/key&gt; &lt;integer&gt;10&lt;/integer&gt; &lt;key&gt;WorkingDirectory&lt;/key&gt; &lt;string&gt;/Users/xiao/.gridea/&lt;/string&gt; &lt;/dict&gt; &lt;/plist&gt; è¯´æ˜ï¼š Label å€¼è‡ªå®šä¹‰è¯¥æœåŠ¡çš„åç§° ProgramArguments ç”¨æ¥æŒ‡å®šæ‰§è¡Œçš„è„šæœ¬å’Œå‚æ•°ï¼Œåç§°å’Œå‚æ•°å•ç‹¬ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºï¼Œå¯ä»¥æ·»åŠ å¤šä¸ªéœ€è¦çš„å‚æ•° WatchPaths å¦‚æœåˆ—å‡ºçš„è·¯å¾„ä¸­çš„ä»»ä½•ä¸€æ¡è¢«ä¿®æ”¹ï¼Œå°†å¯¼è‡´ä½œä¸šå¯åŠ¨ RunAtLoad æŒ‡å®šåŠ è½½æ—¶æ˜¯å¦æ‰§è¡Œï¼›KeepAlive æŒ‡å®šä»»åŠ¡æ˜¯å¦ä¿æŒæ´»åŠ¨çŠ¶æ€ï¼Œå³å®Œæˆåè‡ªåŠ¨é‡å¯ä»»åŠ¡ï¼Œé€šå¸¸æƒ…å†µä¸‹è®¾ç½®false StartInterval æŒ‡å®šé‡å¯ä»»åŠ¡çš„é—´éš”æ—¶é—´ï¼Œæ¯éš” N ç§’é‡å¯æ‰§è¡Œä¸€æ¬¡ï¼Œ-1è¡¨ç¤ºä¸æ‰§è¡Œï¼›ThrottleInterval æŒ‡å®šèŠ‚æµé—´éš”ï¼ŒNç§’å†…ä¸ä¼šé‡æ–°å¯åŠ¨æ‰§è¡Œï¼Œä¿è¯äº†ä¸¤æ¬¡ä»»åŠ¡çš„æœ€å°é—´éš”æ—¶é—´ï¼› WorkingDirectory æŒ‡å®šä»»åŠ¡çš„å·¥ä½œç›®å½•ï¼›PATH æŒ‡å®šç¯å¢ƒå˜é‡ï¼› æ³¨æ„äº‹é¡¹ï¼š ç›‘æµ‹çš„æ–‡ä»¶å¤¹ï¼Œæ˜¯æŒ‡å…¶ä¸­çš„å­æ–‡ä»¶/æ–‡ä»¶å¤¹æ·»åŠ /åˆ é™¤/åç§°ä¿®æ”¹ï¼Œå¦‚æœåªæ˜¯ä¿®æ”¹å­æ–‡ä»¶çš„å†…å®¹æ˜¯ä¸ä¼šå½±å“çš„æ–‡ä»¶å¤¹ç›‘æµ‹çš„(LMT)ã€‚ è§£å†³ï¼šå˜åŠ¨çš„æ—¶å€™æ•´ä½“è¦†ç›–æ–‡ä»¶å¤¹(åˆ é™¤å†åˆ›å»º)ï¼›æˆ–è€…å‘å…¶ä¸­æ·»åŠ ä¸€ä¸ªç©ºæ–‡ä»¶ç„¶ååˆ é™¤ä¹Ÿå¯ä»¥ï¼› ","tags":[{"name":"Mac","slug":"mac","used":true,"link":"https://blog.qxxiao.eu.org/tag/mac/"}],"title":"Mac å®šæ—¶ä»»åŠ¡å’Œè„šæœ¬","feature":"","link":"https://blog.qxxiao.eu.org/post/macå®šæ—¶ä»»åŠ¡å’Œè„šæœ¬/","stats":{"text":"4 min read","time":207000,"words":759,"minutes":4},"date":"2023-06-03 21:42:32","dateFormat":"2023-06-03","isTop":false},{"content":" å†…å®¹ï¼šè§£é‡Šå’Œç†è§£ä¼½ç½—ååŸŸå’ŒåŸºç¡€çš„ RS ç¼–ç ç†è®ºï¼Œå’Œç¼–ç å®è·µã€‚ 1. Cauchy or Vandermonde? 2. å†™ä¸€ä¸ªReed-Solomon codeå¼•æ“ 3. é«˜æ€§èƒ½çº åˆ ç ç¼–ç  4. æœ‰é™åŸŸå†…çš„å››åˆ™è¿ç®— 5. åˆ†å¸ƒå¼ç³»ç»Ÿç³»åˆ—æ•™ç¨‹ä¹‹: Erasure-Code 1. ä¼½ç½—ååŸŸ æœ‰å…³ ç¾¤ã€ç¯ã€åŸŸ åœ¨ä¹‹å‰æ€»ç»“è¿‡ï¼Œè¿™é‡Œä¹Ÿæœ‰ç”¨åˆ°çš„ä»£æ•°åŸºç¡€ èŒƒå¾·è’™ç å’ŒæŸ¯è¥¿ç çš„è¯‘ç è¿‡ç¨‹ã€èŒƒå¾·è’™ç³»ç»Ÿç çš„ç”ŸæˆçŸ©é˜µçš„æ„é€ éƒ½éœ€è¦çŸ©é˜µæ±‚é€†è¿ç®—ï¼ŒæŸ¯è¥¿ç çš„æ„é€ ä¸­æ¶‰åŠåˆ°æ±‚ä¹˜æ³•é€†å…ƒçš„è¿ç®—ï¼Œè¿™äº›è¿ç®—åœ¨å®æ•°åŸŸå†…å­˜åœ¨æ— æ³•æ•´é™¤çš„æƒ…å†µï¼Œå› æ­¤éœ€è¦å°†è¿ç®—é™å®šåœ¨ä¼½ç½—ååŸŸå†…è¿›è¡Œã€‚ æ„é€  æœ¬åŸå¤šé¡¹å¼ P(x)P(x)P(x) æ˜¯ GF(2)GF(2)GF(2) ä¸Šçš„ m æ¬¡å¤šé¡¹å¼ï¼Œå…·æœ‰æ€§è´¨ï¼š(x2mâˆ’1+1)/P(x)(x^{2^m-1}+1)/P(x)(x2mâˆ’1+1)/P(x) çš„ä½™å¼ä¸º 0ï¼Œå¹¶ä¸” P(x)P(x)P(x) ä¸èƒ½è¢« GF(2)GF(2)GF(2) ä¸Šä»»æ„æ¬¡æ•°å°äº m å¤§äº 0 çš„å¤šé¡¹å¼æ•´é™¤ã€‚ ä¸¾ä¾‹è¯´æ˜ GF(23)GF(2^3)GF(23) æ„é€ æ–¹æ³•ï¼Œé€‰æ‹©æœ¬åŸå¤šé¡¹å¼ P(x)=x3+x+1P(x)=x^3+x+1P(x)=x3+x+1 ï¼Œä»¤ P(x)=0P(x)=0P(x)=0 çš„æ ¹ä¸º Î±\\alphaÎ± ï¼Œå³ Î±3+Î±+1=0\\alpha^{3}+\\alpha +1=0Î±3+Î±+1=0ï¼Œä¼½ç½—ååŸŸåŠ æ³•è¿ç®—ä¸ºå¼‚æˆ–ï¼Œæ‰€ä»¥ Î±3=Î±+1\\alpha^{3}= \\alpha+1Î±3=Î±+1ã€‚åˆ©ç”¨æœ¬åŸå…ƒ Î±\\alphaÎ± çš„å¹‚æ¬¡å¯ä»¥ç”Ÿæˆè¯¥åŸŸä¸‹æ‰€æœ‰çš„å…ƒç´ (é™¤ 0 å¤–)ï¼Œå¦‚ä¸‹è¡¨ï¼š å¦‚æœ (xn+1)(x^{n}+1)(xn+1) èƒ½æ•´é™¤ P(x)P(x)P(x) ã€æ¬¡æ•°ä¸º mmm ã€‘ï¼Œå…¶æœ€å°æ¬¡æ•°(æ­£æ•´æ•°) n=2mâˆ’1n=2^m-1n=2mâˆ’1 ï¼Œæ‰€ä»¥æœ‰ Î±2mâˆ’1=1=Î±0\\alpha^{2^m-1}=1=\\alpha^0Î±2mâˆ’1=1=Î±0 ï¼Œå³å¹‚æ¬¡è¾¾åˆ° n=2mâˆ’1n=2^m-1n=2mâˆ’1 é‡æ–°å›åˆ° Î±0\\alpha^0Î±0 å³ç­‰äº 1ï¼Œæ‰€ä»¥æ‰©åŸŸ GF(2w)GF(2^w)GF(2w) å…±æœ‰ 2w2^w2w ä¸ªå…ƒç´ (åŒ…æ‹¬å…ƒç´ 0). 2. çŸ©é˜µ Vandermonde çŸ©é˜µ å®æ•°åŸŸ mÃ—nm \\times nmÃ—n çš„ Vandermonde çŸ©é˜µå½¢å¼å¦‚ä¸‹ï¼ŒVij=Î±jâˆ’1V_{ij}=\\alpha^{j-1}Vijâ€‹=Î±jâˆ’1ï¼Œï¼ˆå¸¸è§å– x1,x2,â‹¯ ,xmx_1,x_2,\\cdots,x_mx1â€‹,x2â€‹,â‹¯,xmâ€‹ ä¸º 1,2,â‹¯ ,m1,2,\\cdots,m1,2,â‹¯,mï¼‰ [1Î±1Î±12â‹¯Î±1nâˆ’11Î±2Î±22â‹¯Î±2nâˆ’11Î±3Î±32â‹¯Î±3nâˆ’1â‹®â‹®â‹®â‹±â‹®1Î±mÎ±m2â‹¯Î±mnâˆ’1]\\begin{bmatrix} 1 &amp; \\alpha_1 &amp; \\alpha_1^2 &amp; \\cdots &amp; \\alpha_1^{n-1} \\\\ 1 &amp; \\alpha_2 &amp; \\alpha_2^2 &amp; \\cdots &amp; \\alpha_2^{n-1} \\\\ 1 &amp; \\alpha_3 &amp; \\alpha_3^2 &amp; \\cdots &amp; \\alpha_3^{n-1} \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 1 &amp; \\alpha_m &amp; \\alpha_m^2 &amp; \\cdots &amp; \\alpha_m^{n-1} \\end{bmatrix}â£â¢â¢â¢â¢â¢â¡â€‹111â‹®1â€‹Î±1â€‹Î±2â€‹Î±3â€‹â‹®Î±mâ€‹â€‹Î±12â€‹Î±22â€‹Î±32â€‹â‹®Î±m2â€‹â€‹â‹¯â‹¯â‹¯â‹±â‹¯â€‹Î±1nâˆ’1â€‹Î±2nâˆ’1â€‹Î±3nâˆ’1â€‹â‹®Î±mnâˆ’1â€‹â€‹â¦â¥â¥â¥â¥â¥â¤â€‹ å®æ•°ä¸‹çš„ä¸åŒå…ƒç´ çš„ Vandermonde çŸ©é˜µ (nÃ—n)(n \\times n)(nÃ—n) æ˜¯ä¸€å®šå¯é€†çš„ï¼Œä½†å®ƒçš„ä»»æ„ m è¡Œ m åˆ—(m&lt;n)ç»„æˆçš„å­çŸ©é˜µä¸ä¸€å®šæ˜¯å¯é€†çš„. ã€å‚è€ƒmathoverflowã€‘ å¯¹äºå®æ•°ä¸‹çš„ vandermonde çŸ©é˜µï¼Œå…ƒç´ ä¸º ä¸åŒæ­£æ•°æ—¶ ä»»æ„çš„å­æ–¹é˜µæ˜¯å¯é€†çš„(*) ç”±äº nâˆ—nn*nnâˆ—n çš„ Vandermonde æ–¹é˜µæ˜¯å¯é€†çš„ï¼Œè‹¥ m&gt;nm&gt;nm&gt;n åˆ™ä»»æ„çš„ nâˆ—nn*nnâˆ—n çš„å­æ–¹é˜µæ˜¯å¯é€†ï¼ˆä¹Ÿæ˜¯èŒƒå¾·è’™çŸ©é˜µï¼‰ã€å¯é€†è¯æ˜æç¤ºï¼šn æ¬¡å¤šé¡¹å¼æœ€å¤šæœ‰ n ä¸ªæ ¹ï¼›å…¶è¡Œåˆ—å¼ä¸ç­‰äº0ã€‘ ã€å®æ•°åŸŸä¸‹çš„å¯é€†æ€§ã€‘ äº’ä¸ç›¸ç­‰çš„å®æ•°æ„æˆçš„èŒƒå¾·è’™çŸ©é˜µæ˜¯å¯é€†çš„ï¼Œè¿™é‡Œè€ƒè™‘å®ƒçš„ä»»æ„å­æ–¹é˜µã€‚ ã€æœ‰é™åŸŸä¸‹çš„å¯é€†æ€§ã€‘ å®æ•°åŸŸä¸‹å¯èƒ½ä¸å¯é€†ï¼Œæœ‰é™åŸŸä¸‹æ›´å¯èƒ½å¦‚æ­¤ã€‚ æ³¨æ„ï¼š æ ¹æ®ã€Note: Correction to the 1997 Tutorial on Reed-Solomon Codingã€‘æ¥æ„é€  VRS çš„ç”ŸæˆçŸ©é˜µã€‚ Cauthy çŸ©é˜µ mÃ—nm \\times nmÃ—n çš„ Cauthy çŸ©é˜µå½¢å¼å¦‚ä¸‹ï¼š X={x1,x2,â€¦,xm}X=\\{ x_1,x_2,\\dots , x_m\\}X={x1â€‹,x2â€‹,â€¦,xmâ€‹}ï¼ŒY={y1,y2,â€¦,yn}Y=\\{ y_1,y_2,\\dots , y_n\\}Y={y1â€‹,y2â€‹,â€¦,ynâ€‹}ï¼Œã€éƒ½æ˜¯ GF(2w)GF(2^w)GF(2w) å…ƒç´ ã€‘ æ»¡è¶³ Xâˆ©Y=âˆ…X \\cap Y = \\emptysetXâˆ©Y=âˆ…ï¼Œå³ä»»æ„ xiâ‰ yj,xiâ‰ xj,yiâ‰ yjx_i \\neq y_j,x_i \\neq x_j, y_i \\neq y_jxiâ€‹î€ â€‹=yjâ€‹,xiâ€‹î€ â€‹=xjâ€‹,yiâ€‹î€ â€‹=yjâ€‹ (éƒ½ä¸ç›¸åŒ) [1x1+y11x1+y21x1+y3â‹¯1x1+yn1x2+y11x2+y21x2+y3â‹¯1x2+yn1x3+y11x3+y21x3+y3â‹¯1x3+ynâ‹®â‹®â‹®â‹±â‹®1xm+y11xm+y21xm+y3â‹¯1xm+yn]\\begin{bmatrix} \\frac{1}{x_1+y_1} &amp; \\frac{1}{x_1+y_2} &amp; \\frac{1}{x_1+y_3} &amp; \\cdots &amp; \\frac{1}{x_1+y_n} \\\\ \\frac{1}{x_2+y_1} &amp; \\frac{1}{x_2+y_2} &amp; \\frac{1}{x_2+y_3} &amp; \\cdots &amp; \\frac{1}{x_2+y_n} \\\\ \\frac{1}{x_3+y_1} &amp; \\frac{1}{x_3+y_2} &amp; \\frac{1}{x_3+y_3} &amp; \\cdots &amp; \\frac{1}{x_3+y_n} \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ \\frac{1}{x_m+y_1} &amp; \\frac{1}{x_m+y_2} &amp; \\frac{1}{x_m+y_3} &amp; \\cdots &amp; \\frac{1}{x_m+y_n} \\end{bmatrix}â£â¢â¢â¢â¢â¢â¢â¡â€‹x1â€‹+y1â€‹1â€‹x2â€‹+y1â€‹1â€‹x3â€‹+y1â€‹1â€‹â‹®xmâ€‹+y1â€‹1â€‹â€‹x1â€‹+y2â€‹1â€‹x2â€‹+y2â€‹1â€‹x3â€‹+y2â€‹1â€‹â‹®xmâ€‹+y2â€‹1â€‹â€‹x1â€‹+y3â€‹1â€‹x2â€‹+y3â€‹1â€‹x3â€‹+y3â€‹1â€‹â‹®xmâ€‹+y3â€‹1â€‹â€‹â‹¯â‹¯â‹¯â‹±â‹¯â€‹x1â€‹+ynâ€‹1â€‹x2â€‹+ynâ€‹1â€‹x3â€‹+ynâ€‹1â€‹â‹®xmâ€‹+ynâ€‹1â€‹â€‹â¦â¥â¥â¥â¥â¥â¥â¤â€‹ å¯¹åº”çš„è¡Œåˆ—å¼çš„å€¼ä¸ºè¯æ˜ï¼š Dn=âˆ1â‰¤iâ‰¤jâ‰¤n(ajâˆ’ai)(bjâˆ’bi)âˆi=1nâˆj=1n(ai+bj)D_n=\\frac{\\prod\\limits_{1\\leq i \\leq j \\leq n} (a_j-a_i)(b_j-b_i)}{\\prod\\limits_{i=1}^{n} \\prod\\limits_{j=1}^{n} (a_i+b_j)} Dnâ€‹=i=1âˆnâ€‹j=1âˆnâ€‹(aiâ€‹+bjâ€‹)1â‰¤iâ‰¤jâ‰¤nâˆâ€‹(ajâ€‹âˆ’aiâ€‹)(bjâ€‹âˆ’biâ€‹)â€‹ Cauchy çŸ©é˜µçš„ä»»æ„ n è¡Œ n åˆ—ç»„æˆçš„çŸ©é˜µéƒ½æ˜¯å¯é€†çš„, å› ä¸ºä»»æ„å­çŸ©é˜µè¿˜æ˜¯ Cauchy çŸ©é˜µ. ã€å®æ•°åŸŸä¸‹çš„å¯é€†æ€§ã€‘ åœ¨ä¸Šè¿°æ¡ä»¶ä¸‹ï¼ŒCauthy çŸ©é˜µæ˜¯éå¥‡å¼‚çŸ©é˜µï¼Œå¯é€†çŸ©é˜µã€‚ ã€æœ‰é™åŸŸä¸‹çš„å¯é€†æ€§ã€‘ çŸ©é˜µä¹Ÿæ˜¯éå¥‡å¼‚çŸ©é˜µ çŸ©é˜µç¼–ç  åˆ©ç”¨å•ä½çŸ©é˜µæ‰©å±• Vandermonde åçš„ nÃ—kn \\times knÃ—k çŸ©é˜µï¼Œå¯èƒ½ä»»æ„ kkk è¡Œçš„å­çŸ©é˜µä¸å¯é€†ï¼Œåœ¨æœ‰é™åŸŸä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ é€šå¸¸ä½¿ç”¨ Vandermonde çŸ©é˜µï¼ŒåšçŸ©é˜µçš„åˆç­‰å˜æ¢ä½¿å¾—å‰ kÃ—kk \\times kkÃ—k æ˜¯å•ä½çŸ©é˜µã€‚ å¯ä»¥ç›´æ¥ä½¿ç”¨å•ä½çŸ©é˜µæ‰©å±• Cauthy çŸ©é˜µï¼Œä»»æ„çš„å­æ–¹é˜µä»ç„¶å¯é€†ã€‚ Cauchy Reed-Solomon çš„ä¼˜åŒ– ä½¿ç”¨ Cauthy çŸ©é˜µ å¯é€†æ€§æ›´å¥½ï¼Œæ„é€ æ›´åŠ ç®€å•ï¼›å¯ä»¥åœ¨ O(n2)O(n^2)O(n2) å®ŒæˆçŸ©é˜µçš„é€†è¿ç®— æŠ•å½±åˆ° GF(2)GF(2)GF(2) æ–¹æ³•ï¼šæ¯ä¸ª GF(2w)GF(2^w)GF(2w) ä¸­çš„å…ƒç´  eee å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ª www ç»´çš„åˆ—å‘é‡ V(e)V(e)V(e)ï¼ˆå¤šé¡¹å¼ç³»æ•°æˆ–äºŒè¿›åˆ¶è¡¨ç¤ºï¼‰ï¼›æ¯ä¸ªå…ƒç´  eee åŒæ ·å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ª wÃ—ww \\times wwÃ—w çš„äºŒè¿›åˆ¶çŸ©é˜µ M(e)M(e)M(e)ï¼Œå…¶ç¬¬ iii åˆ—æ˜¯ eâˆ—2iâˆ’1e*2^{i-1}eâˆ—2iâˆ’1 çš„äºŒè¿›åˆ¶è¡¨ç¤ºå³ V(eâˆ—2iâˆ’1)V(e*2^{i-1})V(eâˆ—2iâˆ’1)ã€‚ä¾‹å¦‚åœ¨ GF(23)GF(2^3)GF(23) ä¸‹å…ƒç´ çš„è¡¨ç¤ºä¸ºï¼š å¾—åˆ°ç»“è®ºï¼š æ ¹æ®æ˜ å°„å…³ç³»ï¼Œä¸åŒå…ƒç´ å¯¹åº”çš„ M(e)M(e)M(e) æ˜¯ä¸åŒçš„ åŸºäºæ ‡å‡†çš„ä½è¿ç®— M(e1)âˆ—V(e2)=V(e1e2)M(e_1) * V(e_2) = V(e_1e_2)M(e1â€‹)âˆ—V(e2â€‹)=V(e1â€‹e2â€‹) åŸºäºæ ‡å‡†çš„ä½è¿ç®— M(e1)âˆ—M(e2)=M(e1e2)M(e_1) * M(e_2)=M(e_1e_2)M(e1â€‹)âˆ—M(e2â€‹)=M(e1â€‹e2â€‹) æ ¹æ®ç»“è®ºï¼Œå¯ä»¥å°† GF(2w)GF(2^w)GF(2w) çš„è¿ç®—è½¬åŒ–ä¸º GF(2)GF(2)GF(2) ä¸‹æ ‡å‡†çš„ä½è¿ç®—ï¼ˆå¼‚æˆ–ï¼ŒæŒ‰ä½ä¸ï¼‰ï¼Œé™ä½äº†è¿ç®—çš„å¤æ‚åº¦ã€‚ (2)çš„ç†è§£ ç”¨ ei,je_{i,j}ei,jâ€‹ è¡¨ç¤ºå…ƒç´  eie_ieiâ€‹ äºŒè¿›åˆ¶çš„ç¬¬ jjj ä½ï¼š e1e2=e1(e2,020+e2,121+â‹¯+e2,wâˆ’12wâˆ’1)=e120âˆ—e2,0+e121âˆ—e2,1+â‹¯+e12wâˆ’1âˆ—e2,wâˆ’1=[e120e121â‹¯e12wâˆ’1]â‹…[e2,0e2,1â‹®e2,wâˆ’1]\\begin{aligned} e_1e_2 &amp;= e_1(e_{2,0}2^{0}+e_{2,1}2^{1}+\\dots+e_{2,w-1}2^{w-1}) \\\\ &amp;= e_12^0*e_{2,0}+e_12^1*e_{2,1}+ \\dots +e_12^{w-1}*e_{2,w-1} \\\\ &amp;= \\begin{bmatrix} e_12^0 &amp; e_12^1 &amp; \\cdots &amp; e_12^{w-1}\\end{bmatrix} \\cdot \\begin{bmatrix} e_{2,0} \\\\ e_{2,1} \\\\ \\vdots \\\\ e_{2,w-1} \\end{bmatrix} \\end{aligned}e1â€‹e2â€‹â€‹=e1â€‹(e2,0â€‹20+e2,1â€‹21+â‹¯+e2,wâˆ’1â€‹2wâˆ’1)=e1â€‹20âˆ—e2,0â€‹+e1â€‹21âˆ—e2,1â€‹+â‹¯+e1â€‹2wâˆ’1âˆ—e2,wâˆ’1â€‹=[e1â€‹20â€‹e1â€‹21â€‹â‹¯â€‹e1â€‹2wâˆ’1â€‹]â‹…â£â¢â¢â¢â¡â€‹e2,0â€‹e2,1â€‹â‹®e2,wâˆ’1â€‹â€‹â¦â¥â¥â¥â¤â€‹â€‹ å°†å¯¹åº”çš„å…ƒç´ æ˜ å°„ä¸º www å‘é‡ï¼Œå³å¯ï¼š V(e1e2)=M(e1)âˆ—V(e2)V(e_1e_2)=M(e_1) * V(e_2) V(e1â€‹e2â€‹)=M(e1â€‹)âˆ—V(e2â€‹) (3)çš„ç†è§£ M(e1)âˆ—M(e2)=M(e1)â‹…[V(e220)V(e221)â‹¯V(e22wâˆ’1)]=[V(e1e220)V(e1e221)â‹¯V(e1e22wâˆ’1)]=M(e1e2)\\begin{aligned} M(e_1)*M(e_2) &amp;= M(e_1) \\cdot \\begin{bmatrix} V(e_22^0) &amp; V(e_22^1) &amp; \\cdots &amp; V(e_22^{w-1}) \\end{bmatrix} \\\\ &amp;= \\begin{bmatrix} V(e_1e_22^0) &amp; V(e_1e_22^1) &amp; \\cdots &amp; V(e_1e_22^{w-1}) \\end{bmatrix} \\\\ &amp;= M(e_1e_2) \\end{aligned}M(e1â€‹)âˆ—M(e2â€‹)â€‹=M(e1â€‹)â‹…[V(e2â€‹20)â€‹V(e2â€‹21)â€‹â‹¯â€‹V(e2â€‹2wâˆ’1)â€‹]=[V(e1â€‹e2â€‹20)â€‹V(e1â€‹e2â€‹21)â€‹â‹¯â€‹V(e1â€‹e2â€‹2wâˆ’1)â€‹]=M(e1â€‹e2â€‹)â€‹ é“¾æ¥ å·¥å…· æœ‰é™åŸŸçš„è®¡ç®—å·¥å…· å¿«é€Ÿä¹˜æ³• é—®ç­” Linear independence of Vandermonde matrix in systematic Reed-Solomon code è®ºæ–‡ A Tutorial on Reed-Solomon Coding for Fault-Tolerance in RAID-like Systems Note: Correction to the 1997 Tutorial on Reed-Solomon Coding Optimizing Cauchy Reed-Solomon Codes for Fault-Tolerant Storage Applications An XOR-Based Erasure-Resilient Coding Scheme Tutorial: Erasure Coding for Storage Applications ","tags":[{"name":"EC","slug":"ec","used":true,"link":"https://blog.qxxiao.eu.org/tag/ec/"}],"title":"çº åˆ ç åŸºç¡€","feature":"","link":"https://blog.qxxiao.eu.org/post/çº åˆ ç åŸºç¡€/","stats":{"text":"11 min read","time":607000,"words":2057,"minutes":11},"date":"2023-05-13 20:37:15","dateFormat":"2023-05-13","isTop":false},{"content":"å‚è€ƒé“¾æ¥ï¼šMinHash-WiKi é—®é¢˜ MinHash ç®—æ³•å’Œ Bloom Filter ä¸€æ ·ï¼Œåˆ©ç”¨å“ˆå¸Œå‡½æ•°çš„éšæœºæ€§ä»æ¦‚ç‡ä¸Šå¿«é€Ÿåœ°è§£å†³é—®é¢˜ï¼Œå®ƒè¯•å›¾è§£å†³çš„é—®é¢˜æ˜¯ï¼šé›†åˆçš„ç›¸ä¼¼æ€§ï¼Œç»™å®šä¸¤ä¸ªå«æœ‰å…ƒç´ çš„é›†åˆï¼Œå®ƒä»¬æœ‰å¤šç›¸ä¼¼ã€‚ç›¸ä¼¼æ€§åº¦é‡ä½¿ç”¨ Jaccard similarity coefficient ï¼š Jaccard similarity(A,B)=âˆ£Aâˆ©Bâˆ£âˆ£AâˆªBâˆ£\\mathbf{Jaccard\\ similarity}(A,B)=\\frac{\\mid A \\cap B \\mid}{\\mid A \\cup B \\mid} Jaccard similarity(A,B)=âˆ£AâˆªBâˆ£âˆ£Aâˆ©Bâˆ£â€‹ å½“ä¸¤ä¸ªé›†åˆä¸ç›¸äº¤æ—¶ï¼Œæ­¤å€¼ä¸º0ï¼›å½“å®ƒä»¬ç›¸ç­‰æ—¶ï¼Œæ­¤å€¼ä¸º1ï¼›å¦åˆ™ä¸¥æ ¼åœ¨0å’Œ1ä¹‹é—´ã€‚å½“JaccardæŒ‡æ•°æ¥è¿‘äº1æ—¶ï¼Œä¸¤ä¸ªé›†åˆæ›´ç›¸ä¼¼ï¼ˆå³å…·æœ‰è¾ƒå¤šå…±åŒæˆå‘˜ï¼‰ã€‚MinHashçš„ç›®æ ‡æ˜¯å¿«é€Ÿä¼°è®¡J(A,B)ï¼Œè€Œæ— éœ€æ˜¾å¼è®¡ç®—äº¤é›†å’Œå¹¶é›†ã€‚ k-hash MinHash ä½¿ç”¨ k hash å‡½æ•°çš„ MinHash æ˜¯ç»å…¸è¡¨ç¤ºï¼Œä¹Ÿå¾ˆä¼˜é›…ã€‚å…¶åšæ³•æ˜¯ï¼šå¯¹ A å’Œ B ä¸­çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œå“ˆå¸Œï¼Œå¹¶æŸ¥çœ‹æ¯ä¸ªé›†åˆä¸­æœ€å°å“ˆå¸Œå€¼ã€‚äº‹å®è¯æ˜ï¼Œè¿™ä¸¤ä¸ªå“ˆå¸Œç›¸ç­‰çš„æ¦‚ç‡æ°å¥½æ˜¯è¿™ä¸¤ä¸ªé›†åˆçš„ Jaccard ç›¸ä¼¼åº¦ã€‚æ³¨æ„ï¼Œä½¿ç”¨ k ä¸ªå“ˆå¸Œå‡½æ•°å¾—åˆ° k ç»„ (hmin(A),hmin(B))(h_{min}(A), h_{min}(B))(hminâ€‹(A),hminâ€‹(B))ï¼Œå¦‚æœå…¶ä¸­æœ‰ y ç»„è¡¨ç¤ºçš„æœ€å°å“ˆå¸Œå€¼ç›¸ç­‰ï¼Œç”¨ y/ky/ky/k æ¥ä¼°è®¡é›†åˆçš„ç›¸ä¼¼åº¦ã€‚ ä¸¾ä¾‹å­è¯´æ˜ï¼Œå¦‚æœ A å’Œ B æ˜¯ç›¸åŒçš„ï¼Œé‚£ä¹ˆå®ƒä»¬çš„æœ€å°å“ˆå¸Œæ˜¾ç„¶æ˜¯ç›¸åŒçš„ã€‚å¦‚æœå®ƒä»¬æ˜¯ä¸ç›¸äº¤çš„ï¼Œå¹¶ä¸”å‡è®¾æ²¡æœ‰å“ˆå¸Œå†²çªï¼ˆæœ¬æ–‡å‰©ä½™éƒ¨åˆ†ä¸­ä¹Ÿè¿™æ ·å‡è®¾ï¼‰ï¼Œé‚£ä¹ˆå®ƒä»¬çš„æœ€å°å“ˆå¸Œæ˜¾ç„¶ä¼šä¸åŒã€‚ä»¥ A åŒ…å« B å¹¶ä¸”å¤§å°ä¸ºå…¶ä¸¤å€ä¸ºä¾‹ã€‚é‚£ä¹ˆå¾ˆå®¹æ˜“ç†è§£ B çš„æœ€å°å“ˆå¸Œæœ‰50% çš„æœºä¼šæˆä¸º A çš„æœ€å°å“ˆå¸Œã€‚ è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼Œéœ€è¦è®¡ç®—æ¯ä¸ªå…ƒç´ çš„ k ä¸ªä¸åŒå“ˆå¸Œå€¼ï¼Œå¹¶ä¸”æœ€åè®¡ç®—å‡ºæ¦‚ç‡ã€‚æ­¤å¤–ï¼Œè¯¥æŠ€æœ¯çš„è¯¯å·®ä¸º 1/(k)1/\\sqrt(k)1/(â€‹k) ï¼Œè¾¾åˆ° 10%è¯¯å·®æ°´å¹³éœ€è¦ 100 ä¸ªå“ˆå¸Œå‡½æ•°ï¼Œ1%è¯¯å·®éœ€è¦ 10000 ä¸ªå“ˆå¸Œå‡½æ•°ã€‚ one-hash MinHash åšæ³•æ˜¯ï¼šè®¡ç®—æ¯ä¸ªå…ƒç´ çš„å“ˆå¸Œå€¼ï¼Œå¹¶å°†é›†åˆä¸­çš„æœ€å°çš„ k ä¸ªå“ˆå¸Œå€¼å­˜å‚¨èµ·æ¥ï¼Œé›†åˆä¸­æœ€å°çš„ k ä¸ªå“ˆå¸Œå€¼ä¹Ÿç”¨åšè¯¥é›†åˆçš„ç­¾åã€‚ç„¶åè®¡ç®—è¿™ä¸¤ä¸ªç­¾åå¯¹åº”é›†åˆçš„ Jaccard ç›¸ä¼¼åº¦ï¼Œå®ƒä»¬çš„ç›¸ä¼¼åº¦å°†è¿‘ä¼¼äº A,B ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œè¯¯å·®ç•Œé™äºä¸Šé¢çš„ç‰ˆæœ¬ç›¸åŒã€‚æ—¶é—´å¤æ‚åº¦ä¸º O(nlogâ¡k)O(n\\log k)O(nlogk) ï¼Œç©ºé—´å¤æ‚åº¦ä¸º O(k)O(k)O(k) ã€‚ å½“ k æ¥è¿‘ n æ—¶ï¼Œå‡†ç¡®åº¦è¶‹è¿‘äº1ï¼Œè€Œå½“ kâ‰¥n æ—¶ï¼Œå‡†ç¡®åº¦ä¸º1ã€‚å¯¹äº k-hash å‡½æ•°ç‰ˆæœ¬çš„ MinHash æ¥è¯´å¹¶éå¦‚æ­¤ã€‚ ä½¿ç”¨ Bloom Filter? ä¹Ÿå¯ä»¥ï¼Œå…ˆå¯¹ A åˆ›å»ºä¸€ä¸ª Bloom Filterï¼Œç„¶åæ ¹æ® B ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ è¿›è¡ŒæŸ¥æ‰¾å¹¶è®¡ç®— Jaccard ç›¸ä¼¼åº¦ã€‚å¹¶ä¸”å¯ä»¥æ ¹æ®è¯¯æŠ¥ç‡æ¥è°ƒæ•´å‡†ç¡®æ€§ã€‚ é“¾æ¥ CS494 Lecture Notes - MinHash ","tags":[{"name":"Article","slug":"article","used":true,"link":"https://blog.qxxiao.eu.org/tag/article/"}],"title":"MinHash","feature":"","link":"https://blog.qxxiao.eu.org/post/minhash/","stats":{"text":"3 min read","time":172000,"words":742,"minutes":3},"date":"2023-05-10 17:21:20","dateFormat":"2023-05-10","isTop":false},{"content":"ç¼–ç¨‹ C++ ç³»åˆ— å·¥å…· Mac ä¸‹çš„ C++å·¥å…·é“¾ ","tags":[{"name":"Article","slug":"article","used":true,"link":"https://blog.qxxiao.eu.org/tag/article/"}],"title":"Notion ç¬”è®°é“¾æ¥","feature":"","link":"https://blog.qxxiao.eu.org/post/notion-links/","stats":{"text":"1 min read","time":3000,"words":14,"minutes":1},"date":"2023-05-05 23:26:04","dateFormat":"2023-05-05","isTop":true},{"content":" http://www.sunshine2k.de/articles/coding/crc/understanding_crc.html#ch6 è¯´æ˜ CRCï¼ˆå¾ªç¯å†—ä½™æ ¡éªŒï¼‰æ˜¯ä¸€ç§æ£€æµ‹æ•°æ®ä¸ä¸€è‡´æ€§çš„æ ¡éªŒç®—æ³•ï¼Œä¾‹å¦‚åœ¨æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­å‡ºç°çš„ä½é”™è¯¯ã€‚ç”± CRC è®¡ç®—å¾—å‡ºçš„æ ¡éªŒå’Œé™„åŠ åˆ°æ•°æ®ä¸Šï¼Œä»¥å¸®åŠ©æ¥æ”¶æ–¹æ£€æµ‹æ­¤ç±»é”™è¯¯ã€‚ CRC åŸºäºé™¤æ³•ã€‚å®é™…è¾“å…¥æ•°æ®è¢«è§£é‡Šä¸ºä¸€ä¸ªé•¿çš„äºŒè¿›åˆ¶ä½æµï¼ˆè¢«é™¤æ•°ï¼‰ï¼Œå®ƒè¢«å¦ä¸€ä¸ªå›ºå®šçš„äºŒè¿›åˆ¶æ•°ï¼ˆé™¤æ•°ï¼‰æ‰€é™¤ã€‚è¿™ä¸ªé™¤æ³•çš„ä½™æ•°å°±æ˜¯æ ¡éªŒå’Œã€‚äºŒè¿›åˆ¶æ•°å­—ï¼ˆè¢«é™¤æ•°å’Œé™¤æ•°ï¼‰ä¸åƒæ™®é€šæ•´å‹å€¼é‚£æ ·å¤„ç†ï¼Œè€Œæ˜¯ä½œä¸ºäºŒå…ƒå¤šé¡¹å¼æ¥å¤„ç†ï¼Œå…¶ä¸­å®é™…ä½ç”¨ä½œç³»æ•°ã€‚ ä¾‹å¦‚è¾“å…¥æ•°æ® 0x25 = 0010 0101 è¢«è§†ä¸º 0âˆ—x7 +0âˆ—x6 +1âˆ—x5 +0âˆ—x4 +0âˆ—x3 +1âˆ—x2 +0âˆ—x1 +1âˆ—x00*x^7 + 0*x^6 + 1*x^5 + 0*x^4 + 0*x^3 + 1*x^2 + 0*x^1 + 1*x^00âˆ—x7 +0âˆ—x6 +1âˆ—x5 +0âˆ—x4 +0âˆ—x3 +1âˆ—x2 +0âˆ—x1 +1âˆ—x0 . è¢«é™¤æ•°æ˜¯å®Œæ•´çš„è¾“å…¥æ•°æ®ï¼ˆè§£é‡Šä¸ºäºŒè¿›åˆ¶æµï¼‰ é™¤æ•°ï¼Œä¹Ÿç§°ä¸ºç”Ÿæˆå¤šé¡¹å¼ï¼Œç”±ä½¿ç”¨çš„ CRC ç®—æ³•å®šä¹‰ã€‚CRC-n ä½¿ç”¨å…·æœ‰ (n+1) ä½çš„å›ºå®šå®šä¹‰ç”Ÿæˆå¤šé¡¹å¼ CRC æ ¡éªŒå’Œçš„å€¼è¢«å®šä¹‰ä¸ºè¢«é™¤æ•° % é™¤æ•°ï¼Œå¯¹ç”Ÿæˆå¤šé¡¹å¼çš„ä½™æ•° ä¸¾ä¾‹ // è¾“å‡ºæ•°æ®æ˜¯ byte 0xC2 = b1100 0010 // ç”Ÿæˆå¤šé¡¹å¼ï¼Œå³é™¤æ•°ä¸º b10001 1101(é™¤æ•°9ä½ï¼Œå› æ­¤æ˜¯CRC-8,æ·»åŠ 8ä¸ª 0bits åˆ°è¾“å…¥æ•°æ®æœ«å°¾) // å°†é™¤æ•°çš„å‰å¯¼â€œ1â€ä¸è¢«é™¤æ•°çš„ç¬¬ä¸€ä¸ªâ€œ1â€å¯¹é½ï¼Œé€æ­¥è¿›è¡Œé™¤æ³•è¿ç®—ï¼Œä½†æ˜¯å¯¹æ¯ä¸ªä½ä½¿ç”¨XORæ“ä½œï¼š 1100001000000000 100011101 --------- 010011001 100011101 --------- 000101111 100011101 (*) --------- 001100101 100011101 --------- 010001001 100011101 --------- 000001111 = 0x0F åœ¨æ¯ä¸€æ­¥ä¸­ï¼Œé™¤æ•°çš„å‰å¯¼â€œ1â€å§‹ç»ˆä¸è¢«é™¤æ•°çš„ç¬¬ä¸€ä¸ªâ€œ1â€å¯¹é½ã€‚è¿™æ„å‘³ç€ï¼Œåœ¨æ¯ä¸€æ­¥ä¸­ï¼Œé™¤æ•°ä¸ä»…å‘å³ç§»åŠ¨ 1 ä½ï¼Œæœ‰æ—¶è¿˜ä¼šç§»åŠ¨å‡ ä¸ªæ­¥éª¤ï¼ˆä¾‹å¦‚åƒ (*) è¡Œï¼‰ã€‚ ç®—æ³•ä¼šåœ¨é™¤æ•°å°†å®é™…è¾“å…¥æ•°æ®ï¼ˆä¸åŒ…æ‹¬å¡«å……å­—èŠ‚ï¼‰çš„æ¯ä¸ªä½éƒ½æ¸…é›¶æ—¶åœæ­¢ã€‚æˆ–è€…è¯´æœ€åçš„æœ‰æ•ˆä½å…¨éƒ¨ä½äºå¡«å……å­—èŠ‚(è¿™é‡Œ n=8)ï¼Œä¹Ÿå³æœ€ç»ˆçš„ä½™æ•°åœ¨ n-bit èŒƒå›´å†…(å°äºè¢«é™¤æ•°)ã€‚ æ¯ä¸€æ­¥ä¸­åªæœ‰ä½™æ•°æ˜¯æ„Ÿå…´è¶£çš„ï¼Œå› æ­¤å®é™…é™¤æ³•ç»“æœï¼ˆå•†ï¼‰å¯ä»¥ä¸å…³å¿ƒã€‚ æœ€ååªå– n-bit çš„ä½™æ•° CRC éªŒè¯ ä½™æ•°æ˜¯ CRC å€¼ï¼Œå®ƒä¸è¾“å…¥æ•°æ®ä¸€èµ·ä¼ è¾“åˆ°æ¥æ”¶å™¨ã€‚å¸¸è§çš„åšæ³•æ˜¯ï¼Œç›´æ¥å°† CRC å€¼é™„åŠ åˆ°å®é™…æ•°æ®æœ«å°¾ã€‚ç„¶åæ¥æ”¶å™¨åœ¨æ•´ä¸ªæ•°æ®ä¸Šï¼ˆåŒ…æ‹¬å·²é™„åŠ äº† CRC å€¼çš„è¾“å…¥ï¼‰è®¡ç®— CRCï¼šå¦‚æœ CRC å€¼ä¸º0ï¼Œåˆ™å¾ˆå¯èƒ½åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰å‘ç”Ÿä½é”™è¯¯ã€‚ å®ç°ç»†èŠ‚ é€šè¿‡æ‰‹åŠ¨æ¨¡æ‹Ÿçš„è¿‡ç¨‹ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°é€šè¿‡ç§»ä½å¯„å­˜å™¨çš„æ–¹å¼é€æ­¥è®¡ç®—å‡ºæœ€åçš„ä½™æ•°ã€‚ åˆå§‹åŒ–å›ºå®šå¤§å°(n-bit)çš„ç§»ä½å¯„å­˜å™¨ä¸º 0; é€ä½ç§»åŠ¨è¾“å…¥æµã€‚å¦‚æœå¼¹å‡ºçš„ MSB æ˜¯ 1ï¼Œåˆ™ä½¿ç”¨ç”Ÿæˆå¤šé¡¹å¼å¯¹å¯„å­˜å™¨å€¼è¿›è¡Œå¼‚æˆ–æ“ä½œ; å¦‚æœæ‰€æœ‰è¾“å…¥ä½éƒ½è¢«å¤„ç†ï¼Œåˆ™ CRC ç§»ä½å¯„å­˜å™¨å†…å®¹å°±æ˜¯ CRC å€¼ã€‚ CRC-8 å®ç° ç”Ÿæˆå¤šé¡¹å¼çš„æœ€é«˜ä½æ˜¯ 1ï¼Œå¹¶ä¸”åœ¨é™¤æ³•è¿‡ç¨‹ä¸­ä¼šå°†ç”Ÿæˆå¤šé¡¹å¼çš„æœ€é«˜ä½ 1 ä¸è¢«é™¤æ•°çš„ä¸‹ä¸€ä¸ªæœ€é«˜ä½ 1 å¯¹é½ï¼Œå¼‚æˆ–ä¸º 0ï¼Œæ‰€ä»¥è¿ç®—è¿‡ç¨‹å¯ä»¥å¿½ç•¥ç”Ÿæˆå¤šé¡¹å¼çš„æœ€é«˜ä½ 1ï¼Œä¾‹å¦‚ 9 ä½çš„ b100011101 åªéœ€è¦ä½¿ç”¨0x1D è¿›è¡Œè¿ç®—ã€‚ æ³¨æ„ï¼Œå¯ä»¥æ¯ä¸ªå­—èŠ‚å•ç‹¬å¤„ç†ï¼Œå¤„ç†å®Œä¸€ä¸ªå­—èŠ‚åçš„ä½™æ•°ä¸ä¸‹ä¸€ä¸ªå­—èŠ‚å¼‚æˆ–åç»§ç»­å¤„ç† ç±»ä¼¼è¿™æ ·å¤„ç† // æŒ‰ç…§æ‰‹åŠ¨é™¤æ³•çš„æ¨¡æ‹Ÿ b1 0 b2 0 b3 0 ...... #include &lt;cstdint&gt; uint8_t Compute_CRC8_Simple(const unsigned char* bytes, size_t length) { const uint8_t generator = 0x1D; // b100011101 = 0x1D uint8_t crc = 0; /* first byte can be 'xored' in */ for (size_t j = 0; j &lt; length; j++) { crc ^= bytes[j]; /* XOR-in the next input byte */ for (int i = 0; i &lt; 8; i++) { if ((crc &amp; 0x80) != 0) crc = (crc &lt;&lt; 1) ^ generator; else crc &lt;&lt;= 1; } } return crc; } CRC-32 å®ç° ç”Ÿæˆå¤šé¡¹å¼å– 33-bitï¼Œè¿™é‡Œä½¿ç”¨0x04C11DB7(çœç•¥æœ€é«˜ä½çš„ 1)ã€‚ ç±»ä¼¼ï¼Œå¯ä»¥é€ä¸ªå­—èŠ‚è¿›è¡Œè®¡ç®— #include &lt;cstdint&gt; uint32_t Compute_CRC32_Simple(const unsigned char* bytes, size_t length){ const uint32_t polynomial = 0x04C11DB7; /* divisor is 32bit */ uint32_t crc = 0; /* CRC value is 32bit */ for (size_t j = 0; j &lt; length; j++){ crc ^= (uint32_t)(bytes[j] &lt;&lt; 24); /* move byte into MSB of 32bit CRC */ for (int i = 0; i &lt; 8; i++){ if ((crc &amp; 0x80000000) != 0) /* test for MSB = bit 31 */ crc = (uint32_t)((crc &lt;&lt; 1) ^ polynomial); else crc &lt;&lt;= 1; } } return crc; } é™„å½• http://www.sunshine2k.de/coding/javascript/crc/crc_js.html ","tags":[{"name":"Article","slug":"article","used":true,"link":"https://blog.qxxiao.eu.org/tag/article/"}],"title":"Understanding and implementing CRC","feature":"","link":"https://blog.qxxiao.eu.org/post/understanding-and-implementing-crc/","stats":{"text":"5 min read","time":278000,"words":1124,"minutes":5},"date":"2023-05-01 16:29:24","dateFormat":"2023-05-01","isTop":false},{"content":"ç†µ Entropy çš„å®šä¹‰ ç¦»æ•£å‹éšæœºå˜é‡ XXX (å­—æ¯è¡¨ä¸º X\\mathcal{X}Xï¼Œæ¦‚ç‡å‡½æ•° p(x)=Pr(X=x),xâˆˆXp(x) = Pr(X=x), x\\in \\mathcal{X}p(x)=Pr(X=x),xâˆˆX)ï¼Œentropy ç†µå®šä¹‰ä¸ºï¼š H(X)=âˆ’âˆ‘xâˆˆXp(x)logâ¡p(x)=âˆ’Elogâ¡p(x)H(X) = - \\sum\\limits_{x\\in \\mathcal{X}} p(x)\\log p(x) = -E\\log p(x) H(X)=âˆ’xâˆˆXâˆ‘â€‹p(x)logp(x)=âˆ’Elogp(x) 0logâ¡0â†’00\\log 0 \\rightarrow 00log0â†’0 (xxx è¶‹è¿‘äº 0ï¼Œxlogâ¡xx\\log xxlogx è¶‹è¿‘äº 0 ) H(X)â‰¥0H(X)\\ge 0H(X)â‰¥0 å½“ XXX æ˜¯åœ¨ X\\mathcal{X}X æœä»å‡åŒ€åˆ†å¸ƒæ—¶ï¼ŒH(X)=logâ¡âˆ£Xâˆ£H(X) = \\log |\\mathcal{X}|H(X)=logâˆ£Xâˆ£ Hb(X)=logâ¡baHa(X)H_b(X)= \\log_{b}a H_a(X)Hbâ€‹(X)=logbâ€‹aHaâ€‹(X) ç®—æ³•/å®šä¹‰ä¸­çš„å¯¹æ•°å¦‚æœä»¥ bbb ä¸ºåº•ï¼Œç†µè®°ä½œ Hb(X)H_b(X)Hbâ€‹(X) ä»¥ 2 ä¸ºåº•ï¼Œå•ä½ä¸º bits ä»¥è‡ªç„¶å¸¸æ•° e ä¸ºåº•ï¼Œå•ä½ä¸º nats ï¼ˆè¡¡é‡ä¿¡æ¯é‡å¤§å°ï¼Œä¸ç¡®å®šæ€§å¤§å°ï¼‰ ä¾‹å­ äºŒè¿›åˆ¶ç†µå‡½æ•° Let X={1with probablity pxwith probability 1âˆ’p\\text{Let }X = \\begin{cases} 1 &amp; \\text{with probablity }p\\\\ x &amp; \\text{with probability }1-p \\end{cases} Let X={1xâ€‹with probablity pwith probability 1âˆ’pâ€‹ ç³»ç»Ÿçš„ç†µï¼š H(x)=âˆ’plogâ¡pâˆ’(1âˆ’p)logâ¡(1âˆ’p)H(x)=-p\\log p - (1-p)\\log(1-p)H(x)=âˆ’plogpâˆ’(1âˆ’p)log(1âˆ’p) ï¼Œå…³ç³»å¦‚ä¸‹ï¼š æ€§è´¨ è¯´æ˜ï¼š å‡¹å‡½æ•°(å‡¹å‘ä¸‹)çš„æ€§è´¨ [1] è¿™é‡Œçš„ Î»1,Î»2,â‹¯\\lambda_{1},\\lambda_{2},\\cdotsÎ»1â€‹,Î»2â€‹,â‹¯ å–å€¼éƒ½æ˜¯ 1âˆ£Xâˆ£\\frac{1}{|\\mathcal{X}|}âˆ£Xâˆ£1â€‹ å½“ä¸”ä»…å½“ï¼Œå‡åŒ€åˆ†å¸ƒå–åˆ°æœ€å¤§ç†µ (å‡åŒ€åˆ†å¸ƒæœ€å¤§åŒ–ç¦»æ•£ç†µ) æ ¹æ®ç†µçš„å®šä¹‰ï¼Œå®ƒåªç”±æ¦‚ç‡åˆ†å¸ƒç¡®å®šï¼Œæ ¹æ®æ¦‚ç‡åˆ†å¸ƒï¼Œå¯ä»¥å¾—åˆ°è”åˆç†µã€æ¡ä»¶ç†µï¼Œé“¾å¼æ³•åˆ™ã€‚ æ¦‚ç‡ç»Ÿè®¡ä¸­çš„æ³•åˆ™ é“¾å¼æ³•åˆ™ï¼šp(x1,x2,â‹¯ ,xn)=p(xn)p(xnâˆ’1âˆ£xn)â‹¯p(x1âˆ£x2,â‹¯ ,xnâˆ’1)p(x_1,x_2,\\cdots,x_{n)}=p(x_n)p(x_{n-1}|x_{n})\\cdots p(x_1|x_2,\\cdots,x_{n-1})p(x1â€‹,x2â€‹,â‹¯,xn)â€‹=p(xnâ€‹)p(xnâˆ’1â€‹âˆ£xnâ€‹)â‹¯p(x1â€‹âˆ£x2â€‹,â‹¯,xnâˆ’1â€‹) è´å¶æ–¯è§„åˆ™ï¼šp(y)p(xâˆ£y)=p(x)p(yâˆ£x)p(y)p(x|y)=p(x)p(y|x)p(y)p(xâˆ£y)=p(x)p(yâˆ£x) è”åˆç†µ Joint Entropy æ¡ä»¶ç†µ Conditional Entropy æ¡ä»¶ç†µ H(Yâˆ£X)H(Y|X)H(Yâˆ£X) æ˜¯ï¼Œåœ¨ p(Yâˆ£X=x)p(Y|X=x)p(Yâˆ£X=x) ä¸Šå®šä¹‰çš„ç†µï¼Œå¯¹ x å–åŠ æƒå¹³å‡ï¼›æˆ–è€…ç›´æ¥æ ¹æ®æœŸæœ›è®¡ç®—ã€‚ æ ¹æ®æœŸæœ›è®¡ç®—æ—¶ï¼Œä½¿ç”¨çš„æ˜¯ p(x,y)p(x,y)p(x,y) ä¾‹å­ æ¡ä»¶ç†µä¸å¯äº¤æ¢å˜é‡çš„ä½ç½® H(Xâˆ£Y)+H(Y)=H(Yâˆ£X)+H(X)=H(X,Y)\\boldsymbol{H}(\\boldsymbol{X} \\mid \\boldsymbol{Y})+\\boldsymbol{H}(\\boldsymbol{Y})=\\boldsymbol{H}(\\boldsymbol{Y} \\mid \\boldsymbol{X})+\\boldsymbol{H}(\\boldsymbol{X})=\\boldsymbol{H}(\\boldsymbol{X}, \\boldsymbol{Y})H(Xâˆ£Y)+H(Y)=H(Yâˆ£X)+H(X)=H(X,Y) å¯ä»¥æ ¹æ®å®šä¹‰çš„æœŸæœ›å…¬å¼è¯æ˜ï¼Œå‚è€ƒä¸‹é¢çš„é“¾å¼æ³•åˆ™ å¯ä»¥ä»ä¿¡æ¯çš„ä¸ç¡®å®šæ€§æ¥ç†è§£ é“¾å¼æ³•åˆ™ é›¶ç†µ Zero Entropy è¯´æ˜ï¼šå¦‚æœç†µ H(X)=0H(X)=0H(X)=0 ï¼Œå¯¹äºç¦»æ•£å˜é‡ XXXï¼Œå…¶æ¦‚ç‡åˆ†å¸ƒåªæœ‰ä¸€ä¸ªå–å€¼ Pr(X=x0)=1Pr(X=x_0)=1Pr(X=x0â€‹)=1 ç”± H(Yâˆ£X)=0âŸ¹H(Yâˆ£X=x)=0H(Y|X)=0 \\Longrightarrow H(Y|X=x)=0H(Yâˆ£X)=0âŸ¹H(Yâˆ£X=x)=0 ï¼Œæ ¹æ®å®ƒçš„å®šä¹‰å®¹æ˜“å¾—åˆ°ï¼› ç”± H(Yâˆ£X=x)=0H(Y|X=x)=0H(Yâˆ£X=x)=0ï¼Œå®¹æ˜“çŸ¥é“ Y åœ¨ X=xX=xX=x ä¸‹åªæœ‰ä¸€ä¸ªç¡®å®šçš„å–å€¼ï¼› Y æ˜¯ X çš„å‡½æ•°ã€‚ ç›¸å¯¹ç†µ Relative Entropy ç›¸å¯¹ç†µï¼šç”¨æ¥åº¦é‡ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„è·ç¦» ç›¸å¯¹ç†µ (Kullback-Leibler(KL)è·ç¦») ï¼Œåœ¨å­—æ¯è¡¨ X\\mathcal{X}X ä¸Šçš„ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒå‡½æ•° p(x),q(x)p(x),q(x)p(x),q(x) çš„ KL è·ç¦»å®šä¹‰ä¸ºï¼š D(pâˆ¥q)=âˆ‘xâˆˆXp(x)logâ¡p(x)q(x)=Eplogâ¡p(X)q(X)\\begin{aligned} D(p \\| q)= &amp; \\sum_{x \\in X} p(x) \\log \\frac{p(x)}{q(x)} \\\\ &amp; =E_p \\log \\frac{p(X)}{q(X)} \\end{aligned} D(pâˆ¥q)=â€‹xâˆˆXâˆ‘â€‹p(x)logq(x)p(x)â€‹=Epâ€‹logq(X)p(X)â€‹â€‹ è¯´æ˜ï¼š Not Metric ç›¸å¯¹ç†µä¸æ˜¯ä¸€ç§ Metric æµ‹åº¦ äº’ä¿¡æ¯ Mutual Information äº’ä¿¡æ¯ï¼Œç”¨æ¥è¡¡é‡ä¸¤ä¸ªéšæœºå˜é‡çš„å…³è”ç¨‹åº¦ï¼ˆç›¸äº’æ‹¥æœ‰çš„ä¿¡æ¯é‡ï¼‰ï¼Œä½¿ç”¨ç›¸å¯¹ç†µã€p(x,y) ä¸ p(x)p(y)ã€‘æ¥å®šä¹‰ï¼š äº’ä¿¡æ¯çš„ä¸¤ä¸ªå˜é‡å¯ä»¥äº¤æ¢ä½ç½® ä¸¤ä¸ªç›¸äº’ç‹¬ç«‹çš„äº’ä¿¡æ¯ä¸º 0ï¼›åŒä¸€ä¸ªå˜é‡çš„äº’ä¿¡æ¯ä¸ºå®ƒçš„ç†µ äº’ä¿¡æ¯ I(X;Y)I(X;Y)I(X;Y) ä¸­ï¼Œä½¿ç”¨åˆ†å· ; åˆ†éš”ä¸¤ä¸ªå˜é‡ Venn å›¾ ä½¿ç”¨ Venn å›¾ç†è§£å¤šä¸ªä¿¡æ¯é‡çš„åº¦é‡ å¤šä¸ªå˜é‡çš„é“¾å¼æ³•åˆ™ æ¡ä»¶äº’ä¿¡æ¯ ä¸ºäº†æè¿°åœ¨å˜é‡ ZZZ ç»™å®šæ¡ä»¶ä¸‹ï¼Œå˜é‡ X,YX,YX,Y çš„äº’ä¿¡æ¯é‡(ç¬¦å·ä¸­ âˆ£Z\\mid Zâˆ£Z æ˜¯æ•´ä½“ï¼Œè¡¨ç¤ºæ¡ä»¶ ZZZ) æ¡ä»¶ç›¸å¯¹ç†µ æ¡ä»¶ç›¸å¯¹ç†µå’Œç›¸å¯¹ç†µçš„é“¾å¼æ³•åˆ™ï¼š é“¾æ¥ ä¿¡æ¯è®ºåŸºç¡€ä¸­æ–‡ç‰ˆ pdf-Cover è‹±æ–‡ç‰ˆ-Cover Information Theory, Inference, and Learning Algorithms An Introduction to Single-User Information Theory.pdf å‡½æ•°çš„å‡¹å‡¸æ€§ â†©ï¸ ","tags":[{"name":"Article","slug":"article","used":true,"link":"https://blog.qxxiao.eu.org/tag/article/"}],"title":"ä¿¡æ¯è®ºåŸºç¡€","feature":"","link":"https://blog.qxxiao.eu.org/post/ä¿¡æ¯è®ºåŸºç¡€/","stats":{"text":"6 min read","time":337000,"words":1173,"minutes":6},"date":"2023-04-27 17:48:27","dateFormat":"2023-04-27","isTop":false},{"content":"ç®€ä»‹ åŸºç¡€ å¯†ç åˆ†æå­¦ å¯†ç åˆ†æè€…æ”»å‡»å¯†ç ä½“åˆ¶çš„æ–¹æ³•ï¼š ç©·ä¸¾æ”»å‡»ï¼šé€šè¿‡è¯•éæ‰€æœ‰çš„å¯†é’¥è¿›è¡Œç ´è¯‘ å¯¹æŠ—ï¼šå¢å¤§å¯†é’¥çš„æ•°é‡ ç»Ÿè®¡åˆ†ææ”»å‡»ï¼šé€šè¿‡åˆ†æå¯†æ–‡å’Œæ˜æ–‡çš„ç»Ÿè®¡è§„å¾‹ç ´è¯‘ å¯¹æŠ—ï¼šè®¾æ³•ä½¿æ˜æ–‡å’Œå¯†æ–‡çš„ç»Ÿè®¡è§„å¾‹ä¸ä¸€æ · è§£å¯†å˜æ¢æ”»å‡»ï¼šé’ˆå¯¹åŠ å¯†å˜æ¢çš„æ•°å­¦åŸºç¡€ï¼Œé€šè¿‡æ•°å­¦æ±‚è§£è®¾æ³•æ‰¾åˆ°è§£å¯†å˜æ¢ å¯¹æŠ—ï¼šé€‰ç”¨å…·æœ‰åšå®çš„æ•°å­¦åŸºç¡€å’Œè¶³å¤Ÿå¤æ‚çš„åŠ å¯†ç®—æ³• æ ¹æ®æ”»å‡»å¼ºåº¦ï¼Œå¯ä»¥åˆ†ä¸ºï¼šå”¯å¯†æ–‡æ”»å‡»ã€å·²çŸ¥æ˜æ–‡æ”»å‡»ã€é€‰æ‹©æ˜æ–‡æ”»å‡»ã€é€‰æ‹©å¯†æ–‡æ”»å‡»ï¼Œå¼ºåº¦è¶Šæ¥è¶Šå¼ºã€‚ å®‰å…¨æ€§ï¼š æ— æ¡ä»¶å®‰å…¨ï¼šæ— è®ºæˆªè·å¤šå°‘å¯†æ–‡ï¼Œéƒ½æ²¡æœ‰è¶³å¤Ÿä¿¡æ¯æ¥å”¯ä¸€ç¡®å®šæ˜æ–‡ï¼Œå³å¯¹ç®—æ³•çš„ç ´è¯‘ä¸æ¯”çŒœæµ‹æœ‰ä¼˜åŠ¿ï¼› è®¡ç®—ä¸Šå®‰å…¨ï¼šä½¿ç”¨æœ‰æ•ˆèµ„æºå¯¹ä¸€ä¸ªå¯†ç ç³»ç»Ÿè¿›è¡Œåˆ†æè€Œæœªèƒ½ç ´è¯‘ï¼› å¤å…¸å¯†ç ç®—æ³• ç½®æ¢å¯†ç  å¯¹æ˜æ–‡å­—ç¬¦è¿›è¡Œä½ç½®ç§»åŠ¨çš„å¯†ç  å•è¡¨ä»£æ›¿å¯†ç  ç”¨å¯†ç å­—æ¯è¡¨ä¸­å­—æ¯ä»£æ›¿æ˜æ–‡å­—æ¯ å¤šè¡¨ä»£æ¢å¯†ç  åœ¨æ¨¡æ•° NNN ä¸‹çš„çŸ©é˜µä¹˜æ³•ä¸­ï¼ŒçŸ©é˜µ AAA åªæœ‰åœ¨æ»¡è¶³ gcd(Adet,N)=1gcd(A_{det}, N) = 1gcd(Adetâ€‹,N)=1 çš„æƒ…å†µä¸‹æ‰æœ‰é€†çŸ©é˜µã€‚è¿™æ˜¯å› ä¸ºåœ¨æ¨¡æ•° NNN ä¸‹ï¼Œåªæœ‰ä¸ NNN äº’è´¨çš„æ•°æ‰æœ‰æ¨¡ NNN ä¸‹çš„ä¹˜æ³•é€†å…ƒã€‚å¦‚æœ gcd(Adet,N)â‰ 1gcd(A_{det}, N) \\neq 1gcd(Adetâ€‹,N)î€ â€‹=1ï¼Œåˆ™ AAA çš„è¡Œåˆ—å¼ AdetA_{det}Adetâ€‹ å’Œæ¨¡æ•° NNN ä¸äº’è´¨ï¼Œå› æ­¤ AAA æ²¡æœ‰æ¨¡ NNN ä¸‹çš„ä¹˜æ³•é€†å…ƒï¼Œä¹Ÿå°±æ²¡æœ‰é€†çŸ©é˜µã€‚ æœ‰é™åŸŸ ä¾‹å¦‚ï¼ŒZn={0,1,2,â‹¯ ,nâˆ’1}mod nZ_{n}= \\{ 0,1,2,\\cdots,n-1 \\}_{mod\\ n}Znâ€‹={0,1,2,â‹¯,nâˆ’1}mod nâ€‹ å¹¶ä¸”åŠ æ³•å’Œä¹˜æ³•éƒ½æ˜¯æ¨¡ nnn çš„è¿ç®—ï¼ŒZnZ_nZnâ€‹ çš„æ•°ä»€ä¹ˆæ—¶å€™æœ‰ä¹˜æ³•é€†å…ƒå‘¢ï¼Ÿ æ•´æ•° a åœ¨æ¨¡ n ä¹˜æ³•ä¸‹æœ‰é€†å…ƒï¼Œå½“ä¸”ä»…å½“ a ä¸ n äº’ç´ ã€‚ æ‰€æœ‰ä¸ n äº’ç´ çš„å…ƒç´ åœ¨æ¨¡ n ä¹˜æ³•ä¸‹æ„æˆä¹˜æ³•äº¤æ¢ç¾¤(äº¤æ¢å¾‹) 1...n-1 éƒ½ä¸ n äº’ç´ ï¼Œåˆ™ n ä¸ºç´ æ•° æ‰€ä»¥ï¼Œå¯¹äºä»»ä½•ä¸€ä¸ªç´ æ•° pï¼ŒZpZ_pZpâ€‹ ä¸ºåŸŸï¼Œå…¶å…ƒç´ çš„ä¸ªæ•°ä¸º p ä¸ªã€‚ å®šä¹‰æœ‰é™åŸŸä¸Šçš„å¤šé¡¹å¼ F[x]F[x]F[x] å’Œ n æ¬¡å¤šé¡¹å¼ f(x)f(x)f(x)ï¼ŒF[x]/f(x)={r(x)=rnâˆ’1xnâˆ’1+rnâˆ’1xnâˆ’2+â‹¯+r1x+r0 âˆ£ riâˆˆF,0â‰¤iâ‰¤nâˆ’1}F[x]/f(x)=\\{ r(x) = r_{n-1}x^{n-1} + r_{n-1}x^{n-2}+\\cdots+r_1x+r_{0}\\ |\\ r_{i}\\in F, 0\\le i \\le n-1 \\}F[x]/f(x)={r(x)=rnâˆ’1â€‹xnâˆ’1+rnâˆ’1â€‹xnâˆ’2+â‹¯+r1â€‹x+r0â€‹ âˆ£ riâ€‹âˆˆF,0â‰¤iâ‰¤nâˆ’1} ï¼ŒåŠ æ³•å’Œä¹˜æ³•éƒ½æ˜¯æ¨¡ f(x)f(x)f(x) çš„è¿ç®—ï¼Œè¿ç®—æ˜¯å°é—­çš„ã€‚é‚£ä¹ˆ F[x]/f(x)F[x]/f(x)F[x]/f(x) ä¸­çš„å¤šé¡¹å¼ä»€ä¹ˆæ—¶å€™æœ‰ä¹˜æ³•é€†å…ƒå‘¢ï¼Ÿ r(x)r(x)r(x) åœ¨æ¨¡ f(x)f(x)f(x) çš„ä¹˜æ³•ä¸‹æœ‰é€†å…ƒï¼Œå½“ä¸”ä»…å½“ r(x)r(x)r(x) ä¸ f(x)f(x)f(x) äº’ç´ ã€‚ æ‰€æœ‰ä¸ f(x)f(x)f(x) äº’ç´ çš„å…ƒç´ åœ¨æ¨¡ f(x)f(x)f(x) çš„ä¹˜æ³•ä¸‹æ„æˆä¹˜æ³•äº¤æ¢ç¾¤ æ¬¡æ•°æ¯” f(x)f(x)f(x) æ¬¡æ•°ä½çš„å¤šé¡¹å¼éƒ½ä¸ f(x)f(x)f(x) äº’ç´ ï¼Œåˆ™ f(x)f(x)f(x) ä¸ºä¸å¯çº¦å¤šé¡¹å¼ å¯¹äºä»»æ„ä¸€ä¸ªé¦–é¡¹ç³»æ•°ä¸º 1 çš„ä¸å¯çº¦å¤šé¡¹å¼ï¼ŒF[x]/f(x)F[x]/f(x)F[x]/f(x) ä¸ºåŸŸ è‹¥ F=ZpF=Z_pF=Zpâ€‹ï¼Œåˆ™ F[x]/f(x)F[x]/f(x)F[x]/f(x) ä¸­å…ƒç´ çš„ä¸ªæ•°ä¸º pnp^npn ä¸ª è¯´æ˜ï¼špnp^npn åŸŸçš„æ„é€ æ–¹æ³•ï¼Œé¦–å…ˆé€‰å– ZpZ_pZpâ€‹ ä¸­çš„ä¸€ä¸ª n æ¬¡ä¸å¯çº¦å¤šé¡¹å¼ï¼Œç„¶åæ„é€ é›†åˆ F[x]/f(x)={r(x)=rnâˆ’1xnâˆ’1+rnâˆ’1xnâˆ’2+â‹¯+r1x+r0 âˆ£ riâˆˆF,0â‰¤iâ‰¤nâˆ’1}F[x]/f(x)=\\{ r(x) = r_{n-1}x^{n-1} + r_{n-1}x^{n-2}+\\cdots+r_1x+r_{0}\\ |\\ r_{i}\\in F, 0\\le i \\le n-1 \\}F[x]/f(x)={r(x)=rnâˆ’1â€‹xnâˆ’1+rnâˆ’1â€‹xnâˆ’2+â‹¯+r1â€‹x+r0â€‹ âˆ£ riâ€‹âˆˆF,0â‰¤iâ‰¤nâˆ’1}ï¼Œé›†åˆä¸­çš„åŠ æ³•å’Œä¹˜æ³•è¿ç®—éƒ½ä¸ºæ¨¡å¤šé¡¹å¼ f(x)f(x)f(x) çš„è¿ç®—ã€‚ èµ„æ–™ ä¸­ç§‘å¤§-ç°ä»£å¯†ç å­¦ å¯†ç å­¦ Cryptography_and_Network_Security Principles_and_Practice-5th_edition.pdf ä¿¡æ¯è®ºä¸ç¼–ç æŠ€æœ¯ ç”µå­ç§‘æŠ€å¤§å­¦-ç°ä»£å¯†ç å­¦ è¯¾ä»¶(å¯†ç  miao) å¯†ç å­¦åŸºç¡€æ–‡ç«  é™„å½• ç¾¤å’ŒåŸŸ ç¾¤å’ŒåŸŸéƒ½æ˜¯æŠ½è±¡ä»£æ•°ä¸­çš„åŸºæœ¬æ¦‚å¿µï¼Œå®ƒä»¬éƒ½æ˜¯ä¸€ç§ä»£æ•°ç»“æ„ã€‚ ç¾¤æ˜¯ä¸€ä¸ªé›†åˆ GGG å’Œä¸€ä¸ªäºŒå…ƒè¿ç®— â‹…\\cdotâ‹… çš„ç»„åˆ (G,â‹…)(G, \\cdot)(G,â‹…)ï¼Œæ»¡è¶³ä»¥ä¸‹å››ä¸ªæ¡ä»¶ï¼š å°é—­æ€§ï¼šå¯¹äºä»»æ„ a,bâˆˆGa, b \\in Ga,bâˆˆGï¼Œaâ‹…bâˆˆGa \\cdot b \\in Gaâ‹…bâˆˆGã€‚ ç»“åˆå¾‹ï¼šå¯¹äºä»»æ„ a,b,câˆˆGa, b, c \\in Ga,b,câˆˆGï¼Œ(aâ‹…b)â‹…c=aâ‹…(bâ‹…c)(a \\cdot b) \\cdot c = a \\cdot (b \\cdot c)(aâ‹…b)â‹…c=aâ‹…(bâ‹…c)ã€‚ å•ä½å…ƒï¼šå­˜åœ¨ä¸€ä¸ªå…ƒç´  eâˆˆGe \\in GeâˆˆGï¼Œä½¿å¾—å¯¹äºä»»æ„ aâˆˆGa \\in GaâˆˆGï¼Œaâ‹…e=eâ‹…a=aa \\cdot e = e \\cdot a = aaâ‹…e=eâ‹…a=aã€‚ é€†å…ƒï¼šå¯¹äºä»»æ„ aâˆˆGa \\in GaâˆˆGï¼Œå­˜åœ¨ä¸€ä¸ªå…ƒç´  aâˆ’1âˆˆGa^{-1} \\in Gaâˆ’1âˆˆGï¼Œä½¿å¾— aâ‹…aâˆ’1=aâˆ’1â‹…a=ea \\cdot a^{-1} = a^{-1} \\cdot a = eaâ‹…aâˆ’1=aâˆ’1â‹…a=eã€‚ æ¢å¥è¯è¯´ï¼Œç¾¤æ˜¯ä¸€ä¸ªæ»¡è¶³å°é—­æ€§ã€ç»“åˆå¾‹ã€å•ä½å…ƒå’Œé€†å…ƒçš„ä»£æ•°ç»“æ„ã€‚ç¾¤ä¸­çš„å…ƒç´ å¯ä»¥æ˜¯ä»»ä½•ä¸œè¥¿ï¼Œä¾‹å¦‚æ•°å­—ã€çŸ©é˜µã€å‡½æ•°ç­‰ç­‰ã€‚ç¾¤çš„ä¸€ä¸ªé‡è¦æ€§è´¨æ˜¯å®ƒçš„å…ƒç´ å¯ä»¥è¿›è¡Œäº¤æ¢ï¼ˆå³æ»¡è¶³äº¤æ¢å¾‹ï¼‰æˆ–è€…ä¸å¯ä»¥è¿›è¡Œäº¤æ¢ï¼ˆå³ä¸æ»¡è¶³äº¤æ¢å¾‹ï¼‰ï¼Œåˆ†åˆ«ç§°ä¸ºäº¤æ¢ç¾¤å’Œéäº¤æ¢ç¾¤ã€‚ åŸŸæ˜¯ä¸€ä¸ªé›†åˆ FFF å’Œä¸¤ä¸ªäºŒå…ƒè¿ç®— +++ å’Œ â‹…\\cdotâ‹… çš„ç»„åˆ (F,+,â‹…)(F, +, \\cdot)(F,+,â‹…)ï¼Œæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š (F,+)(F, +)(F,+) æ˜¯ä¸€ä¸ªäº¤æ¢ç¾¤ï¼Œå…¶ä¸­ 000 æ˜¯åŠ æ³•çš„å•ä½å…ƒï¼Œå¯¹äºä»»æ„ aâˆˆFa \\in FaâˆˆFï¼Œå­˜åœ¨ä¸€ä¸ªå…ƒç´  âˆ’aâˆˆF-a \\in Fâˆ’aâˆˆFï¼Œä½¿å¾— a+(âˆ’a)=(âˆ’a)+a=0a + (-a) = (-a) + a = 0a+(âˆ’a)=(âˆ’a)+a=0ã€‚ (Fâˆ–{0},â‹…)(F \\setminus \\{0\\}, \\cdot)(Fâˆ–{0},â‹…) æ˜¯ä¸€ä¸ªäº¤æ¢ç¾¤ï¼Œå…¶ä¸­ 111 æ˜¯ä¹˜æ³•çš„å•ä½å…ƒï¼Œå¯¹äºä»»æ„ aâˆˆFâˆ–{0}a \\in F \\setminus \\{0\\}aâˆˆFâˆ–{0}ï¼Œå­˜åœ¨ä¸€ä¸ªå…ƒç´  aâˆ’1âˆˆFâˆ–{0}a^{-1} \\in F \\setminus \\{0\\}aâˆ’1âˆˆFâˆ–{0}ï¼Œä½¿å¾— aâ‹…aâˆ’1=aâˆ’1â‹…a=1a \\cdot a^{-1} = a^{-1} \\cdot a = 1aâ‹…aâˆ’1=aâˆ’1â‹…a=1ã€‚ åˆ†é…å¾‹ï¼šå¯¹äºä»»æ„ a,b,câˆˆFa, b, c \\in Fa,b,câˆˆFï¼Œaâ‹…(b+c)=aâ‹…b+aâ‹…ca \\cdot (b + c) = a \\cdot b + a \\cdot caâ‹…(b+c)=aâ‹…b+aâ‹…c å’Œ (a+b)â‹…c=aâ‹…c+bâ‹…c(a + b) \\cdot c = a \\cdot c + b \\cdot c(a+b)â‹…c=aâ‹…c+bâ‹…cã€‚ æ¢å¥è¯è¯´ï¼ŒåŸŸæ˜¯ä¸€ä¸ªæ»¡è¶³åŠ æ³•å’Œä¹˜æ³•éƒ½æ˜¯äº¤æ¢ç¾¤ï¼Œå¹¶ä¸”æ»¡è¶³åˆ†é…å¾‹çš„ä»£æ•°ç»“æ„ã€‚ ","tags":[{"name":"Article","slug":"article","used":true,"link":"https://blog.qxxiao.eu.org/tag/article/"}],"title":"å¯†ç å­¦ç®€ä»‹","feature":"","link":"https://blog.qxxiao.eu.org/post/å¯†ç å­¦ç®€ä»‹/","stats":{"text":"8 min read","time":438000,"words":1649,"minutes":8},"date":"2023-04-25 23:54:32","dateFormat":"2023-04-25","isTop":false},{"content":"Shamirâ€™s Secret Sharing æ–¹æ¡ˆæ˜¯ä¸€ç§é‡è¦çš„åŠ å¯†ç®—æ³•ï¼Œå®ƒå…è®¸ç§äººä¿¡æ¯ secret (æœºå¯†)åœ¨ä¸€ä¸ªä¸å—ä¿¡ä»»çš„ç½‘ç»œä¸­å®‰å…¨åœ°åˆ†å‘ã€‚ secret sharing åœ¨å¯†ç å­¦ä¸­ï¼Œsecret sharing æ˜¯ä¸€ç§å®‰å…¨åœ°åˆ†å‘é‡è¦ç§äººä¿¡æ¯ç‰‡æ®µç»™åˆ†å¸ƒå¼ç½‘ç»œæˆ–ç¾¤ä½“çš„æ–¹æ³•ï¼Œè¿™ä½¿å¾—æ­¤ç±»æ–¹æ¡ˆç‰¹åˆ«é€‚ç”¨äºä¿æŠ¤é«˜åº¦æ•æ„Ÿçš„ä¿¡æ¯ï¼Œå¦‚ç§æœ‰åŠ å¯†å¯†é’¥æˆ–ç”Ÿç‰©è¯†åˆ«æ•°æ®ã€‚ secret sharing é€šè¿‡å°†ç§äººä¿¡æ¯åˆ†å‰²æˆæ›´å°çš„éƒ¨åˆ† sharesï¼Œç„¶ååœ¨ç¾¤ç»„æˆ–ç½‘ç»œä¸­åˆ†å‘è¿™äº› shares æ¥å®ç°ã€‚ æ¯ä¸ªå•ç‹¬çš„ share æœ¬èº«æ˜¯æ— ç”¨çš„ï¼Œä½†æ˜¯è·å–æ‰€æœ‰çš„ shares å¯ä»¥é‡å»ºåŸå§‹çš„ secretã€‚ åœ¨å¤§å¤šæ•°æ–¹æ¡ˆä¸­ï¼Œå®æ–½äº†ä¸€ä¸ªé¢å¤–çš„åŠ å¯†å±‚ï¼Œä»¥ç¡®ä¿é¢å¤–çš„éšç§å’Œå®‰å…¨ï¼Œå…è®¸åœ¨ secret æ‰€æœ‰è€…ä¸çŸ¥é“çš„ç½‘ç»œæˆ–å›¢ä½“ä¸­åˆ†å‘ sharesã€‚ ä¾‹å¦‚ï¼Œæ¯ä¸ª share åˆ†é…è€…åªæœ‰ä¸€ä¸ªçœ‹èµ·æ¥éšæœºçš„æ•°(share)ï¼š 19_____, _5____, __3___, ___18__, ____5_,_____20 é€šè¿‡åŠ å¯†ï¼Œå½“è·å–åˆ°æ‰€æœ‰çš„ shares (ä¾‹å¦‚ä¸Šè¿°çš„æ•°å­—)ï¼Œä»ç„¶éœ€è¦è§£å¯†å¯†é’¥æ¥å¾—åˆ°åŸå§‹çš„ secret (ä¾‹å¦‚ä¸Šè¿°ä¸­è¡¨ç¤ºå…¶å¯¹åº”å­—æ¯è¡¨ä¸­é¡ºåº)ã€‚è¿™ä¸€é‡è¦æ­¥éª¤å¯ä»¥ä¿æŠ¤ç§äººä¿¡æ¯å…å—æœ‰ç»„ç»‡çš„æ”»å‡»ï¼Œå³ä½¿æ¯ä¸ª shareholder éƒ½å‹¾ç»“èµ·æ¥é‡æ–°åˆ›å»ºåŸå§‹ç§˜å¯†ï¼Œä»–ä»¬ä¹Ÿæ— æ³•äº†è§£è¯¥ç§˜å¯†çš„ä»»ä½•ä¿¡æ¯ï¼Œå› ä¸ºåŸå§‹ç§˜å¯†å·²ç»åŠ å¯†ã€‚ Shamirâ€™s Scheme é—®é¢˜ï¼šåˆ†å‘çš„ shares å¯èƒ½ä¸¢å¤±æˆ–è¢«æ³„æ¼ã€‚ shareholder å¯èƒ½ä¸åœ¨çº¿ï¼Œæˆ–è€…ä¸¢å¤±è‡ªå·±çš„ share æˆ–è€…è¢«çªƒå–ï¼›æ­¤å¤– shareholder å¯èƒ½ç§°ä¸ºæ•Œå¯¹æ–¹ã€‚å¦‚æœè¦ä½¿ç”¨æ‰€æœ‰çš„ share æ¥é‡æ„ secret å¯èƒ½ä¼šå˜å¾—ä¸å®é™…å’Œä½æ•ˆã€‚ Shamirâ€™s Secret Sharing æ˜¯ä»¥è‰²åˆ—å¯†ç å­¦å®¶ Adi Shamir 1979 å¹´é¦–æ¬¡æå‡ºçš„ç®—æ³•ã€‚å®ƒå…è®¸ä¿¡æ¯è¢«åˆ†æˆå¤šä»½ (shares)ï¼Œåªéœ€è¦ä¸€éƒ¨åˆ† shares å°±å¯ä»¥é‡å»ºåŸå§‹ secretã€‚éœ€è¦çš„æœ€å°æ•°é‡ç§°ä¸ºé˜ˆå€¼ã€‚ åŸç† SSS(Shamirâ€™s Secret Sharing) ä¾èµ–å¤šé¡¹å¼æ’å€¼ï¼Œæ„é€ ä¸€ä¸ª LLL æ¬¡å¤šé¡¹å¼å‡½æ•° f(x)f(x)f(x) å°† secret s åˆ†æˆ nnn ä¸ª shareï¼Œä½¿å¾—ï¼š f(0)=sf(0)=sf(0)=s share1=f(1),share2=f(2),â‹¯ ,sharen=f(n)\\textbf{share}_{1}= f(1),\\textbf{share}_{2}= f(2),\\cdots,\\textbf{share}_{n}= f(n)share1â€‹=f(1),share2â€‹=f(2),â‹¯,sharenâ€‹=f(n) å…¶ä¸­ï¼š ä»»ä½• â‰¤L\\le Lâ‰¤L æ•°é‡çš„ shares ç»„åˆä¸èƒ½äº†è§£åˆ° secret s ä»»ä½•ä¿¡æ¯ ä»»ä½• &gt;L&gt; L&gt;L æ•°é‡çš„ shares å¯ä»¥å¾—åˆ°å®Œæ•´çš„ secret s è§£ç  ä½¿ç”¨ Lagrange interpolationï¼Œä¾‹å¦‚ä½¿ç”¨ 3 æ¬¡å¤šé¡¹å¼ï¼Œè·å¾—äº† f(5)=3,f(7)=2,f(12)=6,f(30)=15f(5)=3,f(7)=2,f(12)=6,f(30)=15f(5)=3,f(7)=2,f(12)=6,f(30)=15 å¯ä»¥æ„é€ åŸå¤šé¡¹å¼ï¼š secret å°±æ˜¯è®¡ç®— f(0) å½“ç„¶ï¼Œæœ‰é™åŸŸä¸­ä¹Ÿæ˜¯æˆç«‹çš„ï¼Œè¡¨è¾¾å¼ä¸­çš„é™¤æ³•æ”¹ç”¨å…ƒç´ çš„é€†å…ƒè®¡ç®— éšç§ä¿æŠ¤ Shamirâ€™s Secret Sharing ä½¿äº’ä¸ç›¸è¯†çš„å¤šæ–¹æœ‰å¯èƒ½å­˜å‚¨ç§äººä¿¡æ¯ã€‚å› ä¸º Shamir æ–¹æ¡ˆåœ¨ä¿¡æ¯ç†è®ºä¸Šæ˜¯å®‰å…¨çš„ï¼Œå³ä½¿æ˜¯æ‹¥æœ‰æ— é™è®¡ç®—èƒ½åŠ›çš„æ”»å‡»è€…ï¼Œå¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„ share æ¥æ»¡è¶³é˜ˆå€¼(æœ€ä½ä»½ share)ï¼Œä¹Ÿæ— æ³•ç ´è§£è§£å¯†çš„ share æ¥è®¿é—®æ•°æ®ã€‚ è¯¥æ–¹æ¡ˆå¯ä»¥æ‰©å±•ä¸ºï¼Œå¯¹ secret çš„ share æ‰§è¡Œè®¡ç®—å¹¶ä¸”å°†ç»„åˆèµ·æ¥å¾—åˆ° secret çš„è®¡ç®—çš„ç»“æœ(åŒæ€è®¡ç®—)ï¼Œè€Œä¸éœ€è¦å°† secret å…ˆè§£å¯†å‡ºæ¥ã€‚ å½“ä¸å…¶ä»–åŠ å¯†æŠ€æœ¯ç›¸ç»“åˆæ—¶ï¼Œå¦‚å®‰å…¨å¤šæ–¹è®¡ç®—å’Œé›¶çŸ¥è¯†å¯†ç å­¦ï¼ŒSSS æä¾›äº†ä¸€ä¸ªé¢å¤–çš„å®‰å…¨å±‚ï¼Œä½¿æ•°æ®å…±äº«å’Œå­˜å‚¨å®‰å…¨ã€ç§å¯†ï¼Œå¹¶èƒ½æŠµå¾¡æ„å¤–çš„æ•°æ®ä¸¢å¤±å’Œå¤–éƒ¨æ”»å‡»ã€‚ é“¾æ¥ https://web.mit.edu/6.857/OldStuff/Fall03/ref/Shamir-HowToShareASecret.pdf Simple introduction to Shamir's Secret Sharing and Lagrange interpolation Basics of Secure Multiparty Computation Finite Fields in Cryptography | Introduction to GF ","tags":[{"name":"Paper","slug":"paper","used":true,"link":"https://blog.qxxiao.eu.org/tag/paper/"}],"title":"Shamirâ€™s Secret Sharing","feature":"","link":"https://blog.qxxiao.eu.org/post/shamirs-secret-sharing/","stats":{"text":"4 min read","time":228000,"words":957,"minutes":4},"date":"2023-04-13 15:50:21","dateFormat":"2023-04-13","isTop":false},{"content":"è¯´æ˜ ç¿»è¯‘ä½¿ç”¨ Bob ä»¥åŠ Mac è‡ªå¸¦å­—å…¸è½¯ä»¶ï¼Œä¸ºäº†é«˜æ•ˆæŸ¥è¯¢å•è¯çš„å«ä¹‰ä½¿ç”¨æ·»åŠ å¤–éƒ¨å­—å…¸ã€Šæœ—æ–‡å½“ä»£é«˜çº§è‹±è¯­è¯å…¸ã€‹æ–¹å¼ã€‚æµè§ˆå™¨å¤§æ®µæ–‡ç« ä½¿ç”¨æ²‰æµ¸å¼ç¿»è¯‘æ’ä»¶æ›´å¥½ï¼Œå…¶å®ƒæƒ…å†µç¿»è¯‘ä½¿ç”¨ Bob + DeepL æ›´å¿«ã€‚æ›´åŠ å¤æ‚çš„ç¿»è¯‘å¯ä»¥ä½¿ç”¨ MacGPT/ChatGPT ç¿»è¯‘å¹¶è§£é‡Šã€‚ å­—å…¸ä½¿ç”¨åœºæ™¯ï¼š ä¸‰æŒ‡ç‚¹å‡»æŸ¥è¯¢ï¼ˆæ¨èï¼‰ é…åˆ Alfred ï¼ˆdefine å•è¯ =&gt; tr å•è¯ï¼‰ ä½¿ç”¨èšç„¦æœç´¢å¿«é€Ÿæµè§ˆï¼Œè¾“å…¥å•æ¬¡åä½¿ç”¨ cmd+L å®šä½åˆ°å•è¯å®šä¹‰ ä½¿ç”¨ Alfred æ•ˆæœï¼ˆéœ€è¦ Enter æ‰“å¼€å­—å…¸ï¼‰ï¼š ä¸‹è½½åœ°å€ ä¸‹è½½åœ°å€ æ›´å¤šå­—å…¸ä¸‹è½½ ä¸‹è½½è§£å‹åæ‹–å…¥ ~/Library/Dictionaries/ å³å¯ï¼Œé‡å¯å­—å…¸ç¨‹åºã€‚ å…¶å®ƒ å¦‚æœå¸Œæœ›ç¦ç”¨ MacOS ä¸‹ç‰¹å®šç¨‹åºçš„æš—é»‘æ¨¡å¼ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š æŸ¥è¯¢åº”ç”¨æ†ç»‘çš„ idï¼Œå…¶ä¸­ç¨‹åºåç§°å¯ä»¥æŸ¥è¯¢ç®€ä»‹ç­‰è·å– osascript -e 'id of app &quot;&lt;App-Name&gt;&quot;' å†™å…¥å±æ€§ AquaSystemAppearanceï¼Œå…¶ä¸­ ID ä¸ºä¸Šæ¡å‘½ä»¤è¿”å›çš„ç»“æœ defaults write &lt;Bundle-Identifier&gt; NSRequiresAquaSystemAppearance -bool yes æ¢å¤ï¼Œåˆ é™¤è¯¥å±æ€§å€¼å³å¯ï¼š defaults delete &lt;Bundle-Identifier&gt; NSRequiresAquaSystemAppearance ","tags":[{"name":"Mac","slug":"mac","used":true,"link":"https://blog.qxxiao.eu.org/tag/mac/"}],"title":"Mac å­—å…¸å’Œç¿»è¯‘","feature":"https://pic.qxxiao.cn/202304051940623.png","link":"https://blog.qxxiao.eu.org/post/macå­—å…¸å’Œç¿»è¯‘/","stats":{"text":"2 min read","time":66000,"words":291,"minutes":2},"date":"2023-04-05 19:32:35","dateFormat":"2023-04-05","isTop":false},{"content":"https://go.dev/ref/mem The Go Memory Model æ•´ç†å­¦ä¹ ã€‚ Go å†…å­˜æ¨¡å‹è§„å®šäº†ï¼Œåœ¨ä¸€ä¸ª goroutine ä¸­è¯»å–ä¸€ä¸ªå˜é‡æ—¶ï¼Œå¯ä»¥ä¿è¯è§‚å¯Ÿåˆ°ä¸åŒ goroutine ä¸­å¯¹åŒä¸€å˜é‡çš„å†™å…¥æ‰€äº§ç”Ÿçš„å€¼çš„æ¡ä»¶ã€‚ æ•°æ®ç«äº‰ï¼šå¯¹ä¸€ä¸ªå†…å­˜ä½ç½®çš„å†™ä¸å¯¹åŒä¸€ä½ç½®çš„å¦ä¸€ä¸ªè¯»æˆ–å†™åŒæ—¶å‘ç”Ÿï¼Œé™¤éæ‰€æœ‰æ¶‰åŠçš„è®¿é—®éƒ½æ˜¯åŒæ­¥/åŸå­åŒ…æä¾›çš„åŸå­æ•°æ®è®¿é—®ã€‚ å†…å­˜æ¨¡å‹ å†…å­˜æ“ä½œç”±å››ä¸ªç»†èŠ‚æè¿°ï¼š å®ƒçš„ç±»å‹ï¼ŒæŒ‡ç¤ºå®ƒæ˜¯æ™®é€šæ•°æ®è¯»å–ã€æ™®é€šæ•°æ®å†™å…¥è¿˜æ˜¯åŒæ­¥æ“ä½œï¼Œä¾‹å¦‚åŸå­æ•°æ®è®¿é—®ã€äº’æ–¥æ“ä½œæˆ–é€šé“æ“ä½œã€‚ å®ƒåœ¨ç¨‹åºä¸­çš„ä½ç½®ã€‚ æ­£åœ¨è®¿é—®çš„å†…å­˜ä½ç½®æˆ–å˜é‡ã€‚ æ“ä½œè¯»å–æˆ–å†™å…¥çš„å€¼ã€‚ è¦æ±‚ 1ï¼šæ¯ä¸ª goroutine ä¸­çš„å†…å­˜æ“ä½œå¿…é¡»å¯¹åº”äºè¯¥ goroutine çš„æ­£ç¡®é¡ºåºæ‰§è¡Œï¼Œè€ƒè™‘ä»å†…å­˜ä¸­è¯»å–å’Œå†™å…¥çš„å€¼ã€‚è¯¥æ‰§è¡Œå¿…é¡»ä¸ sequenced before å…³ç³»ä¸€è‡´ï¼Œè¯¥å…³ç³»å®šä¹‰ä¸º Go è¯­è¨€è§„èŒƒå¯¹äº Go æ§åˆ¶æµæ„é€ çš„éƒ¨åˆ†é¡ºåºè¦æ±‚ä»¥åŠè¡¨è¾¾å¼çš„æ±‚å€¼é¡ºåºã€‚ ã€Go ç¨‹åºæ‰§è¡Œè¢«å»ºæ¨¡ä¸ºä¸€ç»„ goroutine æ‰§è¡Œï¼Œä»¥åŠä¸€ä¸ªæ˜ å°„ Wï¼ŒæŒ‡å®šæ¯ä¸ªç±»ä¼¼è¯»å–çš„æ“ä½œä»å“ªä¸ªç±»ä¼¼å†™å…¥çš„æ“ä½œä¸­è¯»å–ã€‚ã€‘ è¦æ±‚ 2ï¼šå¯¹äºç»™å®šçš„ç¨‹åºæ‰§è¡Œï¼Œå½“é™åˆ¶ä¸ºåŒæ­¥æ“ä½œæ—¶ï¼Œæ˜ å°„ W å¿…é¡»å¯ä»¥é€šè¿‡ä¸€äº›éšå«çš„åŒæ­¥æ“ä½œçš„æ€»åºæ¥è§£é‡Šï¼Œè¯¥æ€»åºä¸è¿™äº›æ“ä½œè¯»å–å’Œå†™å…¥çš„å€¼ä»¥åŠé¡ºåºä¸€è‡´ã€‚ synchronized before å…³ç³»æ˜¯ä» W æ´¾ç”Ÿçš„åŒæ­¥å†…å­˜æ“ä½œçš„ååºå…³ç³»ã€‚å¦‚æœåŒæ­¥è¯»å–ç±»å†…å­˜æ“ä½œ r è§‚å¯Ÿåˆ°åŒæ­¥å†™å…¥ç±»å†…å­˜æ“ä½œ wï¼ˆå³ï¼Œå¦‚æœ W(r) = wï¼‰ï¼Œåˆ™ w åœ¨ r ä¹‹å‰åŒæ­¥ã€‚ happens before å…³ç³»è¢«å®šä¹‰ä¸º sequenced before å…³ç³»å’Œ synchronized before çš„å¹¶é›†çš„ä¼ é€’é—­åŒ…ã€‚ è¦æ±‚ 3ï¼šå¯¹äºå†…å­˜ä½ç½® x ä¸Šçš„æ™®é€šï¼ˆéåŒæ­¥ï¼‰æ•°æ®è¯»å– rï¼ŒW(r) å¿…é¡»æ˜¯å¯¹ r å¯è§çš„å†™å…¥ wï¼Œå…¶ä¸­â€œå¯è§â€æ„å‘³ç€ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶éƒ½æˆç«‹ï¼š w åœ¨ r ä¹‹å‰å‘ç”Ÿã€‚ w ä¸åœ¨ä»»ä½•å…¶ä»–å†™å…¥ w'ï¼ˆåˆ° xï¼‰ä¹‹å‰å‘ç”Ÿï¼Œè€Œè¿™äº›å†™å…¥ w' åœ¨ r ä¹‹å‰å‘ç”Ÿã€‚ ã€ç®€å•æ¥è¯´ï¼Œå¯¹äºä¸€ä¸ªå†…å­˜ä½ç½® xï¼Œå¦‚æœä¸€ä¸ªæ™®é€šæ•°æ®è¯»å– r è¯»å–äº†è¯¥ä½ç½®çš„å€¼ï¼Œé‚£ä¹ˆå®ƒå¿…é¡»è¯»å–åˆ°æœ€è¿‘çš„å†™å…¥ w çš„å€¼ï¼Œè¯¥å†™å…¥ w æ»¡è¶³ w åœ¨ r ä¹‹å‰å‘ç”Ÿï¼Œå¹¶ä¸”æ²¡æœ‰å…¶ä»–å†™å…¥ w' åœ¨ w å’Œ r ä¹‹é—´å‘ç”Ÿã€‚è¿™ä¸ªè¦æ±‚ç¡®ä¿äº†å†…å­˜è¯»å–æ“ä½œè¯»å–åˆ°çš„æ˜¯æœ€è¿‘çš„å†™å…¥æ“ä½œçš„å€¼ï¼Œè€Œä¸æ˜¯è¿‡æ—¶çš„å€¼ã€‚ã€‘ å¯¹å«æ•°æ®ç«äº‰çš„é™åˆ¶ ä»»ä½•å®ç°éƒ½å¯ä»¥åœ¨æ£€æµ‹åˆ°æ•°æ®ç«äº‰æ—¶æŠ¥å‘Šè¯¥ç«äº‰å¹¶åœæ­¢ç¨‹åºçš„æ‰§è¡Œã€‚ä½¿ç”¨ ThreadSanitizerï¼ˆé€šè¿‡ go build -race è®¿é—®ï¼‰çš„å®ç°æ­£æ˜¯è¿™æ ·åšçš„ã€‚ åŒæ­¥ åˆå§‹åŒ– ç¨‹åºçš„åˆå§‹åŒ–æ˜¯åœ¨ä¸€ä¸ªå•ç‹¬çš„ goroutine ä¸­è¿è¡Œï¼› å¦‚æœ p åŒ…å¯¼å…¥ q åŒ…ï¼Œé‚£ä¹ˆ q åŒ…çš„ initå‡½æ•° æ˜¯ happen before p åŒ…ä»»ä½•å‡½æ•°ï¼› æ‰€æœ‰çš„ init å‡½æ•° çš„å®Œæˆæ˜¯ synchronized before ä¸»åŒ…ä¸­çš„ main.main å‡½æ•°æ‰§è¡Œã€‚ ã€Go ç¨‹åºä¸­ï¼Œç¨‹åºçš„åˆå§‹åŒ–è¿‡ç¨‹æ˜¯ç”±ä¸€ä¸ªå•ç‹¬çš„ goroutine è´Ÿè´£ï¼Œè¯¥ goroutine ä¼šæŒ‰ç…§åŒ…çš„å¯¼å…¥é¡ºåºä¾æ¬¡æ‰§è¡Œæ¯ä¸ªåŒ…çš„ init å‡½æ•°ï¼Œç›´åˆ°æ‰€æœ‰åŒ…çš„ init å‡½æ•°éƒ½è¢«æ‰§è¡Œå®Œæ¯•åŒ…æ‹¬ä¸»åŒ…çš„ init å‡½æ•°ã€‚æœ€åå¯åŠ¨æ–°çš„ä¸» goroutine è¿è¡Œ main å‡½æ•°ã€‚ã€‘ Goroutine åˆ›å»º åˆ›å»ºæ–° goroutine çš„ go è¯­å¥ synchronized before è¿™ä¸ª goroutine çš„æ‰§è¡Œå¼€å§‹ã€‚ Goroutine é”€æ¯ ä¸èƒ½ä¿è¯ goroutine çš„é€€å‡º synchronized before äºç¨‹åºä¸­çš„ä»»æ„äº‹ä»¶ã€‚ Channel é€šä¿¡ é€šé“é€šä¿¡æ˜¯ goroutine ä¹‹é—´åŒæ­¥çš„ä¸»è¦æ–¹æ³•ã€‚ä¸€ä¸ªç‰¹å®šé€šé“ä¸Šçš„æ¯ä¸€ä¸ªå‘é€éƒ½ä¸è¯¥é€šé“çš„ç›¸åº”æ¥æ”¶ç›¸åŒ¹é…ï¼Œé€šå¸¸æ˜¯åœ¨ä¸€ä¸ªä¸åŒçš„ goroutine ä¸­ã€‚ ä¸€ä¸ª channel çš„ä¸€æ¬¡ send æ˜¯ synchronized before äºè¯¥ channel ä¸Šå…¶å¯¹åº” receive çš„å®Œæˆã€‚ var c = make(chan int, 10) var a string func f() { a = &quot;hello, world&quot; c &lt;- 0 // close(c) } func main() { go f() &lt;-c print(a) } ä¾‹å­ä¿è¯ä¼šæ‰“å° &quot;hello world&quot;ã€‚å¯¹ a çš„å†™æ˜¯ sequence before äº c çš„å‘é€ï¼Œc çš„å‘é€æ˜¯ synchronize before äºå¯¹åº”(int) c çš„æ¥æ”¶ï¼Œè€Œ c çš„æ¥æ”¶ sequence before äºæ‰“å°ã€‚ channel çš„å…³é—­æ˜¯ synchronized before å…¶å¯¹åº”çš„ receiveï¼Œå¹¶ä¸”ç”±äºé€šé“å…³é—­ï¼Œæ¥æ”¶è¿”å›çš„æ˜¯é€šé“å…ƒç´ ç±»å‹çš„é›¶å€¼ã€‚ æ— ç¼“å†² channel çš„ receive æ˜¯ synchronized before äºè¯¥é€šé“å…¶å¯¹åº” send çš„å®Œæˆã€‚ ä½¿ç”¨æ— ç¼“å†² channel æ”¹å†™ï¼š var c = make(chan int) var a string func f() { a = &quot;hello, world&quot; &lt;-c } func main() { go f() c &lt;- 0 print(a) } å®¹é‡ä¸º C çš„ channel çš„ç¬¬ k æ¬¡ receive æ˜¯ synchronized before äºè¯¥é€šé“çš„ç¬¬ k+C æ¬¡ send çš„å®Œæˆã€‚ ã€å®¹é‡ä¸º C çš„ channel ä½¿ç”¨ä¿¡å·é‡æ¥å®ç°ã€‘ ä½¿ç”¨ç¼“å†²çš„ channel æ¥é™åˆ¶å¹¶å‘æ‰§è¡Œä»»åŠ¡çš„æ•°é‡ï¼š var limit = make(chan int, 3) func main() { for _, w := range work { go func(w func()) { limit &lt;- 1 w() &lt;-limit }(w) } select{} // ä¸€ç›´é˜»å¡ } Locks sync package å®ç°äº†ä¸¤ç§é” lock æ•°æ®ç±»å‹ï¼šsync.Mutex ä»¥åŠ sync.RWMutexã€‚ å¯¹äºä»»ä½• sync.Mutex æˆ– sync.RWMutex å˜é‡ lï¼Œå¹¶ä¸” n&lt;mn&lt;mn&lt;m ï¼Œå‰ n æ¬¡è°ƒç”¨ l.Unlock() å®Œæˆæ˜¯ synchronized before äºç¬¬ m æ¬¡ l.Lock() è¿”å›ã€‚ å¯¹äºä»»ä½•å¯¹ sync.RWMutex å˜é‡ l çš„ l.RLock() è°ƒç”¨ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ª nï¼Œä½¿å¾—ç¬¬ n æ¬¡è°ƒç”¨ l.Unlock() æ˜¯ synchronized before äº l.RLock() è¿”å›ï¼Œå¹¶ä¸”å¯¹åº”çš„ l.RUnlock() è°ƒç”¨å®Œæˆ synchronized before äºç¬¬ n+1 æ¬¡å¯¹ l.Lock() çš„è°ƒç”¨è¿”å›ã€‚ ã€å°±å†…å­˜æ¨¡å‹è€Œè¨€ï¼Œl.TryLockï¼ˆæˆ– l.TryRLockï¼‰å¯ä»¥è¢«è®¤ä¸ºæ˜¯èƒ½å¤Ÿè¿”å› false çš„ï¼Œå³ä½¿æ˜¯åœ¨ mutex l æ˜¯è§£é”çŠ¶æ€ã€‚ã€‘ Once sync package é€šè¿‡ Once ç±»å‹ä¸ºå­˜åœ¨å¤š goroutine æƒ…å†µä¸‹çš„åˆå§‹åŒ–æä¾›äº†ä¸€ç§å®‰å…¨æœºåˆ¶ã€‚ å¤šä¸ªçº¿ç¨‹ä¸ºå‡½æ•° f å¯æ‰§è¡Œ once.Do(f)ï¼Œåªæœ‰ä¸€ä¸ª goroutine æ‰§è¡Œ f å‡½æ•°ï¼Œå…¶å®ƒ goroutine ä¼šé˜»å¡ç›´åˆ°è¯¥ f å‡½æ•°è¿”å›ã€‚ ã€ä½¿ç”¨ done æ ‡å¿—å’Œäº’æ–¥é”å®ç° ã€‘ once.Do(f) ä¸­è¯¥å•æ¬¡ f è°ƒç”¨å®Œæˆæ˜¯ synchronized before äºä»»ä½• once.Do(f) è°ƒç”¨çš„è¿”å›ã€‚ ä¾‹å¦‚ï¼š var a string var once sync.Once func setup() { a = &quot;hello, world&quot; } func doprint() { once.Do(setup) print(a) } func twoprint() { go doprint() go doprint() } // &quot;hello, world&quot; will be printed twice. Atomic Values sync/atomic åŒ…ä¸­çš„ API æ˜¯â€œåŸå­æ“ä½œâ€ï¼Œå¯ç”¨äºåŒæ­¥ä¸åŒ goroutine çš„æ‰§è¡Œã€‚å¦‚æœåŸå­æ“ä½œ A çš„æ•ˆæœè¢«åŸå­æ“ä½œ B è§‚å¯Ÿåˆ°ï¼Œåˆ™ A åœ¨ B ä¹‹å‰åŒæ­¥ã€‚ç¨‹åºä¸­æ‰§è¡Œçš„æ‰€æœ‰åŸå­æ“ä½œéƒ½è¡¨ç°ä¸ºæŒ‰æŸç§é¡ºåºè¿ç»­æ‰§è¡Œçš„é¡ºåºä¸€è‡´ã€‚è¿™ä¸ªå®šä¹‰ä¸ C++çš„é¡ºåºä¸€è‡´åŸå­(å˜é‡)å’Œ Java çš„ volatile å˜é‡å…·æœ‰ç›¸åŒçš„è¯­ä¹‰ã€‚ Finalizers åœ¨ Go è¯­è¨€ä¸­ï¼ŒFinalizer æ˜¯ä¸€ç§æœºåˆ¶ï¼Œç”¨äºåœ¨å¯¹è±¡è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ä¹‹å‰æ‰§è¡Œä¸€äº›æ¸…ç†æ“ä½œã€‚Finalizer æ˜¯é€šè¿‡ runtime.SetFinalizer å‡½æ•°è®¾ç½®çš„ï¼Œè¯¥å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šè¦è®¾ç½® Finalizer çš„å¯¹è±¡å’Œä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†åœ¨å¯¹è±¡è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ä¹‹å‰æ‰§è¡Œã€‚ å½“ä¸€ä¸ªå¯¹è±¡è¢«åˆ›å»ºæ—¶ï¼ŒGo è¯­è¨€çš„åƒåœ¾å›æ”¶å™¨ä¼šä¸ºå…¶åˆ†é…å†…å­˜ï¼Œå¹¶å°†å…¶æ ‡è®°ä¸ºâ€œå¯è¾¾â€ã€‚å¦‚æœè¯¥å¯¹è±¡ä¸å†è¢«å¼•ç”¨ï¼Œåƒåœ¾å›æ”¶å™¨ä¼šå°†å…¶æ ‡è®°ä¸ºâ€œä¸å¯è¾¾â€ï¼Œå¹¶åœ¨æŸä¸ªæ—¶é—´ç‚¹å›æ”¶è¯¥å¯¹è±¡çš„å†…å­˜ã€‚åœ¨å›æ”¶å¯¹è±¡ä¹‹å‰ï¼Œåƒåœ¾å›æ”¶å™¨ä¼šæ£€æŸ¥è¯¥å¯¹è±¡æ˜¯å¦æœ‰ Finalizerã€‚å¦‚æœæœ‰ï¼Œåƒåœ¾å›æ”¶å™¨ä¼šå°†è¯¥å¯¹è±¡æ·»åŠ åˆ°ä¸€ä¸ª Finalizer é˜Ÿåˆ—ä¸­ï¼Œå¹¶åœ¨ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶æ—¶æ‰§è¡Œ Finalizer å‡½æ•°ã€‚ å¦å¤–ï¼Œç”±äº Finalizer å‡½æ•°çš„æ‰§è¡Œæ˜¯ä¸ç¡®å®šçš„(ç”šè‡³å¯èƒ½ä¸æ‰§è¡Œ)ï¼Œå› æ­¤ä¸å»ºè®®åœ¨ç¨‹åºä¸­è¿‡å¤šåœ°ä½¿ç”¨ Finalizerã€‚å¦‚æœéœ€è¦é‡Šæ”¾èµ„æºæˆ–æ‰§è¡Œå¿…é¡»çš„æ¸…ç†æ“ä½œï¼Œåº”è¯¥ä½¿ç”¨ defer è¯­å¥æˆ–æ˜¾å¼åœ°è°ƒç”¨æ¸…ç†å‡½æ•°æ¥å®ç°ã€‚ è°ƒç”¨ SetFinalizer(x, f) æ˜¯ synchronized before å‡½æ•° f(x) çš„è°ƒç”¨ã€‚ å…¶å®ƒ condition variables, lock-free maps, allocation pools, and wait groups. é”™è¯¯åŒæ­¥ ç¨‹åºä¸­å­˜åœ¨ç«äº‰æ¡ä»¶æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°éé¡ºåºä¸€è‡´çš„æ‰§è¡Œç»“æœã€‚ç‰¹åˆ«åœ°ï¼Œä¸€ä¸ªè¯»æ“ä½œ r å¯èƒ½ä¼šè§‚å¯Ÿåˆ°ä¸ r å¹¶å‘æ‰§è¡Œçš„ä»»ä½•å†™æ“ä½œ w æ‰€å†™å…¥çš„å€¼ã€‚å³ä½¿è¿™ç§æƒ…å†µå‘ç”Ÿäº†ï¼Œä¹Ÿä¸èƒ½ä¿è¯åœ¨ w ä¹‹å‰å‘ç”Ÿçš„å†™æ“ä½œä¼šè¢«åœ¨ r ä¹‹åçš„è¯»æ“ä½œæ‰€è§‚å¯Ÿåˆ°ã€‚ var a, b int func f() { a = 1 b = 2 } func g() { print(b) print(a) } func main() { go f() g() } g() å¯èƒ½æ‰“å° 2 å’Œ 0 ï¼ˆf å‡½æ•°ä¸¤ä¸ªå†™è¯­å¥ä¸æ»¡è¶³ sequenced before å…³ç³» å¦ä¸€ä¸ªä¾‹å­ï¼Œä¸æ­£ç¡®çš„å¿™ç­‰å¾…: var a string var done bool func setup() { a = &quot;hello, world&quot; done = true } func main() { go setup() for !done { } print(a) } å¯èƒ½æ‰“å°ç©ºå­—ç¬¦ä¸²ï¼Œmain ä¸­è§‚å¯Ÿåˆ°å†™å…¥ doneï¼Œå¹¶ä¸ä¿è¯å·²ç»è§‚å¯Ÿåˆ°å†™å…¥ aã€‚ æ›´ç³Ÿç³•çš„æ˜¯ï¼šç”±äºä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´æ²¡æœ‰åŒæ­¥äº‹ä»¶ï¼Œæ‰€ä»¥ä¹Ÿæ— æ³•ä¿è¯å†™å…¥ done çš„å†…å®¹ä¼šè¢« main è§‚å¯Ÿåˆ°ï¼Œä¸èƒ½ä¿è¯ main ä¸­çš„å¾ªç¯èƒ½å¤Ÿç»“æŸã€‚ éœ€è¦æ³¨æ„ä¸Šè¿°é—®é¢˜çš„è§£å†³æ–¹æ³•ï¼šä½¿ç”¨æ˜¾ç¤ºçš„åŒæ­¥è¯­å¥ã€‚ ç¼–è¯‘ä¼˜åŒ–é™åˆ¶ Go è¯­è¨€å†…å­˜æ¨¡å‹å¯¹ç¼–è¯‘å™¨ä¼˜åŒ–çš„é™åˆ¶ï¼Œä¸€äº›ç¼–è¯‘å™¨ä¼˜åŒ–åœ¨å•çº¿ç¨‹ç¨‹åºä¸­æ˜¯æœ‰æ•ˆçš„ï¼Œä½†ä¸æ˜¯å¯¹äºæ‰€æœ‰ Go ç¨‹åºéƒ½æ˜¯æœ‰æ•ˆçš„ã€‚ç‰¹åˆ«æ˜¯ï¼Œç¼–è¯‘å™¨ä¸èƒ½å¼•å…¥æºç¨‹åºä¸­ä¸å­˜åœ¨çš„å†™å…¥æ“ä½œï¼Œä¸å…è®¸ä½¿å¾—å•ä¸ªè¯»å–æ“ä½œè§‚å¯Ÿåˆ°å¤šä¸ªä¸åŒçš„å€¼ï¼Œä¸å…è®¸ä½¿å¾—å•ä¸ªå†™æ“ä½œå†™å…¥å¤šä¸ªå€¼ã€‚ã€ä¸»è¦ç›®çš„ï¼Œé¿å…ç¼–è¯‘å™¨åœ¨ä¼˜åŒ–ç¨‹åºæ—¶å¼•å…¥æ•°æ®ç«äº‰ä»¥åŠä¸ç¡®å®šçš„è¡Œä¸ºã€‚ã€‘ åœ¨æ²¡æœ‰ç«äº‰æ¡ä»¶çš„ç¨‹åºä¸­ï¼Œä¸åº”è¯¥å°†å†™æ“ä½œä»å®ƒä»¬æ‰€åœ¨çš„æ¡ä»¶è¯­å¥ä¸­ç§»å‡ºã€‚(é¿å…å…¶å®ƒ goroutine è§‚å¯Ÿå¯èƒ½è§‚å¯Ÿåˆ°åŸæ¥ä¸å¯èƒ½å‡ºç°çš„å€¼) åœ¨æ²¡æœ‰ç«äº‰æ¡ä»¶çš„ç¨‹åºä¸­ï¼Œç¼–è¯‘å™¨ä¸åº”è¯¥å‡è®¾å¾ªç¯ä¸€å®šä¼šç»ˆæ­¢ã€‚ åœ¨æ²¡æœ‰ç«äº‰æ¡ä»¶çš„ç¨‹åºä¸­ï¼Œç¼–è¯‘å™¨ä¸åº”è¯¥å‡è®¾è¢«è°ƒç”¨çš„å‡½æ•°æ€»æ˜¯ä¼šè¿”å›æˆ–ä¸åŒ…å«åŒæ­¥æ“ä½œã€‚ ç¼–è¯‘å™¨ä¸å…è®¸å•ä¸ªè¯»æ“ä½œè§‚å¯Ÿåˆ°å¤šä¸ªå€¼ï¼Œè¿™æ„å‘³ç€ç¼–è¯‘å™¨ä¸åº”è¯¥ä»å…±äº«å†…å­˜ä¸­é‡æ–°åŠ è½½æœ¬åœ°å˜é‡ã€‚ i := *p if i&lt;0 || i&gt;=len(funcs){...} funcs[i]() // ç¦æ­¢é‡æ–°åŠ è½½ *p funcs[*p]() ç¼–è¯‘å™¨ä¸å…è®¸å•ä¸ªå†™æ“ä½œå†™å…¥å¤šä¸ªå€¼(ç¦æ­¢åœ¨å†™å…¥ä¹‹å‰æŠŠå°†è¦å†™å…¥çš„å±€éƒ¨å˜é‡ä½œä¸ºä¸´æ—¶å­˜å‚¨) *p = i + *p/2 // if i=2,*p=2, åªèƒ½è§‚å¯Ÿåˆ° *p ä¸º 2/3 // ä¸èƒ½æ”¹å†™ä¸º 2/1/3 *p /=2 *p += i è¯´æ˜ï¼šæ‰€æœ‰è¿™äº›ä¼˜åŒ–åœ¨ C/C++ç¼–è¯‘å™¨ä¸­éƒ½æ˜¯å…è®¸çš„ï¼Œä½†æ˜¯ä¸ C/C++ç¼–è¯‘å™¨å…±äº«åç«¯çš„ Go ç¼–è¯‘å™¨å¿…é¡»æ³¨æ„ç¦ç”¨é‚£äº›å¯¹ Go æ— æ•ˆçš„ä¼˜åŒ–ã€‚ è¯·æ³¨æ„ï¼Œç¦æ­¢å¼•å…¥æ•°æ®ç«äº‰çš„è§„åˆ™ä¸é€‚ç”¨äºç¼–è¯‘å™¨å¯ä»¥è¯æ˜è¿™äº›ç«äº‰ä¸ä¼šå½±å“ç›®æ ‡å¹³å°ä¸Šçš„æ­£ç¡®æ‰§è¡Œçš„æƒ…å†µã€‚ æ€»ç»“ å¯¹äºæ²¡æœ‰æ•°æ®ç«äº‰çš„ç¨‹åºï¼Œå¯ä»¥æ”¾å¿ƒåœ°ä¾èµ–äºé¡ºåºä¸€è‡´çš„æ‰§è¡Œï¼› è€Œå¯¹äºå­˜åœ¨æ•°æ®ç«äº‰çš„ç¨‹åºï¼Œåº”è¯¥é¿å…è¿‡äºèªæ˜çš„ä¼˜åŒ–ï¼Œç¼–å†™æ˜“äºç†è§£å’Œæ¨ç†çš„ä»£ç ï¼Œå¹¶ä½¿ç”¨åŒæ­¥åŸè¯­æ¥ç¡®ä¿ç¨‹åºçš„æ­£ç¡®æ€§ã€‚ ","tags":[{"name":"Go","slug":"go","used":true,"link":"https://blog.qxxiao.eu.org/tag/go/"}],"title":"Go å†…å­˜æ¨¡å‹","feature":"https://pic.qxxiao.cn/golang.png","link":"https://blog.qxxiao.eu.org/post/goå†…å­˜æ¨¡å‹/","stats":{"text":"11 min read","time":652000,"words":2834,"minutes":11},"date":"2023-04-04 09:50:43","dateFormat":"2023-04-04","isTop":false},{"content":"ç®€å•æ­å»ºçš„ https://github.com/binary-husky/chatgpt_academic åœ¨çº¿ç‰ˆæœ¬ã€‚ è¯´æ˜ï¼š ä¸èƒ½ä¿è¯é•¿æœŸå¯ç”¨ ç•Œé¢ åœ°å€ ChatGPT å­¦æœ¯ä¼˜åŒ– (ChatGPT å­¦æœ¯ä¼˜åŒ–å¤‡ç”¨) å…¶å®ƒé¡¹ç›® ChatPaper æ€»ç»“è®ºæ–‡ MacGPT (æ¨è) ChatFred(ä¸å¤ªå¥½ç”¨) Warp ç»ˆç«¯å†…ç½®äº†WarpAI ä¹Ÿå¯ä»¥è¾…åŠ©è§£å†³å¾ˆå¤šé—®é¢˜ï¼ŒChatFred æ˜¯é›†æˆåœ¨ Alfred æ’ä»¶ã€‚ ","tags":[{"name":"AI","slug":"ai","used":true,"link":"https://blog.qxxiao.eu.org/tag/ai/"},{"name":"ChatGPT","slug":"chatgpt","used":true,"link":"https://blog.qxxiao.eu.org/tag/chatgpt/"}],"title":"ChatGPT å­¦æœ¯ä¼˜åŒ–","feature":"https://pic.qxxiao.cn/202303310235577.png","link":"https://blog.qxxiao.eu.org/post/chatgptå­¦æœ¯ä¼˜åŒ–/","stats":{"text":"1 min read","time":19000,"words":84,"minutes":1},"date":"2023-03-31 02:27:33","dateFormat":"2023-03-31","isTop":false},{"content":"å‚è€ƒèµ„æ–™ï¼š https://artofproblemsolving.com/wiki/index.php/LaTeX:Symbols https://mathvault.ca/wp-content/uploads/Comprehensive-List-of-Mathematical-Symbols.pdf https://www.latexlive.com/ è¯´æ˜ æ¢è¡Œ \\\\ æˆ–è€… \\newline æ¢æ®µè½ \\par æˆ–è€…ä½¿ç”¨ç©ºè¡Œ latex æºæ–‡ä»¶è¿ç»­ç©ºæ ¼ç­‰æ•ˆäºä¸€ä¸ªï¼Œå¤šä¸ªç©ºè¡Œç­‰æ•ˆä¸€ä¸ªç©ºè¡Œ ä½¿ç”¨å‘½ä»¤çš„å½¢å¼ï¼š\\command[optioné€‰é¡¹å‚æ•°]{argumentå‚æ•°} latex è¿›å…¥æ•°å­¦æ¨¡å¼ å…¶ä¸­ \\[...\\] ä¸ $$...$$ ç­‰æ•ˆ equation ç¯å¢ƒä¸èƒ½æ¢è¡Œï¼Œalign ç¯å¢ƒç”¨äºå¤šä¸ªæ–¹ç¨‹å¯¹é½ï¼Œgather ç¯å¢ƒå±…ä¸­å¯¹é½ï¼› \\displaystyle å‘½ä»¤ç”¨è¯­æ˜¾ç¤ºå…¬å¼å®Œæ•´çš„è¡Œé«˜ è¿ç®—ç¬¦ ç¬¦å· LaTex ç¬¦å· LaTex ç¬¦å· LaTex ç¬¦å· LaTex Â±\\pmÂ± \\pm âˆ“\\mpâˆ“ \\mp Ã—\\timesÃ— \\times Ã·\\divÃ· \\div â‹…\\cdotâ‹… \\cdot âˆ—\\astâˆ— \\ast â‹†\\starâ‹† \\star âˆ™\\bulletâˆ™ \\bullet âˆª\\cupâˆª \\cup âˆ©\\capâˆ© \\cap âŠ”\\sqcupâŠ” \\sqcup âŠ“\\sqcapâŠ“ \\sqcap âˆ¨\\veeâˆ¨ \\vee âˆ§\\wedgeâˆ§ \\wedge âŠ•\\oplusâŠ• \\oplus âŠ—\\otimesâŠ— \\otimes âŠ–\\ominusâŠ– \\ominus âŠ˜\\oslashâŠ˜ \\oslash âŠ™\\odotâŠ™ \\odot âŠ\\uplusâŠ \\uplus âˆ˜\\circâˆ˜ \\circ â—¯\\bigcircâ—¯ \\bigcirc â‹„\\diamondâ‹„ \\diamond â—Š\\Diamondâ—Š \\Diamond âŠ²\\lhdâŠ² \\lhd âŠ³\\rhdâŠ³ \\rhd âŠ´\\unlhdâŠ´ \\unlhd âŠµ\\unrhdâŠµ \\unrhd â—ƒ\\triangleleftâ—ƒ \\triangleleft â–¹\\trianglerightâ–¹ \\triangleright â–³\\bigtriangleupâ–³ \\bigtriangleup â–½\\bigtriangledownâ–½ \\bigtriangledown â–½\\triangledownâ–½ \\triangledown â–¡\\Boxâ–¡ \\Box âˆ–\\setminusâˆ– \\setminus â‰€\\wrâ‰€ \\wr â¨¿\\amalgâ¨¿ \\amalg â€ \\daggerâ€  \\dagger â€¡\\ddaggerâ€¡ \\ddagger xâˆ˜x^{\\circ}xâˆ˜ x^{circ} xn\\sqrt[n]{x}nxâ€‹ \\sqrt[n]{x} axyza^{xyz}axyz a^{xyz} axa_xaxâ€‹ a_x âˆ\\inftyâˆ \\infty âˆ‚\\partialâˆ‚ \\partial âˆ‡\\nablaâˆ‡ \\nabla å…³ç³»ç¬¦å· â‰¡\\equivâ‰¡ \\equiv &lt;\\lt&lt; \\lt &gt;\\gt&gt; \\gt âˆ€\\forallâˆ€ \\forall âˆƒ\\existsâˆƒ \\exists {1,2,â‹¯ ,n}\\lbrace1,2,\\cdots,n\\rbrace{1,2,â‹¯,n} \\lbrace1,2,\\cdots,n\\rbraceï¼Œ \\{1,2,\\cdots,n\\} å¸Œè…Šå­—æ¯ ç®­å¤´ ç‚¹ ç¬¦å· LaTex ç¬¦å· LaTex â‹…\\cdotâ‹… \\cdot â‹®\\vdotsâ‹® \\vdots â€¦\\dotsâ€¦ \\dots â‹±\\ddotsâ‹± \\ddots â‹¯\\cdotsâ‹¯ \\cdots \\iddots \\iddots å£°è°ƒ æ‹¬å·å’Œè¾¹ç•Œ ä½¿ç”¨ \\leftï¼Œ\\right æ¥æ ‡å®šå·¦å³æ‹¬å·è¿›è¡Œé€‚å½“çš„æ”¾å¤§ï¼Œå¯¹ä¸€äº›ç®­å¤´ç¬¦å·ä¹Ÿé€‚ç”¨ï¼›(ax)2\\left(\\frac{a}{x} \\right)^2(xaâ€‹)2 \\left(\\frac{a}{x} \\right)^2 åˆ†æ®µå‡½æ•°ï¼Œä½¿ç”¨ cases ç¯å¢ƒï¼›f(x)={x2xâ‰¥0xx&lt;0f(x) = \\begin{cases} x^2 &amp; x \\ge 0 \\\\ x &amp; x &lt; 0 \\end{cases}f(x)={x2xâ€‹xâ‰¥0x&lt;0â€‹ f(x) = \\begin{cases} x^2 &amp; x \\ge 0 \\\\ x &amp; x &lt; 0 \\end{cases} a0+a1+a2+â‹¯+anâµx\\underbrace{a_0+a_1+a_2+\\cdots+a_n}_{x}xa0â€‹+a1â€‹+a2â€‹+â‹¯+anâ€‹â€‹â€‹ \\underbrace{a_0+a_1+a_2+\\cdots+a_n}_{x} a0+a1+a2+â‹¯+anâx\\overbrace{a_0+a_1+a_2+\\cdots+a_n}^{x}a0â€‹+a1â€‹+a2â€‹+â‹¯+anâ€‹â€‹xâ€‹ \\overbrace{a_0+a_1+a_2+\\cdots+a_n}^{x} å…¶å®ƒå¸¸è§ç¬¦å· æ•°å­¦å¸¸ç”¨å‘½ä»¤ a3i+1a^{i+1}_3a3i+1â€‹ 1+1x3x+2\\frac{1+\\frac{1}{x}}{3x + 2}3x+21+x1â€‹â€‹ 1+1x3x+2\\dfrac{1+\\dfrac{1}{x}}{3x + 2}3x+21+x1â€‹â€‹ 21+21+21+21\\cfrac{2}{1+\\cfrac{2}{1+\\cfrac{2}{1+\\cfrac{2}{1}}}}1+1+1+12â€‹2â€‹2â€‹2â€‹ xn\\sqrt[n]{x}nxâ€‹ âˆ‘i=1âˆ1i\\sum_{i=1}^{\\infty}\\frac{1}{i}âˆ‘i=1âˆâ€‹i1â€‹ âˆ‘i=1âˆ1i\\sum\\limits_{i=1}^{\\infty}\\frac{1}{i}i=1âˆ‘âˆâ€‹i1â€‹ âˆn=15nnâˆ’1\\prod_{n=1}^5\\frac{n}{n-1}âˆn=15â€‹nâˆ’1nâ€‹ limâ¡xâ†’âˆ1x\\lim_{x\\to\\infty}\\frac{1}{x}limxâ†’âˆâ€‹x1â€‹ limâ¡xâ†’âˆ1x\\lim\\limits_{x\\to\\infty}\\frac{1}{x}xâ†’âˆlimâ€‹x1â€‹ logâ¡nn2\\log_n n^2lognâ€‹n2 lnâ¡e\\ln elne 9â‰¡3 mod 69\\equiv 3 \\bmod{6}9â‰¡3mod6 9â‰¡3(mod6)9\\equiv 3 \\pmod{6}9â‰¡3(mod6) 9â‰¡3mod 69\\equiv 3 \\mod{6}9â‰¡3mod6 9â‰¡3(6)9\\equiv 3 \\pod{6}9â‰¡3(6) (nâˆ’1râˆ’1)\\binom{n-1}{r-1}(râˆ’1nâˆ’1â€‹) (nâˆ’1râˆ’1)\\dbinom{n-1}{r-1}(râˆ’1nâˆ’1â€‹) Cnâˆ’1râˆ’1C_{n-1}^{r-1}Cnâˆ’1râˆ’1â€‹ cosâ¡2x+sinâ¡2x=1\\cos^2 x +\\sin^2 x = 1cos2x+sin2x=1 cosâ¡90âˆ˜=0\\cos 90^\\circ = 0cos90âˆ˜=0 a+biâ€¾\\overline{a+bi}a+biâ€‹ 747â€¾\\underline{747}747â€‹ ddx(x2)=2x\\frac{d}{dx}\\left(x^2\\right) = 2xdxdâ€‹(x2)=2x âˆ«2x dx=x2+C\\int 2x\\,dx = x^2+Câˆ«2xdx=x2+C âˆ«152x dx=24\\int^5_1 2x\\,dx = 24âˆ«15â€‹2xdx=24 âˆ‚2Uâˆ‚x2+âˆ‚2Uâˆ‚y2\\frac{\\partial^2U}{\\partial x^2} + \\frac{\\partial^2U}{\\partial y^2}âˆ‚x2âˆ‚2Uâ€‹+âˆ‚y2âˆ‚2Uâ€‹ 14Ï€âˆ®Î£1râˆ‚Uâˆ‚nds\\frac{1}{4\\pi}\\oint_\\Sigma\\frac{1}{r}\\frac{\\partial U}{\\partial n} ds4Ï€1â€‹âˆ®Î£â€‹r1â€‹âˆ‚nâˆ‚Uâ€‹ds âˆ¬\\iintâˆ¬ % 1. ä¸Šä¸‹æ ‡ a^{i+1}_3 % 2. åˆ†æ•° \\frac{1+\\frac{1}{x}}{3x + 2} \\dfrac{1+\\dfrac{1}{x}}{3x + 2} %display æ¨¡å¼ % 3. è¿ç»­åˆ†æ•° \\cfrac{2}{1+\\cfrac{2}{1+\\cfrac{2}{1+\\cfrac{2}{1}}}} % 4. æ ¹å· \\sqrt[n]{x} % 5. æ±‚å’Œï¼Œæ±‚ç§¯ï¼Œæé™ï¼Œå¯¹æ•° \\sum_{i=1}^{\\infty}\\frac{1}{i} \\sum\\limits_{i=1}^{\\infty}\\frac{1}{i} \\prod_{n=1}^5\\frac{n}{n-1} \\lim_{x\\to\\infty}\\frac{1}{x} \\lim\\limits_{x\\to\\infty}\\frac{1}{x} \\log_n n^2 \\ln e % 6. æ¨¡ 9\\equiv 3 \\bmod{6} 9\\equiv 3 \\pmod{6} 9\\equiv 3 \\mod{6} 9\\equiv 3 \\pod{6} % 7. ç»„åˆæ•° \\binom{n-1}{r-1} \\dbinom{n-1}{r-1} %display æ¨¡å¼ C_{n-1}^{r-1} % 8. ä¸‰è§’å‡½æ•° \\sin \\cos \\tan... \\cos^2 x +\\sin^2 x = 1 \\cos 90^\\circ = 0 % 9. ä¸Šä¸‹æ¨ªçº¿ \\overline{a+bi} \\underline{747} % 10. ç§¯åˆ† \\frac{d}{dx}\\left(x^2\\right) = 2x \\int 2x\\,dx = x^2+C %\\,å°ç©ºæ ¼ \\int^5_1 2x\\,dx = 24 \\frac{\\partial^2U}{\\partial x^2} + \\frac{\\partial^2U}{\\partial y^2} \\frac{1}{4\\pi}\\oint_\\Sigma\\frac{1}{r}\\frac{\\partial U}{\\partial n} ds \\iint æ•°å­¦å‡½æ•° çŸ©é˜µ array ç¯å¢ƒ (abcdefghi)\\left( \\begin{array}{ccc} a &amp; b &amp; c \\\\ d &amp; e &amp; f \\\\ g &amp; h &amp; i \\end{array} \\right) ââ›â€‹adgâ€‹behâ€‹cfiâ€‹â ââ€‹ abS001011101110\\begin{array}{|c|c||c|} a &amp; b &amp; S \\\\ \\hline 0&amp;0&amp;1\\\\ 0&amp;1&amp;1\\\\ 1&amp;0&amp;1\\\\ 1&amp;1&amp;0\\\\ \\end{array} a0011â€‹b0101â€‹S1110â€‹â€‹ \\left( \\begin{array}{ccc} a &amp; b &amp; c \\\\ d &amp; e &amp; f \\\\ g &amp; h &amp; i \\end{array} \\right) \\begin{array}{|c|c||c|} a &amp; b &amp; S \\\\ \\hline 0&amp;0&amp;1\\\\ 0&amp;1&amp;1\\\\ 1&amp;0&amp;1\\\\ 1&amp;1&amp;0\\\\ \\end{array} pmatrix ç¯å¢ƒ (abcdefghi)\\begin{pmatrix} a &amp; b &amp; c\\\\ d &amp; e &amp; f\\\\ g &amp; h &amp; i \\end{pmatrix} ââ›â€‹adgâ€‹behâ€‹cfiâ€‹â ââ€‹ \\begin{pmatrix} a &amp; b &amp; c\\\\ d &amp; e &amp; f\\\\ g &amp; h &amp; i \\end{pmatrix} vmatrix ç¯å¢ƒ âˆ£xyzvâˆ£\\begin{vmatrix} x &amp; y \\\\ z &amp; v \\end{vmatrix} âˆ£âˆ£âˆ£âˆ£â€‹xzâ€‹yvâ€‹âˆ£âˆ£âˆ£âˆ£â€‹ âˆ¥xyzvâˆ¥\\begin{Vmatrix} x &amp; y \\\\ z &amp; v \\end{Vmatrix} âˆ¥âˆ¥âˆ¥âˆ¥â€‹xzâ€‹yvâ€‹âˆ¥âˆ¥âˆ¥âˆ¥â€‹ \\begin{vmatrix} x &amp; y \\\\ z &amp; v \\end{vmatrix} \\begin{Vmatrix} x &amp; y \\\\ z &amp; v \\end{Vmatrix} bmatrix ç¯å¢ƒ [0â‹¯0â‹®â‹±â‹®0â‹¯0]\\begin{bmatrix} 0 &amp; \\cdots &amp; 0 \\\\ \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; \\cdots &amp; 0 \\end{bmatrix} â£â¢â¡â€‹0â‹®0â€‹â‹¯â‹±â‹¯â€‹0â‹®0â€‹â¦â¥â¤â€‹ {xyzv}\\begin{Bmatrix} x &amp; y \\\\ z &amp; v \\end{Bmatrix} {xzâ€‹yvâ€‹} \\bigl(\\begin{smallmatrix} a&amp;b\\\\ c&amp;d \\end{smallmatrix}\\bigr) \\begin{bmatrix} 0 &amp; \\cdots &amp; 0 \\\\ \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; \\cdots &amp; 0 \\end{bmatrix} \\begin{Bmatrix} x &amp; y \\\\ z &amp; v \\end{Bmatrix} \\bigl(\\begin{smallmatrix} a&amp;b\\\\ c&amp;d \\end{smallmatrix}\\bigr) cases ç¯å¢ƒ array ä»£æ›¿ è¿™é‡Œä¸æ”¯æŒ \\mboxï¼Œä½¿ç”¨ \\text ä»£æ›¿ f(x)={x+7if 5&lt;x;x2âˆ’3if âˆ’3â‰¤xâ‰¤5;âˆ’xif x&lt;âˆ’3.f(x) = \\left\\{ \\begin{array}{ll} x+7 &amp; \\text{if $5&lt; x$};\\\\ x^2-3 &amp; \\text{if $-3 \\le x \\le 5$};\\\\ -x &amp; \\text{if $x &lt; -3$}.\\end{array} \\right. f(x)=â©â¨â§â€‹x+7x2âˆ’3âˆ’xâ€‹if 5&lt;x;if âˆ’3â‰¤xâ‰¤5;if x&lt;âˆ’3.â€‹ x+7if 5&lt;x;x2âˆ’3if âˆ’3â‰¤xâ‰¤5;âˆ’xif x&lt;âˆ’3.}=f(x)\\left. \\begin{array}{ll} x+7 &amp; \\text{if $5&lt; x$};\\\\ x^2-3 &amp; \\text{if $-3 \\le x \\le 5$};\\\\ -x &amp; \\text{if $x &lt; -3$}. \\end{array} \\right\\} =f(x) x+7x2âˆ’3âˆ’xâ€‹if 5&lt;x;if âˆ’3â‰¤xâ‰¤5;if x&lt;âˆ’3.â€‹â­â¬â«â€‹=f(x) cases ç¯å¢ƒ f(x)={x+7if 5&lt;x;x2âˆ’3if âˆ’3â‰¤xâ‰¤5;âˆ’xif x&lt;âˆ’3.f(x) = \\begin{cases} x+7 &amp; \\text{if $5&lt; x$}; \\\\ x^2-3 &amp; \\text{if $-3 \\le x \\le 5$}; \\\\ -x &amp; \\text{if $x &lt; -3$}. \\end{cases} f(x)=â©âªâ¨âªâ§â€‹x+7x2âˆ’3âˆ’xâ€‹if 5&lt;x;if âˆ’3â‰¤xâ‰¤5;if x&lt;âˆ’3.â€‹ f(n)={n2,if n is even3n+1,if n is oddf(n) = \\begin{cases} \\dfrac{n}{2}, &amp; \\text{if $n$ is even} \\\\[2ex] 3n+1, &amp; \\text{if $n$ is odd} \\end{cases} f(n)=â©â¨â§â€‹2nâ€‹,3n+1,â€‹if n is evenif n is oddâ€‹ % ä½¿ç”¨ array f(x) = \\left\\{ \\begin{array}{ll} x+7 &amp; \\text{if $5&lt; x$};\\\\ x^2-3 &amp; \\text{if $-3 \\le x \\le 5$};\\\\ -x &amp; \\text{if $x &lt; -3$}.\\end{array} \\right. \\left. \\begin{array}{ll} x+7 &amp; \\text{if $5&lt; x$};\\\\ x^2-3 &amp; \\text{if $-3 \\le x \\le 5$};\\\\ -x &amp; \\text{if $x &lt; -3$}. \\end{array} \\right\\} =f(x) % æ¨èä½¿ç”¨ amsmath åŒ…casesç¯å¢ƒ f(x) = \\begin{cases} x+7 &amp; \\text{if $5&lt; x$}; \\\\ x^2-3 &amp; \\text{if $-3 \\le x \\le 5$}; \\\\ -x &amp; \\text{if $x &lt; -3$}. \\end{cases} f(n) = \\begin{cases} \\dfrac{n}{2}, &amp; \\text{if $n$ is even} \\\\[2ex] % ä½¿ç”¨\\\\[2ex] é€‚é…è¡Œé«˜ 3n+1, &amp; \\text{if $n$ is odd} \\end{cases} align ç¯å¢ƒ ç½‘é¡µå¯èƒ½ä¸æ”¯æŒ align ï¼Œå¯ä»¥ä½¿ç”¨ array æ¥æ›¿ä»£ \\begin{align} \\sqrt{37} &amp; = \\sqrt{\\frac{73^2-1}{12^2}} \\\\ &amp; = \\sqrt{\\frac{73^2}{12^2}\\cdot\\frac{73^2-1}{73^2}} \\\\ &amp; = \\sqrt{\\frac{73^2}{12^2}}\\sqrt{\\frac{73^2-1}{73^2}} \\\\ &amp; = \\frac{73}{12}\\sqrt{1 - \\frac{1}{73^2}} \\\\ &amp; \\approx \\frac{73}{12}\\left(1 - \\frac{1}{2\\cdot73^2}\\right) \\end{align} % å¯¹é½å’Œæ ‡å· \\begin{align} v + w &amp; = 0 &amp;\\text{Given} \\tag 1\\\\ -w &amp; = -w + 0 &amp; \\text{additive identity} \\tag 2\\\\ -w + 0 &amp; = -w + (v + w) &amp; \\text{equations $(1)$ and $(2)$} \\end{align} ç¬¦å·æ ·å¼ \\mathbb é»‘æ¿ç²—ä½“ï¼Œç©ºå¿ƒå­—æ¯ï¼Œå‘é‡æˆ–é›†åˆçš„ç¬¦å· \\mathbf æ­£ç²—ä½“ \\mathcal æ‰‹å†™ä½“ï¼Œå¤§å†™å­—æ¯ \\mathfrak å“¥ç‰¹ä½“ RQZFabcwxyz01234567890123456789RQZFRUFL\\begin{aligned} &amp;\\boldsymbol{R\\quad Q\\quad Z\\quad F \\quad abcwxyz} \\\\ &amp;\\mathit{0123456789} \\\\ &amp;\\mathrm{0123456789 \\quad R\\quad Q\\quad Z\\quad F} \\\\ &amp;\\mathscr{R} \\quad \\mathscr{U} \\quad \\mathscr{F}\\quad \\mathscr{L} \\\\ \\end{aligned} â€‹RQZFabcwxyz01234567890123456789RQZFRUFLâ€‹ % æ–œç²—ä½“ï¼Œå¯ä»¥åŠ ç²—æ‰€æœ‰åˆæ³•ç¬¦å· \\boldsymbol{R Q Z F abcwxyz} % æ–œä½“æ•°å­— \\mathit{0123456789} % ç½—é©¬ä½“ \\mathrm{012â€¦abcâ€¦ABCâ€¦}æˆ–\\operatorname{} % èŠ±ä½“å­—æ¯ \\mathscr{R U F L} ç©ºæ ¼ é¢œè‰² å­—ä½“é¢œè‰² {\\color{è‰²è°ƒ}è¡¨è¾¾å¼} \\textcolor[rgb]{0,0,1}{è¡¨è¾¾å¼} èƒŒæ™¯é¢œè‰² \\colorbox{è‰²è°ƒ}{è¡¨è¾¾å¼} Red\\colorbox{Red}{\\color{white}Red}Redâ€‹ Blue\\colorbox{Blue}{\\color{white}Blue}Blueâ€‹ Aquamarine\\colorbox{Aquamarine}{\\color{white}Aquamarine}Aquamarineâ€‹ Orange\\colorbox{Orange}{\\color{white}Orange}Orangeâ€‹ Cyan\\colorbox{Cyan}{\\color{white}Cyan}Cyanâ€‹ ForestGreen\\colorbox{ForestGreen}{\\color{white}ForestGreen}ForestGreenâ€‹ SpringGreen\\colorbox{SpringGreen}{\\color{white}SpringGreen}SpringGreenâ€‹ Goldenrod\\colorbox{Goldenrod}{\\color{white}Goldenrod}Goldenrodâ€‹ åˆæƒ³èµ·ä½ æ›¾è¯´çš„é™ªæˆ‘åˆ°æœ€å,æš–è‰²çš„æ¢¦å˜å†°å‡‰çš„æ·é”,å¦‚æœæ—¶å…‰å€’æµæˆ‘ä»¬åˆèƒ½æŠ“å¾—ä½ä»€ä¹ˆ\\textcolor{Blue}{åˆæƒ³èµ·ä½ æ›¾è¯´çš„é™ªæˆ‘åˆ°æœ€å,æš–è‰²çš„æ¢¦å˜å†°å‡‰çš„æ·é”,å¦‚æœæ—¶å…‰å€’æµæˆ‘ä»¬åˆèƒ½æŠ“å¾—ä½ä»€ä¹ˆ}åˆæƒ³èµ·ä½ æ›¾è¯´çš„é™ªæˆ‘åˆ°æœ€å,æš–è‰²çš„æ¢¦å˜å†°å‡‰çš„æ·é”,å¦‚æœæ—¶å…‰å€’æµæˆ‘ä»¬åˆèƒ½æŠ“å¾—ä½ä»€ä¹ˆ åˆæƒ³èµ·ä½ æ›¾è¯´çš„é™ªæˆ‘åˆ°æœ€å,æš–è‰²çš„æ¢¦å˜å†°å‡‰çš„æ·é”,å¦‚æœæ—¶å…‰å€’æµæˆ‘ä»¬åˆèƒ½æŠ“å¾—ä½ä»€ä¹ˆ\\textcolor{Pink}{åˆæƒ³èµ·ä½ æ›¾è¯´çš„é™ªæˆ‘åˆ°æœ€å,æš–è‰²çš„æ¢¦å˜å†°å‡‰çš„æ·é”,å¦‚æœæ—¶å…‰å€’æµæˆ‘ä»¬åˆèƒ½æŠ“å¾—ä½ä»€ä¹ˆ}åˆæƒ³èµ·ä½ æ›¾è¯´çš„é™ªæˆ‘åˆ°æœ€å,æš–è‰²çš„æ¢¦å˜å†°å‡‰çš„æ·é”,å¦‚æœæ—¶å…‰å€’æµæˆ‘ä»¬åˆèƒ½æŠ“å¾—ä½ä»€ä¹ˆ åˆæƒ³èµ·ä½ æ›¾è¯´çš„é™ªæˆ‘åˆ°æœ€å,æš–è‰²çš„æ¢¦å˜å†°å‡‰çš„æ·é”,å¦‚æœæ—¶å…‰å€’æµæˆ‘ä»¬åˆèƒ½æŠ“å¾—ä½ä»€ä¹ˆ\\textcolor{ForestGreen}{åˆæƒ³èµ·ä½ æ›¾è¯´çš„é™ªæˆ‘åˆ°æœ€å,æš–è‰²çš„æ¢¦å˜å†°å‡‰çš„æ·é”,å¦‚æœæ—¶å…‰å€’æµæˆ‘ä»¬åˆèƒ½æŠ“å¾—ä½ä»€ä¹ˆ}åˆæƒ³èµ·ä½ æ›¾è¯´çš„é™ªæˆ‘åˆ°æœ€å,æš–è‰²çš„æ¢¦å˜å†°å‡‰çš„æ·é”,å¦‚æœæ—¶å…‰å€’æµæˆ‘ä»¬åˆèƒ½æŠ“å¾—ä½ä»€ä¹ˆ ","tags":[{"name":"LaTeX","slug":"latex","used":true,"link":"https://blog.qxxiao.eu.org/tag/latex/"}],"title":"LaTeX æ•°å­¦å…¬å¼","feature":"https://pic.qxxiao.cn/202303200109311.png","link":"https://blog.qxxiao.eu.org/post/latexæ•°å­¦å…¬å¼/","stats":{"text":"14 min read","time":795000,"words":2447,"minutes":14},"date":"2023-03-19 19:15:10","dateFormat":"2023-03-19","isTop":false},{"content":"é—®é¢˜ å›¾è®ºä¸­çš„æœ€çŸ­è·¯é—®é¢˜ï¼Œæ±‚ä¸¤ä¸ªç‚¹ä¹‹é—´æœ€çŸ­è·ç¦»ï¼ˆè·¯å¾„ï¼‰çš„é—®é¢˜ï¼› è§„å®šä½¿ç”¨ n: è¡¨ç¤ºç‚¹çš„æ•°é‡ï¼›m: è¡¨ç¤ºè¾¹çš„æ•°é‡ï¼›è¾¹æ•° m æ˜¯é¡¶ç‚¹æ•° n çš„å¹³æ–¹çº§åˆ«è§†ä¸ºç¨ å¯†å›¾ ç¨ å¯†å›¾ä½¿ç”¨é‚»æ¥çŸ©é˜µå­˜å‚¨ ç¨€ç–å›¾ä½¿ç”¨é‚»æ¥è¡¨å­˜å‚¨ï¼ˆä½¿ç”¨æ•°ç»„æ¨¡æ‹Ÿï¼‰ åªè€ƒè™‘æœ‰å‘å›¾ï¼Œå¦‚æœæ˜¯æ— å‘å›¾åˆ™å»ºç«‹ 2 æ¡åŒå‘è¾¹å³å¯ï¼›é»˜è®¤åªè€ƒè™‘æœ‰å‘å›¾ ç®—æ³•æ€»ç»“ï¼š å•æºæœ€çŸ­è·¯ æ±‚ä»ä¸€ä¸ªç‚¹åˆ°å…¶ä»–æ‰€æœ‰ç‚¹çš„æœ€çŸ­è·ç¦»ï¼Œé¡¶ç‚¹ä¸º 1,2,3...nï¼Œæ±‚é¡¶ç‚¹ 1 åˆ°å…¶ä»–æ‰€æœ‰é¡¶ç‚¹çš„æœ€çŸ­è·¯ è¾¹æƒéƒ½æ˜¯æ­£æ•° Dijkstra åŸºäºè´ªå¿ƒç®—æ³• æœ´ç´ çš„ Dijkstra ç®—æ³• O(n2)O(n^2)O(n2) é€‚ç”¨äºç¨ å¯†å›¾ï¼Œè¾¹æ•°å¤šçš„æƒ…å½¢ m=n2m=n^2m=n2ï¼Œæ­¤æ—¶æ¯”å †ä¼˜åŒ–å¥½ å †ä¼˜åŒ–ç‰ˆ Dijkstra ç®—æ³• O(mlogn)O(mlogn)O(mlogn) é€‚ç”¨äºç¨€ç–å›¾ï¼Œm å’Œ n åŒé˜¶çš„æƒ…å½¢ m&lt;n2m&lt;n^2m&lt;n2 æœ´ç´  Dijkstra O(n2)O(n^2)O(n2) ç¨ å¯†å›¾ä½¿ç”¨é‚»æ¥çŸ©é˜µå­˜å‚¨ è¾¹æƒæ˜¯æ­£æ•°æ—¶ï¼Œå¦‚æœæ•°æ®å‡ºç°è‡ªç¯å’Œé‡è¾¹éœ€è¦é¢„å¤„ç†ï¼š çœç•¥è‡ªç¯ é‡è¾¹åªä¿å­˜æœ€çŸ­çš„è¾¹ è·ç¦»éƒ½æ˜¯å•æºç‚¹ 1 å·ç‚¹åˆ°å…¶ä»–ç‚¹çš„è·ç¦»ï¼Œä½¿ç”¨ dist[N]æ•°ç»„ä¿å­˜å½“å‰è·ç¦»ï¼›ç»´æŠ¤ä¸€ä¸ªå·²ç»ç¡®å®šæœ€å°è·ç¦»çš„ç‚¹çš„é›†åˆ Sï¼Œä½¿ç”¨äº† st[N]æ•°ç»„æ¥æ ‡è®°ï¼š ç®—æ³•æ€è·¯ï¼š 1. åˆå§‹åŒ–è·ç¦»: dist[1] = 0, dist[i!=0] = +âˆ 2. for i: 1~n: // è¿­ä»£næ¬¡ï¼Œæ¯æ¬¡å¾—åˆ°ä¸€ä¸ªæœ€çŸ­è·¯å¾„çš„ç‚¹ t &lt;-- ä¸åœ¨Sä¸­çš„ç‚¹ï¼Œä¸”è·ç¦»æœ€è¿‘çš„ç‚¹ S &lt;-- tï¼ˆå°†tåŠ å…¥åˆ°Sä¸­) ç”¨ç‚¹tæ¥æ›´æ–°å…¶ä»–ç‚¹çš„è·ç¦» æœ´ç´ ç‰ˆ Dijkstra ç®—æ³• Dijkstra æ±‚æœ€çŸ­è·¯ I #include &lt;iostream&gt; #include &lt;cstring&gt; #include &lt;algorithm&gt; using namespace std; const int N = 510; int n, m; int g[N][N]; // é‚»æ¥çŸ©é˜µ int dist[N]; // å½“å‰é¡¶ç‚¹ 1 åˆ°æ‰€æœ‰ç‚¹çš„è·ç¦» bool st[N]; // æ˜¯å¦åŠ å…¥é›†åˆ S(å·²çŸ¥æœ€çŸ­è·ç¦»çš„ç‚¹é›†åˆ) int dijkstra() { // åˆå§‹åŒ–å½“å‰çš„è·ç¦» memset(dist, 0x3f, sizeof dist); dist[1] = 0; for (int i = 0; i &lt; n; i++) { int t = -1; for (int j = 1; j &lt;= n; j++) if (!st[j] &amp;&amp; (t == -1 || dist[t] &gt; dist[j])) t = j; st[t] = true; // æ›´æ–°ç›¸é‚»é¡¶ç‚¹çš„è·ç¦» for (int j = 1; j &lt;= n; j++) dist[j] = min(dist[j], dist[t] + g[t][j]); } //åˆ¤æ–­ dist[n] if (dist[n] == 0x3f3f3f3f) return -1; return dist[n]; } int main() { scanf(&quot;%d%d&quot;, &amp;n, &amp;m); memset(g, 0x3f, sizeof g); while (m--) { int a, b, c; scanf(&quot;%d%d%d&quot;, &amp;a, &amp;b, &amp;c); // å¤„ç†å¤šé‡è¾¹ g[a][b] = min(g[a][b], c); } int t = dijkstra(); printf(&quot;%d\\n&quot;, t); } å †ä¼˜åŒ–çš„ Dijkstra O(mlogn) ç¨€ç–å›¾--ä½¿ç”¨é‚»æ¥è¡¨å­˜å‚¨ï¼Œæ–¹ä¾¿éå†é‚»æ¥è¾¹ï¼Œh[N],w[N],e[N],ne[N] é‡‡ç”¨ stl çš„priority_queue&lt;PII, vector&lt;PII&gt;, greater&lt;PII&gt;&gt; queue; å †ä¼˜åŒ–ç‰ˆæœ¬ Dijkstra ç®—æ³• Dijkstra æ±‚æœ€çŸ­è·¯ II #include &lt;cstring&gt; #include &lt;iostream&gt; #include &lt;algorithm&gt; #include &lt;queue&gt; using namespace std; using PII = pair&lt;int, int&gt;; const int N = 100010; int n, m; int h[N], w[N], e[N], ne[N], idx; int dist[N]; bool st[N]; // é‚»æ¥è¡¨æ·»åŠ è¾¹ a --&gt; b (w=c) void add(int a, int b, int c) { e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx++; } int dijkstra() { // åˆå§‹åŒ–è·ç¦» memset(dist, 0x3f, sizeof dist); dist[1] = 0; priority_queue&lt;PII, vector&lt;PII&gt;, greater&lt;PII&gt;&gt; heap; heap.push({0, 1}); while (heap.size()) { auto t = heap.top(); heap.pop(); int ver = t.second, distance = t.first; if (st[ver]) continue; // æ ‡è®°æ›´æ–°è¿‡ st[ver] = true; // åªéå†æ‰€æœ‰çš„é‚»è¾¹ for (int i = h[ver]; i != -1; i = ne[i]) { int j = e[i]; if (dist[j] &gt; distance + w[i]) { dist[j] = distance + w[i]; heap.push({dist[j], j}); } } } if (dist[n] == 0x3f3f3f3f) return -1; return dist[n]; } int main() { scanf(&quot;%d%d&quot;, &amp;n, &amp;m); // é‚»æ¥è¡¨çš„è¡¨å¤´åˆå§‹åŒ– memset(h, -1, sizeof h); while (m--) { int a, b, c; scanf(&quot;%d%d%d&quot;, &amp;a, &amp;b, &amp;c); // æœ‰é‡è¾¹ä¹Ÿä¸å½±å“ï¼Œç®—æ³•ä¼šä½¿ç”¨æœ€çŸ­çš„æ¥æ›´æ–° add(a, b, c); } int t = dijkstra(); printf(&quot;%d\\n&quot;, t); return 0; } è¿™é‡Œå–å‡ºé˜Ÿå¤´åå¯ä»¥æ·»åŠ  dist[ver]=distance ï¼Œå…¶å¯ä»¥çœç•¥çš„åŸå› æ˜¯ï¼šç”±äºåˆå§‹åŒ–äº†èµ·ç‚¹è·ç¦»ä¸º 0ï¼Œå¹¶ä¸”æ‰©å±•æ—¶æ ¹æ®æ˜¯å¦è·ç¦»æ˜¯å¦æ›´æ–°æ›´æ–°äº†è·ç¦»ã€‚ å­˜åœ¨è´Ÿæƒè¾¹ Bellman-Ford ç®—æ³• O(nm) SPFA ä¸€èˆ¬ï¼šO(m)ï¼Œæœ€å O(nm); æ˜¯ Bellman-Ford ç®—æ³•çš„ä¸€ä¸ªä¼˜åŒ–ï¼Œæ•ˆç‡æ¯” Bellman-Ford å¥½ ä½†æ˜¯ä¸æ˜¯æ‰€æœ‰çš„é—®é¢˜éƒ½å¯ä»¥ç”¨ SPFA åšï¼Œä¾‹å¦‚æœ€çŸ­è·¯è¾¹æ•°&lt;=k çš„æœ€çŸ­è·¯ï¼Œåªèƒ½ä½¿ç”¨ Bellman-Ford ç®—æ³• Bellman-Ford ç®—æ³• O(nm)O(nm)O(nm) è¾¹çš„å­˜å‚¨æ–¹å¼ï¼šåªè¦èƒ½å¤Ÿéå†æ‰€æœ‰çš„è¾¹å°±å¯ä»¥ï¼›ç®—æ³•æ€è·¯ï¼š struct edge{ int a,b,w; }edges[N]; for 1:n : // n æ¬¡å¾ªç¯ for æ‰€æœ‰è¾¹ a,b,w // éå†æ‰€æœ‰è¾¹ (a -&gt; b,(w))è¿›è¡Œæ›´æ–° dist[b]=min(dist[b], dist[a]+w(a,b)); æ€æƒ³ï¼šå› ä¸ºæœ€çŸ­è·¯å¾„æœ€å¤šä¸º n-1 ä¸ªè¾¹çš„ç»„åˆ; æ¾å¼› n-1 æ¬¡ï¼Œä¸€å®šå¯ä»¥æ¾å¼›å®Œæœ€è¿œçš„ç‚¹ï¼Œå¾—åˆ°æ‰€æœ‰çš„æœ€çŸ­è·ç¦» æ³¨æ„ï¼š æ¯æ¬¡è¿­ä»£ï¼Œæ˜¯å¯¹ä¸Šä¸€ä¸ª dist æ•°ç»„ï¼ˆåŒä¸€ä¸ªçŠ¶æ€)è¿›è¡Œè¿­ä»£çš„ï¼Œå¯¹ç›¸åŒçš„è·ç¦»çŠ¶æ€è¿›è¡Œæ›´æ–°ï¼ˆéœ€è¦å…ˆå¤‡ä»½ï¼‰ Bellman-Ford ç®—æ³• #include &lt;iostream&gt; #include &lt;algorithm&gt; #include &lt;cstring&gt; using namespace std; const int N = 510, M = 10010; int n, m, k; int dist[N], backup[N]; struct Edge { int a, b, w; } edges[M]; int bellman_ford() { memset(dist, 0x3f, sizeof dist); dist[1] = 0; for (int i = 0; i &lt; k; i++) { memcpy(backup, dist, sizeof dist); for (int j = 0; j &lt; m; j++) { int a = edges[j].a, b = edges[j].b, w = edges[j].w; dist[b] = min(dist[b], dist[a] + w); } } // if (dist[n] &gt; 0x3f3f3f3f / 2) // return -1; // return dist[n]; // -1 ä¹Ÿå¯èƒ½æ˜¯è·¯å¾„é•¿åº¦ return dist[n]; } int main() { cin &gt;&gt; n &gt;&gt; m &gt;&gt; k; for (int i = 0; i &lt; m; i++) { int a, b, w; cin &gt;&gt; a &gt;&gt; b &gt;&gt; w; edges[i] = {a, b, w}; } int res = bellman_ford(); if (res &gt; 0x3f3f3f3f / 2) puts(&quot;impossible&quot;); else cout &lt;&lt; res &lt;&lt; endl; return 0; } è¯´æ˜ è¿­ä»£ k æ¬¡ï¼Œè¡¨ç¤º 1 å·ç‚¹ä¸è¶…è¿‡ k æ¡è¾¹çš„æœ€çŸ­è·ç¦» å¦‚æœç»è¿‡ n æ¬¡è¿­ä»£ï¼Œç¬¬ n æ¬¡æœ€çŸ­è·¯å¾„è¿˜æœ‰æ›´æ–°ï¼Œè¯´æ˜è¿™ä¸ª n æ¡è¾¹çš„è·¯å¾„ä¸Š n+1 ä¸ªèŠ‚ç‚¹ï¼Œæœ‰ç¯ï¼Œè¯´æ˜æœ‰è´Ÿç¯ï¼Œå› æ­¤ï¼Œå¯ä»¥åˆ¤æ–­æœ‰è´Ÿç¯ï¼Œä½†é€šå¸¸ä½¿ç”¨ spfa åˆ¤æ–­ SPFA ï¼ˆæ²¡æœ‰è´Ÿç¯ï¼‰ ä½¿ç”¨é‚»æ¥è¡¨å­˜å‚¨ï¼Œå¤æ‚åº¦ä¸€èˆ¬æ˜¯ O(m)ï¼Œç½‘æ ¼å›¾å¯èƒ½å¡æˆ O(nm) å¯¹ Bellman-Ford ç®—æ³•çš„æ”¹è¿›ï¼Œæ¯æ¬¡è¿­ä»£ä¸­å¯¹äºä»»æ„è¾¹a --&gt; b(w)ï¼Œåªæœ‰é¡¶ç‚¹aè·ç¦»å˜å°äº†ï¼Œæ‰æœ‰å¯èƒ½æ›´æ–°é‚»ç‚¹bçš„è·ç¦» ä½¿ç”¨ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå­˜å‚¨æ‰€æœ‰è·ç¦»å˜å°çš„é¡¶ç‚¹ aï¼Œï¼ˆä¼˜åŒ–ï¼šä½¿ç”¨ st æ•°ç»„å­˜å‚¨é¡¶ç‚¹æ˜¯å¦å·²ç»åœ¨é˜Ÿåˆ—ä¸­ï¼‰ï¼Œç®—æ³•æ€è·¯ï¼š 1. åˆå§‹åŒ–è·ç¦»: dist[1] = 0, dist[i!=0] = +âˆ 2. queue &lt;-- {0,1} //é¡¶ç‚¹ 1 å…¥é˜Ÿ{è·ç¦»ï¼Œç¼–å·} while queue éç©ºï¼š t &lt;-- queue.front() queue.pop() æ›´æ–° t çš„æ‰€æœ‰å‡ºè¾¹çš„ç»ˆç‚¹çš„è·ç¦» t --&gt; b // æ›´æ–° å¦‚æœ t ä¸åœ¨é˜Ÿåˆ— queue ä¸­ï¼Œqueue &lt;-- t æ³¨æ„ï¼šæ²¡æœ‰è´Ÿç¯ï¼Œæ‰èƒ½ç›´æ¥ç”¨ spfa ç®—æ³• spfa æ±‚æœ€çŸ­è·¯ #include &lt;cstring&gt; #include &lt;algorithm&gt; #include &lt;queue&gt; using namespace std; const int N = 100010; int n, m; int h[N], e[N], w[N], ne[N], idx; int dist[N]; // ä¼˜åŒ–: æ ‡è®°æ˜¯å¦åœ¨é˜Ÿåˆ—ä¸­ bool st[N]; void add(int a, int b, int c) { e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx++; } int spfa() { memset(dist, 0x3f, sizeof dist); dist[1] = 0; queue&lt;int&gt; q; q.push(1); st[1] = true; // åªæœ‰æ›´æ–°è¿‡çš„ç‚¹æ‰èƒ½æ›´æ–°å…¶ä»–é¡¶ç‚¹çš„è·ç¦» while (!q.empty()) { auto t = q.front(); q.pop(); st[t] = false; for (int i = h[t]; i != -1; i = ne[i]) { int j = e[i]; if (dist[j] &gt; dist[t] + w[i]) { dist[j] = dist[t] + w[i]; if (!st[j]) { q.push(j); st[j] = true; } } } } return dist[n]; } int main() { scanf(&quot;%d%d&quot;, &amp;n, &amp;m); memset(h, -1, sizeof h); for (int i = 0; i &lt; m; i++) { int x, y, z; scanf(&quot;%d%d%d&quot;, &amp;x, &amp;y, &amp;z); add(x, y, z); } int t = spfa(); if (t &gt; 0x3f3f3f3f / 2) puts(&quot;impossible&quot;); else printf(&quot;%d\\n&quot;, t); return 0; } åˆ¤æ–­è´Ÿç¯ï¼šåˆ¤æ–­(ä»»æ„ä¸€æ¡)æœ€çŸ­è·¯å¾„çš„é•¿åº¦æ˜¯å¦&gt;=n (æ³¨æ„è¿™é‡Œéœ€è¦å°†æ‰€æœ‰ç‚¹é¢„å…ˆåŠ å…¥é˜Ÿåˆ—)ï¼Œå› ä¸ºè´Ÿç¯å¯èƒ½åœ¨æŸäº›é¡¶ç‚¹ä¸å¯åˆ°è¾¾ ä¸éœ€è¦ç»´æŠ¤ç»å¯¹è·ç¦»ï¼Œç»´æŠ¤ä¸€ä¸ª cnt æ•°ç»„ï¼Œå­˜å‚¨æ›´æ–°åè·¯å¾„ä¸Šè¾¹æ•°ï¼Œå¦‚æœæœ‰ä¸€è·¯å¾„çš„è¾¹æ•°&gt;=nï¼Œè¯´æ˜è·¯å¾„ä¸Šå‡ºç°è´Ÿç¯ï¼š bool spfa() { queue&lt;int&gt; q; // åˆ¤æ–­è´Ÿç¯ for (int i = 1; i &lt;= n; i++) //å¯èƒ½ 1 å·ç‚¹åˆ°ä¸äº†ï¼ŒæŠŠæ‰€æœ‰ç‚¹éƒ½åŠ å…¥ { q.push(i); st[i] = true; } //é˜Ÿåˆ—ä¸­çš„ç‚¹ï¼Œéƒ½æ˜¯è·ç¦»ç¼©çŸ­çš„ï¼Œéœ€è¦æ›´æ–°å®ƒçš„é‚»ç‚¹è·ç¦» while (q.size()) { int t = q.front(); q.pop(); st[t] = false; for (int i = h[t]; i != -1; i = ne[i]) { int j = e[i]; if (dist[j] &gt; dist[t] + w[i]) { dist[j] = dist[t] + w[i]; cnt[j] = cnt[t] + 1; // æ›´æ–°è·¯å¾„é•¿åº¦ if (cnt[j] &gt;= n) // è¯´æ˜æœ‰è´Ÿç¯ return true; if (!st[j]) { q.push(j); st[j] = true; } } } } return false; } è¯´æ˜ï¼šæœ‰è´Ÿæƒå›è·¯çš„å›¾ï¼Œè´Ÿç¯ä¸åœ¨è·¯å¾„ä¸Šä¹Ÿå¯èƒ½æ±‚åˆ°æŸç‚¹çš„æœ€çŸ­è·¯å¾„ å¤šæºæ±‡æœ€çŸ­è·¯ èµ·ç‚¹å’Œç»ˆç‚¹éƒ½ä¸ç¡®å®š/éƒ½ä»»æ„ï¼Œæ±‚æ‰€æœ‰é¡¶ç‚¹é—´çš„æœ€çŸ­è·¯ Floyd ç®—æ³• O(n^3) åŸºäºåŠ¨æ€è§„åˆ’åŸç† Floyd ç®—æ³• O(n3)O(n^3)O(n3) ä½¿ç”¨é‚»æ¥çŸ©é˜µå­˜å‚¨ d[N][N]é¡¶ç‚¹é—´çš„è·ç¦»ï¼Œè‡ªå·±åˆ°è‡ªå·±çš„è·ç¦»ä¸º 0ï¼› ç®—æ³•æ€è·¯ï¼šåˆ†é˜¶æ®µd[k,i,j]=min(d[k-1,i,j], d[k-1,i,k]+d[k-1,k,j]) éœ€è¦æ²¡æœ‰è´Ÿæƒç¯ï¼Œæ•°æ®çš„é¢„å¤„ç†ï¼šè‡ªç¯ï¼ˆæ­£ï¼‰å¯ä»¥çœç•¥ï¼Œé‡è¾¹å–æœ€çŸ­çš„è¾¹ #include &lt;cstring&gt; #include &lt;iostream&gt; #include &lt;algorithm&gt; using namespace std; const int N = 210, INF = 1 e 9; int n, m, Q; int d[N][N]; void floyd() { for (int k = 1; k &lt;= n; k++) for (int i = 1; i &lt;= n; i++) for (int j = 1; j &lt;= n; j++) d[i][j] = min(d[i][j], d[i][k] + d[k][j]); } int main() { cin &gt;&gt; n &gt;&gt; m &gt;&gt; Q; for (int i = 1; i &lt;= n; i++) for (int j = 1; j &lt;= n; j++) if (i == j) d[i][j] = 0; else d[i][j] = INF; while (m--) { int a, b, w; cin &gt;&gt; a &gt;&gt; b &gt;&gt; w; d[a][b] = min(d[a][b], w); } floyd(); while (Q--) { int a, b; cin &gt;&gt; a &gt;&gt; b; if (d[a][b]&gt;INF/2) cout &lt;&lt; &quot;impossible&quot; &lt;&lt; endl; else cout &lt;&lt;d[a][b]&lt;&lt;endl; } } é“¾æ¥ æœ€çŸ­è·¯ç®—æ³•æ¨¡ç‰ˆ ","tags":[{"name":"Algorithm","slug":"algorithm","used":true,"link":"https://blog.qxxiao.eu.org/tag/algorithm/"}],"title":"å›¾è®º-æœ€çŸ­è·¯é—®é¢˜","feature":"https://pic.qxxiao.cn/algorithm.png","link":"https://blog.qxxiao.eu.org/post/æœ€çŸ­è·¯é—®é¢˜/","stats":{"text":"13 min read","time":729000,"words":2542,"minutes":13},"date":"2023-03-15 17:35:00","dateFormat":"2023-03-15","isTop":false},{"content":"èƒŒåŒ…é—®é¢˜ https://www.cnblogs.com/jbelial/articles/2116074.html èƒŒåŒ…é—®é¢˜ 01 èƒŒåŒ…é—®é¢˜ å®Œå…¨èƒŒåŒ…é—®é¢˜ å¤šé‡èƒŒåŒ…é—®é¢˜ æ··åˆèƒŒåŒ…é—®é¢˜ äºŒç»´è´¹ç”¨çš„èƒŒåŒ…é—®é¢˜ åˆ†ç»„èƒŒåŒ…é—®é¢˜ æœ‰ä¾èµ–çš„èƒŒåŒ…é—®é¢˜ èƒŒåŒ…é—®é¢˜æ±‚æ–¹æ¡ˆæ•° æ±‚èƒŒåŒ…é—®é¢˜çš„æ–¹æ¡ˆ 01 èƒŒåŒ…é—®é¢˜ https://www.acwing.com/problem/content/2/ æœ‰ NNN ä»¶ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ VVV çš„èƒŒåŒ…ã€‚æ¯ä»¶ç‰©å“åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚ç¬¬ iii ä»¶ç‰©å“çš„ä½“ç§¯æ˜¯ viv_iviâ€‹ï¼Œä»·å€¼æ˜¯ wiw_iwiâ€‹ã€‚ æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿è¿™äº›ç‰©å“çš„æ€»ä½“ç§¯ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”æ€»ä»·å€¼æœ€å¤§ã€‚ è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚ æ³¨æ„çš„ç‚¹ï¼š ç©ºé—´ä¼˜åŒ–ï¼šä½¿ç”¨ä¸€ä¸ªä¸€ç»´æ•°ç»„å³å¯ï¼Œæ¯æ¬¡ä¿å­˜ä¸Šä¸€å±‚çš„è®¡ç®—ç»“æœï¼Œç„¶åä»åå¾€å‰è®¡ç®—(ä¿è¯é€»è¾‘ç­‰ä»·å³å¯)ã€‚ å¦‚æœè€ƒè™‘ä½“ç§¯æ°å¥½ç­‰äº VVV çš„æœ€å¤§ä»·å€¼ï¼Œåªéœ€è¦å°† f[0][0]f[0][0]f[0][0] åˆå§‹åŒ–ä¸º 0ï¼Œf[0][jâ‰ 0]f[0][j\\neq 0]f[0][jî€ â€‹=0] åˆå§‹åŒ–ä¸ºè´Ÿæ— ç©·ï¼Œä¿è¯å¦‚æœç»“æœä¸æ˜¯ä» f[0][0]f[0][0]f[0][0] é€’æ¨å‡ºæ¥çš„ä¸ºè´Ÿæ— ç©·ï¼Œæœ€ååˆ¤æ–­æœ€å¤§çš„ç»“æœ maxâ¡{f[n][m=0,1...n]}\\max\\{f[n][m=0,1...n]\\}max{f[n][m=0,1...n]} #include&lt;iostream&gt; using namespace std; const int N=1010; int v[N], w[N]; int f[N][N]; int main() { int n,m; cin&gt;&gt;n&gt;&gt;m; for(int i=1;i&lt;=n;i++) cin&gt;&gt;v[i]&gt;&gt;w[i]; for(int i=1; i&lt;=n; i++) { for(int j=1; j&lt;=m; j++) { f[i][j]=f[i-1][j]; if(j&gt;=v[i]) f[i][j] = max(f[i-1][j], f[i-1][j-v[i]]+w[i]); } } cout&lt;&lt;f[n][m]&lt;&lt;endl; } å®Œå…¨èƒŒåŒ…é—®é¢˜ https://www.acwing.com/problem/content/3/ æœ‰ NNN ç§ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ VVV çš„èƒŒåŒ…ï¼Œæ¯ç§ç‰©å“éƒ½æœ‰æ— é™ä»¶å¯ç”¨ã€‚ç¬¬ iii ç§ç‰©å“çš„ä½“ç§¯æ˜¯ viv_iviâ€‹ï¼Œä»·å€¼æ˜¯ wiw_iwiâ€‹ã€‚ æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿è¿™äº›ç‰©å“çš„æ€»ä½“ç§¯ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”æ€»ä»·å€¼æœ€å¤§ã€‚ è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚ ä¼˜åŒ–ç©ºé—´åŒ–çš„å½¢å¼ä¸ 01 èƒŒåŒ…ç›¸ä¼¼ï¼Œä½“ç§¯å¾ªç¯çš„æ–¹å‘ä»å°åˆ°å¤§ /** * 1. 01èƒŒåŒ… f[i][j]=max(f[i-1][j], f[i-1][j-v]+w); * 2. å®Œå…¨èƒŒåŒ… f[i][j]=max(f[i-1][j], f[i][j-v]+w); * */ #include&lt;iostream&gt; using namespace std; const int N=1010; int n,m; int v[N], w[N]; int f[N][N]; int main() { cin&gt;&gt;n&gt;&gt;m; for(int i=1;i&lt;=n;i++) cin&gt;&gt;v[i]&gt;&gt;w[i]; for(int i=1; i&lt;=n; i++) { for(int j=1; j&lt;=m; j++) { f[i][j] = f[i-1][j]; if(j&gt;=v[i]) f[i][j]=max(f[i][j], f[i][j-v[i]]+w[i]); } } cout&lt;&lt;f[n][m]&lt;&lt;endl; return 0; } å¤šé‡èƒŒåŒ…é—®é¢˜ https://www.acwing.com/problem/content/4/ æœ‰ NNN ç§ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ VVV çš„èƒŒåŒ…ã€‚ç¬¬ iii ç§ç‰©å“æœ€å¤šæœ‰ sis_isiâ€‹ ä»¶ï¼Œæ¯ä»¶ä½“ç§¯æ˜¯ viv_iviâ€‹ï¼Œä»·å€¼æ˜¯ wiw_iwiâ€‹ã€‚ æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿ç‰©å“ä½“ç§¯æ€»å’Œä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”ä»·å€¼æ€»å’Œæœ€å¤§ã€‚ è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚ ç‚¹å‡»æŸ¥çœ‹ä»£ç -ä¼˜åŒ–ç©ºé—´çš„å†™æ³• #include&lt;iostream&gt; using namespace std; const int N=110; int n,m; int f[N]; int main() { cin&gt;&gt;n&gt;&gt;m; for(int i=1; i&lt;=n; i++) { int v,w,s; cin&gt;&gt;v&gt;&gt;w&gt;&gt;s; // ä¼˜åŒ–åŒ01èƒŒåŒ… for(int j=m; j&gt;=0; j--) for(int k=1; k&lt;=s &amp;&amp; k*v &lt;=j; k++) f[j]=max(f[j], f[j-k*v]+k*w); } cout&lt;&lt;f[m]&lt;&lt;endl; return 0; } æ³¨æ„çš„ç‚¹ï¼š äºŒè¿›åˆ¶ä¼˜åŒ–æ–¹æ³•ï¼šå¦‚æœ SSS èŒƒå›´è¾ƒå¤§ï¼Œå¯ä»¥å°† SSS ç”¨ âŒŠlog2SâŒ‹+1\\lfloor{log_2S}\\rfloor+1âŒŠlog2â€‹SâŒ‹+1 ä¸ªæ•°æ¥è¡¨ç¤º (å³äºŒè¿›åˆ¶ 1,2,4...1,2,4...1,2,4... åˆ’åˆ†ï¼Œä½†æ˜¯ä¸èƒ½è¶…ç•Œ)ï¼Œç„¶åä½¿ç”¨ 01 èƒŒåŒ…é—®é¢˜æ±‚è§£ã€‚å¤æ‚åº¦ O(NVlnS)O(NVlnS)O(NVlnS) é¢˜ç›®å’Œä»£ç  å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–æ–¹æ³•ï¼šå°†å¾ªç¯çš„ä½“ç§¯åˆ†ä¸º vvv ç±»ï¼Œä½¿ç”¨å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ã€‚(ç®—æ³•é¢˜ä¸­ä½¿ç”¨ deque å¯èƒ½ä¼šå¡å¸¸æ•°ï¼Œä½¿ç”¨æ•°ç»„æ¨¡æ‹Ÿ) é¢˜ç›®å’Œä»£ç  å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–æ–¹æ³•ï¼š ä»£ç ï¼š #include&lt;iostream&gt; #include&lt;deque&gt; #include&lt;cstring&gt; using namespace std; const int N=20010; //V int n,m; int f[N], g[N]; // g[N]ä½œä¸ºæ»šåŠ¨æ•°ç»„ deque&lt;int&gt; q; int main() { cin&gt;&gt;n&gt;&gt;m; for(int i=0;i&lt;n;i++) { int v,w,s; cin&gt;&gt;v&gt;&gt;w&gt;&gt;s; memcpy(g, f, sizeof f); for(int j=0; j&lt;v; j++) //remain { //æ¯æ¬¡éœ€è¦é‡æ–°æ¸…ç©ºé˜Ÿåˆ— q.clear(); for(int k=j; k&lt;=m; k+=v) //éå†j j+v j+2v ...;çª—å£å¤§å°ä¸ºs { if(!q.empty() &amp;&amp; q.front()&lt;k-s*v) //å‰sä¸ª(ä¸åŒ…æ‹¬k) q.pop_front(); //å…ˆæ›´æ–°ç»“æœï¼Œf[k]ä¸è¯¥å…ƒç´ å‰sçª—å£å…ƒç´ çš„max if(!q.empty()) f[k]=max(f[k], g[q.front()]+(k-q.front())/v * w); //insert while(!q.empty() &amp;&amp; g[q.back()]-(q.back()-j)/v *w &lt;= g[k]-(k-j)/v *w) //while (hh &lt;= tt &amp;&amp; g[q[tt]] &lt;= g[k] - (k - q[tt]) / v * w) tt -- ; q.pop_back(); q.push_back(k); } } } cout&lt;&lt;f[m]&lt;&lt;endl; return 0; } æ··åˆèƒŒåŒ…é—®é¢˜ https://www.acwing.com/problem/content/7/ æœ‰ NNN ç§ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ VVV çš„èƒŒåŒ…ã€‚ç‰©å“ä¸€å…±æœ‰ä¸‰ç±»ï¼š ç¬¬ä¸€ç±»ç‰©å“åªèƒ½ç”¨ 1 æ¬¡ï¼ˆ01 èƒŒåŒ…ï¼‰ï¼› ç¬¬äºŒç±»ç‰©å“å¯ä»¥ç”¨æ— é™æ¬¡ï¼ˆå®Œå…¨èƒŒåŒ…ï¼‰ï¼› ç¬¬ä¸‰ç±»ç‰©å“æœ€å¤šåªèƒ½ç”¨ sis_isiâ€‹ æ¬¡ï¼ˆå¤šé‡èƒŒåŒ…ï¼‰ï¼› æ¯ç§ä½“ç§¯æ˜¯ viv_iviâ€‹ï¼Œä»·å€¼æ˜¯ wiw_iwiâ€‹ã€‚ æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿ç‰©å“ä½“ç§¯æ€»å’Œä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”ä»·å€¼æ€»å’Œæœ€å¤§ã€‚ è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚ åˆ©ç”¨äºŒè¿›åˆ¶ä¼˜åŒ–ï¼Œå…¨éƒ¨è½¬æ¢ä¸º 01 èƒŒåŒ…å’Œå®Œå…¨èƒŒåŒ…ï¼Œç„¶åæ±‚è§£æ¯ä¸€å±‚(åˆ—ä¸¾ç‰©å“) äºŒç»´è´¹ç”¨çš„èƒŒåŒ…é—®é¢˜ https://www.acwing.com/problem/content/8/ æœ‰ NNN ä»¶ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ VVV çš„èƒŒåŒ…ï¼ŒèƒŒåŒ…èƒ½æ‰¿å—çš„æœ€å¤§é‡é‡æ˜¯ MMMã€‚æ¯ä»¶ç‰©å“åªèƒ½ç”¨ä¸€æ¬¡ã€‚ä½“ç§¯æ˜¯ viv_iviâ€‹ï¼Œé‡é‡æ˜¯ mim_imiâ€‹ï¼Œä»·å€¼æ˜¯ wiw_iwiâ€‹ã€‚ æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿ç‰©å“æ€»ä½“ç§¯ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œæ€»é‡é‡ä¸è¶…è¿‡èƒŒåŒ…å¯æ‰¿å—çš„æœ€å¤§é‡é‡ï¼Œä¸”ä»·å€¼æ€»å’Œæœ€å¤§ã€‚ è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚ äºŒç»´è´¹ç”¨èƒŒåŒ…é—®é¢˜å°†é™åˆ¶æ‰©å±•ä¸ºä¸¤ç»´-ä½“ç§¯å’Œé‡é‡ï¼Œæ€è·¯å’Œ 01 èƒŒåŒ…ç›¸åŒï¼Œdp æ•°ç»„å¯ä»¥çœç•¥ä¸€ç»´ #include&lt;iostream&gt; using namespace std; const int N=110; int n,v,m; int f[N][N]; int main() { cin&gt;&gt;n&gt;&gt;v&gt;&gt;m; for(int i=0; i&lt;n; i++) { int a,b,c; cin&gt;&gt;a&gt;&gt;b&gt;&gt;c; for(int j=v; j&gt;=a; j--) for(int k=m; k&gt;=b; k--) f[j][k]=max(f[j][k], f[j-a][k-b]+c); } cout&lt;&lt;f[v][m]&lt;&lt;endl; return 0; } åˆ†ç»„èƒŒåŒ…é—®é¢˜ https://www.acwing.com/problem/content/9/ æœ‰ NNN ç»„ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ VVV çš„èƒŒåŒ…ã€‚æ¯ç»„ç‰©å“æœ‰è‹¥å¹²ä¸ªï¼ŒåŒä¸€ç»„å†…çš„ç‰©å“æœ€å¤šåªèƒ½é€‰ä¸€ä¸ªã€‚ æ¯ä»¶ç‰©å“çš„ä½“ç§¯æ˜¯ vijv_{ij}vijâ€‹ï¼Œä»·å€¼æ˜¯ wijw_{ij}wijâ€‹ï¼Œå…¶ä¸­ iii æ˜¯ç»„å·ï¼Œjjj æ˜¯ç»„å†…ç¼–å·ã€‚ æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿ç‰©å“æ€»ä½“ç§¯ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”æ€»ä»·å€¼æœ€å¤§ã€‚ è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚ æ€è·¯ä¸ 01 èƒŒåŒ…ä¸€æ · æœ‰ä¾èµ–çš„èƒŒåŒ…é—®é¢˜ https://www.acwing.com/problem/content/10/ æœ‰ NNN ä¸ªç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ VVV çš„èƒŒåŒ…ã€‚ç‰©å“ä¹‹é—´å…·æœ‰ä¾èµ–å…³ç³»ï¼Œä¸”ä¾èµ–å…³ç³»ç»„æˆä¸€æ£µæ ‘çš„å½¢çŠ¶ã€‚å¦‚æœé€‰æ‹©ä¸€ä¸ªç‰©å“ï¼Œåˆ™å¿…é¡»é€‰æ‹©å®ƒçš„çˆ¶èŠ‚ç‚¹ã€‚(ä¾èµ–å…³ç³»å½¢æˆä¸€é¢—æ ‘) æ¯ä»¶ç‰©å“çš„ç¼–å·æ˜¯ iiiï¼Œä½“ç§¯æ˜¯ viv_iviâ€‹ï¼Œä»·å€¼æ˜¯ wiw_iwiâ€‹ï¼Œä¾èµ–çš„çˆ¶èŠ‚ç‚¹ç¼–å·æ˜¯ pip_ipiâ€‹ã€‚ç‰©å“çš„ä¸‹æ ‡èŒƒå›´æ˜¯ 1â€¦N1â€¦N1â€¦Nã€‚æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿ç‰©å“æ€»ä½“ç§¯ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”æ€»ä»·å€¼æœ€å¤§ã€‚ è¾“å‡ºæœ€å¤§ä»·å€¼ã€‚ æ ‘å½¢ DP+åˆ†ç»„èƒŒåŒ…é—®é¢˜ #include&lt;iostream&gt; #include&lt;cstring&gt; using namespace std; const int N=110; int n,m; int h[N], e[N], ne[N], idx; int v[N], w[N], f[N][N]; void add(int a, int b) // add node(b) to head(a) { e[idx]=b, ne[idx]=h[a], h[a]=idx++; } void dfs(int u) { for(int i=h[u]; i!=-1; i=ne[i]) { int son=e[i]; dfs(son); // æ›´æ–°å­èŠ‚ç‚¹ for(int j=m-v[u]; j&gt;=0; j--) for(int k=0; k&lt;=j; k++) f[u][j]=max(f[u][j], f[u][j-k]+f[son][k]); } for(int i=m; i&gt;=v[u]; i--) // å®¹é‡å¤§äºç­‰äºæ ¹èŠ‚ç‚¹éœ€è¦åŠ ä¸Šæ ¹èŠ‚ç‚¹çš„ä»·å€¼ f[u][i]=f[u][i-v[u]]+w[u]; for(int i=0; i&lt;v[u];i++) // å®¹é‡å°äºæ ¹èŠ‚ç‚¹çš„æ€»ä»·å€¼ä¸º0 f[u][i]=0; } int main() { memset(h, -1, sizeof h); cin&gt;&gt;n&gt;&gt;m; int root; for(int i=1; i&lt;=n; i++) { int p; cin&gt;&gt;v[i]&gt;&gt;w[i]&gt;&gt;p; if(p==-1) root=i; else add(p, i); } dfs(root); cout&lt;&lt;f[root][m]&lt;&lt;endl; return 0; } èƒŒåŒ…é—®é¢˜æ±‚æ–¹æ¡ˆæ•° https://www.acwing.com/problem/content/11/ æ€è·¯åŒ 01 èƒŒåŒ… æ³¨æ„çš„ç‚¹ï¼š æ±‚æœ€å¤§ä»·å€¼çš„æ–¹æ¡ˆæ•°ï¼Œå°±æ˜¯æ±‚æ°å¥½è¾¾åˆ°æœ€å¤§ä»·å€¼çš„æ–¹æ¡ˆæ•°ï¼Œéœ€è¦å°†çŠ¶æ€ f[j]f[j]f[j] ç†è§£ä¸ºå‰ iii ä¸ªç‰©å“ä¸­ä½“ç§¯æ°å¥½æ˜¯ jjj çš„æœ€å¤§ä»·å€¼ï¼ˆåªéœ€è¦å°†åˆå§‹åŒ– f[j=0]=0,f[j&gt;=1]=âˆ’âˆf[j=0]=0, f[j&gt;=1]=- \\inftyf[j=0]=0,f[j&gt;=1]=âˆ’âˆï¼Œå³æ‰€æœ‰å…¶ä»–çŠ¶æ€éƒ½æ˜¯æœ‰ f[0]f[0]f[0] è½¬ç§»è€Œæ¥çš„ï¼‰ åŒæ—¶æ·»åŠ æ–¹æ¡ˆæ•°ç»„ g[j]g[j]g[j] è¡¨ç¤ºä½“ç§¯æ°å¥½æ˜¯ jjj çš„æœ€å¤§ä»·å€¼çš„æ–¹æ¡ˆæ•°ã€‚ï¼ˆæ ¹æ®é€’æ¨å…³ç³»å¾—åˆ°ï¼‰ for(int j=m; j&gt;=v; j--) { int t=max(f[j], f[j-v]+w); int s=0; if(t==f[j]) s+=g[j]; // æœ€å¤§ä»·å€¼è½¬ç§»è·¯å¾„1 if(t==f[j-v]+w) s+=g[j-v]; // æœ€å¤§ä»·å€¼è½¬ç§»è·¯å¾„2 if(s&gt;=mod) s-=mod; f[j]=t; g[j]=s; } æ³¨æ„æœ€åæœ€ä¼˜è§£æ˜¯æ‰€æœ‰ f[j]f[j]f[j] çš„æœ€å¤§ä»·å€¼ï¼ˆå› ä¸ºæœ€ä¼˜è§£éœ€è¦çš„ä½“ç§¯å¯èƒ½å°äºèƒŒåŒ…æ€»å®¹é‡ï¼Œè€Œä¸”å¯èƒ½æ˜¯ä¸åŒçš„ä½“ç§¯ï¼‰ æ±‚èƒŒåŒ…é—®é¢˜çš„æ–¹æ¡ˆ https://www.acwing.com/problem/content/12/ æœ‰ NNN ä»¶ç‰©å“å’Œä¸€ä¸ªå®¹é‡æ˜¯ VVV çš„èƒŒåŒ…ã€‚æ¯ä»¶ç‰©å“åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚ç¬¬ iii ä»¶ç‰©å“çš„ä½“ç§¯æ˜¯ viv_iviâ€‹ï¼Œä»·å€¼æ˜¯ wiw_iwiâ€‹ã€‚ æ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…ï¼Œå¯ä½¿è¿™äº›ç‰©å“çš„æ€»ä½“ç§¯ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œä¸”æ€»ä»·å€¼æœ€å¤§ã€‚ è¾“å‡º å­—å…¸åºæœ€å°çš„æ–¹æ¡ˆã€‚è¿™é‡Œçš„å­—å…¸åºæ˜¯æŒ‡ï¼šæ‰€é€‰ç‰©å“çš„ç¼–å·æ‰€æ„æˆçš„åºåˆ—ã€‚ç‰©å“çš„ç¼–å·èŒƒå›´æ˜¯ 1â€¦N1â€¦N1â€¦Nã€‚ æ³¨æ„ï¼š å­˜å‚¨å®Œæ•´çš„çŠ¶æ€ f[i][j]f[i][j]f[i][j] æ ¹æ®çŠ¶æ€æ¥ f[n][m]f[n][m]f[n][m] æ¥å€’æ¨é€‰æ‹©çš„ç‰©å“ ï¼ˆæ˜¯å¦é€‰æ‹©äº†ç¬¬ nnn ä»¶ï¼Œç¬¬ nâˆ’1n-1nâˆ’1 ä»¶ï¼Œâ€¦ï¼‰ // f[n][m] // if f[n][m] = f[n-1][m] ä¸é€‰ç¬¬nä»¶ç‰©å“ // if f[n][m] = f[n-1][m-v[n]]+w[n] é€‰ç¬¬nä»¶ç‰©å“ ç”±äºè¾“å‡ºå­—å…¸åºæœ€å°çš„æ–¹æ¡ˆï¼Œæ ¹æ®è´ªå¿ƒï¼Œéœ€è¦ä¼˜å…ˆé€‰æ‹©åºå·å°çš„ç‰©å“ï¼Œå€’æ¨éœ€è¦ä»ç¬¬ 1 ä»¶ç‰©å“å¼€å§‹ï¼› æ‰€ä»¥æ±‚è§£é—®é¢˜æ—¶ä» N...1N...1N...1 çš„é¡ºåºæ¥åˆ—ä¸¾ç‰©å“ï¼ˆå°† 1 å·ç‰©å“çœ‹æˆæœ€åä¸€ä¸ªï¼‰ï¼Œæœ€åä» f[1][m]f[1][m]f[1][m] æ ¹æ®è´ªå¿ƒæ¥å€’æ¨é€‰æ‹©çš„ç‰©å“ã€‚ ","tags":[{"name":"Algorithm","slug":"algorithm","used":true,"link":"https://blog.qxxiao.eu.org/tag/algorithm/"}],"title":"èƒŒåŒ…ä¹è®²","feature":"https://pic.qxxiao.cn/algorithm.png","link":"https://blog.qxxiao.eu.org/post/èƒŒåŒ…ä¹è®²/","stats":{"text":"13 min read","time":766000,"words":2790,"minutes":13},"date":"2023-03-10 19:44:59","dateFormat":"2023-03-10","isTop":false},{"content":" https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Iteration_protocols å¯è¿­ä»£åè®® å¯è¿­ä»£å¯¹è±¡ï¼šå¯¹è±¡å¿…é¡»å®ç° @@iterator æ–¹æ³•ï¼Œè¿™æ„å‘³ç€å¯¹è±¡ï¼ˆæˆ–è€…å®ƒåŸå‹é“¾ä¸Šçš„æŸä¸ªå¯¹è±¡ï¼‰å¿…é¡»æœ‰ä¸€ä¸ªé”®ä¸º @@iteratorçš„å±æ€§ï¼Œå¯é€šè¿‡å¸¸é‡ Symbol.iterator è®¿é—®è¯¥å±æ€§ã€‚å¯è¿­ä»£å¯¹è±¡å¯ä»¥ä½¿ç”¨ forâ€¦of ä¸­éå†ï¼Œä½¿ç”¨å±•å¼€è¯­æ³• â€¦object ï¼Œè§£æ„èµ‹å€¼ç­‰ [Symbol.iterator] ä¸€ä¸ªæ— å‚å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ æ­¤å‡½æ•°å¯ä»¥æ˜¯æ™®é€šå‡½æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯ç”Ÿæˆå™¨å‡½æ•° ä¸€ä¸ªå¯¹è±¡éœ€è¦è¢«è¿­ä»£ï¼Œé¦–å…ˆè°ƒç”¨å®ƒçš„ @@iteratoræ–¹æ³•ï¼Œç„¶åä½¿ç”¨æ­¤æ–¹æ³•è¿”å›çš„è¿­ä»£å™¨è·å¾—è¦è¿­ä»£çš„å€¼ è¿­ä»£å™¨ è¿­ä»£å™¨åè®®å®šä¹‰äº†äº§ç”Ÿä¸€ç³»åˆ—å€¼çš„æ ‡å‡†æ–¹å¼ã€‚ å®šä¹‰äº†ç‰¹å®šè¯­ä¹‰çš„ next()æ–¹æ³•ï¼Œè¯¥å¯¹è±¡æ‰èƒ½æˆä¸ºè¿­ä»£å™¨ï¼š è¿”å›ä¸€ä¸ªå¯¹è±¡ {done: boolean, value: any} ï¼Œdone ä¸º true æ—¶å±æ€§ value å¯çœç•¥; æ³¨æ„ï¼š ä¸èƒ½åˆ¤æ–­ä¸€ä¸ªç‰¹å®šçš„å¯¹è±¡æ˜¯å¦å®ç°äº†è¿­ä»£å™¨åè®® åˆ›å»ºåŒæ—¶æ»¡è¶³è¿­ä»£å™¨åè®®å’Œå¯è¿­ä»£åè®®æ˜¯å®¹æ˜“çš„ï¼Œä¾‹å¦‚ Map çš„ keys()/values()/entries() æ–¹æ³•è¿”å›çš„å¯¹è±¡. å› æ­¤ï¼Œè¿­ä»£å™¨ä¸€èˆ¬éƒ½ä¼šå®ç°å¯è¿­ä»£åè®®æˆä¸ºå¯è¿­ä»£å¯¹è±¡ï¼š var myIterator = { next: function() { // ... }, [Symbol.iterator]: function() { return this; } }; å†…ç½®å¯è¿­ä»£å¯¹è±¡ Stringã€Arrayã€TypedArrayã€Mapå’Œ Setï¼Œå®ƒä»¬çš„åŸå‹å¯¹è±¡éƒ½å®ç°äº† @@iteratoræ–¹æ³•ã€‚ ä¾‹å¦‚ï¼Œç®€å•çš„ map ç¤ºä¾‹ï¼š(åªæ˜¯ä¸ºäº†è¯´æ˜è¿­ä»£åŸç†ï¼Œéåº•å±‚å®ç°) CodeBlock Â· GitHubCodeBlock. GitHub Gist: instantly share code, notes, and snippets. https://gist.github.com/qxxiao/5ae665244881bb12564cf74785c1bcaf#file-js-mymap-md ç”Ÿæˆå™¨ ç”Ÿæˆå™¨å¯¹è±¡æ˜¯ç”±ä¸€ä¸ª generator function è¿”å›çš„ï¼Œå®ƒæ˜¯è¿­ä»£å™¨(nextæ–¹æ³•)ï¼Œä¹Ÿæ˜¯å¯è¿­ä»£å¯¹è±¡(@@iterator )ã€‚ function* å£°æ˜æ–¹å¼ï¼Œå®šä¹‰ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°ï¼Œå…¶è¿”å›ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ã€‚ æ‰§è¡Œæµç¨‹ï¼š next()æ–¹æ³•è¢«é¦–æ¬¡ï¼ˆåç»­ï¼‰è°ƒç”¨æ—¶ï¼Œå…¶å†…çš„è¯­å¥ä¼šæ‰§è¡Œåˆ°ç¬¬ä¸€ä¸ªï¼ˆåç»­ï¼‰å‡ºç°yieldçš„ä½ç½®ä¸ºæ­¢ï¼Œyield åç´§è·Ÿè¿­ä»£å™¨è¦è¿”å›çš„å€¼ã€‚ æˆ–è€…å¦‚æœç”¨çš„æ˜¯ yield*ï¼ˆå¤šäº†ä¸ªæ˜Ÿå·ï¼‰ï¼Œåˆ™è¡¨ç¤ºå°†æ‰§è¡Œæƒç§»äº¤ç»™å¦ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°ï¼› next()æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«ä¸¤ä¸ªå±æ€§ï¼švalue å’Œ doneï¼ˆè¿­ä»£å™¨è¯­ä¹‰ï¼‰ è°ƒç”¨ next()æ–¹æ³•æ—¶ï¼Œå¦‚æœä¼ å…¥äº†å‚æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°ä¼šä¼ ç»™ä¸Šä¸€æ¡æ‰§è¡Œçš„ yield è¯­å¥å·¦è¾¹çš„å˜é‡ æ³¨æ„ï¼šç”Ÿæˆå™¨å‡½æ•°ä¸­ return å¯ä»¥æå‰ç»“æŸç”Ÿæˆå™¨çš„çŠ¶æ€(nextè¿”å›çš„å¯¹è±¡ done:true)ï¼Œå¯ä»¥è¿”å›å€¼ã€‚è¿”å›çš„ç”Ÿæˆå™¨å¯¹è±¡ä¹Ÿå¯ä»¥è°ƒç”¨ return å‡½æ•°æå‰ç»“æŸã€‚ let aGeneratorObject = function* (){ yield 1; yield 2; yield 3; }(); // è¿”å›ç”Ÿæˆå™¨å¯¹è±¡ typeof aGeneratorObject.next; // è¿”å›&quot;function&quot;, å› ä¸ºæœ‰ä¸€ä¸ª next æ–¹æ³•ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ typeof aGeneratorObject[Symbol.iterator]; // è¿”å›&quot;function&quot;, å› ä¸ºæœ‰ä¸€ä¸ª @@iterator æ–¹æ³•ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ aGeneratorObject[Symbol.iterator]() === aGeneratorObject; // trueï¼Œå› ä¸º @@iterator æ–¹æ³•è¿”å›è‡ªèº«ï¼ˆå³è¿­ä»£å™¨ï¼‰ [...aGeneratorObject]; // è¿”å› [1, 2, 3] console.log(Symbol.iterator in aGeneratorObject) // true CodeBlock Â· GitHubCodeBlock. GitHub Gist: instantly share code, notes, and snippets. https://gist.github.com/qxxiao/5ae665244881bb12564cf74785c1bcaf#file-js-js å¼‚æ­¥å¯è¿­ä»£å¯¹è±¡ å¼‚æ­¥å¯è¿­ä»£å¯¹è±¡ï¼šå®šä¹‰äº† Symbol.asyncIterator å±æ€§ï¼Œå¯ç”¨äº for await...of å¾ªç¯ã€‚ (Symbol.asyncIterator æ˜¯ä¸€ä¸ªç”¨äºè®¿é—®å¯¹è±¡çš„@@asyncIterator æ–¹æ³•çš„å†…å»ºç¬¦å·) ä¸»è¦ä½œç”¨ï¼šè¿­ä»£è¿”å›å€¼çš„æ“ä½œæ˜¯å¼‚æ­¥æ“ä½œæ—¶ï¼Œä¼˜åŒ–æ€§èƒ½ã€‚ ä½¿ç”¨for await...of è¯­å¥åˆ›å»ºä¸€ä¸ªå¾ªç¯ï¼Œå¯éå†å¼‚æ­¥å¯è¿­ä»£å¯¹è±¡ï¼Œæ³¨æ„å®ƒä¹Ÿå¯ä»¥éå†ä¸Šé¢çš„åŒæ­¥å¯è¿­ä»£å¯¹è±¡(ç›¸å½“äºä½¿ç”¨ Promise.resolve(val)åŒ…è£…). åŒæ—¶å­˜åœ¨ï¼Œä¼˜å…ˆè¿­ä»£è¿”å›çš„å¼‚æ­¥è¿­ä»£å™¨å¯¹è±¡ã€‚ è‡ªå®šä¹‰å¼‚æ­¥å¯è¿­ä»£å¯¹è±¡ const myAsyncIterable = new Object(); myAsyncIterable[Symbol.asyncIterator] = async function*() { yield &quot;hello&quot;; yield &quot;async&quot;; yield &quot;iteration!&quot;; }; (async () =&gt; { for await (const x of myAsyncIterable) { console.log(x); // expected output: // &quot;hello&quot; // &quot;async&quot; // &quot;iteration!&quot; } })(); å¼‚æ­¥è¿­ä»£å™¨ï¼Œå¯ä»¥çœ‹ä½œæ¯æ¬¡è¿­ä»£è¿”å›çš„æ˜¯ä¸€ä¸ª promise å¯¹è±¡ã€‚ æ³¨æ„ï¼šasync å‡½æ•°è°ƒç”¨ï¼Œawait åé¢çš„è¡¨è¾¾å¼æ‰§è¡Œéƒ½æ˜¯åŒæ­¥æ“ä½œï¼Œåªæœ‰ await è¯­å¥åé¢çš„è¯­å¥å³å›è°ƒæ‰æ˜¯å¼‚æ­¥æ‰§è¡Œ(å¾®ä»»åŠ¡) ","tags":[{"name":"JavaScript","slug":"javascript","used":true,"link":"https://blog.qxxiao.eu.org/tag/javascript/"}],"title":"è¿­ä»£å™¨å’Œç”Ÿæˆå™¨","feature":"https://pic.qxxiao.cn/js-logo.png","link":"https://blog.qxxiao.eu.org/post/è¿­ä»£å™¨å’Œç”Ÿæˆå™¨/","stats":{"text":"5 min read","time":241000,"words":1026,"minutes":5},"date":"2022-11-23 00:57:00","dateFormat":"2022-11-23","isTop":false},{"content":" æ¥æºï¼šhttps://www.jianshu.com/p/992dfcecff34 githubï¼šhttps://github.com/imhuster/DynamicProxy/blob/master/src/main/java/com/iqts/MyProxy.java å½»åº•ç†è§£åŠ¨æ€ä»£ç† - ç®€ä¹¦æœ¬æ–‡ç¯‡å¹…æ¯”è¾ƒé•¿ï¼Œåœ¨ç¡®å®šæ‚¨æ˜¯å¦éœ€è¦ä»”ç»†é˜…è¯»æœ¬æ–‡å‰ï¼Œå¯ä»¥å…ˆæ€è€ƒä¸€ä¸‹ä¸‹é¢å‡ ä¸ªé—®é¢˜ï¼š åŠ¨æ€ä»£ç†æ˜¯ä»€ä¹ˆï¼Ÿ å¦‚ä½•å®ç°åŠ¨æ€ä»£ç†ï¼Ÿ æ‰€æœ‰ç±»éƒ½èƒ½å®ç°åŠ¨æ€ä»£ç†å—ï¼Ÿ éç›®æ ‡æ–¹æ³•æ˜¯å¦ä¼šè¢«ä»£ç†ï¼Ÿ ä¸ºä»€... https://www.jianshu.com/p/992dfcecff34 JDK åŠ¨æ€ä»£ç† å®ç°ï¼šåŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»çš„å­—èŠ‚ç (å†…å­˜ä¸­ []byte)ï¼ŒåŸç†æ˜¯ç»§æ‰¿Proxy ç±»ï¼Œå®ç°è¢«ä»£ç†ç±»çš„æ‰€æœ‰æ¥å£ç”ŸæˆåŠ¨æ€ä»£ç†ç±»ã€‚ ç”Ÿæˆçš„ä»£ç†ç±» // // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package proxy.jdk; import java.lang.reflect.InvocationHandler; import java.lang.reflect.Method; import java.lang.reflect.Proxy; import java.lang.reflect.UndeclaredThrowableException; final class $Proxy0 extends Proxy implements Subject { private static Method m1; private static Method m2; private static Method m3; private static Method m0; public $Proxy0(InvocationHandler var1) throws { super(var1); } public final boolean equals(Object var1) throws { try { return (Boolean)super.h.invoke(this, m1, new Object[]{var1}); } catch (RuntimeException | Error var3) { throw var3; } catch (Throwable var4) { throw new UndeclaredThrowableException(var4); } } public final String toString() throws { try { return (String)super.h.invoke(this, m2, (Object[])null); } catch (RuntimeException | Error var2) { throw var2; } catch (Throwable var3) { throw new UndeclaredThrowableException(var3); } } public final void doOperation() throws { try { super.h.invoke(this, m3, (Object[])null); } catch (RuntimeException | Error var2) { throw var2; } catch (Throwable var3) { throw new UndeclaredThrowableException(var3); } } public final int hashCode() throws { try { return (Integer)super.h.invoke(this, m0, (Object[])null); } catch (RuntimeException | Error var2) { throw var2; } catch (Throwable var3) { throw new UndeclaredThrowableException(var3); } } static { try { m1 = Class.forName(&quot;java.lang.Object&quot;).getMethod(&quot;equals&quot;, Class.forName(&quot;java.lang.Object&quot;)); m2 = Class.forName(&quot;java.lang.Object&quot;).getMethod(&quot;toString&quot;); m3 = Class.forName(&quot;proxy.jdk.Subject&quot;).getMethod(&quot;doOperation&quot;); m0 = Class.forName(&quot;java.lang.Object&quot;).getMethod(&quot;hashCode&quot;); } catch (NoSuchMethodException var2) { throw new NoSuchMethodError(var2.getMessage()); } catch (ClassNotFoundException var3) { throw new NoClassDefFoundError(var3.getMessage()); } } } é™¤äº†å®ç°äº†è¢«ä»£ç†ç±»æ‰€æœ‰æ¥å£ä¸­çš„æ–¹æ³•å¤–ï¼ŒJDK åŠ¨æ€ä»£ç†è¿˜é‡å†™äº† Object ç±»ä¸­çš„ hashCodeã€equalsã€toString ä¸‰ä¸ªæ–¹æ³•ã€‚ï¼ˆæ³¨æ„åœ¨ invoke æ–¹æ³•ä¸­åœ¨ä»£ç†ç±»ä¸Šè°ƒç”¨å®ƒä»¬ä¼šé€’å½’ï¼‰ ç»§æ‰¿çš„ Proxy ç±»æ‹¥æœ‰ InvocationHandler å­—æ®µï¼Œé€šè¿‡ä»£ç†ç±»çš„æ„é€ å™¨åˆå§‹åŒ–ï¼› é‡å†™çš„æ–¹æ³•ä¸­ï¼Œéƒ½ä¼šè½¬å‘è°ƒç”¨ super.h.invoke é—®é¢˜ï¼š ä¸ºä»€ä¹ˆ JDK å®ç°åŠ¨æ€ä»£ç†å¿…é¡»è¦æ±‚è¢«ä»£ç†ç±»å®ç°æ¥å£ï¼Ÿ åŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»éœ€è¦ç»§æ‰¿ Proxy ç±»ï¼Œè€Œ Java ä¸­åªèƒ½å•ç»§æ‰¿çš„é™åˆ¶ä½¿å¾—è¢«ä»£ç†ç±»å¿…é¡»å®ç°æ¥å£æ‰èƒ½å®ç°åŠ¨æ€ä»£ç† å¦‚æœè¢«ä»£ç†çš„ç±»æ²¡æœ‰å®ç°æ¥å£å°±æ— æ³•å®ç°åŠ¨æ€ä»£ç†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹å·¥å…·ã€‚ CGLib CGLib å¯ä»¥åœ¨è¿è¡ŒæœŸæ‰©å±• Java ç±»åŠå®ç°Javaæ¥å£ã€æä¾›æ–¹æ³•çš„æ‹¦æˆªï¼Œå› æ­¤è¢«ä¼—å¤š AOP æ¡†æ¶ä½¿ç”¨ã€‚CGLib åŒ…çš„åº•å±‚æ˜¯é€šè¿‡ä½¿ç”¨å­—èŠ‚ç å¤„ç†æ¡†æ¶ ASM æ¥è½¬æ¢å­—èŠ‚ç å¹¶ç”Ÿæˆæ–°çš„ç±»ã€‚ åŸç†ï¼šCGLib æ˜¯é€šè¿‡ç»§æ‰¿è¢«ä»£ç†ç±»å®ç°åŠ¨æ€ä»£ç†çš„ï¼Œè¿™ä¹Ÿå°±è¦æ±‚è¢«ä»£ç†çš„ç±»ä¸èƒ½æ˜¯ final ç±» ä»£ç†ç±» // // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package proxy.cglib; ... public class RealSubject$$EnhancerByCGLIB$$5fe030cf extends RealSubject implements Factory { private MethodInterceptor CGLIB$CALLBACK_0; private static final Method CGLIB$doOperation$0$Method; private static final MethodProxy CGLIB$doOperation$0$Proxy; ... static void CGLIB$STATICHOOK1() { CGLIB$THREAD_CALLBACKS = new ThreadLocal(); CGLIB$emptyArgs = new Object[0]; Class var0 = Class.forName(&quot;proxy.cglib.RealSubject$$EnhancerByCGLIB$$5fe030cf&quot;); Class var1; CGLIB$doOperation$0$Method = ReflectUtils.findMethods(new String[]{&quot;doOperation&quot;, &quot;()V&quot;}, (var1 = Class.forName(&quot;proxy.cglib.RealSubject&quot;)).getDeclaredMethods())[0]; CGLIB$doOperation$0$Proxy = MethodProxy.create(var1, var0, &quot;()V&quot;, &quot;doOperation&quot;, &quot;CGLIB$doOperation$0&quot;); ... } final void CGLIB$doOperation$0() { super.doOperation(); } public final void doOperation() { MethodInterceptor var10000 = this.CGLIB$CALLBACK_0; if (var10000 == null) { CGLIB$BIND_CALLBACKS(this); var10000 = this.CGLIB$CALLBACK_0; } if (var10000 != null) { var10000.intercept(this, CGLIB$doOperation$0$Method, CGLIB$emptyArgs, CGLIB$doOperation$0$Proxy); } else { super.doOperation(); } } ...... static { CGLIB$STATICHOOK1(); } } CGLib ä¸ä»…é‡å†™äº† Object ç±»çš„ hashCodeã€equalsã€toStringæ–¹æ³•ï¼Œè¿˜é‡å†™äº† clone æ–¹æ³•ã€‚ ä»£ç†çš„æ–¹æ³•éƒ½å¯¹åº”ä¸¤ä¸ªå…·ä½“çš„æ–¹æ³•ï¼Œä¾‹å¦‚ CGLIB$doOperation$0 å’Œ doOperation ï¼Œåè€…æ˜¯å¯¹è¢«ä»£ç†å¯¹è±¡çš„é‡å†™æ–¹æ³•ï¼Œå‰è€…æ˜¯è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ã€‚å› æ­¤åœ¨å®ç° MethodInterceptor æ¥å£çš„ intercept æ–¹æ³•ä¸­ï¼š methodProxy.invoke() æ˜¯å¯¹ doOperation æ–¹æ³•çš„è°ƒç”¨(å¯¹äºä»£ç†å¯¹è±¡ï¼Œå°±è°ƒç”¨è¯¥é‡å†™æ–¹æ³•ï¼Œå› æ­¤éœ€è¦æ³¨æ„é€’å½’è°ƒç”¨) methodProxy.invokeSuper() æ˜¯å¯¹ CGLIB$doOperation$0 æ–¹æ³•çš„è°ƒç”¨(å¿…é¡»æ˜¯ä»£ç†å¯¹è±¡ï¼Œè¯¥æ–¹æ³•ä»…è°ƒç”¨çˆ¶ç±»çš„ doOperation æ–¹æ³•ï¼Œå³ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•)ã€‚ ç”±äºæ˜¯ç»§æ‰¿å®ç°ï¼Œfinal æ–¹æ³•æ˜¯ä¸ä¼šä»£ç†çš„ï¼Œåªä¼šè°ƒç”¨çˆ¶ç±»çš„ final æ–¹æ³•ã€‚ CGLib å¯ä»¥ç›´æ¥ç”Ÿæˆæ¥å£çš„ä»£ç†å¯¹è±¡ï¼Œä»£ç†å¯¹é‡æ–°æ¥å£ä¸­çš„æ–¹æ³•ï¼Œç±»ä¼¼ JDK åŠ¨æ€ä»£ç†ï¼› ^26a5aa CGLib å¯ä»¥å®ç° MethodInterceptor æ¥å£ä¸ InvocationHandler æ¥å£(CGLibåŒ…ä¸­)ï¼Œä½¿ç”¨ InvocationHandler æ–¹å¼ä¸ JDK æ–¹å¼ç±»ä¼¼ï¼Œå¹¶ä¸”ä»£ç†çš„æ–¹æ³•åªå¯¹åº”ä¸€ä¸ªå…·ä½“çš„æ–¹æ³•(ä»£ç†ç±»å¯¹çˆ¶ç±»çš„é‡å†™æ–¹æ³•-åŒå)ã€‚ ","tags":[{"name":"Java","slug":"java","used":true,"link":"https://blog.qxxiao.eu.org/tag/java/"}],"title":"JavaåŠ¨æ€ä»£ç†","feature":"https://www.notion.so/images/page-cover/webb1.jpg","link":"https://blog.qxxiao.eu.org/post/JavaåŠ¨æ€ä»£ç†/","stats":{"text":"6 min read","time":318000,"words":1154,"minutes":6},"date":"2022-11-11 14:58:00","dateFormat":"2022-11-11","isTop":false},{"content":" å®˜æ–¹æ•™ç¨‹ï¼šhttps://cmake.org/cmake/help/latest/guide/tutorial/index.html ä¸€äº›æ€»ç»“ï¼šhttps://wangpengcheng.github.io/2019/08/13/learn_cmake/ åŸºç¡€ æœ€å°é…ç½®çš„ CMakeLists.txt # Set the minimum required version of CMake to be 3.10 cmake_minimum_required(VERSION 3.10) # Create a project named Tutorial project(Tutorial VERSION 1.0) # set(Tutorial_VERSION_MAJOR 1) # set(Tutorial_VERSION_MINOR 0) # Set the variable CMAKE_CXX_STANDARD to 11 set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_STANDARD_REQUIRED True) set(CMAKE_EXPORT_COMPILE_COMMANDS ON) # Add an executable called Tutorial to the project add_executable(Tutorial tutorial.cpp) å¦‚æœæ–‡ä»¶è¾ƒå¤šï¼Œaux_source_directory(. DIR_SRCS) å°†å½“å‰ç›®å½•æ‰€æœ‰æºæ–‡ä»¶çš„æ–‡ä»¶åèµ‹å€¼ç»™å˜é‡ DIR_SRCSï¼Œä½¿ç”¨ add_executable(Tutorial ${DIR_SRCS}) å¯é€‰ï¼šMacOS + gcc + clangd æœ€å°é…ç½® # Set the minimum required version of CMake to be 3.10 cmake_minimum_required(VERSION 3.10) # Create a project named Tutorial project(Tutorial VERSION 1.0) # set(Tutorial_VERSION_MAJOR 1) # set(Tutorial_VERSION_MINOR 0) # Set the variable CMAKE_CXX_STANDARD to 11 set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_STANDARD_REQUIRED True) set(CMAKE_EXPORT_COMPILE_COMMANDS ON) # set -isysroot for macOS # default to macOS [according to gcc version] if(APPLE) set(CMAKE_OSX_SYSROOT /Library/Developer/CommandLineTools/SDKs/MacOSX12.sdk) set(CMAKE_OSX_DEPLOYMENT_TARGET 12.0) # [according to gcc built for macos version] endif() # Add an executable called Tutorial to the project aux_source_directory(. DIR_SRCS) add_executable(Tutorial ${DIR_SRCS}) ç”Ÿæˆlibå¹¶å¯é€‰ä½¿ç”¨ ç”Ÿæˆlibï¼Œå¹¶åœ¨é¡¹ç›®ä¸­å¯é€‰åœ°ä½¿ç”¨ é¡¹ç›®ä¸­ä¼šç”Ÿæˆ lib åº“æ–‡ä»¶ï¼Œå¹¶åœ¨å…¶ä»–éƒ¨åˆ†å¯é€‰çš„é“¾æ¥ä½¿ç”¨è¯¥åº“ cmake_minimum_required(VERSION 3.10) # set the project name and version project(Tutorial VERSION 1.0) # specify the C++ standard set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_STANDARD_REQUIRED True) set(CMAKE_EXPORT_COMPILE_COMMANDS ON) option(USE_MYMATH &quot;Use tutorial provided math implementation&quot; ON) configure_file(TutorialConfig.h.in TutorialConfig.h) if(USE_MYMATH) add_subdirectory(MathFunctions) # å­ç›®å½•ä¼šç”Ÿæˆ MathFunctions lib list(APPEND EXTRA_LIBS MathFunctions) list(APPEND EXTRA_INCLUDES &quot;${PROJECT_SOURCE_DIR}/MathFunctions&quot;) endif() # add the executable add_executable(Tutorial tutorial.cxx) target_link_libraries(Tutorial PUBLIC ${EXTRA_LIBS}) target_include_directories(Tutorial PUBLIC &quot;${PROJECT_BINARY_DIR}&quot; ${EXTRA_INCLUDES}) ä½¿ç”¨ option å‘½ä»¤ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªbooleanå˜é‡ ä½¿ç”¨ configure_file å‘½ä»¤ï¼Œå°†é…ç½®å¤´æ–‡ä»¶ï¼Œç»è¿‡å˜é‡æ›¿æ¢ç”ŸæˆC++ header file: @var@ å˜é‡ï¼Œä½¿ç”¨ CMakeLists.txt ä¸­å®šä¹‰ä¸ªå˜é‡è¿›è¡Œæ›¿æ¢ï¼› #cmakedefine æ›¿æ¢ä¸º #define ï¼Œå¦‚æœåé¢å®šä¹‰çš„booleanå˜é‡æ˜¯ ON åˆ™è¿›è¡Œæ›¿æ¢ ç”Ÿæˆçš„å¤´æ–‡ä»¶æ”¾ç½®åœ¨ ${PROJECT_BINARY_DIR} ç›®å½•ï¼Œå³ cmake çš„ build ç›®å½• ä½¿ç”¨ if() æ¥æ§åˆ¶æ·»åŠ  lib ç”Ÿæˆï¼Œå®šä¹‰ EXTRA_LIBS åˆ—è¡¨ï¼ŒEXTRA_INCLUDES åˆ—è¡¨ï¼Œé»˜è®¤ä¸ºç©º ä½¿ç”¨ target_link_libraries å¯¹ target é“¾æ¥æŒ‡å®šçš„åº“ ä½¿ç”¨ target_include_directories å¯¹ target æ·»åŠ æŒ‡å®šçš„å¤´æ–‡ä»¶ç›®å½• è¯´æ˜ï¼šå¯ä»¥åœ¨é…ç½®é¡¹ç›®æ—¶ï¼ŒæŒ‡å®š cmake .. -DUSE_MYMATH=OFF æ¥è¦†ç›–å®šä¹‰çš„å€¼ ç”Ÿæˆlibå¹¶å¯é€‰ä½¿ç”¨(INTERFACE) å¯¹ä¸Šä¸€ä¸ª cmake æ”¹è¿›ï¼Œä¹‹å‰çš„åšæ³•éœ€è¦é“¾æ¥ lib åº“æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨ä¸Šå±‚ä¸­éœ€è¦æ˜¾ç¤ºçš„æŒ‡å®šåº“å¯¹åº”çš„ include å¤´æ–‡ä»¶ç›®å½•ï¼Œéå¸¸ç¹çã€‚ é€šè¿‡ Usage Requirements æ¥æ§åˆ¶åº“åœ¨é“¾æ¥æ—¶çš„ä¼ é€’å±æ€§ï¼Œä½¿ç”¨ INTERFACE æ¥è¡¨è¾¾è¯¥è¯­ä¹‰ï¼šä»»æ„é“¾æ¥è¯¥åº“ target å¿…é¡» include å½“å‰/æŒ‡å®šçš„æºç›®å½•(ç”¨äºæœç´¢å¤´æ–‡ä»¶)ã€‚INTERFACE è¡¨ç¤ºæ¶ˆè´¹è€…éœ€è¦ï¼Œä½†æ˜¯ç”Ÿäº§è€…ä¸éœ€è¦ã€‚(å¯¹äºåº“è€Œè¨€ï¼Œç”Ÿæˆçš„ lib target ä¸éœ€è¦ï¼Œä½†æ˜¯éœ€è¦é“¾æ¥è¯¥åº“çš„ target å¿…é¡»åŒ…å«æŒ‡å®šçš„ç›®å½•) å­ç›®å½•ç”Ÿæˆ lib å¹¶æŒ‡å®š Usage Requirements çš„ CMakeLists.txt ï¼š add_library(MathFunctions mysqrt.cxx) # Hint: Use target_include_directories with the INTERFACE keyword # å°½ç®¡ MathFunctions åº“ä¸éœ€è¦åŒ…å«å½“å‰æºç›®å½•ï¼Œä½†æ˜¯ä»»ä½•é“¾æ¥åˆ° MathFunctions çš„åº“éƒ½éœ€è¦åŒ…å«å½“å‰æºç›®å½• target_include_directories(MathFunctions INTERFACE ${CMAKE_CURRENT_SOURCE_DIR}) top-level CMakeLists.txt ï¼š cmake_minimum_required(VERSION 3.10) # set the project name and version project(Tutorial VERSION 1.0) # specify the C++ standard set(CMAKE_CXX_STANDARD 11) set(CMAKE_CXX_STANDARD_REQUIRED True) set(CMAKE_EXPORT_COMPILE_COMMANDS ON) # should we use our own math functions option(USE_MYMATH &quot;Use tutorial provided math implementation&quot; ON) # configure a header file to pass some of the CMake settings # to the source code configure_file(TutorialConfig.h.in TutorialConfig.h) # add the MathFunctions library if(USE_MYMATH) add_subdirectory(MathFunctions) list(APPEND EXTRA_LIBS MathFunctions) endif() # add the executable add_executable(Tutorial tutorial.cxx) target_link_libraries(Tutorial PUBLIC ${EXTRA_LIBS}) # find TutorialConfig.h target_include_directories(Tutorial PUBLIC &quot;${PROJECT_BINARY_DIR}&quot;) ä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼ https://cmake.org/cmake/help/latest/manual/cmake-generator-expressions.7.html#manual:cmake-generator-expressions(7) ç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼Œä¸»è¦å¯ä»¥ç”Ÿæˆå¤æ‚çš„æ¡ä»¶è¡¨è¾¾å¼ï¼Œç”¨äºæ¡ä»¶ç¼–è¯‘ï¼Œæ¡ä»¶é“¾æ¥ç­‰ç­‰ã€‚ ä¾‹å¦‚ï¼Œä½¿ç”¨ä¸€ä¸ª interface library æ¥æŒ‡å®šç¼–è¯‘é€‰é¡¹ï¼Œä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼å¯¹ä¸åŒçš„ç¼–è¯‘å™¨é€‰æ‹©ä¸åŒçš„ç¼–è¯‘é€‰é¡¹ï¼š cmake_minimum_required(VERSION 3.15) # set the project name and version project(Tutorial VERSION 1.0) set(CMAKE_EXPORT_COMPILE_COMMANDS ON) # * Creating an interface library called tutorial_compiler_flags add_library(tutorial_compiler_flags INTERFACE) target_compile_features(tutorial_compiler_flags INTERFACE cxx_std_11) # Create helper variables to determine which compiler we are using set(gcc_like_cxx &quot;$&lt;COMPILE_LANG_AND_ID:CXX,ARMClang,AppleClang,Clang,GNU,LCC&gt;&quot;) set(msvc_cxx &quot;$&lt;COMPILE_LANG_AND_ID:CXX,MSVC&gt;&quot;) # With nested generator expressions, only use the flags for the build-tree target_compile_options(tutorial_compiler_flags INTERFACE &quot;$&lt;${gcc_like_cxx}:$&lt;BUILD_INTERFACE:-Wall;-Wextra;-Wshadow;-Wformat=2;-Wunused&gt;&gt;&quot; &quot;$&lt;${msvc_cxx}:$&lt;BUILD_INTERFACE:-W3&gt;&gt;&quot; ) # should we use our own math functions option(USE_MYMATH &quot;Use tutorial provided math implementation&quot; ON) configure_file(TutorialConfig.h.in TutorialConfig.h) # add the MathFunctions library if(USE_MYMATH) add_subdirectory(MathFunctions) list(APPEND EXTRA_LIBS MathFunctions) endif() # add the executable add_executable(Tutorial tutorial.cxx) # Link to tutorial_compiler_flags target_link_libraries(Tutorial PUBLIC tutorial_compiler_flags ${EXTRA_LIBS}) target_include_directories(Tutorial PUBLIC &quot;${PROJECT_BINARY_DIR}&quot;) ä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼ŒæŒ‡å®š cmake æœ€å°ç‰ˆæœ¬ä¸º 3.15 ä½¿ç”¨ INTERFACE æ¥åˆ›å»ºä¸€ä¸ªæ¥å£åº“ï¼Œç”¨äºä¼ é€’/æŒ‡å®š Usage Requirements è¡¨è¾¾å¼ï¼š $&lt;COMPILE_LANG_AND_ID:CXX,...&gt; å¦‚æœç¼–è¯‘å•å…ƒçš„è¯­è¨€æ˜¯CXXï¼Œå¹¶ä¸”ç¼–è¯‘å™¨IDä¸åé¢ä¹‹ä¸€åŒ¹é…ï¼Œè¡¨è¾¾å¼ä¸º1å¦åˆ™ä¸º0 $&lt;BUILD_INTERFACE: STRING&gt; åœ¨ç›¸åŒbuildä¸ºSTRINGï¼Œå¦åˆ™ä¸ºç©ºï¼›ä¸Šé¢çš„ç›®çš„æ˜¯ï¼šä¸ºäº†ä½¿å¾—æˆ‘ä»¬ installed project çš„å…¶ä»–æ¶ˆè´¹è€…ä¸ä¼šç»§æ‰¿ç¼–è¯‘é€‰é¡¹ï¼› install and test å®‰è£… executable | lib | headers set(installable_libs MathFunctions tutorial_compiler_flags) install(TARGETS ${installable_libs} DESTINATION lib) install(FILES MathFunctions.h DESTINATION include/MathFunc) # bin file install(TARGETS Tutorial DESTINATION bin) æ„å»ºå’Œå®‰è£…ï¼š cmake --build . cmake --install . --prefix &quot;/home/myuser/installdir&quot; # æœ‰é»˜è®¤çš„ä½ç½®ï¼Œä¾‹å¦‚ /usr/local æˆ–è€… cmake --build . --target install ç®€å•çš„æµ‹è¯•æ ·ä¾‹ # enable testing enable_testing() # basic test, return value is zero add_test(NAME Runs COMMAND Tutorial 25) # verify that the output of the test contains certain strings. add_test(NAME Correctness COMMAND Tutorial 4 ) set_tests_properties(Correctness PROPERTIES PASS_REGULAR_EXPRESSION &quot;4 is 2&quot;) # å®šä¹‰å‡½æ•° do_test æ·»åŠ å¤šä¸ªæµ‹è¯• function(do_test target arg result) add_test(NAME Comp${arg} COMMAND ${target} ${arg}) set_tests_properties(Comp${arg} PROPERTIES PASS_REGULAR_EXPRESSION ${result} ) endfunction() # do a bunch of result based tests do_test(Tutorial 4 &quot;4 is 2&quot;) do_test(Tutorial 9 &quot;9 is 3&quot;) do_test(Tutorial 5 &quot;5 is 2.236&quot;) do_test(Tutorial 7 &quot;7 is 2.645&quot;) do_test(Tutorial 25 &quot;25 is 5&quot;) do_test(Tutorial -25 &quot;-25 is (-nan|nan|0)&quot;) do_test(Tutorial 0.0001 &quot;0.0001 is 0.01&quot;) æ„å»ºå®Œæˆåï¼Œä½¿ç”¨ ctest -VV è¿›è¡Œæµ‹è¯• æ·»åŠ ç³»ç»Ÿæ£€æŸ¥ ä¾‹å¦‚æµ‹è¯•ç³»ç»Ÿæ˜¯å¦æ”¯æŒæŸä¸ªåº“/å‡½æ•°ï¼š # does this system provide the log and exp functions? include(CheckCXXSourceCompiles) check_cxx_source_compiles(&quot; #include &lt;cmath&gt; int main() { std::log(1.0); return 0; } &quot; HAVE_LOG) check_cxx_source_compiles(&quot; #include &lt;cmath&gt; int main() { std::exp(1.0); return 0; } &quot; HAVE_EXP) if(HAVE_LOG AND HAVE_EXP) target_compile_definitions(MathFunctions PRIVATE &quot;HAVE_LOG&quot; &quot;HAVE_EXP&quot;) endif() æ ¹æ®æµ‹è¯•ç»“æœï¼Œæ·»åŠ ç¼–è¯‘å®šä¹‰ target_compile_definitions() å…¶æœ€ç»ˆæŒ‡ä»¤ç»“æœï¼šg++ -DHAVE_EXP -DHAVE_LOG æ·»åŠ è‡ªå®šä¹‰å‘½ä»¤ åœ¨buildå¼€å§‹å¯ä»¥å…ˆç”Ÿæˆ outputï¼Œç”¨äºåç»­çš„ target build: add_executable(MakeTable MakeTable.cxx) # add a custom command that specifies how to produce Table.h by running MakeTable. add_custom_command( OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/Table.h COMMAND MakeTable ${CMAKE_CURRENT_BINARY_DIR}/Table.h DEPENDS MakeTable ) build ä¼šå…ˆæŒ‡å®šè‡ªå®šä¹‰å‘½ä»¤ä¸­çš„æŒ‡å®šï¼Œç”Ÿæˆ output æ–‡ä»¶ï¼Œåœ¨ cmake --build . æ‰§è¡Œ ã€è¯´æ˜ï¼šåœ¨æŒ‡å®š add_library ç­‰ï¼Œå¯ä»¥æŒ‡å®šä¾èµ–çš„å¤´æ–‡ä»¶ç”¨äºè¯´æ˜æ„å»ºçš„ä¾èµ–å…³ç³»ã€‘ æ‰“åŒ…ç¨‹åº ä½¿ç”¨ CPack å°†ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œåº“å’Œå¤´æ–‡ä»¶æ‰“åŒ…æˆå‹ç¼©æ–‡ä»¶ï¼Œå¹¶ç”Ÿæˆç®€æ˜“çš„æå–å®‰è£…è„šæœ¬ã€‚ # è¯¥æ¨¡å—å°†åŒ…æ‹¬å½“å‰å¹³å°é¡¹ç›®æ‰€éœ€çš„ä»»ä½•è¿è¡Œæ—¶åº“ include(InstallRequiredSystemLibraries) set(CPACK_RESOURCE_FILE_LICENSE &quot;${CMAKE_CURRENT_SOURCE_DIR}/License.txt&quot;) set(CPACK_PACKAGE_VERSION_MAJOR &quot;${Tutorial_VERSION_MAJOR}&quot;) set(CPACK_PACKAGE_VERSION_MINOR &quot;${Tutorial_VERSION_MINOR}&quot;) set(CPACK_SOURCE_GENERATOR &quot;TGZ&quot;) # selects a file format for the source package include(CPack) æ„å»º build åï¼Œä½¿ç”¨ cpack æ‰“åŒ…å³å¯ï¼Œä¸»è¦å·¥ä½œï¼š å¯¼å…¥ InstallRequiredSystemLibraries æ¨¡å—ï¼Œä»¥ä¾¿ä¹‹åå¯¼å…¥ CPack æ¨¡å—ï¼› è®¾ç½®ä¸€äº› CPack ç›¸å…³å˜é‡ï¼ŒåŒ…æ‹¬ç‰ˆæƒä¿¡æ¯ï¼Œç‰ˆæœ¬ä¿¡æ¯ï¼Œå‹ç¼©æ ¼å¼ï¼› å¯¼å…¥ CPack æ¨¡å—ã€‚ æ·»åŠ å¯¼å‡ºé…ç½® https://cmake.org/cmake/help/latest/guide/tutorial/Adding Export Configuration.html#cmakelists-txt-install-export ä¾¿äºå…¶ä»– CMake é¡¹ç›®å¯ä»¥å¤ç”¨æˆ‘ä»¬çš„é¡¹ç›®ï¼Œæ— è®ºæ˜¯é€šè¿‡æˆ‘ä»¬çš„æ„å»ºç›®å½•ã€æœ¬åœ°å®‰è£…è¿˜æ˜¯æ‰“åŒ…æ—¶ã€‚ è¡Œä¸ºï¼šåœ¨æ„å»ºç›®å½•buildï¼Œæœ¬åœ°å®‰è£…(/usr/local/lib/cmake)æˆ–è€…åœ¨æ‰“åŒ…çš„æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆcmakeé…ç½®æ–‡ä»¶ã€‚ å¥½å¤„ï¼šä¸ç”¨ç‰¹åˆ«æŒ‡å®šé¡¹ç›®/åº“çš„ç›¸å…³ include/lib è·¯å¾„ï¼Œæ–¹ä¾¿ä½¿ç”¨ï¼ˆæŒ‡å®š package ç›®å½•ï¼‰ ç”Ÿæˆçš„æ–‡ä»¶ï¼š xxx.cmake ç›®æ ‡ä¿¡æ¯ xxxConfig.cmake é€šè¿‡ Config.cmake.in æ–‡ä»¶ç”Ÿæˆï¼Œä»¥ä¾¿ CMake **find_package()**å‘½ä»¤å¯ä»¥æ‰¾åˆ°è¯¥é¡¹ç›®(ç”¨äºä¿®æ”¹åŒ…çš„ PREFIX_DIR è·¯å¾„) xxxConfigVersion.cmake è®°å½•è½¯ä»¶åŒ…çš„ç‰ˆæœ¬å’Œå…¼å®¹æ€§ ä½¿ç”¨packageï¼Œä¾‹å¦‚æ‰“åŒ…åçš„ç›®å½•ä¸ºï¼š Tutorial-1.0-Darwin â”œâ”€â”€ bin â”‚ â””â”€â”€ Tutorial â”œâ”€â”€ include â”‚ â”œâ”€â”€ MathFunctions.h â”‚ â””â”€â”€ TutorialConfig.h â””â”€â”€ lib â”œâ”€â”€ cmake â”‚ â””â”€â”€ MathFunctions â”‚ â”œâ”€â”€ MathFunctionsConfig.cmake â”‚ â”œâ”€â”€ MathFunctionsConfigVersion.cmake â”‚ â”œâ”€â”€ MathFunctionsTargets-noconfig.cmake â”‚ â””â”€â”€ MathFunctionsTargets.cmake â”œâ”€â”€ libMathFunctions.dylib â””â”€â”€ libSqrtLibrary.a ä½¿ç”¨éå¸¸æ–¹ä¾¿ï¼š list(APPEND CMAKE_PREFIX_PATH &quot;${PROJECT_SOURCE_DIR}/Tutorial-1.0-Darwin&quot;) find_package(MathFunctions REQUIRED) # add the executable add_executable(Tutorial tutorial.cxx) target_link_libraries(Tutorial PUBLIC MathFunctions) # no namespace ä½¿ç”¨ INTERFACE è‡ªåŠ¨åŒ…å«é“¾æ¥åº“çš„å¤´æ–‡ä»¶ç›®å½• ","tags":[{"name":"CMake","slug":"cmake","used":true,"link":"https://blog.qxxiao.eu.org/tag/cmake/"}],"title":"cmakeç¤ºä¾‹","feature":"https://pic.qxxiao.cn/20221031044602.png","link":"https://blog.qxxiao.eu.org/post/cmakeç¤ºä¾‹/","stats":{"text":"10 min read","time":593000,"words":2060,"minutes":10},"date":"2022-10-29 12:23:00","dateFormat":"2022-10-29","isTop":false},{"content":" libcurlï¼šé«˜å¯ç§»æ¤ã€åŠŸèƒ½ä¸°å¯Œçš„é€šä¿¡åº“ cprï¼šæ›´ç°ä»£ã€æ›´æ˜“ç”¨çš„é€šä¿¡åº“ å®‰è£… ZMQï¼šé«˜æ•ˆã€å¤šåŠŸèƒ½çš„é€šä¿¡åº“ sockpp å°ç»“ è½¬è½½å’Œæ¥æºäºï¼šç½—å‰‘é”‹çš„ C++ å®æˆ˜ç¬”è®° libcurlï¼šé«˜å¯ç§»æ¤ã€åŠŸèƒ½ä¸°å¯Œçš„é€šä¿¡åº“ libcurlï¼Œæ¥æºäºè‘—åçš„curl é¡¹ç›®ï¼Œä¹Ÿæ˜¯ curl çš„åº•å±‚æ ¸å¿ƒã€‚ å®ƒæœ€æ—©åªæ”¯æŒ HTTP åè®®ï¼Œä½†ç°åœ¨å·²ç»æ‰©å±•åˆ°æ”¯æŒæ‰€æœ‰çš„åº”ç”¨å±‚åè®®ï¼Œæ¯”å¦‚ HTTPSã€FTPã€LDAPã€SMTP ç­‰ï¼ŒåŠŸèƒ½å¼ºå¤§ã€‚ libcurl ä½¿ç”¨çº¯ C è¯­è¨€å¼€å‘ï¼Œå…¼å®¹æ€§ã€å¯ç§»æ¤æ€§éå¸¸å¥½ï¼ŒåŸºäº C æ¥å£å¯ä»¥å¾ˆå®¹æ˜“å†™å‡ºå„ç§è¯­è¨€çš„å°è£…ï¼Œæ‰€ä»¥ Pythonã€PHP ç­‰è¯­è¨€éƒ½æœ‰ libcurl ç›¸å…³çš„åº“ã€‚ ubuntu ä¸‹å®‰è£…ï¼š apt-get install libcurl4-openssl-dev libcurl çš„æ¥å£å¯ä»¥ç²—ç•¥åœ°åˆ†æˆä¸¤å¤§ç±»ï¼šeasy ç³»åˆ—å’Œ multi ç³»åˆ—ã€‚å…¶ä¸­ï¼Œeasy ç³»åˆ—æ˜¯åŒæ­¥è°ƒç”¨ï¼Œæ¯”è¾ƒç®€å•ï¼›multi ç³»åˆ—æ˜¯å¼‚æ­¥çš„å¤šçº¿ç¨‹è°ƒç”¨ã€‚ ä½¿ç”¨ libcurl æ”¶å‘ HTTP æ•°æ®çš„åŸºæœ¬æ­¥éª¤æœ‰ 4 ä¸ªï¼š ä½¿ç”¨ curl_easy_init() åˆ›å»ºä¸€ä¸ªå¥æŸ„ï¼Œç±»å‹æ˜¯ CURL*ã€‚ä½†æˆ‘ä»¬å®Œå…¨æ²¡æœ‰å¿…è¦å…³å¿ƒå¥æŸ„çš„ç±»å‹ï¼Œç›´æ¥ç”¨ auto æ¨å¯¼å°±è¡Œã€‚ ä½¿ç”¨ curl_easy_setopt() è®¾ç½®è¯·æ±‚çš„å„ç§å‚æ•°ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•ã€URLã€header/body æ•°æ®ã€è¶…æ—¶ã€å›è°ƒå‡½æ•°ç­‰ã€‚è¿™æ˜¯æœ€å…³é”®çš„æ“ä½œã€‚ ä½¿ç”¨ curl_easy_perform() å‘é€æ•°æ®ï¼Œè¿”å›çš„æ•°æ®ä¼šç”±å›è°ƒå‡½æ•°å¤„ç†ã€‚ ä½¿ç”¨ curl_easy_cleanup() æ¸…ç†å¥æŸ„ç›¸å…³çš„èµ„æºï¼Œç»“æŸä¼šè¯ã€‚ Codeç¤ºä¾‹ #include &lt;assert.h&gt; #include &lt;curl/curl.h&gt; #include &lt;iostream&gt; using namespace std; // å›è°ƒå‡½æ•°çš„åŸå‹ // å›è°ƒä¼šè¢«å¤šæ¬¡è°ƒç”¨ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½ä¼šä¼ é€’ä¸€å—æ•°æ®;ptræŒ‡å‘ä¼ é€’çš„æ•°æ®ï¼Œè¯¥æ•°æ®çš„å¤§å°ä¸ºnmembï¼›sizeå§‹ç»ˆä¸º1 // size * nmemb æ˜¯ç¼“å†²åŒºçš„å¤§å° // ptr æ˜¯ç¼“å†²åŒºçš„åœ°å€ // userdata æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„æ•°æ® size_t write_callback(char*, size_t, size_t, void*); int main() { auto curl = curl_easy_init(); // åˆ›å»ºCURLå¥æŸ„ assert(curl); curl_easy_setopt(curl, CURLOPT_URL, &quot;http://nginx.org&quot;); // è®¾ç½®è¯·æ±‚URI // é¿å…ä»£ç†è®¾ç½®ä¸ºé•¿è¿æ¥ Proxy-Connection:closeæˆ–è€…ä¸ä½¿ç”¨ä»£ç† curl_easy_setopt(curl, CURLOPT_PROXY, &quot;&quot;); curl_easy_setopt(curl, CURLOPT_VERBOSE, 1L); // æ²¡æœ‰è®¾ç½®å›è°ƒå‡½æ•°æ—¶ï¼Œå†…éƒ¨çš„é»˜è®¤å›è°ƒï¼ŒæŠŠå¾—åˆ°çš„ HTTP å“åº”æ•°æ®è¾“å‡ºåˆ°æ ‡å‡†æµ // c++11, æ— æ•è·çš„ lambda è¡¨è¾¾å¼å¯ä»¥æ˜¾å¼è½¬æ¢æˆä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ=&gt;Cä½¿ç”¨ curl_easy_setopt( curl, CURLOPT_WRITEFUNCTION, // è®¾ç½®å›è°ƒå‡½æ•° (decltype(&amp;write_callback)) // decltypeè·å–å‡½æ•°æŒ‡é’ˆç±»å‹ï¼Œæ˜¾å¼è½¬æ¢ [](char* ptr, size_t size, size_t nmemb, void* userdata) { cout &lt;&lt; &quot;size = &quot; &lt;&lt; size &lt;&lt; &quot;*&quot; &lt;&lt; nmemb &lt;&lt; &quot;=&quot; &lt;&lt; size * nmemb &lt;&lt; endl; // ç®€å•çš„å¤„ç† return size * nmemb; // è¿”å›æ¥æ”¶çš„å­—èŠ‚æ•° }); auto res = curl_easy_perform(curl); // å‘é€æ•°æ® if (res != CURLE_OK) { // æ£€æŸ¥æ˜¯å¦æ‰§è¡ŒæˆåŠŸ cout &lt;&lt; curl_easy_strerror(res) &lt;&lt; endl; } curl_easy_cleanup(curl); // æ¸…ç†å¥æŸ„ç›¸å…³çš„èµ„æº return 0; } æ¨èä½¿ç”¨cprä»£æ›¿å®ƒ cprï¼šæ›´ç°ä»£ã€æ›´æ˜“ç”¨çš„é€šä¿¡åº“ cpr æ˜¯å¯¹ libcurl çš„ä¸€ä¸ª C++11 å°è£…ï¼Œä½¿ç”¨äº†å¾ˆå¤šç°ä»£ C++ çš„é«˜çº§ç‰¹æ€§ï¼Œå¯¹å¤–çš„æ¥å£æ¨¡ä»¿äº† Python çš„ requests åº“ï¼Œéå¸¸ç®€å•æ˜“ç”¨ã€‚ å®‰è£… ä¸‹è½½æºç ï¼Œç”¨ cmake ç¼–è¯‘å®‰è£… git clone git@github.com:whoshuu/cpr.git cmake . -DUSE_SYSTEM_CURL=ON -DBUILD_CPR_TESTS=OFF make &amp;&amp; make install æˆ–è€…åœ¨ cmake é¡¹ç›®ä¸­ç›´æ¥ä½¿ç”¨[CMakeLists.txt]ï¼š include(FetchContent) FetchContent_Declare(cpr GIT_REPOSITORY https://github.com/libcpr/cpr.git GIT_TAG 871ed52d350214a034f6ef8a3b8f51c5ce1bd400) # The commit hash for 1.9.0. Replace with the latest from: https://github.com/libcpr/cpr/releases FetchContent_MakeAvailable(cpr) target_link_libraries(cpr_example PRIVATE cpr::cpr) è¯´æ˜ï¼šmacos ä¸‹æŒ‡å®š clang++/clang ç¼–è¯‘å™¨ç”Ÿæˆé¡¹ç›®ï¼›gcc ç¼–è¯‘ä¼šå¤±è´¥ï¼› åœ¨ cpr é‡Œï¼ŒHTTP åè®®çš„æ¦‚å¿µéƒ½è¢«å®ç°ä¸ºç›¸åº”çš„å‡½æ•°æˆ–è€…ç±»ï¼Œå†…éƒ¨å†è½¬åŒ–ä¸º libcurl æ“ä½œï¼Œä¸»è¦çš„æœ‰ï¼š GET/HEAD/POST ç­‰è¯·æ±‚æ–¹æ³•ï¼Œä½¿ç”¨åŒåçš„ Get/Head/Post å‡½æ•°ï¼› URL ä½¿ç”¨ Url ç±»ï¼Œå®ƒæ˜¯ string çš„å°è£…ï¼› URL å‚æ•°ä½¿ç”¨ Parameters ç±»ï¼ŒKV ç»“æ„ï¼Œè¿‘ä¼¼ mapï¼› è¯·æ±‚å¤´å­—æ®µä½¿ç”¨ Header ç±»ï¼Œå®ƒå…¶å®æ˜¯ map çš„åˆ«åï¼Œä½¿ç”¨å®šåˆ¶çš„å‡½æ•°å®ç°äº†å¤§å°å†™æ— å…³æ¯”è¾ƒï¼› Cookie ä½¿ç”¨ Cookies ç±»ï¼Œä¹Ÿæ˜¯ KV ç»“æ„ï¼Œè¿‘ä¼¼ mapï¼› è¯·æ±‚ä½“ä½¿ç”¨ Body ç±»ï¼›è¶…æ—¶è®¾ç½®ä½¿ç”¨ Timeout ç±»ã€‚ cpr ä¹Ÿæ”¯æŒå¼‚æ­¥å¤„ç†ï¼Œä½†å®ƒå†…éƒ¨æ²¡æœ‰ä½¿ç”¨ libcurl çš„ multi æ¥å£ï¼Œè€Œæ˜¯ä½¿ç”¨äº†æ ‡å‡†åº“é‡Œçš„ future å’Œ asyncã€‚ Codeç¤ºä¾‹ #include &lt;cpr/cpr.h&gt; #include &lt;iostream&gt; #include &lt;string&gt; int main(int argc, char** argv) { cpr::Response r = cpr::Get(cpr::Url{&quot;https://api.github.com/repos/whoshuu/cpr/contributors&quot;}, cpr::Authentication{&quot;user&quot;, &quot;pass&quot;, cpr::AuthMode::BASIC}, cpr::Parameters{{&quot;anon&quot;, &quot;true&quot;}, {&quot;key&quot;, &quot;value&quot;}}); std::cout &lt;&lt; &quot;Status code: &quot; &lt;&lt; r.status_code &lt;&lt; '\\n'; std::cout &lt;&lt; &quot;Header:\\n&quot;; for (const std::pair&lt;const std::basic_string&lt;char&gt;, std::basic_string&lt;char&gt;&gt;&amp; kv : r.header) { std::cout &lt;&lt; '\\t' &lt;&lt; kv.first &lt;&lt; ':' &lt;&lt; kv.second &lt;&lt; '\\n'; } std::cout &lt;&lt; &quot;Text: &quot; &lt;&lt; r.text &lt;&lt; '\\n'; return 0; } ZMQï¼šé«˜æ•ˆã€å¤šåŠŸèƒ½çš„é€šä¿¡åº“ libcurl å’Œ cpr å¤„ç†çš„éƒ½æ˜¯ HTTP åè®®ï¼Œæ–¹ä¾¿ä½†åè®®è‡ªèº«ä¹Ÿæœ‰ä¸€äº›é™åˆ¶ï¼Œæ¯”å¦‚å¿…é¡»è¦ä¸€æ¥ä¸€å›ï¼Œå¿…é¡»ç‚¹å¯¹ç‚¹ç›´è¿ï¼Œåœ¨è¶…å¤§æ•°æ®é‡é€šä¿¡çš„æ—¶å€™å°±ä¸æ˜¯å¤ªåˆé€‚ã€‚å¹¶ä¸” libcurl å’Œ cpr åªèƒ½å……å½“ HTTP çš„å®¢æˆ·ç«¯ã€‚ ZMQ ä¸ä»…æ˜¯ä¸€ä¸ªå•çº¯çš„ç½‘ç»œé€šä¿¡åº“ï¼Œæ›´åƒæ˜¯ä¸€ä¸ªé«˜çº§çš„å¼‚æ­¥å¹¶å‘æ¡†æ¶ã€‚ https://zeromq.org/get-started/ Zero Message Queueâ€”â€”é›¶å»¶è¿Ÿçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ„å‘³ç€å®ƒé™¤äº†å¯ä»¥æ”¶å‘æ•°æ®å¤–ï¼Œè¿˜å¯ä»¥ç”¨ä½œæ¶ˆæ¯ä¸­é—´ä»¶ï¼Œè§£è€¦å¤šä¸ªåº”ç”¨æœåŠ¡ä¹‹é—´çš„å¼ºä¾èµ–å…³ç³»ï¼Œæ­å»ºé«˜æ•ˆã€æœ‰å¼¹æ€§çš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œä»è€Œè¶…è¶ŠåŸç”Ÿçš„ Socketã€‚ ubuntu ä¸‹å®‰è£… apt-get install libzmq3-dev ZMQ æ˜¯ç”¨ C++ å¼€å‘çš„ï¼Œä½†å‡ºäºå…¼å®¹çš„è€ƒè™‘ï¼Œå¯¹å¤–æä¾›çš„æ˜¯çº¯ C æ¥å£ã€‚å®ƒä¹Ÿæœ‰å¾ˆå¤š C++ å°è£…ï¼Œå¯ä»¥ä½¿ç”¨ cppzmqï¼Œåªæœ‰å¤´æ–‡ä»¶çš„å°è£…ï¼Œç®€å•ä½¿ç”¨ã€‚ ZMQ æŠŠè‡ªèº«å®šä½äºæ›´é«˜å±‚æ¬¡çš„â€œå¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—â€ï¼Œå®šä¹‰äº† 5 ç§ä¸åŒçš„å·¥ä½œæ¨¡å¼ï¼Œæ¥é€‚åº”å®é™…ä¸­å¸¸è§çš„ç½‘ç»œé€šä¿¡åœºæ™¯ã€‚ åŸç”Ÿæ¨¡å¼ï¼ˆRAWï¼‰ï¼Œæ²¡æœ‰æ¶ˆæ¯é˜Ÿåˆ—åŠŸèƒ½ï¼Œç›¸å½“äºåº•å±‚ Socket çš„ç®€å•å°è£…ï¼› ç»“å¯¹æ¨¡å¼ï¼ˆPAIRï¼‰ï¼Œä¸¤ä¸ªç«¯ç‚¹ä¸€å¯¹ä¸€é€šä¿¡ï¼› è¯·æ±‚å“åº”æ¨¡å¼ï¼ˆREQ-REPï¼‰ï¼Œä¹Ÿæ˜¯ä¸¤ä¸ªç«¯ç‚¹ä¸€å¯¹ä¸€é€šä¿¡ï¼Œä½†è¯·æ±‚å¿…é¡»æœ‰å“åº”ï¼› å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼ˆPUB-SUBï¼‰ï¼Œä¸€å¯¹å¤šé€šä¿¡ï¼Œä¸€ä¸ªç«¯ç‚¹å‘å¸ƒæ¶ˆæ¯ï¼Œå¤šä¸ªç«¯ç‚¹æ¥æ”¶å¤„ç†ï¼› ç®¡é“æ¨¡å¼ï¼ˆPUSH-PULLï¼‰ï¼Œæˆ–è€…å«æµæ°´çº¿ï¼Œå¯ä»¥ä¸€å¯¹å¤šï¼Œä¹Ÿå¯ä»¥å¤šå¯¹ä¸€ï¼› å‰å››ç§æ¨¡å¼ç±»ä¼¼ HTTP åè®®ã€Client-Server æ¶æ„ï¼Œç®¡é“æ¨¡å¼éå¸¸é€‚åˆè¿›ç¨‹é—´æ— é˜»å¡ä¼ é€æµ·é‡æ•°æ®ã€‚ç®¡é“æ¨¡å¼ä»‹ç»ç¤ºæ„ï¼š åœ¨ ZMQ é‡Œæœ‰ä¸¤ä¸ªåŸºæœ¬çš„ç±»ã€‚ ç¬¬ä¸€ä¸ªæ˜¯ context_tï¼Œå®ƒæ˜¯ ZMQ çš„è¿è¡Œç¯å¢ƒã€‚ä½¿ç”¨ ZMQ çš„ä»»ä½•åŠŸèƒ½å‰ï¼Œå¿…é¡»è¦å…ˆåˆ›å»ºå®ƒã€‚ ç¬¬äºŒä¸ªæ˜¯ socket_tï¼Œè¡¨ç¤º ZMQ çš„å¥—æ¥å­—ï¼Œéœ€è¦æŒ‡å®šåˆšæ‰è¯´çš„é‚£ 5 ç§å·¥ä½œæ¨¡å¼ã€‚æ³¨æ„å®ƒä¸åŸç”Ÿ Socket æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œåªæ˜¯å€Ÿç”¨äº†åå­—æ¥æ–¹ä¾¿ç†è§£ã€‚ ZMQ å¥—æ¥å­—æ”¯æŒ TCP/IPï¼Œè¿˜æ”¯æŒè¿›ç¨‹å†…å’Œè¿›ç¨‹é—´é€šä¿¡ï¼Œè¿™åœ¨æœ¬æœºäº¤æ¢æ•°æ®æ—¶ä¼šæ›´é«˜æ•ˆï¼š TCP é€šä¿¡åœ°å€çš„å½¢å¼æ˜¯ tcp://â€¦ï¼ŒæŒ‡å®š IP åœ°å€å’Œç«¯å£å·ï¼› è¿›ç¨‹å†…é€šä¿¡åœ°å€çš„å½¢å¼æ˜¯ inproc://â€¦ï¼ŒæŒ‡å®šä¸€ä¸ªæœ¬åœ°å¯è®¿é—®çš„è·¯å¾„ï¼› è¿›ç¨‹é—´é€šä¿¡åœ°å€çš„å½¢å¼æ˜¯ ipc://â€¦ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæœ¬åœ°å¯è®¿é—®çš„è·¯å¾„ã€‚ ç”¨ bind()/connect() è¿™ä¸¤ä¸ªå‡½æ•°æŠŠ ZMQ å¥—æ¥å­—è¿æ¥èµ·æ¥ä¹‹åï¼Œå°±å¯ä»¥ç”¨ send()/recv() æ¥æ”¶å‘æ•°æ®äº†ï¼š Codeç¤ºä¾‹ #include &quot;zmq.hpp&quot; #include &lt;iostream&gt; #include &lt;memory&gt; #include &lt;string&gt; #include &lt;thread&gt; using namespace std; int main() { const auto thread_num = 1; // å¹¶å‘çº¿ç¨‹æ•°z zmq::context_t context(thread_num); // ZMQç¯å¢ƒå˜é‡ auto make_sock = [&amp;](auto mode) { // å®šä¹‰ä¸€ä¸ªlambdaè¡¨è¾¾å¼ return zmq::socket_t(context, mode); // åˆ›å»ºZMQå¥—æ¥å­— }; const auto addr = &quot;ipc:///tmp/shm/zmq.sock&quot;s; // é€šä¿¡åœ°å€ auto receiver = [=]() { // lambdaè¡¨è¾¾å¼æ¥æ”¶æ•°æ® auto sock = make_sock(ZMQ_PULL); // åˆ›å»ºZMQå¥—æ¥å­—ï¼Œæ‹‰æ•°æ® sock.bind(addr); // ç»‘å®šå¥—æ¥å­— assert(sock.handle() != nullptr); // æ–­è¨€å¥—æ¥å­—æœ‰æ•ˆ auto buf = make_unique&lt;char[]&gt;(1024); // åˆ›å»ºä¸€ä¸ª1024å­—èŠ‚çš„ç¼“å†²åŒº zmq::mutable_buffer msg(buf.get(), 1024); // åˆ›å»ºZMQæ¶ˆæ¯ sock.recv(msg, zmq::recv_flags::none); // æ¥æ”¶æ•°æ® cout &lt;&lt; (char*)msg.data() &lt;&lt; endl; }; auto sender = [=]() { // lambdaè¡¨è¾¾å¼å‘é€æ•°æ® auto sock = make_sock(ZMQ_PUSH); // åˆ›å»ºZMQå¥—æ¥å­—ï¼Œæ¨æ•°æ® sock.connect(addr); // è¿æ¥åˆ°å¯¹ç«¯ assert(sock.handle() != nullptr); string s = &quot;hello zmq&quot;; sock.send(zmq::const_buffer{s.data(), s.length()}); // å‘é€æ¶ˆæ¯ }; thread t1(sender); thread t2(receiver); t1.join(); t2.join(); } ä½¿ç”¨ ZMQ å®Œå…¨ä¸éœ€è¦è€ƒè™‘åº•å±‚çš„ TCP/IP é€šä¿¡ç»†èŠ‚ï¼Œå®ƒä¼šä¿è¯æ¶ˆæ¯å¼‚æ­¥ã€å®‰å…¨ã€å®Œæ•´åœ°åˆ°è¾¾æœåŠ¡å™¨ï¼Œè®©ä½ å…³æ³¨ç½‘ç»œé€šä¿¡ä¹‹ä¸Šçš„ä¸šåŠ¡é€»è¾‘ã€‚ å…¶ä»–è¯´æ˜ ZMQ ç¯å¢ƒçš„çº¿ç¨‹æ•°ã€‚å®ƒçš„é»˜è®¤å€¼æ˜¯ 1ï¼Œé€‚å½“å¢å¤§ä¸€äº›å°±å¯ä»¥æé«˜ ZMQ çš„å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚ æ”¶å‘æ¶ˆæ¯æ—¶çš„æœ¬åœ°ç¼“å­˜æ•°é‡ï¼ŒZMQ çš„æœ¯è¯­å« High Water Markã€‚å¦‚æœæ”¶å‘çš„æ•°æ®è¿‡å¤šï¼Œæ•°é‡è¶…è¿‡ HWMï¼ŒZMQ è¦ä¹ˆé˜»å¡ï¼Œè¦ä¹ˆä¸¢å¼ƒæ¶ˆæ¯ã€‚ HWM éœ€è¦è°ƒç”¨å¥—æ¥å­—çš„æˆå‘˜å‡½æ•° setsockopt() æ¥è®¾ç½®ï¼Œæ³¨æ„æ”¶å‘ä½¿ç”¨çš„æ˜¯ä¸¤ä¸ªä¸åŒçš„æ ‡å¿—ï¼š sock.setsockopt(ZMQ_RCVHWM, 1000); // æ¥æ”¶æ¶ˆæ¯æœ€å¤šç¼“å­˜1000æ¡ sock.setsockopt(ZMQ_SNDHWM, 100); // å‘é€æ¶ˆæ¯æœ€å¤šç¼“å­˜100æ¡ å³ä½¿è®¾ç½® 100 ä¸‡ä»¥ä¸Šçš„å€¼ï¼ŒZMQ ä¼šæŠŠä¸€åˆ‡éƒ½å¤„ç†å¾—å¾ˆå¥½ã€‚ sockpp ç®€å•æ˜“ç”¨çš„C++ Socket åº“ï¼Œè¿™æ˜¯ä¸€ä¸ªä½å±‚çº§çš„ socket åŒ…è£…åº“ï¼Œæä¾› socket, connector, acceptor ç­‰ç›¸å…³æ¥å£ã€‚ ä¸‹è½½å¹¶å®‰è£… https://github.com/fpagliughi/sockpp git clone https://github.com/fpagliughi/sockpp cd sockpp mkdir build &amp;&amp; cd build cmake .. # é»˜è®¤ä½¿ç”¨ -DSOCKPP_BUILD_SHARED=ON cmake --build . --target install MacOS ä¸‹å¦‚æœä½¿ç”¨ gcc/g++ï¼Œåˆ™ä½¿ç”¨ gcc/g++ toolchain ç¼–è¯‘å®‰è£… ä½¿ç”¨æ–¹å¼éå¸¸ç®€å•ï¼Œä¾‹å¦‚ TCP ç¼–ç¨‹ï¼š TCP Server #include &lt;iostream&gt; #include &lt;thread&gt; #include &quot;sockpp/tcp_acceptor.h&quot; #include &quot;sockpp/version.h&quot; using namespace std; // The thread function. void run_echo(sockpp::tcp_socket sock) { ssize_t n; char buf[512]; while ((n = sock.read(buf, sizeof(buf))) &gt; 0) sock.write_n(buf, n); cout &lt;&lt; &quot;Connection closed from &quot; &lt;&lt; sock.peer_address() &lt;&lt; endl; } int main(int argc, char* argv[]) { cout &lt;&lt; &quot;Sample TCP echo server for 'sockpp' &quot; &lt;&lt; sockpp::SOCKPP_VERSION &lt;&lt; '\\n' &lt;&lt; endl; in_port_t port = (argc &gt; 1) ? atoi(argv[1]) : 12345; sockpp::socket_initializer sockInit; sockpp::tcp_acceptor acc(port); if (!acc) { cerr &lt;&lt; &quot;Error creating the acceptor: &quot; &lt;&lt; acc.last_error_str() &lt;&lt; endl; return 1; } cout &lt;&lt; &quot;Awaiting connections on port &quot; &lt;&lt; port &lt;&lt; &quot;...&quot; &lt;&lt; endl; while (true) { sockpp::inet_address peer; // Accept a new client connection sockpp::tcp_socket sock = acc.accept(&amp;peer); cout &lt;&lt; &quot;Received a connection request from &quot; &lt;&lt; peer &lt;&lt; endl; if (!sock) { cerr &lt;&lt; &quot;Error accepting incoming connection: &quot; &lt;&lt; acc.last_error_str() &lt;&lt; endl; } else { // Create a thread and transfer the new stream to it. thread thr(run_echo, std::move(sock)); thr.detach(); } } return 0; } TCP Client #include &lt;iostream&gt; #include &lt;string&gt; #include &quot;sockpp/tcp_connector.h&quot; #include &quot;sockpp/version.h&quot; using namespace std; using namespace std::chrono; int main(int argc, char* argv[]) { cout &lt;&lt; &quot;Sample TCP echo client for 'sockpp' &quot; &lt;&lt; sockpp::SOCKPP_VERSION &lt;&lt; '\\n' &lt;&lt; endl; string host = (argc &gt; 1) ? argv[1] : &quot;localhost&quot;; in_port_t port = (argc &gt; 2) ? atoi(argv[2]) : 12345; sockpp::socket_initializer sockInit; sockpp::tcp_connector conn({host, port}); if (!conn) { cerr &lt;&lt; &quot;Error connecting to server at &quot; &lt;&lt; sockpp::inet_address(host, port) &lt;&lt; &quot;\\n\\t&quot; &lt;&lt; conn.last_error_str() &lt;&lt; endl; return 1; } cout &lt;&lt; &quot;Created a connection from &quot; &lt;&lt; conn.address() &lt;&lt; endl; // Set a timeout for the responses if (!conn.read_timeout(seconds(5))) { cerr &lt;&lt; &quot;Error setting timeout on TCP stream: &quot; &lt;&lt; conn.last_error_str() &lt;&lt; endl; } string s, sret; while (getline(cin, s) &amp;&amp; !s.empty()) { if (conn.write(s) != ssize_t(s.length())) { cerr &lt;&lt; &quot;Error writing to the TCP stream: &quot; &lt;&lt; conn.last_error_str() &lt;&lt; endl; break; } sret.resize(s.length()); ssize_t n = conn.read_n(&amp;sret[0], s.length()); if (n != ssize_t(s.length())) { cerr &lt;&lt; &quot;Error reading from TCP stream: &quot; &lt;&lt; conn.last_error_str() &lt;&lt; endl; break; } cout &lt;&lt; sret &lt;&lt; endl; } return (!conn) ? 1 : 0; } å°ç»“ libcurl æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå–„ã€ç¨³å®šå¯é çš„åº”ç”¨å±‚é€šä¿¡åº“ï¼Œæœ€å¸¸ç”¨çš„å°±æ˜¯ HTTP åè®®ï¼› cpr æ˜¯å¯¹ libcurl çš„ C++ å°è£…ï¼Œæ¥å£ç®€å•æ˜“ç”¨ï¼›libcurl å’Œ cpr éƒ½åªèƒ½ä½œä¸ºå®¢æˆ·ç«¯æ¥ä½¿ç”¨ï¼Œä¸èƒ½ç¼–å†™æœåŠ¡å™¨ç«¯åº”ç”¨ï¼› ZMQ æ˜¯ä¸€ä¸ªé«˜çº§çš„ç½‘ç»œé€šä¿¡åº“ï¼Œæ”¯æŒå¤šç§é€šä¿¡æ¨¡å¼ï¼Œå¯ä»¥æŠŠæ¶ˆæ¯é˜Ÿåˆ—åŠŸèƒ½ç›´æ¥åµŒå…¥åº”ç”¨ç¨‹åºï¼Œæ­å»ºå‡ºé«˜æ•ˆã€çµæ´»ã€å…ç®¡ç†çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚ sockpp æ˜¯ä¸€ä¸ªç®€å•æ˜“ç”¨çš„åº•å±‚sockå°è£…åº“ã€‚ æœ€åï¼Œ C++20ï¼ŒåŸæœ¬é¢„è®¡ä¼šåŠ å…¥æœŸå¾…å·²ä¹…çš„ networking åº“ï¼Œä½†ç°åœ¨å·²ç»è¢«æ¨è¿Ÿåˆ°äº†ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼ˆC++23ï¼‰ networking åº“åŸºäºå·²æœ‰å¤šå¹´å®è·µçš„ boost.asioï¼Œé‡‡ç”¨å‰æ‘„å™¨æ¨¡å¼ï¼ˆProactorï¼‰ç»Ÿä¸€å°è£…äº†æ“ä½œç³»ç»Ÿçš„å„ç§å¼‚æ­¥æœºåˆ¶ï¼ˆepollã€kqueueã€IOCPï¼‰ï¼Œè€Œä¸”æ”¯æŒåç¨‹ã€‚ ","tags":[{"name":"C++","slug":"c","used":true,"link":"https://blog.qxxiao.eu.org/tag/c/"}],"title":"C++ç½‘ç»œåº“","feature":"https://pic.qxxiao.cn/cpp-logo.png","link":"https://blog.qxxiao.eu.org/post/C++ç½‘ç»œåº“/","stats":{"text":"14 min read","time":820000,"words":3072,"minutes":14},"date":"2022-10-23 21:42:00","dateFormat":"2022-10-23","isTop":false},{"content":"GitåŸç† .git æ–‡ä»¶å¤¹è¯´æ˜ -rw-r--r-- HEAD # å½“å‰çš„å¤´éƒ¨commit/æŒ‡å‘ -rw-r--r-- config # æœ¬åœ°ä»“åº“çš„é…ç½® drwxr-xr-x hooks # hooksæ¨¡ç‰ˆ -rw-r--r-- index # æš‚å­˜åŒºçš„ç´¢å¼•[è¢«è¿½è¸ªçš„æ–‡ä»¶ä¿¡æ¯](æ·»åŠ åˆ°æš‚å­˜åŒºä¼šæŒä¹…åŒ–) drwxr-xr-x logs # HEAD çš„è®°å½•[åˆ†æ”¯è®°å½•ä»¥åŠHEADç§»åŠ¨è®°å½•] drwxr-xr-x objects # æ–‡ä»¶å¯¹è±¡[commitå¯¹è±¡æ–‡ä»¶ï¼Œtreeå¯¹è±¡æ–‡ä»¶ï¼Œbobæ™®é€šæ–‡ä»¶] drwxr-xr-x refs # åˆ†æ”¯çš„å¤´éƒ¨å’Œtags(å¯¹åº”çš„commitID) commitå¯¹è±¡è¡¨ç¤ºäº†æ­¤æ¬¡æäº¤çš„ä¸€æ¬¡å¿«ç…§/ç‰ˆæœ¬ï¼Œè€Œæš‚å­˜åŒºæ˜¯å½“å‰çš„ä¿®æ”¹ç‰ˆæœ¬ï¼Œç­‰åˆ°æäº¤æ—¶å°†å½“å‰çš„çŠ¶æ€å»ºç«‹ä¸€ä¸ªcommitä¿å­˜å½’æ¡£ã€‚ ä¾‹å¦‚ä¸€ä¸ªcommitå¯¹è±¡å…³è”çš„å¯¹è±¡ï¼š commitå¯¹è±¡åŒ…å«ä¸€ä¸ªtreeå¯¹è±¡(æŒ‡é’ˆ)ï¼Œè¡¨ç¤ºäº†å½“å‰æ–‡ä»¶æ ‘å½¢ç»„ç»‡çš„å¿«ç…§ç‰ˆæœ¬ commitå¯¹è±¡ä¹‹é—´é€šè¿‡parentæŒ‡é’ˆè”ç³» æš‚å­˜åŒºï¼Œä¸Šæ¬¡æäº¤+åç»­æ·»åŠ åˆ°æš‚å­˜çš„æ–‡ä»¶ä¿®æ”¹çš„æ–‡ä»¶çŠ¶æ€ è¯´æ˜ï¼š commitä¹‹é—´ï¼Œç›¸åŒçš„æ–‡ä»¶å¯¹è±¡æ˜¯å…±äº«çš„ï¼› æ¯æ¬¡ä¿®æ”¹æ·»åŠ åˆ°æš‚å­˜åŒºåï¼Œåªä¼šå½±å“bobæ–‡ä»¶å¯¹è±¡ã€treeå¯¹è±¡ç­‰åˆ°æäº¤æ‰ä¼šç”Ÿæˆã€‘ æ¯ä¸ªæ–‡ä»¶çš„æƒé™ã€æ–‡ä»¶è·¯å¾„å’ŒHashå­˜å‚¨åœ¨.git/indexæ–‡ä»¶ Gitçš„hashæŒ‡é’ˆ/å†…å®¹å¯»å€/DAGç»“æ„è¢«å¹¿æ³›ç”¨äº IPFS çš„å­˜å‚¨æ¶æ„ä¸­ã€‚ Gitå¯¹è±¡ç®€å•æµ‹è¯• # git sha-1 hash echo &quot;Hello&quot; | git hash-object --stdin # æŸ¥çœ‹æš‚å­˜åŒºçš„å†…å®¹[ç”±gitè¿½è¸ªçš„æ–‡ä»¶] git ls-files --stage # æŸ¥çœ‹gitå¯¹è±¡çš„ç±»å‹ git cat-file -t ID # æŸ¥çœ‹gitå¯¹è±¡çš„å†…å®¹ git cat-file -p ID å®æˆ˜ æ¯”è¾ƒå‘½ä»¤ git diff commitID1 commitID2 [-- file1 ...] æ¯”è¾ƒä¸¤ä¸ªæäº¤çš„[éƒ¨åˆ†]æ–‡ä»¶å·®å¼‚ï¼Œå¯ä»¥ä½¿ç”¨åˆ†æ”¯åä»£æ›¿ID git diff [-- file1 ...] æ¯”è¾ƒå·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„æ–‡ä»¶å·®å¼‚ git diff --cached [-- file1 ...] æ¯”è¾ƒæš‚å­˜åŒºå’ŒHEAD/æœ€è¿‘æäº¤çš„æ–‡ä»¶å·®å¼‚ åˆ†ç¦»å¤´æŒ‡é’ˆ åˆ†ç¦»å¤´æŒ‡é’ˆï¼Œå³HEADæŒ‡å‘äº†éåˆ†æ”¯çš„å¤´éƒ¨æäº¤ï¼Œå¦‚æœæ–°å»ºæäº¤ä¸å±äºä»»ä½•åˆ†æ”¯ï¼Œä¸ä¼šè¢«gitç®¡ç†åç»­ä¼šè¢«æ¸…ç†ã€‚ ä½†æ˜¯ï¼ŒåŸºäºè¯¥æäº¤è¿›è¡Œè¯•éªŒäº§ç”Ÿæ–°æäº¤æ˜¯å¯è¡Œçš„ å¦‚æœæ–°æäº¤éœ€è¦ä¿ç•™ï¼Œåº”è¯¥åŸºäºæ–°æäº¤å»ºç«‹æ–°åˆ†æ”¯/tag å¯¹äºåŸºäºåˆ†ç¦»å¤´æŒ‡é’ˆçš„æäº¤ ä¸º unreachable object ä¼šåœ¨é»˜è®¤ç­–ç•¥ä¸‹è¢«æ¸…ç†ã€åˆ†æ”¯/tag/index/reflogä¸èƒ½åˆ°è¾¾çš„å¯¹è±¡ã€‘å¹¶ä¸”é»˜è®¤2weeksä¸å˜(ä¸ä¿®æ”¹)[ç¼“è§£ç«äº‰æ¡ä»¶]çš„è¯ä¼šè¢«æ¸…ç† å¦‚æœæƒ³è¦åŠæ—¶åˆ é™¤ï¼Œä¾‹å¦‚å¤§æ–‡ä»¶æäº¤ å°†å¯¹åº”çš„æäº¤å˜ä¸ºunreachable å(æ³¨æ„ref/reflogç­‰éƒ½ä¸èƒ½ç´¢å¼•åˆ°å®ƒ)ï¼Œæ‰§è¡Œ git gc --prune=now ä¿®æ”¹æœ¬åœ°æäº¤ ä¿®æ”¹æœ€æ–°commitçš„message git commit --amend ä½¿ç”¨å˜åŸºrebaseä¿®æ”¹ã€åˆå¹¶æäº¤ å˜åŸºï¼Œæ”¹å˜å½“å‰åˆ†æ”¯baseæäº¤ä½ç½®ï¼Œä½¿ç”¨ rebase å‘½ä»¤å°†æäº¤åˆ°æŸä¸€åˆ†æ”¯ä¸Šçš„æ‰€æœ‰ä¿®æ”¹éƒ½ç§»è‡³å¦ä¸€åˆ†æ”¯ä¸Šï¼Œå°±å¥½åƒé‡æ–°æ’­æ”¾ä¸€æ ·ã€‚ç”¨äºåˆå¹¶åˆ†æ”¯ã€ä¼šå°†åˆ†æ”¯çš„æäº¤æ•´ç†æˆçº¿æ€§ã€‘ git rebase ç›®æ ‡åˆ†æ”¯ [æºåˆ†æ”¯] ï¼ˆä¼šå…ˆåˆ‡æ¢åˆ°æºåˆ†æ”¯[é»˜è®¤ä¸ºå½“å‰åˆ†æ”¯]ï¼Œå¹¶å°†å½“å‰åˆ†æ”¯æŒ‡å‘ç›®æ ‡åˆ†æ”¯çš„ä½ç½®ï¼Œåº”ç”¨æºåˆ†æ”¯ä¸Šçš„æ¯ä¸ªæäº¤ï¼‰ (1) ä¿®æ”¹æœ¬åˆ†æ”¯ä¸Šçš„æ—§commitçš„æäº¤ä¿¡æ¯ å¯¹è‡ªå·±è¿›è¡Œå˜åŸºï¼Œé‡æ–°ä¿®æ”¹baseæäº¤åç»­çš„æäº¤ git rebase -i commitID commitIDåº”è¯¥é€‰å–ä¸ºéœ€è¦ä¿®æ”¹çš„å‰ä¸€ä¸ªæäº¤IDï¼Œé€šè¿‡äº¤äº’å¼å‘½ä»¤æ“ä½œåç»­æäº¤çš„çŠ¶æ€ï¼Œä»è€Œä¿®æ”¹åç»­çš„æ‰€æœ‰æäº¤ (2) åˆå¹¶åˆ†æ”¯ä¸Šçš„å‡ ä¸ªcommit git rebase -i commitID åŒæ ·å¯ä»¥æ“ä½œä¸åŒçš„commit ä¸åŒåœºæ™¯çš„æ¢å¤ é¦–å…ˆéœ€è¦çŸ¥é“å·¥ä½œåŒºã€æš‚å­˜åŒºå’Œæœ€è¿‘æäº¤commitä¸‰è€…ä¹‹é—´çš„å…³ç³» è®©æš‚å­˜åŒºæ¢å¤æˆHEADä¸€æ · git reset HEAD [file1 ...] å«ä¹‰ï¼šæ¸…ç†è·ç¦»ä¸Šæ¬¡æäº¤æ·»åŠ çš„æ‰€æœ‰æš‚å­˜ï¼Œå·¥ä½œåŒºä¿®æ”¹å–æ¶ˆæŒä¹…åŒ– å¯ä»¥æ·»åŠ æŒ‡å®šçš„æ–‡ä»¶åç§°ï¼Œæ¥æ’¤é”€æš‚å­˜åŒºè¯¥æ–‡ä»¶ä¿®æ”¹ï¼Œä»è€Œå®ç°å¯¹éƒ¨åˆ†æ–‡ä»¶çš„æäº¤ã€‚ å°†å·¥ä½œåŒºæ¢å¤æˆæš‚å­˜åŒºä¸€æ · å¦‚æœå½“å‰çš„å·¥ä½œåŒºéœ€è¦ä¸¢å¼ƒè·ç¦»ä¸Šä¸€æ¬¡æš‚å­˜æ‰€åšçš„ä¿®æ”¹[ä¸€ä¸ªæš‚å­˜çŠ¶æ€] git checkout -- '*' ä¸¢å¼ƒæœ€è¿‘çš„å‡ æ¬¡æäº¤ã€ä»£ç å›æ»šã€‘ git reset â€”hard commitID å°†å½“å‰åˆ†æ”¯é‡ç½®åˆ° commitID çš„ä½ç½®(ä¿®æ”¹å½“å‰åˆ†æ”¯çš„å¤´/æœ€è¿‘çš„æäº¤)ï¼Œå¹¶ä¸”é‡ç½®å·¥ä½œåŒºå’Œæš‚å­˜åŒºä¸è¯¥ä½ç½®çš„ commit ä¿æŒä¸€è‡´ã€‚(ä½¿ç”¨å‰åº”ä¿æŒå·¥ä½œåŒºclean) è¯´æ˜ï¼šç”±äºä¸¢å¼ƒçš„æäº¤å¤„äºæ¸¸ç¦»éƒ¨åˆ†/ä¸å±äºåˆ†æ”¯æˆ–tagå…³è”çš„æäº¤ï¼Œå¯èƒ½ä¼šè¢«æ¸…ç†ï¼Œæƒ³åˆ‡æ¢åˆ†æ”¯è¯·ä½¿ç”¨ checkout å‘½ä»¤ cherry-pick å¤åˆ¶æäº¤ ä¸åˆ†æ”¯åˆå¹¶(merge/rebase)ä¸åŒï¼Œåœ¨åªéœ€è¦å¤åˆ¶å…¶ä»–åˆ†æ”¯æŸä¸€ä¸ª commitï¼Œä½¿ç”¨ cherry-pick å‘½ä»¤ï¼Œå³å¯å¤åˆ¶ä¸€ä¸ªç‰¹å®šçš„æäº¤åˆ°å½“å‰åˆ†æ”¯å¹¶ç”Ÿæˆä¸€æ¬¡æ–°çš„æäº¤ï¼Œé¿å…äº†ç›¸åŒçš„å·¥ä½œæˆ–åˆ†æ”¯çš„åˆå¹¶æ“ä½œã€‚ git cherry-pick commitID åœ¨å½“å‰åˆ†æ”¯åº”ç”¨ç‰¹å®šçš„æäº¤ è´®è—å·¥ä½œåŒºä¸æš‚å­˜åŒº https://git-scm.com/book/zh/v2/Git-å·¥å…·-è´®è—ä¸æ¸…ç† åœºæ™¯ï¼šå½“æ­£åœ¨è‡ªå·±åˆ†æ”¯ä¸Šå¼€å‘ï¼Œå¹¶ä¿®æ”¹å’Œæš‚å­˜äº†éƒ¨åˆ†æ–‡ä»¶ï¼Œä¸´æ—¶éœ€è¦åˆ‡æ¢åˆ°å…¶å®ƒåˆ†æ”¯å·¥ä½œï¼Œä½†æ˜¯æ­¤æ—¶ä¸æƒ³æäº¤è‡ªå·±æœªå®Œæˆçš„å·¥ä½œã€‚éœ€è¦ä¸´æ—¶ä¿å­˜è‡ªå·±çš„å·¥ä½œçŠ¶æ€ï¼Œä½¿ç”¨ git stash æ¥ä¿å­˜ã€‚ git stash å°†å·¥ä½œåŒºå’Œæš‚å­˜åŒºä¸­å°šæœªæäº¤çš„ä¿®æ”¹å­˜å…¥æ ˆä¸­ git stash list æŸ¥çœ‹æ ˆä¸­æ‰€æœ‰å…ƒç´  git stash pop --index å°†æ ˆé¡¶å­˜å‚¨çš„ä¿®æ”¹æ¢å¤åˆ°å½“å‰åˆ†æ”¯ï¼ŒåŒæ—¶åˆ é™¤æ ˆé¡¶å…ƒç´  é»˜è®¤ä¼šå°†å…ˆå‰æš‚å­˜åŒºçš„å­˜å‚¨çš„å†…å®¹æ’¤é”€åˆ°å·¥ä½œåŒº(æš‚å­˜åŒºä¿®æ”¹çš„å†…å®¹è¢«æ¸…ç©º)ï¼Œä½¿ç”¨--indexæ¢å¤æš‚å­˜åŒºçš„å†…å®¹/æ¢å¤å¾—å’ŒåŸæ¥ä¸€æ · git stash apply --index å°†æ ˆé¡¶å­˜å‚¨çš„ä¿®æ”¹æ¢å¤åˆ°å½“å‰åˆ†æ”¯ï¼Œä½†ä¸åˆ é™¤æ ˆé¡¶å…ƒç´  git stash drop åˆ é™¤æ ˆé¡¶å­˜å‚¨çš„è´®è— è¿œç¨‹åˆ†æ”¯æ“ä½œ https://learngitbranching.js.org/?locale=zh_CN .gitignore é…ç½® æ·»åŠ å¿½ç•¥æ–‡ä»¶åˆ—è¡¨åˆ° .gitignore ï¼Œè®©gitå¿½ç•¥è¿™äº›æ–‡ä»¶/ä¸ç®¡ç† æœ‰æ—¶ä¸€äº›æ–‡ä»¶æœ€å¥½ä¸è¦ç”¨ Git è·Ÿè¸ªã€‚è¿™é€šå¸¸åœ¨åä¸º .gitignore çš„ç‰¹æ®Šæ–‡ä»¶ä¸­å®Œæˆã€‚ä½ å¯ä»¥åœ¨ github.com/github/gitignore æ‰¾åˆ°æœ‰ç”¨çš„ .gitignoreæ–‡ä»¶æ¨¡æ¿ã€‚æˆ–è€…ï¼šhttps://www.toptal.com/developers/gitignore ç®€å•ç¤ºä¾‹ï¼š *.class doc/ # å¿½ç•¥docæ–‡ä»¶å¤¹ doc/*.txt # éé€’å½’ doc/**/*.pdf # é€’å½’ï¼Œå¿½ç•¥doc/ä¸‹æ‰€æœ‰pdf # ä¸å¿½ç•¥.gitignoreå’ŒApp.class: !.gitignore !App.class Gité›†æˆä½¿ç”¨ç¦å¿Œ ç¦æ­¢å‘å›¢é˜Ÿé›†æˆçš„åˆ†æ”¯å¼ºåˆ¶æ¨é€ push -f å¼ºåˆ¶æ¨é€åˆ†æ”¯ï¼Œå‘ç”Ÿå†²çªä¼šå¼ºåˆ¶è¦†ç›–è¿œç¨‹åˆ†æ”¯çš„å†…å®¹ã€‚ä¼šå¯¼è‡´åŸæ¥åˆ†æ”¯å†…å®¹å…¨éƒ¨ä¸¢å¤±/æˆ–éƒ¨åˆ†ä¸¢å¤±ã€‚ å› æ­¤ï¼Œå¯¹å›¢é˜Ÿçš„é›†æˆåˆ†æ”¯ä¸¥ç¦ä½¿ç”¨ push -f å‘½ä»¤ ç¦æ­¢å¯¹å›¢é˜Ÿçš„é›†æˆåˆ†æ”¯ä½œå˜åŸºæ“ä½œ å›¢é˜Ÿçš„é›†æˆåˆ†æ”¯ï¼Œæ˜¯ä¸èƒ½ä¿®æ”¹å†å²æäº¤çš„ï¼Œåªèƒ½é€šè¿‡å¢åŠ  commit æäº¤æ¥æ”¹è¿› å¦‚æœä½¿ç”¨rebaseä¿®æ”¹å†å²ï¼Œä¼šå¯¼è‡´å…¶ä»–æˆå‘˜ä¸é›†æˆåˆ†æ”¯çš„å†²çªã€‚ ğŸ’¡ æ€»çš„åŸåˆ™æ˜¯ï¼Œåªå¯¹å°šæœªæ¨é€æˆ–åˆ†äº«ç»™åˆ«äººçš„æœ¬åœ°ä¿®æ”¹æ‰§è¡Œå˜åŸºæ“ä½œæ¸…ç†å†å²ï¼Œ ä»ä¸å¯¹å·²æ¨é€è‡³åˆ«å¤„çš„æäº¤æ‰§è¡Œå˜åŸºæ“ä½œ. æ‰‹å†Œ https://git-scm.com/book/zh/v2/Git-åˆ†æ”¯-å˜åŸº å¯è§†åŒ–Gitå‘½ä»¤ https://ndpsoftware.com/git-cheatsheet.html#loc=workspace; Gitç›¸å…³æ–‡ç«  https://github.blog/2022-09-13-scaling-gits-garbage-collection/ ","tags":[{"name":"Git","slug":"git","used":true,"link":"https://blog.qxxiao.eu.org/tag/git/"}],"title":"ç†è§£Gitå’Œå®æˆ˜","feature":"https://images.unsplash.com/photo-1556075798-4825dfaaf498?ixlib=rb-4.0.3&q=80&fm=jpg&crop=entropy&cs=tinysrgb","link":"https://blog.qxxiao.eu.org/post/ç†è§£Gitå’Œå®æˆ˜/","stats":{"text":"8 min read","time":423000,"words":1888,"minutes":8},"date":"2022-10-17 15:48:00","dateFormat":"2022-10-17","isTop":false},{"content":" è½¬è½½ï¼š Javaçº¿ç¨‹æ± å®ç°åŸç†åŠå…¶åœ¨ç¾å›¢ä¸šåŠ¡ä¸­çš„å®è·µ éšç€è®¡ç®—æœºè¡Œä¸šçš„é£é€Ÿå‘å±•ï¼Œæ‘©å°”å®šå¾‹é€æ¸å¤±æ•ˆï¼Œå¤šæ ¸CPUæˆä¸ºä¸»æµã€‚ä½¿ç”¨å¤šçº¿ç¨‹å¹¶è¡Œè®¡ç®—é€æ¸æˆä¸ºå¼€å‘äººå‘˜æå‡æœåŠ¡å™¨æ€§èƒ½çš„åŸºæœ¬æ­¦å™¨ã€‚J.U.Cæä¾›çš„çº¿ç¨‹æ± ï¼šThreadPoolExecutorç±»ï¼Œå¸®åŠ©å¼€å‘äººå‘˜ç®¡ç†çº¿ç¨‹å¹¶æ–¹ä¾¿åœ°æ‰§è¡Œå¹¶è¡Œä»»åŠ¡ã€‚äº†è§£å¹¶åˆç†ä½¿ç”¨çº¿ç¨‹æ± ï¼Œæ˜¯ä¸€ä¸ªå¼€å‘äººå‘˜å¿…ä¿®çš„åŸºæœ¬åŠŸã€‚ æœ¬æ–‡å¼€ç¯‡ç®€è¿°çº¿ç¨‹æ± æ¦‚å¿µå’Œç”¨é€”ï¼Œæ¥ç€ç»“åˆçº¿ç¨‹æ± çš„æºç ï¼Œå¸®åŠ©è¯»è€…é¢†ç•¥çº¿ç¨‹æ± çš„è®¾è®¡æ€è·¯ï¼Œæœ€åå›å½’å®è·µï¼Œé€šè¿‡æ¡ˆä¾‹è®²è¿°ä½¿ç”¨çº¿ç¨‹æ± é‡åˆ°çš„é—®é¢˜ï¼Œå¹¶ç»™å‡ºäº†ä¸€ç§åŠ¨æ€åŒ–çº¿ç¨‹æ± è§£å†³æ–¹æ¡ˆã€‚ ä¸€ã€å†™åœ¨å‰é¢ 1.1 çº¿ç¨‹æ± æ˜¯ä»€ä¹ˆ çº¿ç¨‹æ± ï¼ˆThread Poolï¼‰æ˜¯ä¸€ç§åŸºäºæ± åŒ–æ€æƒ³ç®¡ç†çº¿ç¨‹çš„å·¥å…·ï¼Œç»å¸¸å‡ºç°åœ¨å¤šçº¿ç¨‹æœåŠ¡å™¨ä¸­ï¼Œå¦‚MySQLã€‚ çº¿ç¨‹è¿‡å¤šä¼šå¸¦æ¥é¢å¤–çš„å¼€é”€ï¼Œå…¶ä¸­åŒ…æ‹¬åˆ›å»ºé”€æ¯çº¿ç¨‹çš„å¼€é”€ã€è°ƒåº¦çº¿ç¨‹çš„å¼€é”€ç­‰ç­‰ï¼ŒåŒæ—¶ä¹Ÿé™ä½äº†è®¡ç®—æœºçš„æ•´ä½“æ€§èƒ½ã€‚çº¿ç¨‹æ± ç»´æŠ¤å¤šä¸ªçº¿ç¨‹ï¼Œç­‰å¾…ç›‘ç£ç®¡ç†è€…åˆ†é…å¯å¹¶å‘æ‰§è¡Œçš„ä»»åŠ¡ã€‚è¿™ç§åšæ³•ï¼Œä¸€æ–¹é¢é¿å…äº†å¤„ç†ä»»åŠ¡æ—¶åˆ›å»ºé”€æ¯çº¿ç¨‹å¼€é”€çš„ä»£ä»·ï¼Œå¦ä¸€æ–¹é¢é¿å…äº†çº¿ç¨‹æ•°é‡è†¨èƒ€å¯¼è‡´çš„è¿‡åˆ†è°ƒåº¦é—®é¢˜ï¼Œä¿è¯äº†å¯¹å†…æ ¸çš„å……åˆ†åˆ©ç”¨ã€‚ è€Œæœ¬æ–‡æè¿°çº¿ç¨‹æ± æ˜¯JDKä¸­æä¾›çš„ThreadPoolExecutorç±»ã€‚ å½“ç„¶ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥å¸¦æ¥ä¸€ç³»åˆ—å¥½å¤„ï¼š é™ä½èµ„æºæ¶ˆè€—ï¼šé€šè¿‡æ± åŒ–æŠ€æœ¯é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹ï¼Œé™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æŸè€—ã€‚ æé«˜å“åº”é€Ÿåº¦ï¼šä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œæ— éœ€ç­‰å¾…çº¿ç¨‹åˆ›å»ºå³å¯ç«‹å³æ‰§è¡Œã€‚ æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ï¼šçº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šå› ä¸ºçº¿ç¨‹çš„ä¸åˆç†åˆ†å¸ƒå¯¼è‡´èµ„æºè°ƒåº¦å¤±è¡¡ï¼Œé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚ä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ã€è°ƒä¼˜å’Œç›‘æ§ã€‚ æä¾›æ›´å¤šæ›´å¼ºå¤§çš„åŠŸèƒ½ï¼šçº¿ç¨‹æ± å…·å¤‡å¯æ‹“å±•æ€§ï¼Œå…è®¸å¼€å‘äººå‘˜å‘å…¶ä¸­å¢åŠ æ›´å¤šçš„åŠŸèƒ½ã€‚æ¯”å¦‚å»¶æ—¶å®šæ—¶çº¿ç¨‹æ± ScheduledThreadPoolExecutorï¼Œå°±å…è®¸ä»»åŠ¡å»¶æœŸæ‰§è¡Œæˆ–å®šæœŸæ‰§è¡Œã€‚ 1.2 çº¿ç¨‹æ± è§£å†³çš„é—®é¢˜æ˜¯ä»€ä¹ˆ çº¿ç¨‹æ± è§£å†³çš„æ ¸å¿ƒé—®é¢˜å°±æ˜¯èµ„æºç®¡ç†é—®é¢˜ã€‚åœ¨å¹¶å‘ç¯å¢ƒä¸‹ï¼Œç³»ç»Ÿä¸èƒ½å¤Ÿç¡®å®šåœ¨ä»»æ„æ—¶åˆ»ä¸­ï¼Œæœ‰å¤šå°‘ä»»åŠ¡éœ€è¦æ‰§è¡Œï¼Œæœ‰å¤šå°‘èµ„æºéœ€è¦æŠ•å…¥ã€‚è¿™ç§ä¸ç¡®å®šæ€§å°†å¸¦æ¥ä»¥ä¸‹è‹¥å¹²é—®é¢˜ï¼š é¢‘ç¹ç”³è¯·/é”€æ¯èµ„æºå’Œè°ƒåº¦èµ„æºï¼Œå°†å¸¦æ¥é¢å¤–çš„æ¶ˆè€—ï¼Œå¯èƒ½ä¼šéå¸¸å·¨å¤§ã€‚ å¯¹èµ„æºæ— é™ç”³è¯·ç¼ºå°‘æŠ‘åˆ¶æ‰‹æ®µï¼Œæ˜“å¼•å‘ç³»ç»Ÿèµ„æºè€—å°½çš„é£é™©ã€‚ ç³»ç»Ÿæ— æ³•åˆç†ç®¡ç†å†…éƒ¨çš„èµ„æºåˆ†å¸ƒï¼Œä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚ ä¸ºè§£å†³èµ„æºåˆ†é…è¿™ä¸ªé—®é¢˜ï¼Œçº¿ç¨‹æ± é‡‡ç”¨äº†â€œæ± åŒ–â€ï¼ˆPoolingï¼‰æ€æƒ³ã€‚æ± åŒ–ï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯ä¸ºäº†æœ€å¤§åŒ–æ”¶ç›Šå¹¶æœ€å°åŒ–é£é™©ï¼Œè€Œå°†èµ„æºç»Ÿä¸€åœ¨ä¸€èµ·ç®¡ç†çš„ä¸€ç§æ€æƒ³ã€‚ Pooling is the grouping together of resources (assets, equipment, personnel, effort, etc.) for the purposes of maximizing advantage or minimizing risk to the users. The term is used in finance, computing and equipment management.â€”â€”wikipedia â€œæ± åŒ–â€æ€æƒ³ä¸ä»…ä»…èƒ½åº”ç”¨åœ¨è®¡ç®—æœºé¢†åŸŸï¼Œåœ¨é‡‘èã€è®¾å¤‡ã€äººå‘˜ç®¡ç†ã€å·¥ä½œç®¡ç†ç­‰é¢†åŸŸä¹Ÿæœ‰ç›¸å…³çš„åº”ç”¨ã€‚ åœ¨è®¡ç®—æœºé¢†åŸŸä¸­çš„è¡¨ç°ä¸ºï¼šç»Ÿä¸€ç®¡ç†ITèµ„æºï¼ŒåŒ…æ‹¬æœåŠ¡å™¨ã€å­˜å‚¨ã€å’Œç½‘ç»œèµ„æºç­‰ç­‰ã€‚é€šè¿‡å…±äº«èµ„æºï¼Œä½¿ç”¨æˆ·åœ¨ä½æŠ•å…¥ä¸­è·ç›Šã€‚é™¤å»çº¿ç¨‹æ± ï¼Œè¿˜æœ‰å…¶ä»–æ¯”è¾ƒå…¸å‹çš„å‡ ç§ä½¿ç”¨ç­–ç•¥åŒ…æ‹¬ï¼š å†…å­˜æ± (Memory Pooling)ï¼šé¢„å…ˆç”³è¯·å†…å­˜ï¼Œæå‡ç”³è¯·å†…å­˜é€Ÿåº¦ï¼Œå‡å°‘å†…å­˜ç¢ç‰‡ã€‚ è¿æ¥æ± (Connection Pooling)ï¼šé¢„å…ˆç”³è¯·æ•°æ®åº“è¿æ¥ï¼Œæå‡ç”³è¯·è¿æ¥çš„é€Ÿåº¦ï¼Œé™ä½ç³»ç»Ÿçš„å¼€é”€ã€‚ å®ä¾‹æ± (Object Pooling)ï¼šå¾ªç¯ä½¿ç”¨å¯¹è±¡ï¼Œå‡å°‘èµ„æºåœ¨åˆå§‹åŒ–å’Œé‡Šæ”¾æ—¶çš„æ˜‚è´µæŸè€—ã€‚ åœ¨äº†è§£å®Œâ€œæ˜¯ä»€ä¹ˆâ€å’Œâ€œä¸ºä»€ä¹ˆâ€ä¹‹åï¼Œä¸‹é¢æˆ‘ä»¬æ¥ä¸€èµ·æ·±å…¥ä¸€ä¸‹çº¿ç¨‹æ± çš„å†…éƒ¨å®ç°åŸç†ã€‚ äºŒã€çº¿ç¨‹æ± æ ¸å¿ƒè®¾è®¡ä¸å®ç° åœ¨å‰æ–‡ä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ°ï¼šçº¿ç¨‹æ± æ˜¯ä¸€ç§é€šè¿‡â€œæ± åŒ–â€æ€æƒ³ï¼Œå¸®åŠ©æˆ‘ä»¬ç®¡ç†çº¿ç¨‹è€Œè·å–å¹¶å‘æ€§çš„å·¥å…·ï¼Œåœ¨Javaä¸­çš„ä½“ç°æ˜¯ThreadPoolExecutorç±»ã€‚é‚£ä¹ˆå®ƒçš„çš„è¯¦ç»†è®¾è®¡ä¸å®ç°æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿæˆ‘ä»¬ä¼šåœ¨æœ¬ç« è¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚ 2.1 æ€»ä½“è®¾è®¡ Javaä¸­çš„çº¿ç¨‹æ± æ ¸å¿ƒå®ç°ç±»æ˜¯ThreadPoolExecutorï¼Œæœ¬ç« åŸºäºJDK 1.8çš„æºç æ¥åˆ†æJavaçº¿ç¨‹æ± çš„æ ¸å¿ƒè®¾è®¡ä¸å®ç°ã€‚æˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ThreadPoolExecutorçš„UMLç±»å›¾ï¼Œäº†è§£ä¸‹ThreadPoolExecutorçš„ç»§æ‰¿å…³ç³»ã€‚ å›¾1 ThreadPoolExecutor UMLç±»å›¾ ThreadPoolExecutorå®ç°çš„é¡¶å±‚æ¥å£æ˜¯Executorï¼Œé¡¶å±‚æ¥å£Executoræä¾›äº†ä¸€ç§æ€æƒ³ï¼šå°†ä»»åŠ¡æäº¤å’Œä»»åŠ¡æ‰§è¡Œè¿›è¡Œè§£è€¦ã€‚ç”¨æˆ·æ— éœ€å…³æ³¨å¦‚ä½•åˆ›å»ºçº¿ç¨‹ï¼Œå¦‚ä½•è°ƒåº¦çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œç”¨æˆ·åªéœ€æä¾›Runnableå¯¹è±¡ï¼Œå°†ä»»åŠ¡çš„è¿è¡Œé€»è¾‘æäº¤åˆ°æ‰§è¡Œå™¨(Executor)ä¸­ï¼Œç”±Executoræ¡†æ¶å®Œæˆçº¿ç¨‹çš„è°ƒé…å’Œä»»åŠ¡çš„æ‰§è¡Œéƒ¨åˆ†ã€‚ ExecutorServiceæ¥å£å¢åŠ äº†ä¸€äº›èƒ½åŠ›ï¼š ï¼ˆ1ï¼‰æ‰©å……æ‰§è¡Œä»»åŠ¡çš„èƒ½åŠ›ï¼Œè¡¥å……å¯ä»¥ä¸ºä¸€ä¸ªæˆ–ä¸€æ‰¹å¼‚æ­¥ä»»åŠ¡ç”ŸæˆFutureçš„æ–¹æ³•ï¼› ï¼ˆ2ï¼‰æä¾›äº†ç®¡æ§çº¿ç¨‹æ± çš„æ–¹æ³•ï¼Œæ¯”å¦‚åœæ­¢çº¿ç¨‹æ± çš„è¿è¡Œã€‚ AbstractExecutorServiceåˆ™æ˜¯ä¸Šå±‚çš„æŠ½è±¡ç±»ï¼Œå°†æ‰§è¡Œä»»åŠ¡çš„æµç¨‹ä¸²è”äº†èµ·æ¥ï¼Œä¿è¯ä¸‹å±‚çš„å®ç°åªéœ€å…³æ³¨ä¸€ä¸ªæ‰§è¡Œä»»åŠ¡çš„æ–¹æ³•å³å¯ã€‚ æœ€ä¸‹å±‚çš„å®ç°ç±»ThreadPoolExecutorå®ç°æœ€å¤æ‚çš„è¿è¡Œéƒ¨åˆ†ï¼ŒThreadPoolExecutorå°†ä¼šä¸€æ–¹é¢ç»´æŠ¤è‡ªèº«çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¦ä¸€æ–¹é¢åŒæ—¶ç®¡ç†çº¿ç¨‹å’Œä»»åŠ¡ï¼Œä½¿ä¸¤è€…è‰¯å¥½çš„ç»“åˆä»è€Œæ‰§è¡Œå¹¶è¡Œä»»åŠ¡ã€‚ ThreadPoolExecutoræ˜¯å¦‚ä½•è¿è¡Œï¼Œå¦‚ä½•åŒæ—¶ç»´æŠ¤çº¿ç¨‹å’Œæ‰§è¡Œä»»åŠ¡çš„å‘¢ï¼Ÿå…¶è¿è¡Œæœºåˆ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å›¾2 ThreadPoolExecutorè¿è¡Œæµç¨‹ çº¿ç¨‹æ± åœ¨å†…éƒ¨å®é™…ä¸Šæ„å»ºäº†ä¸€ä¸ªç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹ï¼Œå°†çº¿ç¨‹å’Œä»»åŠ¡ä¸¤è€…è§£è€¦ï¼Œå¹¶ä¸ç›´æ¥å…³è”ï¼Œä»è€Œè‰¯å¥½çš„ç¼“å†²ä»»åŠ¡ï¼Œå¤ç”¨çº¿ç¨‹ã€‚çº¿ç¨‹æ± çš„è¿è¡Œä¸»è¦åˆ†æˆä¸¤éƒ¨åˆ†ï¼šä»»åŠ¡ç®¡ç†ã€çº¿ç¨‹ç®¡ç†ã€‚ ä»»åŠ¡ç®¡ç†éƒ¨åˆ†å……å½“ç”Ÿäº§è€…çš„è§’è‰²ï¼Œå½“ä»»åŠ¡æäº¤åï¼Œçº¿ç¨‹æ± ä¼šåˆ¤æ–­è¯¥ä»»åŠ¡åç»­çš„æµè½¬ï¼š ç›´æ¥ç”³è¯·çº¿ç¨‹æ‰§è¡Œè¯¥ä»»åŠ¡ï¼› ç¼“å†²åˆ°é˜Ÿåˆ—ä¸­ç­‰å¾…çº¿ç¨‹æ‰§è¡Œï¼› æ‹’ç»è¯¥ä»»åŠ¡ã€‚ çº¿ç¨‹ç®¡ç†éƒ¨åˆ†æ˜¯æ¶ˆè´¹è€…ï¼Œå®ƒä»¬è¢«ç»Ÿä¸€ç»´æŠ¤åœ¨çº¿ç¨‹æ± å†…ï¼Œæ ¹æ®ä»»åŠ¡è¯·æ±‚è¿›è¡Œçº¿ç¨‹çš„åˆ†é…ï¼Œå½“çº¿ç¨‹æ‰§è¡Œå®Œä»»åŠ¡ååˆ™ä¼šç»§ç»­è·å–æ–°çš„ä»»åŠ¡å»æ‰§è¡Œï¼Œæœ€ç»ˆå½“çº¿ç¨‹è·å–ä¸åˆ°ä»»åŠ¡çš„æ—¶å€™ï¼Œçº¿ç¨‹å°±ä¼šè¢«å›æ”¶ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¼šæŒ‰ç…§ä»¥ä¸‹ä¸‰ä¸ªéƒ¨åˆ†å»è¯¦ç»†è®²è§£çº¿ç¨‹æ± è¿è¡Œæœºåˆ¶ï¼š çº¿ç¨‹æ± å¦‚ä½•ç»´æŠ¤è‡ªèº«çŠ¶æ€ã€‚ çº¿ç¨‹æ± å¦‚ä½•ç®¡ç†ä»»åŠ¡ã€‚ çº¿ç¨‹æ± å¦‚ä½•ç®¡ç†çº¿ç¨‹ã€‚ 2.2 ç”Ÿå‘½å‘¨æœŸç®¡ç† çº¿ç¨‹æ± è¿è¡Œçš„çŠ¶æ€ï¼Œå¹¶ä¸æ˜¯ç”¨æˆ·æ˜¾å¼è®¾ç½®çš„ï¼Œè€Œæ˜¯ä¼´éšç€çº¿ç¨‹æ± çš„è¿è¡Œï¼Œç”±å†…éƒ¨æ¥ç»´æŠ¤ã€‚çº¿ç¨‹æ± å†…éƒ¨ä½¿ç”¨ä¸€ä¸ªå˜é‡ç»´æŠ¤ä¸¤ä¸ªå€¼ï¼šè¿è¡ŒçŠ¶æ€(runState)å’Œçº¿ç¨‹æ•°é‡ (workerCount)ã€‚åœ¨å…·ä½“å®ç°ä¸­ï¼Œçº¿ç¨‹æ± å°†è¿è¡ŒçŠ¶æ€(runState)ã€çº¿ç¨‹æ•°é‡ (workerCount)ä¸¤ä¸ªå…³é”®å‚æ•°çš„ç»´æŠ¤æ”¾åœ¨äº†ä¸€èµ·ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š private final AtomicInteger ctl = new AtomicInteger(ctlOf(RUNNING, 0)); ctlè¿™ä¸ªAtomicIntegerç±»å‹ï¼Œæ˜¯å¯¹çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€å’Œçº¿ç¨‹æ± ä¸­æœ‰æ•ˆçº¿ç¨‹çš„æ•°é‡è¿›è¡Œæ§åˆ¶çš„ä¸€ä¸ªå­—æ®µï¼Œ å®ƒåŒæ—¶åŒ…å«ä¸¤éƒ¨åˆ†çš„ä¿¡æ¯ï¼šçº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€ (runState) å’Œçº¿ç¨‹æ± å†…æœ‰æ•ˆçº¿ç¨‹çš„æ•°é‡ (workerCount)ï¼Œé«˜3ä½ä¿å­˜runStateï¼Œä½29ä½ä¿å­˜workerCountï¼Œä¸¤ä¸ªå˜é‡ä¹‹é—´äº’ä¸å¹²æ‰°ã€‚ç”¨ä¸€ä¸ªå˜é‡å»å­˜å‚¨ä¸¤ä¸ªå€¼ï¼Œå¯é¿å…åœ¨åšç›¸å…³å†³ç­–æ—¶ï¼Œå‡ºç°ä¸ä¸€è‡´çš„æƒ…å†µï¼Œä¸å¿…ä¸ºäº†ç»´æŠ¤ä¸¤è€…çš„ä¸€è‡´ï¼Œè€Œå ç”¨é”èµ„æºã€‚é€šè¿‡é˜…è¯»çº¿ç¨‹æ± æºä»£ç ä¹Ÿå¯ä»¥å‘ç°ï¼Œç»å¸¸å‡ºç°è¦åŒæ—¶åˆ¤æ–­çº¿ç¨‹æ± è¿è¡ŒçŠ¶æ€å’Œçº¿ç¨‹æ•°é‡çš„æƒ…å†µã€‚çº¿ç¨‹æ± ä¹Ÿæä¾›äº†è‹¥å¹²æ–¹æ³•å»ä¾›ç”¨æˆ·è·å¾—çº¿ç¨‹æ± å½“å‰çš„è¿è¡ŒçŠ¶æ€ã€çº¿ç¨‹ä¸ªæ•°ã€‚è¿™é‡Œéƒ½ä½¿ç”¨çš„æ˜¯ä½è¿ç®—çš„æ–¹å¼ï¼Œç›¸æ¯”äºåŸºæœ¬è¿ç®—ï¼Œé€Ÿåº¦ä¹Ÿä¼šå¿«å¾ˆå¤šã€‚ å…³äºå†…éƒ¨å°è£…çš„è·å–ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ã€è·å–çº¿ç¨‹æ± çº¿ç¨‹æ•°é‡çš„è®¡ç®—æ–¹æ³•å¦‚ä»¥ä¸‹ä»£ç æ‰€ç¤ºï¼š private static int runStateOf(int c) { return c &amp; ~CAPACITY; } //è®¡ç®—å½“å‰è¿è¡ŒçŠ¶æ€ private static int workerCountOf(int c) { return c &amp; CAPACITY; } //è®¡ç®—å½“å‰çº¿ç¨‹æ•°é‡ private static int ctlOf(int rs, int wc) { return rs | wc; } //é€šè¿‡çŠ¶æ€å’Œçº¿ç¨‹æ•°ç”Ÿæˆctl ThreadPoolExecutorçš„è¿è¡ŒçŠ¶æ€æœ‰5ç§ï¼Œåˆ†åˆ«ä¸ºï¼š å…¶ç”Ÿå‘½å‘¨æœŸè½¬æ¢å¦‚ä¸‹å…¥æ‰€ç¤ºï¼š å›¾3 çº¿ç¨‹æ± ç”Ÿå‘½å‘¨æœŸ 2.3 ä»»åŠ¡æ‰§è¡Œæœºåˆ¶ 2.3.1 ä»»åŠ¡è°ƒåº¦ ä»»åŠ¡è°ƒåº¦æ˜¯çº¿ç¨‹æ± çš„ä¸»è¦å…¥å£ï¼Œå½“ç”¨æˆ·æäº¤äº†ä¸€ä¸ªä»»åŠ¡ï¼Œæ¥ä¸‹æ¥è¿™ä¸ªä»»åŠ¡å°†å¦‚ä½•æ‰§è¡Œéƒ½æ˜¯ç”±è¿™ä¸ªé˜¶æ®µå†³å®šçš„ã€‚äº†è§£è¿™éƒ¨åˆ†å°±ç›¸å½“äºäº†è§£äº†çº¿ç¨‹æ± çš„æ ¸å¿ƒè¿è¡Œæœºåˆ¶ã€‚ é¦–å…ˆï¼Œæ‰€æœ‰ä»»åŠ¡çš„è°ƒåº¦éƒ½æ˜¯ç”±executeæ–¹æ³•å®Œæˆçš„ï¼Œè¿™éƒ¨åˆ†å®Œæˆçš„å·¥ä½œæ˜¯ï¼šæ£€æŸ¥ç°åœ¨çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€ã€è¿è¡Œçº¿ç¨‹æ•°ã€è¿è¡Œç­–ç•¥ï¼Œå†³å®šæ¥ä¸‹æ¥æ‰§è¡Œçš„æµç¨‹ï¼Œæ˜¯ç›´æ¥ç”³è¯·çº¿ç¨‹æ‰§è¡Œï¼Œæˆ–æ˜¯ç¼“å†²åˆ°é˜Ÿåˆ—ä¸­æ‰§è¡Œï¼Œäº¦æˆ–æ˜¯ç›´æ¥æ‹’ç»è¯¥ä»»åŠ¡ã€‚å…¶æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š é¦–å…ˆæ£€æµ‹çº¿ç¨‹æ± è¿è¡ŒçŠ¶æ€ï¼Œå¦‚æœä¸æ˜¯RUNNINGï¼Œåˆ™ç›´æ¥æ‹’ç»ï¼Œçº¿ç¨‹æ± è¦ä¿è¯åœ¨RUNNINGçš„çŠ¶æ€ä¸‹æ‰§è¡Œä»»åŠ¡ã€‚ å¦‚æœworkerCount &lt; corePoolSizeï¼Œåˆ™åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œæ–°æäº¤çš„ä»»åŠ¡ã€‚ å¦‚æœworkerCount &gt;= corePoolSizeï¼Œä¸”çº¿ç¨‹æ± å†…çš„é˜»å¡é˜Ÿåˆ—æœªæ»¡ï¼Œåˆ™å°†ä»»åŠ¡æ·»åŠ åˆ°è¯¥é˜»å¡é˜Ÿåˆ—ä¸­ã€‚ å¦‚æœworkerCount &gt;= corePoolSize &amp;&amp; workerCount &lt; maximumPoolSizeï¼Œä¸”çº¿ç¨‹æ± å†…çš„é˜»å¡é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œæ–°æäº¤çš„ä»»åŠ¡ã€‚ å¦‚æœworkerCount &gt;= maximumPoolSizeï¼Œå¹¶ä¸”çº¿ç¨‹æ± å†…çš„é˜»å¡é˜Ÿåˆ—å·²æ»¡, åˆ™æ ¹æ®æ‹’ç»ç­–ç•¥æ¥å¤„ç†è¯¥ä»»åŠ¡, é»˜è®¤çš„å¤„ç†æ–¹å¼æ˜¯ç›´æ¥æŠ›å¼‚å¸¸ã€‚ å…¶æ‰§è¡Œæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å›¾4 ä»»åŠ¡è°ƒåº¦æµç¨‹ 2.3.2 ä»»åŠ¡ç¼“å†² ä»»åŠ¡ç¼“å†²æ¨¡å—æ˜¯çº¿ç¨‹æ± èƒ½å¤Ÿç®¡ç†ä»»åŠ¡çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚çº¿ç¨‹æ± çš„æœ¬è´¨æ˜¯å¯¹ä»»åŠ¡å’Œçº¿ç¨‹çš„ç®¡ç†ï¼Œè€Œåšåˆ°è¿™ä¸€ç‚¹æœ€å…³é”®çš„æ€æƒ³å°±æ˜¯å°†ä»»åŠ¡å’Œçº¿ç¨‹ä¸¤è€…è§£è€¦ï¼Œä¸è®©ä¸¤è€…ç›´æ¥å…³è”ï¼Œæ‰å¯ä»¥åšåç»­çš„åˆ†é…å·¥ä½œã€‚çº¿ç¨‹æ± ä¸­æ˜¯ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼Œé€šè¿‡ä¸€ä¸ªé˜»å¡é˜Ÿåˆ—æ¥å®ç°çš„ã€‚é˜»å¡é˜Ÿåˆ—ç¼“å­˜ä»»åŠ¡ï¼Œå·¥ä½œçº¿ç¨‹ä»é˜»å¡é˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡ã€‚ é˜»å¡é˜Ÿåˆ—(BlockingQueue)æ˜¯ä¸€ä¸ªæ”¯æŒä¸¤ä¸ªé™„åŠ æ“ä½œçš„é˜Ÿåˆ—ã€‚è¿™ä¸¤ä¸ªé™„åŠ çš„æ“ä½œæ˜¯ï¼šåœ¨é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œè·å–å…ƒç´ çš„çº¿ç¨‹ä¼šç­‰å¾…é˜Ÿåˆ—å˜ä¸ºéç©ºã€‚å½“é˜Ÿåˆ—æ»¡æ—¶ï¼Œå­˜å‚¨å…ƒç´ çš„çº¿ç¨‹ä¼šç­‰å¾…é˜Ÿåˆ—å¯ç”¨ã€‚é˜»å¡é˜Ÿåˆ—å¸¸ç”¨äºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„åœºæ™¯ï¼Œç”Ÿäº§è€…æ˜¯å¾€é˜Ÿåˆ—é‡Œæ·»åŠ å…ƒç´ çš„çº¿ç¨‹ï¼Œæ¶ˆè´¹è€…æ˜¯ä»é˜Ÿåˆ—é‡Œæ‹¿å…ƒç´ çš„çº¿ç¨‹ã€‚é˜»å¡é˜Ÿåˆ—å°±æ˜¯ç”Ÿäº§è€…å­˜æ”¾å…ƒç´ çš„å®¹å™¨ï¼Œè€Œæ¶ˆè´¹è€…ä¹Ÿåªä»å®¹å™¨é‡Œæ‹¿å…ƒç´ ã€‚ ä¸‹å›¾ä¸­å±•ç¤ºäº†çº¿ç¨‹1å¾€é˜»å¡é˜Ÿåˆ—ä¸­æ·»åŠ å…ƒç´ ï¼Œè€Œçº¿ç¨‹2ä»é˜»å¡é˜Ÿåˆ—ä¸­ç§»é™¤å…ƒç´ ï¼š å›¾5 é˜»å¡é˜Ÿåˆ— ä½¿ç”¨ä¸åŒçš„é˜Ÿåˆ—å¯ä»¥å®ç°ä¸ä¸€æ ·çš„ä»»åŠ¡å­˜å–ç­–ç•¥ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å†ä»‹ç»ä¸‹é˜»å¡é˜Ÿåˆ—çš„æˆå‘˜ï¼š 2.3.3 ä»»åŠ¡ç”³è¯· ç”±ä¸Šæ–‡çš„ä»»åŠ¡åˆ†é…éƒ¨åˆ†å¯çŸ¥ï¼Œä»»åŠ¡çš„æ‰§è¡Œæœ‰ä¸¤ç§å¯èƒ½ï¼šä¸€ç§æ˜¯ä»»åŠ¡ç›´æ¥ç”±æ–°åˆ›å»ºçš„çº¿ç¨‹æ‰§è¡Œã€‚å¦ä¸€ç§æ˜¯çº¿ç¨‹ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡ç„¶åæ‰§è¡Œï¼Œæ‰§è¡Œå®Œä»»åŠ¡çš„ç©ºé—²çº¿ç¨‹ä¼šå†æ¬¡å»ä»é˜Ÿåˆ—ä¸­ç”³è¯·ä»»åŠ¡å†å»æ‰§è¡Œã€‚ç¬¬ä¸€ç§æƒ…å†µä»…å‡ºç°åœ¨çº¿ç¨‹åˆå§‹åˆ›å»ºçš„æ—¶å€™ï¼Œç¬¬äºŒç§æ˜¯çº¿ç¨‹è·å–ä»»åŠ¡ç»å¤§å¤šæ•°çš„æƒ…å†µã€‚ çº¿ç¨‹éœ€è¦ä»ä»»åŠ¡ç¼“å­˜æ¨¡å—ä¸­ä¸æ–­åœ°å–ä»»åŠ¡æ‰§è¡Œï¼Œå¸®åŠ©çº¿ç¨‹ä»é˜»å¡é˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡ï¼Œå®ç°çº¿ç¨‹ç®¡ç†æ¨¡å—å’Œä»»åŠ¡ç®¡ç†æ¨¡å—ä¹‹é—´çš„é€šä¿¡ã€‚è¿™éƒ¨åˆ†ç­–ç•¥ç”±getTaskæ–¹æ³•å®ç°ï¼Œå…¶æ‰§è¡Œæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å›¾6 è·å–ä»»åŠ¡æµç¨‹å›¾ getTaskè¿™éƒ¨åˆ†è¿›è¡Œäº†å¤šæ¬¡åˆ¤æ–­ï¼Œä¸ºçš„æ˜¯æ§åˆ¶çº¿ç¨‹çš„æ•°é‡ï¼Œä½¿å…¶ç¬¦åˆçº¿ç¨‹æ± çš„çŠ¶æ€ã€‚å¦‚æœçº¿ç¨‹æ± ç°åœ¨ä¸åº”è¯¥æŒæœ‰é‚£ä¹ˆå¤šçº¿ç¨‹ï¼Œåˆ™ä¼šè¿”å›nullå€¼ã€‚å·¥ä½œçº¿ç¨‹Workerä¼šä¸æ–­æ¥æ”¶æ–°ä»»åŠ¡å»æ‰§è¡Œï¼Œè€Œå½“å·¥ä½œçº¿ç¨‹Workeræ¥æ”¶ä¸åˆ°ä»»åŠ¡çš„æ—¶å€™ï¼Œå°±ä¼šå¼€å§‹è¢«å›æ”¶ã€‚ 2.3.4 ä»»åŠ¡æ‹’ç» ä»»åŠ¡æ‹’ç»æ¨¡å—æ˜¯çº¿ç¨‹æ± çš„ä¿æŠ¤éƒ¨åˆ†ï¼Œçº¿ç¨‹æ± æœ‰ä¸€ä¸ªæœ€å¤§çš„å®¹é‡ï¼Œå½“çº¿ç¨‹æ± çš„ä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—å·²æ»¡ï¼Œå¹¶ä¸”çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®è¾¾åˆ°maximumPoolSizeæ—¶ï¼Œå°±éœ€è¦æ‹’ç»æ‰è¯¥ä»»åŠ¡ï¼Œé‡‡å–ä»»åŠ¡æ‹’ç»ç­–ç•¥ï¼Œä¿æŠ¤çº¿ç¨‹æ± ã€‚ æ‹’ç»ç­–ç•¥æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå…¶è®¾è®¡å¦‚ä¸‹ï¼š public interface RejectedExecutionHandler { void rejectedExecution(Runnable r, ThreadPoolExecutor executor); } ç”¨æˆ·å¯ä»¥é€šè¿‡å®ç°è¿™ä¸ªæ¥å£å»å®šåˆ¶æ‹’ç»ç­–ç•¥ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©JDKæä¾›çš„å››ç§å·²æœ‰æ‹’ç»ç­–ç•¥ï¼Œå…¶ç‰¹ç‚¹å¦‚ä¸‹ï¼š 2.4 Workerçº¿ç¨‹ç®¡ç† 2.4.1 Workerçº¿ç¨‹ çº¿ç¨‹æ± ä¸ºäº†æŒæ¡çº¿ç¨‹çš„çŠ¶æ€å¹¶ç»´æŠ¤çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼Œè®¾è®¡äº†çº¿ç¨‹æ± å†…çš„å·¥ä½œçº¿ç¨‹Workerã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å®ƒçš„éƒ¨åˆ†ä»£ç ï¼š private final class Worker extends AbstractQueuedSynchronizer implements Runnable{ final Thread thread;//WorkeræŒæœ‰çš„çº¿ç¨‹ Runnable firstTask;//åˆå§‹åŒ–çš„ä»»åŠ¡ï¼Œå¯ä»¥ä¸ºnull } Workerè¿™ä¸ªå·¥ä½œçº¿ç¨‹ï¼Œå®ç°äº†Runnableæ¥å£ï¼Œå¹¶æŒæœ‰ä¸€ä¸ªçº¿ç¨‹threadï¼Œä¸€ä¸ªåˆå§‹åŒ–çš„ä»»åŠ¡firstTaskã€‚threadæ˜¯åœ¨è°ƒç”¨æ„é€ æ–¹æ³•æ—¶é€šè¿‡ThreadFactoryæ¥åˆ›å»ºçš„çº¿ç¨‹ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡Œä»»åŠ¡ï¼›firstTaskç”¨å®ƒæ¥ä¿å­˜ä¼ å…¥çš„ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œè¿™ä¸ªä»»åŠ¡å¯ä»¥æœ‰ä¹Ÿå¯ä»¥ä¸ºnullã€‚å¦‚æœè¿™ä¸ªå€¼æ˜¯éç©ºçš„ï¼Œé‚£ä¹ˆçº¿ç¨‹å°±ä¼šåœ¨å¯åŠ¨åˆæœŸç«‹å³æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ï¼Œä¹Ÿå°±å¯¹åº”æ ¸å¿ƒçº¿ç¨‹åˆ›å»ºæ—¶çš„æƒ…å†µï¼›å¦‚æœè¿™ä¸ªå€¼æ˜¯nullï¼Œé‚£ä¹ˆå°±éœ€è¦åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡åˆ—è¡¨ï¼ˆworkQueueï¼‰ä¸­çš„ä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯éæ ¸å¿ƒçº¿ç¨‹çš„åˆ›å»ºã€‚ Workeræ‰§è¡Œä»»åŠ¡çš„æ¨¡å‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š çº¿ç¨‹æ± éœ€è¦ç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼Œéœ€è¦åœ¨çº¿ç¨‹é•¿æ—¶é—´ä¸è¿è¡Œçš„æ—¶å€™è¿›è¡Œå›æ”¶ã€‚çº¿ç¨‹æ± ä½¿ç”¨ä¸€å¼ Hashè¡¨å»æŒæœ‰çº¿ç¨‹çš„å¼•ç”¨ï¼Œè¿™æ ·å¯ä»¥é€šè¿‡æ·»åŠ å¼•ç”¨ã€ç§»é™¤å¼•ç”¨è¿™æ ·çš„æ“ä½œæ¥æ§åˆ¶çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™ä¸ªæ—¶å€™é‡è¦çš„å°±æ˜¯å¦‚ä½•åˆ¤æ–­çº¿ç¨‹æ˜¯å¦åœ¨è¿è¡Œã€‚ â€‹Workeræ˜¯é€šè¿‡ç»§æ‰¿AQSï¼Œä½¿ç”¨AQSæ¥å®ç°ç‹¬å é”è¿™ä¸ªåŠŸèƒ½ã€‚æ²¡æœ‰ä½¿ç”¨å¯é‡å…¥é”ReentrantLockï¼Œè€Œæ˜¯ä½¿ç”¨AQSï¼Œä¸ºçš„å°±æ˜¯å®ç°ä¸å¯é‡å…¥çš„ç‰¹æ€§å»ååº”çº¿ç¨‹ç°åœ¨çš„æ‰§è¡ŒçŠ¶æ€ã€‚ 1.lockæ–¹æ³•ä¸€æ—¦è·å–äº†ç‹¬å é”ï¼Œè¡¨ç¤ºå½“å‰çº¿ç¨‹æ­£åœ¨æ‰§è¡Œä»»åŠ¡ä¸­ã€‚ 2.å¦‚æœæ­£åœ¨æ‰§è¡Œä»»åŠ¡ï¼Œåˆ™ä¸åº”è¯¥ä¸­æ–­çº¿ç¨‹ã€‚ 3.å¦‚æœè¯¥çº¿ç¨‹ç°åœ¨ä¸æ˜¯ç‹¬å é”çš„çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯ç©ºé—²çš„çŠ¶æ€ï¼Œè¯´æ˜å®ƒæ²¡æœ‰åœ¨å¤„ç†ä»»åŠ¡ï¼Œè¿™æ—¶å¯ä»¥å¯¹è¯¥çº¿ç¨‹è¿›è¡Œä¸­æ–­ã€‚ 4.çº¿ç¨‹æ± åœ¨æ‰§è¡Œshutdownæ–¹æ³•æˆ–tryTerminateæ–¹æ³•æ—¶ä¼šè°ƒç”¨interruptIdleWorkersæ–¹æ³•æ¥ä¸­æ–­ç©ºé—²çš„çº¿ç¨‹ï¼ŒinterruptIdleWorkersæ–¹æ³•ä¼šä½¿ç”¨tryLockæ–¹æ³•æ¥åˆ¤æ–­çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ˜¯å¦æ˜¯ç©ºé—²çŠ¶æ€ï¼›å¦‚æœçº¿ç¨‹æ˜¯ç©ºé—²çŠ¶æ€åˆ™å¯ä»¥å®‰å…¨å›æ”¶ã€‚ åœ¨çº¿ç¨‹å›æ”¶è¿‡ç¨‹ä¸­å°±ä½¿ç”¨åˆ°äº†è¿™ç§ç‰¹æ€§ï¼Œå›æ”¶è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š 2.4.2 Workerçº¿ç¨‹å¢åŠ  å¢åŠ çº¿ç¨‹æ˜¯é€šè¿‡çº¿ç¨‹æ± ä¸­çš„addWorkeræ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„åŠŸèƒ½å°±æ˜¯å¢åŠ ä¸€ä¸ªçº¿ç¨‹ï¼Œè¯¥æ–¹æ³•ä¸è€ƒè™‘çº¿ç¨‹æ± æ˜¯åœ¨å“ªä¸ªé˜¶æ®µå¢åŠ çš„è¯¥çº¿ç¨‹ï¼Œè¿™ä¸ªåˆ†é…çº¿ç¨‹çš„ç­–ç•¥æ˜¯åœ¨ä¸Šä¸ªæ­¥éª¤å®Œæˆçš„ï¼Œè¯¥æ­¥éª¤ä»…ä»…å®Œæˆå¢åŠ çº¿ç¨‹ï¼Œå¹¶ä½¿å®ƒè¿è¡Œï¼Œæœ€åè¿”å›æ˜¯å¦æˆåŠŸè¿™ä¸ªç»“æœã€‚addWorkeræ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼šfirstTaskã€coreã€‚firstTaskå‚æ•°ç”¨äºæŒ‡å®šæ–°å¢çš„çº¿ç¨‹æ‰§è¡Œçš„ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œè¯¥å‚æ•°å¯ä»¥ä¸ºç©ºï¼›coreå‚æ•°ä¸ºtrueè¡¨ç¤ºåœ¨æ–°å¢çº¿ç¨‹æ—¶ä¼šåˆ¤æ–­å½“å‰æ´»åŠ¨çº¿ç¨‹æ•°æ˜¯å¦å°‘äºcorePoolSizeï¼Œfalseè¡¨ç¤ºæ–°å¢çº¿ç¨‹å‰éœ€è¦åˆ¤æ–­å½“å‰æ´»åŠ¨çº¿ç¨‹æ•°æ˜¯å¦å°‘äºmaximumPoolSizeï¼Œå…¶æ‰§è¡Œæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š 2.4.3 Workerçº¿ç¨‹å›æ”¶ çº¿ç¨‹æ± ä¸­çº¿ç¨‹çš„é”€æ¯ä¾èµ–JVMè‡ªåŠ¨çš„å›æ”¶ï¼Œçº¿ç¨‹æ± åšçš„å·¥ä½œæ˜¯æ ¹æ®å½“å‰çº¿ç¨‹æ± çš„çŠ¶æ€ç»´æŠ¤ä¸€å®šæ•°é‡çš„çº¿ç¨‹å¼•ç”¨ï¼Œé˜²æ­¢è¿™éƒ¨åˆ†çº¿ç¨‹è¢«JVMå›æ”¶ï¼Œå½“çº¿ç¨‹æ± å†³å®šå“ªäº›çº¿ç¨‹éœ€è¦å›æ”¶æ—¶ï¼Œåªéœ€è¦å°†å…¶å¼•ç”¨æ¶ˆé™¤å³å¯ã€‚Workerè¢«åˆ›å»ºå‡ºæ¥åï¼Œå°±ä¼šä¸æ–­åœ°è¿›è¡Œè½®è¯¢ï¼Œç„¶åè·å–ä»»åŠ¡å»æ‰§è¡Œï¼Œæ ¸å¿ƒçº¿ç¨‹å¯ä»¥æ— é™ç­‰å¾…è·å–ä»»åŠ¡ï¼Œéæ ¸å¿ƒçº¿ç¨‹è¦é™æ—¶è·å–ä»»åŠ¡ã€‚å½“Workeræ— æ³•è·å–åˆ°ä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯è·å–çš„ä»»åŠ¡ä¸ºç©ºæ—¶ï¼Œå¾ªç¯ä¼šç»“æŸï¼ŒWorkerä¼šä¸»åŠ¨æ¶ˆé™¤è‡ªèº«åœ¨çº¿ç¨‹æ± å†…çš„å¼•ç”¨ã€‚ try { while (task != null || (task = getTask()) != null) { //æ‰§è¡Œä»»åŠ¡ } } finally { processWorkerExit(w, completedAbruptly);//è·å–ä¸åˆ°ä»»åŠ¡æ—¶ï¼Œä¸»åŠ¨å›æ”¶è‡ªå·± } çº¿ç¨‹å›æ”¶çš„å·¥ä½œæ˜¯åœ¨processWorkerExitæ–¹æ³•å®Œæˆçš„ã€‚ äº‹å®ä¸Šï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œå°†çº¿ç¨‹å¼•ç”¨ç§»å‡ºçº¿ç¨‹æ± å°±å·²ç»ç»“æŸäº†çº¿ç¨‹é”€æ¯çš„éƒ¨åˆ†ã€‚ä½†ç”±äºå¼•èµ·çº¿ç¨‹é”€æ¯çš„å¯èƒ½æ€§æœ‰å¾ˆå¤šï¼Œçº¿ç¨‹æ± è¿˜è¦åˆ¤æ–­æ˜¯ä»€ä¹ˆå¼•å‘äº†è¿™æ¬¡é”€æ¯ï¼Œæ˜¯å¦è¦æ”¹å˜çº¿ç¨‹æ± çš„ç°é˜¶æ®µçŠ¶æ€ï¼Œæ˜¯å¦è¦æ ¹æ®æ–°çŠ¶æ€ï¼Œé‡æ–°åˆ†é…çº¿ç¨‹ã€‚ 2.4.4 Workerçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ åœ¨Workerç±»ä¸­çš„runæ–¹æ³•è°ƒç”¨äº†runWorkeræ–¹æ³•æ¥æ‰§è¡Œä»»åŠ¡ï¼ŒrunWorkeræ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š 1.whileå¾ªç¯ä¸æ–­åœ°é€šè¿‡getTask()æ–¹æ³•è·å–ä»»åŠ¡ã€‚ 2.getTask()æ–¹æ³•ä»é˜»å¡é˜Ÿåˆ—ä¸­å–ä»»åŠ¡ã€‚ 3.å¦‚æœçº¿ç¨‹æ± æ­£åœ¨åœæ­¢ï¼Œé‚£ä¹ˆè¦ä¿è¯å½“å‰çº¿ç¨‹æ˜¯ä¸­æ–­çŠ¶æ€ï¼Œå¦åˆ™è¦ä¿è¯å½“å‰çº¿ç¨‹ä¸æ˜¯ä¸­æ–­çŠ¶æ€ã€‚ 4.æ‰§è¡Œä»»åŠ¡ã€‚ 5.å¦‚æœgetTaskç»“æœä¸ºnullåˆ™è·³å‡ºå¾ªç¯ï¼Œæ‰§è¡ŒprocessWorkerExit()æ–¹æ³•ï¼Œé”€æ¯çº¿ç¨‹ã€‚ æ‰§è¡Œæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸‰ã€çº¿ç¨‹æ± åœ¨ä¸šåŠ¡ä¸­çš„å®è·µ 3.1 ä¸šåŠ¡èƒŒæ™¯ åœ¨å½“ä»Šçš„äº’è”ç½‘ä¸šç•Œï¼Œä¸ºäº†æœ€å¤§ç¨‹åº¦åˆ©ç”¨CPUçš„å¤šæ ¸æ€§èƒ½ï¼Œå¹¶è¡Œè¿ç®—çš„èƒ½åŠ›æ˜¯ä¸å¯æˆ–ç¼ºçš„ã€‚é€šè¿‡çº¿ç¨‹æ± ç®¡ç†çº¿ç¨‹è·å–å¹¶å‘æ€§æ˜¯ä¸€ä¸ªéå¸¸åŸºç¡€çš„æ“ä½œï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸¤ä¸ªå…¸å‹çš„ä½¿ç”¨çº¿ç¨‹æ± è·å–å¹¶å‘æ€§çš„åœºæ™¯ã€‚ åœºæ™¯1ï¼šå¿«é€Ÿå“åº”ç”¨æˆ·è¯·æ±‚ æè¿°ï¼šç”¨æˆ·å‘èµ·çš„å®æ—¶è¯·æ±‚ï¼ŒæœåŠ¡è¿½æ±‚å“åº”æ—¶é—´ã€‚æ¯”å¦‚è¯´ç”¨æˆ·è¦æŸ¥çœ‹ä¸€ä¸ªå•†å“çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å°†å•†å“ç»´åº¦çš„ä¸€ç³»åˆ—ä¿¡æ¯å¦‚å•†å“çš„ä»·æ ¼ã€ä¼˜æƒ ã€åº“å­˜ã€å›¾ç‰‡ç­‰ç­‰èšåˆèµ·æ¥ï¼Œå±•ç¤ºç»™ç”¨æˆ·ã€‚ åˆ†æï¼šä»ç”¨æˆ·ä½“éªŒè§’åº¦çœ‹ï¼Œè¿™ä¸ªç»“æœå“åº”çš„è¶Šå¿«è¶Šå¥½ï¼Œå¦‚æœä¸€ä¸ªé¡µé¢åŠå¤©éƒ½åˆ·ä¸å‡ºï¼Œç”¨æˆ·å¯èƒ½å°±æ”¾å¼ƒæŸ¥çœ‹è¿™ä¸ªå•†å“äº†ã€‚è€Œé¢å‘ç”¨æˆ·çš„åŠŸèƒ½èšåˆé€šå¸¸éå¸¸å¤æ‚ï¼Œä¼´éšç€è°ƒç”¨ä¸è°ƒç”¨ä¹‹é—´çš„çº§è”ã€å¤šçº§çº§è”ç­‰æƒ…å†µï¼Œä¸šåŠ¡å¼€å‘åŒå­¦å¾€å¾€ä¼šé€‰æ‹©ä½¿ç”¨çº¿ç¨‹æ± è¿™ç§ç®€å•çš„æ–¹å¼ï¼Œå°†è°ƒç”¨å°è£…æˆä»»åŠ¡å¹¶è¡Œçš„æ‰§è¡Œï¼Œç¼©çŸ­æ€»ä½“å“åº”æ—¶é—´ã€‚å¦å¤–ï¼Œä½¿ç”¨çº¿ç¨‹æ± ä¹Ÿæ˜¯æœ‰è€ƒé‡çš„ï¼Œè¿™ç§åœºæ™¯æœ€é‡è¦çš„å°±æ˜¯è·å–æœ€å¤§çš„å“åº”é€Ÿåº¦å»æ»¡è¶³ç”¨æˆ·ï¼Œæ‰€ä»¥åº”è¯¥ä¸è®¾ç½®é˜Ÿåˆ—å»ç¼“å†²å¹¶å‘ä»»åŠ¡ï¼Œè°ƒé«˜corePoolSizeå’ŒmaxPoolSizeå»å°½å¯èƒ½åˆ›é€ å¤šçš„çº¿ç¨‹å¿«é€Ÿæ‰§è¡Œä»»åŠ¡ã€‚ åœºæ™¯2ï¼šå¿«é€Ÿå¤„ç†æ‰¹é‡ä»»åŠ¡ æè¿°ï¼šç¦»çº¿çš„å¤§é‡è®¡ç®—ä»»åŠ¡ï¼Œéœ€è¦å¿«é€Ÿæ‰§è¡Œã€‚æ¯”å¦‚è¯´ï¼Œç»Ÿè®¡æŸä¸ªæŠ¥è¡¨ï¼Œéœ€è¦è®¡ç®—å‡ºå…¨å›½å„ä¸ªé—¨åº—ä¸­æœ‰å“ªäº›å•†å“æœ‰æŸç§å±æ€§ï¼Œç”¨äºåç»­è¥é”€ç­–ç•¥çš„åˆ†æï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦æŸ¥è¯¢å…¨å›½æ‰€æœ‰é—¨åº—ä¸­çš„æ‰€æœ‰å•†å“ï¼Œå¹¶ä¸”è®°å½•å…·æœ‰æŸå±æ€§çš„å•†å“ï¼Œç„¶åå¿«é€Ÿç”ŸæˆæŠ¥è¡¨ã€‚ åˆ†æï¼šè¿™ç§åœºæ™¯éœ€è¦æ‰§è¡Œå¤§é‡çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬ä¹Ÿä¼šå¸Œæœ›ä»»åŠ¡æ‰§è¡Œçš„è¶Šå¿«è¶Šå¥½ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä¹Ÿåº”è¯¥ä½¿ç”¨å¤šçº¿ç¨‹ç­–ç•¥ï¼Œå¹¶è¡Œè®¡ç®—ã€‚ä½†ä¸å“åº”é€Ÿåº¦ä¼˜å…ˆçš„åœºæ™¯åŒºåˆ«åœ¨äºï¼Œè¿™ç±»åœºæ™¯ä»»åŠ¡é‡å·¨å¤§ï¼Œå¹¶ä¸éœ€è¦ç¬æ—¶çš„å®Œæˆï¼Œè€Œæ˜¯å…³æ³¨å¦‚ä½•ä½¿ç”¨æœ‰é™çš„èµ„æºï¼Œå°½å¯èƒ½åœ¨å•ä½æ—¶é—´å†…å¤„ç†æ›´å¤šçš„ä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯ååé‡ä¼˜å…ˆçš„é—®é¢˜ã€‚æ‰€ä»¥åº”è¯¥è®¾ç½®é˜Ÿåˆ—å»ç¼“å†²å¹¶å‘ä»»åŠ¡ï¼Œè°ƒæ•´åˆé€‚çš„corePoolSizeå»è®¾ç½®å¤„ç†ä»»åŠ¡çš„çº¿ç¨‹æ•°ã€‚åœ¨è¿™é‡Œï¼Œè®¾ç½®çš„çº¿ç¨‹æ•°è¿‡å¤šå¯èƒ½è¿˜ä¼šå¼•å‘çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢é¢‘ç¹çš„é—®é¢˜ï¼Œä¹Ÿä¼šé™ä½å¤„ç†ä»»åŠ¡çš„é€Ÿåº¦ï¼Œé™ä½ååé‡ã€‚ 3.2 å®é™…é—®é¢˜åŠæ–¹æ¡ˆæ€è€ƒ çº¿ç¨‹æ± ä½¿ç”¨é¢ä¸´çš„æ ¸å¿ƒçš„é—®é¢˜åœ¨äºï¼šçº¿ç¨‹æ± çš„å‚æ•°å¹¶ä¸å¥½é…ç½®ã€‚ä¸€æ–¹é¢çº¿ç¨‹æ± çš„è¿è¡Œæœºåˆ¶ä¸æ˜¯å¾ˆå¥½ç†è§£ï¼Œé…ç½®åˆç†éœ€è¦å¼ºä¾èµ–å¼€å‘äººå‘˜çš„ä¸ªäººç»éªŒå’ŒçŸ¥è¯†ï¼›å¦ä¸€æ–¹é¢ï¼Œçº¿ç¨‹æ± æ‰§è¡Œçš„æƒ…å†µå’Œä»»åŠ¡ç±»å‹ç›¸å…³æ€§è¾ƒå¤§ï¼ŒIOå¯†é›†å‹å’ŒCPUå¯†é›†å‹çš„ä»»åŠ¡è¿è¡Œèµ·æ¥çš„æƒ…å†µå·®å¼‚éå¸¸å¤§ï¼Œè¿™å¯¼è‡´ä¸šç•Œå¹¶æ²¡æœ‰ä¸€äº›æˆç†Ÿçš„ç»éªŒç­–ç•¥å¸®åŠ©å¼€å‘äººå‘˜å‚è€ƒã€‚ å…³äºçº¿ç¨‹æ± é…ç½®ä¸åˆç†å¼•å‘çš„æ•…éšœï¼Œå…¬å¸å†…éƒ¨æœ‰è¾ƒå¤šè®°å½•ï¼Œä¸‹é¢ä¸¾ä¸€äº›ä¾‹å­ï¼š Case1ï¼š2018å¹´XXé¡µé¢å±•ç¤ºæ¥å£å¤§é‡è°ƒç”¨é™çº§ï¼š äº‹æ•…æè¿°ï¼šXXé¡µé¢å±•ç¤ºæ¥å£äº§ç”Ÿå¤§é‡è°ƒç”¨é™çº§ï¼Œæ•°é‡çº§åœ¨å‡ ååˆ°ä¸Šç™¾ã€‚ äº‹æ•…åŸå› ï¼šè¯¥æœåŠ¡å±•ç¤ºæ¥å£å†…éƒ¨é€»è¾‘ä½¿ç”¨çº¿ç¨‹æ± åšå¹¶è¡Œè®¡ç®—ï¼Œç”±äºæ²¡æœ‰é¢„ä¼°å¥½è°ƒç”¨çš„æµé‡ï¼Œå¯¼è‡´æœ€å¤§æ ¸å¿ƒæ•°è®¾ç½®åå°ï¼Œå¤§é‡æŠ›å‡ºRejectedExecutionExceptionï¼Œè§¦å‘æ¥å£é™çº§æ¡ä»¶ï¼Œç¤ºæ„å›¾çº¿ç¨‹æ•°æ ¸å¿ƒè®¾ç½®è¿‡å°å¼•å‘RejectExecutionExceptionå¦‚ä¸‹ï¼š Case2ï¼š2018å¹´XXä¸šåŠ¡æœåŠ¡ä¸å¯ç”¨S2çº§æ•…éšœ äº‹æ•…æè¿°ï¼šXXä¸šåŠ¡æä¾›çš„æœåŠ¡æ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œä½œä¸ºä¸Šæ¸¸æœåŠ¡æ•´ä½“è¶…æ—¶ï¼Œå¤§é‡ä¸‹æ¸¸æœåŠ¡è°ƒç”¨å¤±è´¥ã€‚ äº‹æ•…åŸå› ï¼šè¯¥æœåŠ¡å¤„ç†è¯·æ±‚å†…éƒ¨é€»è¾‘ä½¿ç”¨çº¿ç¨‹æ± åšèµ„æºéš”ç¦»ï¼Œç”±äºé˜Ÿåˆ—è®¾ç½®è¿‡é•¿ï¼Œæœ€å¤§çº¿ç¨‹æ•°è®¾ç½®å¤±æ•ˆï¼Œå¯¼è‡´è¯·æ±‚æ•°é‡å¢åŠ æ—¶ï¼Œå¤§é‡ä»»åŠ¡å †ç§¯åœ¨é˜Ÿåˆ—ä¸­ï¼Œä»»åŠ¡æ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œæœ€ç»ˆå¯¼è‡´ä¸‹æ¸¸æœåŠ¡çš„å¤§é‡è°ƒç”¨è¶…æ—¶å¤±è´¥ã€‚ç¤ºæ„å›¾çº¿ç¨‹æ± é˜Ÿåˆ—é•¿åº¦è®¾ç½®è¿‡é•¿ã€corePoolSizeè®¾ç½®è¿‡å°å¯¼è‡´ä»»åŠ¡æ‰§è¡Œé€Ÿåº¦ä½å¦‚ä¸‹ï¼š ä¸šåŠ¡ä¸­è¦ä½¿ç”¨çº¿ç¨‹æ± ï¼Œè€Œä½¿ç”¨ä¸å½“åˆä¼šå¯¼è‡´æ•…éšœï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€æ ·æ‰èƒ½æ›´å¥½åœ°ä½¿ç”¨çº¿ç¨‹æ± å‘¢ï¼Ÿé’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¸‹é¢å»¶å±•å‡ ä¸ªæ–¹å‘ï¼š 1. èƒ½å¦ä¸ç”¨çº¿ç¨‹æ± ? å›åˆ°æœ€åˆçš„é—®é¢˜ï¼Œä¸šåŠ¡ä½¿ç”¨çº¿ç¨‹æ± æ˜¯ä¸ºäº†è·å–å¹¶å‘æ€§ï¼Œå¯¹äºè·å–å¹¶å‘æ€§ï¼Œæ˜¯å¦å¯ä»¥æœ‰ä»€ä¹ˆå…¶ä»–çš„æ–¹æ¡ˆå‘¢æ›¿ä»£ï¼Ÿæˆ‘ä»¬å°è¯•è¿›è¡Œäº†ä¸€äº›å…¶ä»–æ–¹æ¡ˆçš„è°ƒç ”ï¼š ç»¼åˆè€ƒè™‘ï¼Œè¿™äº›æ–°çš„æ–¹æ¡ˆéƒ½èƒ½åœ¨æŸç§æƒ…å†µä¸‹æå‡å¹¶è¡Œä»»åŠ¡çš„æ€§èƒ½ï¼Œç„¶è€Œæœ¬æ¬¡é‡ç‚¹è§£å†³çš„é—®é¢˜æ˜¯å¦‚ä½•æ›´ç®€æ˜“ã€æ›´å®‰å…¨åœ°è·å¾—çš„å¹¶å‘æ€§ã€‚å¦å¤–ï¼ŒActoræ¨¡å‹çš„åº”ç”¨å®é™…ä¸Šç”šå°‘ï¼Œåªåœ¨Scalaä¸­ä½¿ç”¨å¹¿æ³›ï¼Œåç¨‹æ¡†æ¶åœ¨Javaä¸­ç»´æŠ¤çš„ä¹Ÿä¸æˆç†Ÿã€‚è¿™ä¸‰è€…ç°é˜¶æ®µéƒ½ä¸æ˜¯è¶³å¤Ÿçš„æ˜“ç”¨ï¼Œä¹Ÿå¹¶ä¸èƒ½è§£å†³ä¸šåŠ¡ä¸Šç°é˜¶æ®µçš„é—®é¢˜ã€‚ 2. è¿½æ±‚å‚æ•°è®¾ç½®åˆç†æ€§ï¼Ÿ æœ‰æ²¡æœ‰ä¸€ç§è®¡ç®—å…¬å¼ï¼Œèƒ½å¤Ÿè®©å¼€å‘åŒå­¦å¾ˆç®€æ˜“åœ°è®¡ç®—å‡ºæŸç§åœºæ™¯ä¸­çš„çº¿ç¨‹æ± åº”è¯¥æ˜¯ä»€ä¹ˆå‚æ•°å‘¢ï¼Ÿ å¸¦ç€è¿™æ ·çš„ç–‘é—®ï¼Œæˆ‘ä»¬è°ƒç ”äº†ä¸šç•Œçš„ä¸€äº›çº¿ç¨‹æ± å‚æ•°é…ç½®æ–¹æ¡ˆï¼š è°ƒç ”äº†ä»¥ä¸Šä¸šç•Œæ–¹æ¡ˆåï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰å¾—å‡ºé€šç”¨çš„çº¿ç¨‹æ± è®¡ç®—æ–¹å¼ã€‚å¹¶å‘ä»»åŠ¡çš„æ‰§è¡Œæƒ…å†µå’Œä»»åŠ¡ç±»å‹ç›¸å…³ï¼ŒIOå¯†é›†å‹å’ŒCPUå¯†é›†å‹çš„ä»»åŠ¡è¿è¡Œèµ·æ¥çš„æƒ…å†µå·®å¼‚éå¸¸å¤§ï¼Œä½†è¿™ç§å æ¯”æ˜¯è¾ƒéš¾åˆç†é¢„ä¼°çš„ï¼Œè¿™å¯¼è‡´å¾ˆéš¾æœ‰ä¸€ä¸ªç®€å•æœ‰æ•ˆçš„é€šç”¨å…¬å¼å¸®æˆ‘ä»¬ç›´æ¥è®¡ç®—å‡ºç»“æœã€‚ 3. çº¿ç¨‹æ± å‚æ•°åŠ¨æ€åŒ–ï¼Ÿ å°½ç®¡ç»è¿‡è°¨æ…çš„è¯„ä¼°ï¼Œä»ç„¶ä¸èƒ½å¤Ÿä¿è¯ä¸€æ¬¡è®¡ç®—å‡ºæ¥åˆé€‚çš„å‚æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥å°†ä¿®æ”¹çº¿ç¨‹æ± å‚æ•°çš„æˆæœ¬é™ä¸‹æ¥ï¼Œè¿™æ ·è‡³å°‘å¯ä»¥å‘ç”Ÿæ•…éšœçš„æ—¶å€™å¯ä»¥å¿«é€Ÿè°ƒæ•´ä»è€Œç¼©çŸ­æ•…éšœæ¢å¤çš„æ—¶é—´å‘¢ï¼ŸåŸºäºè¿™ä¸ªæ€è€ƒï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥å°†çº¿ç¨‹æ± çš„å‚æ•°ä»ä»£ç ä¸­è¿ç§»åˆ°åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒä¸Šï¼Œå®ç°çº¿ç¨‹æ± å‚æ•°å¯åŠ¨æ€é…ç½®å’Œå³æ—¶ç”Ÿæ•ˆï¼Œçº¿ç¨‹æ± å‚æ•°åŠ¨æ€åŒ–å‰åçš„å‚æ•°ä¿®æ”¹æµç¨‹å¯¹æ¯”å¦‚ä¸‹ï¼š åŸºäºä»¥ä¸Šä¸‰ä¸ªæ–¹å‘å¯¹æ¯”ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºå‚æ•°åŠ¨æ€åŒ–æ–¹å‘ç®€å•æœ‰æ•ˆã€‚ 3.3 åŠ¨æ€åŒ–çº¿ç¨‹æ±  3.3.1 æ•´ä½“è®¾è®¡ åŠ¨æ€åŒ–çº¿ç¨‹æ± çš„æ ¸å¿ƒè®¾è®¡åŒ…æ‹¬ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢ï¼š ç®€åŒ–çº¿ç¨‹æ± é…ç½®ï¼šçº¿ç¨‹æ± æ„é€ å‚æ•°æœ‰8ä¸ªï¼Œä½†æ˜¯æœ€æ ¸å¿ƒçš„æ˜¯3ä¸ªï¼šcorePoolSizeã€maximumPoolSizeï¼ŒworkQueueï¼Œå®ƒä»¬æœ€å¤§ç¨‹åº¦åœ°å†³å®šäº†çº¿ç¨‹æ± çš„ä»»åŠ¡åˆ†é…å’Œçº¿ç¨‹åˆ†é…ç­–ç•¥ã€‚è€ƒè™‘åˆ°åœ¨å®é™…åº”ç”¨ä¸­æˆ‘ä»¬è·å–å¹¶å‘æ€§çš„åœºæ™¯ä¸»è¦æ˜¯ä¸¤ç§ï¼šï¼ˆ1ï¼‰å¹¶è¡Œæ‰§è¡Œå­ä»»åŠ¡ï¼Œæé«˜å“åº”é€Ÿåº¦ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œåº”è¯¥ä½¿ç”¨åŒæ­¥é˜Ÿåˆ—ï¼Œæ²¡æœ‰ä»€ä¹ˆä»»åŠ¡åº”è¯¥è¢«ç¼“å­˜ä¸‹æ¥ï¼Œè€Œæ˜¯åº”è¯¥ç«‹å³æ‰§è¡Œã€‚ï¼ˆ2ï¼‰å¹¶è¡Œæ‰§è¡Œå¤§æ‰¹æ¬¡ä»»åŠ¡ï¼Œæå‡ååé‡ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œåº”è¯¥ä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—ï¼Œä½¿ç”¨é˜Ÿåˆ—å»ç¼“å†²å¤§æ‰¹é‡çš„ä»»åŠ¡ï¼Œé˜Ÿåˆ—å®¹é‡å¿…é¡»å£°æ˜ï¼Œé˜²æ­¢ä»»åŠ¡æ— é™åˆ¶å †ç§¯ã€‚æ‰€ä»¥çº¿ç¨‹æ± åªéœ€è¦æä¾›è¿™ä¸‰ä¸ªå…³é”®å‚æ•°çš„é…ç½®ï¼Œå¹¶ä¸”æä¾›ä¸¤ç§é˜Ÿåˆ—çš„é€‰æ‹©ï¼Œå°±å¯ä»¥æ»¡è¶³ç»å¤§å¤šæ•°çš„ä¸šåŠ¡éœ€æ±‚ï¼ŒLess is Moreã€‚ å‚æ•°å¯åŠ¨æ€ä¿®æ”¹ï¼šä¸ºäº†è§£å†³å‚æ•°ä¸å¥½é…ï¼Œä¿®æ”¹å‚æ•°æˆæœ¬é«˜ç­‰é—®é¢˜ã€‚åœ¨Javaçº¿ç¨‹æ± ç•™æœ‰é«˜æ‰©å±•æ€§çš„åŸºç¡€ä¸Šï¼Œå°è£…çº¿ç¨‹æ± ï¼Œå…è®¸çº¿ç¨‹æ± ç›‘å¬åŒæ­¥å¤–éƒ¨çš„æ¶ˆæ¯ï¼Œæ ¹æ®æ¶ˆæ¯è¿›è¡Œä¿®æ”¹é…ç½®ã€‚å°†çº¿ç¨‹æ± çš„é…ç½®æ”¾ç½®åœ¨å¹³å°ä¾§ï¼Œå…è®¸å¼€å‘åŒå­¦ç®€å•çš„æŸ¥çœ‹ã€ä¿®æ”¹çº¿ç¨‹æ± é…ç½®ã€‚ å¢åŠ çº¿ç¨‹æ± ç›‘æ§ï¼šå¯¹æŸäº‹ç‰©ç¼ºä¹çŠ¶æ€çš„è§‚æµ‹ï¼Œå°±å¯¹å…¶æ”¹è¿›æ— ä»ä¸‹æ‰‹ã€‚åœ¨çº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡çš„ç”Ÿå‘½å‘¨æœŸæ·»åŠ ç›‘æ§èƒ½åŠ›ï¼Œå¸®åŠ©å¼€å‘åŒå­¦äº†è§£çº¿ç¨‹æ± çŠ¶æ€ã€‚ 3.3.2 åŠŸèƒ½æ¶æ„ åŠ¨æ€åŒ–çº¿ç¨‹æ± æä¾›å¦‚ä¸‹åŠŸèƒ½ï¼š åŠ¨æ€è°ƒå‚ï¼šæ”¯æŒçº¿ç¨‹æ± å‚æ•°åŠ¨æ€è°ƒæ•´ã€ç•Œé¢åŒ–æ“ä½œï¼›åŒ…æ‹¬ä¿®æ”¹çº¿ç¨‹æ± æ ¸å¿ƒå¤§å°ã€æœ€å¤§æ ¸å¿ƒå¤§å°ã€é˜Ÿåˆ—é•¿åº¦ç­‰ï¼›å‚æ•°ä¿®æ”¹ååŠæ—¶ç”Ÿæ•ˆã€‚ ä»»åŠ¡ç›‘æ§ï¼šæ”¯æŒåº”ç”¨ç²’åº¦ã€çº¿ç¨‹æ± ç²’åº¦ã€ä»»åŠ¡ç²’åº¦çš„Transactionç›‘æ§ï¼›å¯ä»¥çœ‹åˆ°çº¿ç¨‹æ± çš„ä»»åŠ¡æ‰§è¡Œæƒ…å†µã€æœ€å¤§ä»»åŠ¡æ‰§è¡Œæ—¶é—´ã€å¹³å‡ä»»åŠ¡æ‰§è¡Œæ—¶é—´ã€95/99çº¿ç­‰ã€‚ è´Ÿè½½å‘Šè­¦ï¼šçº¿ç¨‹æ± é˜Ÿåˆ—ä»»åŠ¡ç§¯å‹åˆ°ä¸€å®šå€¼çš„æ—¶å€™ä¼šé€šè¿‡å¤§è±¡ï¼ˆç¾å›¢å†…éƒ¨é€šè®¯å·¥å…·ï¼‰å‘ŠçŸ¥åº”ç”¨å¼€å‘è´Ÿè´£äººï¼›å½“çº¿ç¨‹æ± è´Ÿè½½æ•°è¾¾åˆ°ä¸€å®šé˜ˆå€¼çš„æ—¶å€™ä¼šé€šè¿‡å¤§è±¡å‘ŠçŸ¥åº”ç”¨å¼€å‘è´Ÿè´£äººã€‚ æ“ä½œç›‘æ§ï¼šåˆ›å»º/ä¿®æ”¹å’Œåˆ é™¤çº¿ç¨‹æ± éƒ½ä¼šé€šçŸ¥åˆ°åº”ç”¨çš„å¼€å‘è´Ÿè´£äººã€‚ æ“ä½œæ—¥å¿—ï¼šå¯ä»¥æŸ¥çœ‹çº¿ç¨‹æ± å‚æ•°çš„ä¿®æ”¹è®°å½•ï¼Œè°åœ¨ä»€ä¹ˆæ—¶å€™ä¿®æ”¹äº†çº¿ç¨‹æ± å‚æ•°ã€ä¿®æ”¹å‰çš„å‚æ•°å€¼æ˜¯ä»€ä¹ˆã€‚ æƒé™æ ¡éªŒï¼šåªæœ‰åº”ç”¨å¼€å‘è´Ÿè´£äººæ‰èƒ½å¤Ÿä¿®æ”¹åº”ç”¨çš„çº¿ç¨‹æ± å‚æ•°ã€‚ å‚æ•°åŠ¨æ€åŒ– JDKåŸç”Ÿçº¿ç¨‹æ± ThreadPoolExecutoræä¾›äº†å¦‚ä¸‹å‡ ä¸ªpublicçš„setteræ–¹æ³•ï¼Œå¦‚ä¸‹å›¾JDK çº¿ç¨‹æ± å‚æ•°è®¾ç½®æ¥å£æ‰€ç¤ºï¼š JDKå…è®¸çº¿ç¨‹æ± ä½¿ç”¨æ–¹é€šè¿‡ThreadPoolExecutorçš„å®ä¾‹æ¥åŠ¨æ€è®¾ç½®çº¿ç¨‹æ± çš„æ ¸å¿ƒç­–ç•¥ï¼Œä»¥setCorePoolSizeä¸ºæ–¹æ³•ä¾‹ï¼Œåœ¨è¿è¡ŒæœŸçº¿ç¨‹æ± ä½¿ç”¨æ–¹è°ƒç”¨æ­¤æ–¹æ³•è®¾ç½®corePoolSizeä¹‹åï¼Œçº¿ç¨‹æ± ä¼šç›´æ¥è¦†ç›–åŸæ¥çš„corePoolSizeå€¼ï¼Œå¹¶ä¸”åŸºäºå½“å‰å€¼å’ŒåŸå§‹å€¼çš„æ¯”è¾ƒç»“æœé‡‡å–ä¸åŒçš„å¤„ç†ç­–ç•¥ã€‚å¯¹äºå½“å‰å€¼å°äºå½“å‰å·¥ä½œçº¿ç¨‹æ•°çš„æƒ…å†µï¼Œè¯´æ˜æœ‰å¤šä½™çš„workerçº¿ç¨‹ï¼Œæ­¤æ—¶ä¼šå‘å½“å‰idleçš„workerçº¿ç¨‹å‘èµ·ä¸­æ–­è¯·æ±‚ä»¥å®ç°å›æ”¶ï¼Œå¤šä½™çš„workeråœ¨ä¸‹æ¬¡idelçš„æ—¶å€™ä¹Ÿä¼šè¢«å›æ”¶ï¼›å¯¹äºå½“å‰å€¼å¤§äºåŸå§‹å€¼ä¸”å½“å‰é˜Ÿåˆ—ä¸­æœ‰å¾…æ‰§è¡Œä»»åŠ¡ï¼Œåˆ™çº¿ç¨‹æ± ä¼šåˆ›å»ºæ–°çš„workerçº¿ç¨‹æ¥æ‰§è¡Œé˜Ÿåˆ—ä»»åŠ¡ï¼ŒsetCorePoolSizeå…·ä½“æµç¨‹å¦‚ä¸‹ï¼š çº¿ç¨‹æ± å†…éƒ¨ä¼šå¤„ç†å¥½å½“å‰çŠ¶æ€åšåˆ°å¹³æ»‘ä¿®æ”¹ï¼Œå…¶ä»–å‡ ä¸ªæ–¹æ³•é™äºç¯‡å¹…ï¼Œè¿™é‡Œä¸ä¸€ä¸€ä»‹ç»ã€‚é‡ç‚¹æ˜¯åŸºäºè¿™å‡ ä¸ªpublicæ–¹æ³•ï¼Œæˆ‘ä»¬åªéœ€è¦ç»´æŠ¤ThreadPoolExecutorçš„å®ä¾‹ï¼Œå¹¶ä¸”åœ¨éœ€è¦ä¿®æ”¹çš„æ—¶å€™æ‹¿åˆ°å®ä¾‹ä¿®æ”¹å…¶å‚æ•°å³å¯ã€‚åŸºäºä»¥ä¸Šçš„æ€è·¯ï¼Œæˆ‘ä»¬å®ç°äº†çº¿ç¨‹æ± å‚æ•°çš„åŠ¨æ€åŒ–ã€çº¿ç¨‹æ± å‚æ•°åœ¨ç®¡ç†å¹³å°å¯é…ç½®å¯ä¿®æ”¹ï¼Œå…¶æ•ˆæœå›¾å¦‚ä¸‹å›¾å¯åŠ¨æ€ä¿®æ”¹çº¿ç¨‹æ± å‚æ•°æ‰€ç¤ºï¼š ç”¨æˆ·å¯ä»¥åœ¨ç®¡ç†å¹³å°ä¸Šé€šè¿‡çº¿ç¨‹æ± çš„åå­—æ‰¾åˆ°æŒ‡å®šçš„çº¿ç¨‹æ± ï¼Œç„¶åå¯¹å…¶å‚æ•°è¿›è¡Œä¿®æ”¹ï¼Œä¿å­˜åä¼šå®æ—¶ç”Ÿæ•ˆã€‚ç›®å‰æ”¯æŒçš„åŠ¨æ€å‚æ•°åŒ…æ‹¬æ ¸å¿ƒæ•°ã€æœ€å¤§å€¼ã€é˜Ÿåˆ—é•¿åº¦ç­‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨ç•Œé¢ä¸­ï¼Œæˆ‘ä»¬è¿˜èƒ½çœ‹åˆ°ç”¨æˆ·å¯ä»¥é…ç½®æ˜¯å¦å¼€å¯å‘Šè­¦ã€é˜Ÿåˆ—ç­‰å¾…ä»»åŠ¡å‘Šè­¦é˜ˆå€¼ã€æ´»è·ƒåº¦å‘Šè­¦ç­‰ç­‰ã€‚å…³äºç›‘æ§å’Œå‘Šè­¦ï¼Œæˆ‘ä»¬ä¸‹é¢ä¸€èŠ‚ä¼šå¯¹é½è¿›è¡Œä»‹ç»ã€‚ çº¿ç¨‹æ± ç›‘æ§ é™¤äº†å‚æ•°åŠ¨æ€åŒ–ä¹‹å¤–ï¼Œä¸ºäº†æ›´å¥½åœ°ä½¿ç”¨çº¿ç¨‹æ± ï¼Œæˆ‘ä»¬éœ€è¦å¯¹çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶å†µæœ‰æ„ŸçŸ¥ï¼Œæ¯”å¦‚å½“å‰çº¿ç¨‹æ± çš„è´Ÿè½½æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿåˆ†é…çš„èµ„æºå¤Ÿä¸å¤Ÿç”¨ï¼Ÿä»»åŠ¡çš„æ‰§è¡Œæƒ…å†µæ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿæ˜¯é•¿ä»»åŠ¡è¿˜æ˜¯çŸ­ä»»åŠ¡ï¼ŸåŸºäºå¯¹è¿™äº›é—®é¢˜çš„æ€è€ƒï¼ŒåŠ¨æ€åŒ–çº¿ç¨‹æ± æä¾›äº†å¤šä¸ªç»´åº¦çš„ç›‘æ§å’Œå‘Šè­¦èƒ½åŠ›ï¼ŒåŒ…æ‹¬ï¼šçº¿ç¨‹æ± æ´»è·ƒåº¦ã€ä»»åŠ¡çš„æ‰§è¡ŒTransactionï¼ˆé¢‘ç‡ã€è€—æ—¶ï¼‰ã€Rejectå¼‚å¸¸ã€çº¿ç¨‹æ± å†…éƒ¨ç»Ÿè®¡ä¿¡æ¯ç­‰ç­‰ï¼Œæ—¢èƒ½å¸®åŠ©ç”¨æˆ·ä»å¤šä¸ªç»´åº¦åˆ†æçº¿ç¨‹æ± çš„ä½¿ç”¨æƒ…å†µï¼Œåˆèƒ½åœ¨å‡ºç°é—®é¢˜ç¬¬ä¸€æ—¶é—´é€šçŸ¥åˆ°ç”¨æˆ·ï¼Œä»è€Œé¿å…æ•…éšœæˆ–åŠ é€Ÿæ•…éšœæ¢å¤ã€‚ 1. è´Ÿè½½ç›‘æ§å’Œå‘Šè­¦ çº¿ç¨‹æ± è´Ÿè½½å…³æ³¨çš„æ ¸å¿ƒé—®é¢˜æ˜¯ï¼šåŸºäºå½“å‰çº¿ç¨‹æ± å‚æ•°åˆ†é…çš„èµ„æºå¤Ÿä¸å¤Ÿã€‚å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä»äº‹å‰å’Œäº‹ä¸­ä¸¤ä¸ªè§’åº¦æ¥çœ‹ã€‚äº‹å‰ï¼Œçº¿ç¨‹æ± å®šä¹‰äº†â€œæ´»è·ƒåº¦â€è¿™ä¸ªæ¦‚å¿µï¼Œæ¥è®©ç”¨æˆ·åœ¨å‘ç”ŸRejectå¼‚å¸¸ä¹‹å‰èƒ½å¤Ÿæ„ŸçŸ¥çº¿ç¨‹æ± è´Ÿè½½é—®é¢˜ï¼Œçº¿ç¨‹æ± æ´»è·ƒåº¦è®¡ç®—å…¬å¼ä¸ºï¼šçº¿ç¨‹æ± æ´»è·ƒåº¦ = activeCount/maximumPoolSizeã€‚è¿™ä¸ªå…¬å¼ä»£è¡¨å½“æ´»è·ƒçº¿ç¨‹æ•°è¶‹å‘äºmaximumPoolSizeçš„æ—¶å€™ï¼Œä»£è¡¨çº¿ç¨‹è´Ÿè½½è¶‹é«˜ã€‚äº‹ä¸­ï¼Œä¹Ÿå¯ä»¥ä»ä¸¤æ–¹é¢æ¥çœ‹çº¿ç¨‹æ± çš„è¿‡è½½åˆ¤å®šæ¡ä»¶ï¼Œä¸€ä¸ªæ˜¯å‘ç”Ÿäº†Rejectå¼‚å¸¸ï¼Œä¸€ä¸ªæ˜¯é˜Ÿåˆ—ä¸­æœ‰ç­‰å¾…ä»»åŠ¡ï¼ˆæ”¯æŒå®šåˆ¶é˜ˆå€¼ï¼‰ã€‚ä»¥ä¸Šä¸¤ç§æƒ…å†µå‘ç”Ÿäº†éƒ½ä¼šè§¦å‘å‘Šè­¦ï¼Œå‘Šè­¦ä¿¡æ¯ä¼šé€šè¿‡å¤§è±¡æ¨é€ç»™æœåŠ¡æ‰€å…³è”çš„è´Ÿè´£äººã€‚å¤§è±¡å‘Šè­¦é€šçŸ¥ 2. ä»»åŠ¡çº§ç²¾ç»†åŒ–ç›‘æ§ åœ¨ä¼ ç»Ÿçš„çº¿ç¨‹æ± åº”ç”¨åœºæ™¯ä¸­ï¼Œçº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡æ‰§è¡Œæƒ…å†µå¯¹äºç”¨æˆ·æ¥è¯´æ˜¯é€æ˜çš„ã€‚æ¯”å¦‚åœ¨ä¸€ä¸ªå…·ä½“çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œä¸šåŠ¡å¼€å‘ç”³è¯·äº†ä¸€ä¸ªçº¿ç¨‹æ± åŒæ—¶ç”¨äºæ‰§è¡Œä¸¤ç§ä»»åŠ¡ï¼Œä¸€ä¸ªæ˜¯å‘æ¶ˆæ¯ä»»åŠ¡ã€ä¸€ä¸ªæ˜¯å‘çŸ­ä¿¡ä»»åŠ¡ï¼Œè¿™ä¸¤ç±»ä»»åŠ¡å®é™…æ‰§è¡Œçš„é¢‘ç‡å’Œæ—¶é•¿å¯¹äºç”¨æˆ·æ¥è¯´æ²¡æœ‰ä¸€ä¸ªç›´è§‚çš„æ„Ÿå—ï¼Œå¾ˆå¯èƒ½è¿™ä¸¤ç±»ä»»åŠ¡ä¸é€‚åˆå…±äº«ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œä½†æ˜¯ç”±äºç”¨æˆ·æ— æ³•æ„ŸçŸ¥ï¼Œå› æ­¤ä¹Ÿæ— ä»ä¼˜åŒ–ã€‚åŠ¨æ€åŒ–çº¿ç¨‹æ± å†…éƒ¨å®ç°äº†ä»»åŠ¡çº§åˆ«çš„åŸ‹ç‚¹ï¼Œä¸”å…è®¸ä¸ºä¸åŒçš„ä¸šåŠ¡ä»»åŠ¡æŒ‡å®šå…·æœ‰ä¸šåŠ¡å«ä¹‰çš„åç§°ï¼Œçº¿ç¨‹æ± å†…éƒ¨åŸºäºè¿™ä¸ªåç§°åšTransactionæ‰“ç‚¹ï¼ŒåŸºäºè¿™ä¸ªåŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥çœ‹åˆ°çº¿ç¨‹æ± å†…éƒ¨ä»»åŠ¡çº§åˆ«çš„æ‰§è¡Œæƒ…å†µï¼Œä¸”åŒºåˆ†ä¸šåŠ¡ï¼Œä»»åŠ¡ç›‘æ§ç¤ºæ„å›¾å¦‚ä¸‹å›¾çº¿ç¨‹æ± ä»»åŠ¡æ‰§è¡Œç›‘æ§æ‰€ç¤ºï¼š 3. è¿è¡Œæ—¶çŠ¶æ€å®æ—¶æŸ¥çœ‹ ç”¨æˆ·åŸºäºJDKåŸç”Ÿçº¿ç¨‹æ± ThreadPoolExecutoræä¾›çš„å‡ ä¸ªpublicçš„getteræ–¹æ³•ï¼Œå¯ä»¥è¯»å–åˆ°å½“å‰çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€ä»¥åŠå‚æ•°ï¼Œå¦‚ä¸‹å›¾çº¿ç¨‹æ± å®æ—¶è¿è¡Œæƒ…å†µæ‰€ç¤ºï¼š åŠ¨æ€åŒ–çº¿ç¨‹æ± åŸºäºè¿™å‡ ä¸ªæ¥å£å°è£…äº†è¿è¡Œæ—¶çŠ¶æ€å®æ—¶æŸ¥çœ‹çš„åŠŸèƒ½ï¼Œç”¨æˆ·åŸºäºè¿™ä¸ªåŠŸèƒ½å¯ä»¥äº†è§£çº¿ç¨‹æ± çš„å®æ—¶çŠ¶æ€ï¼Œæ¯”å¦‚å½“å‰æœ‰å¤šå°‘ä¸ªå·¥ä½œçº¿ç¨‹ï¼Œæ‰§è¡Œäº†å¤šå°‘ä¸ªä»»åŠ¡ï¼Œé˜Ÿåˆ—ä¸­ç­‰å¾…çš„ä»»åŠ¡æ•°ç­‰ç­‰ã€‚æ•ˆæœå¦‚ä¸‹å›¾çº¿ç¨‹æ± å®æ—¶è¿è¡Œæƒ…å†µæ‰€ç¤ºï¼š 3.4 å®è·µæ€»ç»“ é¢å¯¹ä¸šåŠ¡ä¸­ä½¿ç”¨çº¿ç¨‹æ± é‡åˆ°çš„å®é™…é—®é¢˜ï¼Œæˆ‘ä»¬æ›¾å›åˆ°æ”¯æŒå¹¶å‘æ€§é—®é¢˜æœ¬èº«æ¥æ€è€ƒæœ‰æ²¡æœ‰å–ä»£çº¿ç¨‹æ± çš„æ–¹æ¡ˆï¼Œä¹Ÿæ›¾å°è¯•ç€å»è¿½æ±‚çº¿ç¨‹æ± å‚æ•°è®¾ç½®çš„åˆç†æ€§ï¼Œä½†é¢å¯¹ä¸šç•Œæ–¹æ¡ˆå…·ä½“è½åœ°çš„å¤æ‚æ€§ã€å¯ç»´æŠ¤æ€§ä»¥åŠçœŸå®è¿è¡Œç¯å¢ƒçš„ä¸ç¡®å®šæ€§ï¼Œæˆ‘ä»¬åœ¨å‰ä¸¤ä¸ªæ–¹å‘ä¸Šå¯è°“â€œä¸¾æ­¥ç»´è‰°â€ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬å›åˆ°çº¿ç¨‹æ± å‚æ•°åŠ¨æ€åŒ–æ–¹å‘ä¸Šæ¢ç´¢ï¼Œå¾—å‡ºä¸€ä¸ªä¸”å¯ä»¥è§£å†³ä¸šåŠ¡é—®é¢˜çš„æ–¹æ¡ˆï¼Œè™½ç„¶æœ¬è´¨ä¸Šè¿˜æ˜¯æ²¡æœ‰é€ƒç¦»ä½¿ç”¨çº¿ç¨‹æ± çš„èŒƒç•´ï¼Œä½†æ˜¯åœ¨æˆæœ¬å’Œæ”¶ç›Šä¹‹é—´ï¼Œç®—æ˜¯å–å¾—äº†ä¸€ä¸ªå¾ˆå¥½çš„å¹³è¡¡ã€‚æˆæœ¬åœ¨äºå®ç°åŠ¨æ€åŒ–ä»¥åŠç›‘æ§æˆæœ¬ä¸é«˜ï¼Œæ”¶ç›Šåœ¨äºï¼šåœ¨ä¸é¢ è¦†åŸæœ‰çº¿ç¨‹æ± ä½¿ç”¨æ–¹å¼çš„åŸºç¡€ä¹‹ä¸Šï¼Œä»é™ä½çº¿ç¨‹æ± å‚æ•°ä¿®æ”¹çš„æˆæœ¬ä»¥åŠå¤šç»´åº¦ç›‘æ§è¿™ä¸¤ä¸ªæ–¹é¢é™ä½äº†æ•…éšœå‘ç”Ÿçš„æ¦‚ç‡ã€‚å¸Œæœ›æœ¬æ–‡æä¾›çš„åŠ¨æ€åŒ–çº¿ç¨‹æ± æ€è·¯èƒ½å¯¹å¤§å®¶æœ‰å¸®åŠ©ã€‚ å››ã€å‚è€ƒèµ„æ–™ [1] JDK 1.8æºç  [2] ç»´åŸºç™¾ç§‘-çº¿ç¨‹æ±  [3] æ›´å¥½çš„ä½¿ç”¨Javaçº¿ç¨‹æ±  [4] ç»´åŸºç™¾ç§‘Pooling(Resource Management) [5] æ·±å…¥ç†è§£Javaçº¿ç¨‹æ± ï¼šThreadPoolExecutor [6]ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®è·µã€‹ ä½œè€…ç®€ä»‹ è‡´è¿œï¼Œ2018å¹´åŠ å…¥ç¾å›¢ç‚¹è¯„ï¼Œç¾å›¢åˆ°åº—ç»¼åˆç ”å‘ä¸­å¿ƒåå°å¼€å‘å·¥ç¨‹å¸ˆã€‚ é™†æ™¨ï¼Œ2015å¹´åŠ å…¥ç¾å›¢ç‚¹è¯„ï¼Œç¾å›¢åˆ°åº—ç»¼åˆç ”å‘ä¸­å¿ƒåå°æŠ€æœ¯ä¸“å®¶ã€‚ ","tags":[{"name":"Java","slug":"java","used":true,"link":"https://blog.qxxiao.eu.org/tag/java/"}],"title":"Javaçº¿ç¨‹æ± å®ç°åŸç†","feature":"https://pic.qxxiao.cn/bg-wallhaven.jpg","link":"https://blog.qxxiao.eu.org/post/Javaçº¿ç¨‹æ± å®ç°åŸç†/","stats":{"text":"32 min read","time":1863000,"words":8986,"minutes":32},"date":"2022-10-14 10:24:29","dateFormat":"2022-10-14","isTop":false},{"content":"https://www.acwing.com/blog/content/21860/ https://www.w3cschool.cn/java/ å˜é‡å’Œè¾“å…¥è¾“å‡º Javaçš„æ‰€æœ‰å˜é‡å’Œå‡½æ•°éƒ½è¦å®šä¹‰åœ¨classä¸­ã€‚ ä¸C++ä¸»è¦çš„åŒºåˆ«ï¼š Javaå±äºå®Œå…¨é¢å‘å¯¹è±¡è¯­è¨€ï¼Œæ²¡æœ‰è¿ç®—ç¬¦é‡è½½(éœ€è¦ç‰¹å®šçš„æ–¹æ³•å®ç°åŠŸèƒ½) åŸºç¡€ç±»å‹ 8ç§å†…ç½®æ•°æ®ç±»å‹/åŸºç¡€ç±»å‹ï¼Œä¸æ”¯æŒæ— ç¬¦å·æ•´æ•°ç±»å‹ã€‚ åŸºç¡€ç±»å‹ å­—èŠ‚æ•° ä¸¾ä¾‹ byte 1 123 short 2 12345 int 4 123456789 long 8 1234567891011L float 4 1.2F double 8 1.2ï¼Œ1.2D boolean 1 trueï¼Œfalse char 2 'A'ï¼Œ'\\u0041' è¾“å‡ºè¾“å‡º è¾“å…¥ æ–¹å¼1 ï¼Œä½¿ç”¨Scannerç±»è¾“å…¥ï¼Œæ•ˆç‡è¾ƒä½ï¼Œè¾“å…¥è§„æ¨¡è¾ƒå°æ—¶ä½¿ç”¨ Scanner sc = new Scanner(System.in); String str = sc.next(); // è¯»å…¥ä¸‹ä¸€ä¸ªå­—ç¬¦ä¸² int x = sc.nextInt(); // è¯»å…¥ä¸‹ä¸€ä¸ªæ•´æ•° float y = sc.nextFloat(); // è¯»å…¥ä¸‹ä¸€ä¸ªå•ç²¾åº¦æµ®ç‚¹æ•° double z = sc.nextDouble(); // è¯»å…¥ä¸‹ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•° String line = sc.nextLine(); // è¯»å…¥ä¸‹ä¸€è¡Œ æ–¹å¼2ï¼Œä½¿ç”¨è¾“å…¥æµå’Œç¼“å­˜ï¼Œæ•ˆç‡è¾ƒé«˜ï¼Œè¾“å…¥è§„æ¨¡è¾ƒå¤§æ—¶ä½¿ç”¨ã€‚æ³¨æ„éœ€è¦æŠ›å¼‚å¸¸ã€‚ import java.io.BufferedReader; import java.io.InputStreamReader; public class Main { public static void main(String[] args) throws Exception { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); String str = br.readLine(); System.out.println(str); } } è¾“å‡º æ–¹å¼1ï¼Œä½¿ç”¨printç³»åˆ—æ–¹æ³•ï¼Œæ•ˆç‡è¾ƒä½ï¼Œè¾“å‡ºè§„æ¨¡è¾ƒå°æ—¶ä½¿ç”¨ã€‚ System.out.println(123); // è¾“å‡ºæ•´æ•° + æ¢è¡Œ System.out.println(&quot;Hello World&quot;); // è¾“å‡ºå­—ç¬¦ä¸² + æ¢è¡Œ System.out.print(123); // è¾“å‡ºæ•´æ•° System.out.print(&quot;yxc\\n&quot;); // è¾“å‡ºå­—ç¬¦ä¸² System.out.printf(&quot;%04d %.2f\\n&quot;, 4, 123.456D); // æ ¼å¼åŒ–è¾“å‡ºï¼Œfloatä¸doubleéƒ½ç”¨%fè¾“å‡º æ–¹å¼2ï¼Œä½¿ç”¨è¾“å‡ºæµå’Œç¼“å­˜æ•ˆç‡è¾ƒé«˜ï¼Œè¾“å‡ºè§„æ¨¡è¾ƒå¤§æ—¶ä½¿ç”¨ã€‚æ³¨æ„éœ€è¦æŠ›å¼‚å¸¸ã€‚ import java.io.BufferedWriter; import java.io.OutputStreamWriter; public class Main { public static void main(String[] args) throws Exception { BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(System.out)); bw.write(&quot;Hello World\\n&quot;); bw.flush(); // éœ€è¦æ‰‹åŠ¨åˆ·æ–°ç¼“å†²åŒº } } å­—ç¬¦ä¸²å’Œæ•°ç»„ å­—ç¬¦ä¸² å­—ç¬¦ä¸²ç±»Stringçš„å¸¸ç”¨åˆå§‹åŒ–æ–¹å¼ï¼š String a = &quot;Hello World&quot;; String b = &quot;My name is&quot;; String x = b; // å­˜å‚¨åˆ°äº†ç›¸åŒåœ°å€ String c = b + &quot;yxc&quot;; // Stringå¯ä»¥é€šè¿‡+æ‹¼æ¥ String d = &quot;My age is &quot; + 18; // intä¼šè¢«éšå¼è½¬åŒ–æˆå­—ç¬¦ä¸²&quot;18&quot; String str = String.format(&quot;My age is %d&quot;, 18); // æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œç±»ä¼¼äºC++ä¸­çš„sprintf String money_str = &quot;123.45&quot;; double money = Double.parseDouble(money_str); // Stringè½¬double;å…¶ä½™åŒ…è£…ç±»å‹å…·æœ‰ç±»ä¼¼æ–¹æ³• æ³¨æ„ï¼šJava ä¸­çš„å­—ç¬¦ä¸²æ˜¯åªè¯»å˜é‡(åº•å±‚ä½¿ç”¨ final ä¿®é¥°)ï¼Œä¸èƒ½ä¿®æ”¹ï¼›æ¯æ¬¡æ‹¼æ¥ä¼šæ„é€ ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ã€‚ æ³¨æ„è®¿é—®Stringä¸­çš„å­—ç¬¦æ–¹å¼ï¼š str.length()è¿”å›è¯¥å­—ç¬¦ä¸² Unicode ç ç‚¹æ•°é‡ï¼ˆå­—ç¬¦çš„æ•°é‡ï¼‰ ä½¿ç”¨str.charAt(int index)è®¿é—®ç¬¬indexä¸ªå­—ç¬¦ è¯´æ˜ï¼šåº•å±‚ä½¿ç”¨ char(16bit) å­˜å‚¨ï¼ŒUTF16ç¼–ç æ€æƒ³ï¼šä»U+D800åˆ°U+DFFFä¹‹é—´çš„ç ä½åŒºæ®µæ˜¯æ°¸ä¹…ä¿ç•™ä¸æ˜ å°„åˆ°Unicodeå­—ç¬¦ã€‚UTF-16å°±åˆ©ç”¨ä¿ç•™ä¸‹æ¥çš„0xD800-0xDFFFåŒºæ®µçš„ç ä½æ¥å¯¹**è¾…åŠ©å¹³é¢çš„å­—ç¬¦(ä»U+10000åˆ°U+10FFFF)**çš„ç ä½è¿›è¡Œç¼–ç ã€‚https://zh.m.wikipedia.org/zh-hans/UTF-16 String str = &quot;Hello World&quot;; for (int i = 0; i &lt; str.length(); i ++ ) { System.out.print(str.charAt(i)); // åªèƒ½è¯»å–ï¼Œä¸èƒ½å†™å…¥ } å­—ç¬¦ä¸²ç±»å¸¸ç”¨ API: length()ï¼šè¿”å›é•¿åº¦ split(String regex)ï¼šåˆ†å‰²å­—ç¬¦ä¸² indexOf(int c)ã€indexOf(String str)ï¼šæŸ¥æ‰¾ï¼Œè¿”å›ç¬¬ä¸€æ¬¡æ‰¾åˆ°ä¸‹æ ‡ï¼Œæ‰¾ä¸åˆ°è¿”å›-1 equals()ï¼šåˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œæ³¨æ„ä¸èƒ½ç›´æ¥ç”¨ == compareTo()ï¼šåˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²çš„å­—å…¸åºå¤§å°ï¼Œè´Ÿæ•°è¡¨ç¤ºå°äºï¼Œ0è¡¨ç¤ºç›¸ç­‰ï¼Œæ­£æ•°è¡¨ç¤ºå¤§äº startsWith()ï¼šåˆ¤æ–­æ˜¯å¦ä»¥æŸä¸ªå‰ç¼€å¼€å¤´ endsWith()ï¼šåˆ¤æ–­æ˜¯å¦ä»¥æŸä¸ªåç¼€ç»“å°¾ trim()ï¼šå»æ‰é¦–å°¾çš„ç©ºç™½å­—ç¬¦ toLowerCase()ï¼šå…¨éƒ¨ç”¨å°å†™å­—ç¬¦ toUpperCase()ï¼šå…¨éƒ¨ç”¨å¤§å†™å­—ç¬¦ replace(char oldChar, char newChar)ï¼šæ›¿æ¢å­—ç¬¦(æ‰€æœ‰ä½ç½®) replace(CharSequence target, CharSequence rep)ï¼šæ›¿æ¢å­—ç¬¦ä¸²(replaceFirst,replaceAll) substring(int beginIndex, int endIndex)ï¼šè¿”å›[beginIndex, endIndex)ä¸­çš„å­ä¸² å¯ä¿®æ”¹çš„å­—ç¬¦ä¸²ç±»å‹ï¼šStringBuilderã€StringBuffer å¦‚æœæ‰“ç®—ä¿®æ”¹å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨StringBuilderå’ŒStringBufferã€‚ StringBuilderçº¿ç¨‹ä¸å®‰å…¨ï¼Œé€Ÿåº¦è¾ƒå¿«ï¼›è€ŒStringBufferçº¿ç¨‹å®‰å…¨ï¼Œé€Ÿåº¦è¾ƒæ…¢ã€‚ StringBuilder sb = new StringBuilder(&quot;Hello &quot;); // åˆå§‹åŒ– sb.append(&quot;World&quot;); // æ‹¼æ¥å­—ç¬¦ä¸² System.out.println(sb); for (int i = 0; i &lt; sb.length(); i ++ ) { sb.setCharAt(i, (char)(sb.charAt(i) + 1)); // è¯»å–å’Œå†™å…¥å­—ç¬¦ } System.out.println(sb); å¸¸ç”¨ APIï¼š reverse()ï¼šç¿»è½¬å­—ç¬¦ä¸² æ•°ç»„ Java æ•°ç»„æ˜¯å¼•ç”¨ç±»å‹ï¼Œæ¨èä½¿ç”¨ Javaé£æ ¼int[] arr åˆå§‹åŒ–å®šé•¿æ•°ç»„ï¼Œé•¿åº¦å¯ä»¥æ˜¯å˜é‡ï¼Œå¹¶ä¸”å¯ä»¥åœ¨åˆå§‹åŒ–æ—¶èµ‹å€¼ int[] a = new int[5]; // åˆå§‹åŒ–é•¿åº¦ä¸º5çš„intæ•°ç»„ï¼Œåˆå§‹å€¼ä¸º0 int n = 10; float[] b = new float[n]; // åˆå§‹åŒ–é•¿åº¦ä¸ºnçš„floatæ•°ç»„ï¼Œåˆå§‹å€¼ä¸º0.0F char[] c = {'a', 'b', 'c'}; // åˆå§‹åŒ–é•¿åº¦ä¸º3çš„charæ•°ç»„ï¼Œåˆå§‹å€¼ä¸ºï¼š'a', 'b', 'c' char[] d = c; // dä¸cåœ°å€ç›¸åŒï¼Œæ›´æ”¹cä¸­çš„å…ƒç´ ï¼Œdä¸­çš„å…ƒç´ ä¹Ÿä¼šæ”¹å˜ã€å¼•ç”¨ç±»å‹ã€‘ å¤šç»´æ•°ç»„ æ³¨æ„æ•°ç»„æ˜¯å¼•ç”¨ç±»å‹ï¼Œå¤šç»´æ•°ç»„çš„å˜é‡ä¹Ÿæ˜¯å¼•ç”¨ç±»å‹ï¼Œä½¿ç”¨åº”è¯¥ç”³è¯·ç©ºé—´ã€‚ int[][] a = new int[2][3]; a[1][2] = 1; int[][] b = { {1, 2, 3}, {4, 5, 6}, }; // å£°æ˜å’Œåˆå§‹åŒ–èµ‹å€¼ System.out.println(a[1][2]); System.out.println(b[0][1]); æ•°ç»„å¸¸ç”¨ APIï¼š(ä½¿ç”¨Arrayså·¥å…·ç±»æ“ä½œ) å±æ€§ lengthï¼šè¿”å›æ•°ç»„é•¿åº¦ï¼Œæ³¨æ„ä¸åŠ å°æ‹¬å·(å±æ€§) Arrays.sort()ï¼šæ•°ç»„æ’åº Arrays.fill(int[] a, int val)ï¼šå¡«å……æ•°ç»„ Arrays.toString()ï¼šå°†æ•°ç»„è½¬åŒ–ä¸ºå­—ç¬¦ä¸² Arrays.deepToString()ï¼šå°†å¤šç»´æ•°ç»„è½¬åŒ–ä¸ºå­—ç¬¦ä¸² Arrays.asList(Tâ€¦)è¿”å›è‡ªå·±å®ç°çš„ä¸€ä¸ªå†…éƒ¨ç±»ArrayList(å®ç°äº†Listæ¥å£)â€”ä¿å­˜äº†å‚æ•°æ•°ç»„çš„å¼•ç”¨ï¼Œæ˜¯è¯¥æ•°ç»„çš„ä¸€ä¸ªè§†å›¾(ä¿®æ”¹ä¼šåæ˜ åˆ°åŸæ•°ç»„)ï¼›è¯´æ˜ï¼šå¦‚æœè¦å¾—åˆ°ä¸€ä¸ªå¯ç‹¬ç«‹ä¿®æ”¹å¹¶å¯ä»¥æ·»åŠ /åˆ é™¤çš„Listï¼Œä½¿ç”¨***ArrayList&lt;&gt;(Arrays.asList(array))***ã€‚ copyOfå¤åˆ¶æ•°ç»„(ä¸€ç»´)ï¼›binarySearch()äºŒåˆ†æŸ¥æ‰¾ï¼Œéœ€è¦å…ˆæ’åºï¼›equals()åˆ¤æ–­ä¸¤ä¸ªæ•°ç»„æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœå…ƒç´ æ˜¯å¯¹è±¡ä½¿ç”¨(e1==null ? e2==null : e1.equals(e2))åˆ¤æ–­å¯¹åº”ä½ç½®å…ƒç´ ç›¸ç­‰ï¼›å¯¹äºå¤šç»´æ•°ç»„ä½¿ç”¨deepEquals()ï¼›stream()è¿”å›å¯¹åº”å…ƒç´ çš„æµï¼› æ•°ç»„æ˜¯ä¸å¯å˜é•¿åº¦çš„ ç±»å’Œæ¥å£ Java ä¸­æ‰€æœ‰å˜é‡å’Œå‡½æ•°éƒ½è¦å®šä¹‰åœ¨ç±»ä¸­ã€‚ æºæ–‡ä»¶å£°æ˜è§„åˆ™ ä¸€ä¸ªæºæ–‡ä»¶ä¸­æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªpublicç±»(å…¶å®ƒç±»éƒ½ä¸ºé»˜è®¤) æºæ–‡ä»¶çš„åç§°åº”è¯¥å’Œpublicç±»çš„ç±»åä¿æŒä¸€è‡´ æ¯ä¸ªæºæ–‡ä»¶ä¸­ï¼Œå…ˆå†™packageè¯­å¥ï¼Œå†å†™importè¯­å¥ï¼Œæœ€åå®šä¹‰ç±» å˜é‡æˆ–æ–¹æ³•å‰åŠ staticè¡¨ç¤ºé™æ€å˜é‡(ç±»å˜é‡)/é™æ€æ–¹æ³•(ç±»æ–¹æ³•)ï¼Œå±äºclassï¼Œè€Œä¸å±äºclassçš„å…·ä½“å®ä¾‹ã€‚static å¯ä»¥ä¿®é¥° Block å³é™æ€å—ï¼Œç”¨æ¥åˆå§‹åŒ–é™æ€æ•°æ®æˆå‘˜ã€‚staticä¹Ÿå¯ç”¨æ¥ä¿®é¥°å†…éƒ¨ç±»ã€‚ é™æ€æ–¹æ³•ä¸­åªèƒ½è°ƒç”¨é™æ€æ–¹æ³•å’Œé™æ€å˜é‡å³ç±»æˆå‘˜ï¼› é™æ€æ–¹æ³•ä¸èƒ½ä½¿ç”¨this,super å†…éƒ¨ç±» å†…éƒ¨ç±»ä¸»è¦åˆ†ä¸ºéé™æ€å†…éƒ¨ç±»å’Œé™æ€å†…éƒ¨ç±»ã€‚ è¯´æ˜ï¼šéé™æ€å†…éƒ¨ç±»ï¼Œå…¶å¯¹è±¡æ€»æœ‰ä¸€ä¸ªéšå¼å¼•ç”¨ï¼ŒæŒ‡å‘äº†åˆ›å»ºå®ƒçš„å¤–éƒ¨ç±»å¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥è®¿é—®å¤–éƒ¨ç±»å˜é‡/æ–¹æ³•ã€‚å¯ä»¥å®šä¹‰ staticå˜é‡ä½†æ˜¯ä¸èƒ½å®šä¹‰é™æ€å—(java8)ã€‚ é™æ€å†…éƒ¨ç±»ï¼Œå±äºå¤–éƒ¨ç±»æœ¬èº«ï¼Œä½†æ˜¯ä¸å±äºå¤–éƒ¨ç±»çš„ä»»ä½•å¯¹è±¡ã€‚ é™æ€å†…éƒ¨ç±»åªèƒ½è®¿é—®å¤–éƒ¨ç±»çš„ç±»æˆå‘˜ã€‚ å¤–éƒ¨ç±»å¯ä»¥ä½¿ç”¨é™æ€å†…éƒ¨ç±»çš„ç±»åä½œä¸ºè°ƒç”¨è€…æ¥è®¿é—®é™æ€å†…éƒ¨ç±»çš„ç±»æˆå‘˜ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é™æ€å†…éƒ¨ç±»å¯¹è±¡è®¿é—®å…¶å®ä¾‹æˆå‘˜ã€‚ 4ç§è®¿é—®ä¿®é¥°ç¬¦ Java ä¸­æœ‰4ä¸­è®¿é—®ä¿®é¥°ç¬¦ï¼Œpublic, protected, friendly(default), privateã€‚ Javaè®¿é—®æ§åˆ¶ç¬¦çš„å«ä¹‰å’Œå¯è®¿é—®æƒ…å†µï¼š ç±»å†…éƒ¨ æœ¬åŒ… å­ç±» å¤–éƒ¨åŒ… public âœ”ï¸ âœ”ï¸ âœ”ï¸ âœ”ï¸ protected âœ”ï¸ âœ”ï¸ âœ”ï¸ âœ–ï¸ friendly(default) âœ”ï¸ âœ”ï¸ âœ–ï¸ âœ–ï¸ private âœ”ï¸ âœ–ï¸ âœ–ï¸ âœ–ï¸ publicï¼šå¯ä»¥è¢«æ‰€æœ‰å…¶ä»–ç±»æ‰€è®¿é—® protectedï¼šè‡ªèº«ï¼Œå­ç±»åŠåŒä¸€ä¸ªåŒ…ä¸­ç±»å¯ä»¥è®¿é—® friendlyï¼šåŒä¸€åŒ…ä¸­çš„ç±»å¯ä»¥è®¿é—®ï¼Œå£°æ˜æ—¶æ²¡æœ‰åŠ ä¿®é¥°ç¬¦ï¼Œè®¤ä¸ºæ˜¯friendly privateï¼šåªèƒ½è¢«è‡ªå·±è®¿é—®å’Œä¿®æ”¹ æ³¨æ„ï¼šJavaçš„è®¿é—®æ§åˆ¶æ˜¯åœç•™åœ¨ç¼–è¯‘å±‚çš„ï¼Œä¹Ÿå°±æ˜¯å®ƒä¸ä¼šåœ¨.classæ–‡ä»¶ä¸­ç•™ä¸‹ä»»ä½•çš„ç—•è¿¹ï¼Œåªåœ¨ç¼–è¯‘çš„æ—¶å€™è¿›è¡Œè®¿é—®æ§åˆ¶çš„æ£€æŸ¥ã€‚é€šè¿‡åå°„çš„æ‰‹æ®µï¼Œæ˜¯å¯ä»¥è®¿é—®ä»»ä½•åŒ…ä¸‹ä»»ä½•ç±»ä¸­çš„æˆå‘˜ã€‚ ç±»ç»§æ‰¿ æ¯ä¸ªç±»æœ€å¤šåªèƒ½ç»§æ‰¿ä¸€ä¸ªç±»ã€‚ ç¤ºä¾‹ï¼šä½¿ç”¨superæ¥è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°æˆ–è€…è®¿é—®å…¶æˆå‘˜ã€‚ class ColorPoint extends Point { private String color; public ColorPoint(int x, int y, String color) { super(x, y); this.color = color; } public void setColor(String color) { this.color = color; } public String toString() { return String.format(&quot;(%d, %d, %s)&quot;, super.getX(), super.getY(), this.color); } } æ–¹æ³•é‡è½½ æ–¹æ³•ç­¾åä¸åŒï¼Œå³å‚æ•°ä¸ªæ•°æˆ–è€…å¯¹åº”ç±»å‹ä¸ç›¸åŒçš„åŒåå‡½æ•°ç§°ä½œæ–¹æ³•é‡è½½ã€‚ ç±»(åŠæ¥å£)çš„å¤šæ€ çˆ¶ç±»å¼•ç”¨(æˆ–è€…æ¥å£)å¯ä»¥æŒ‡å‘ä¸åŒå­ç±»(æ¥å£å˜é‡æŒ‡å‘ä¸åŒæ˜¯çš„å®ç°ç±»å¯¹è±¡)ï¼Œè°ƒç”¨ç›¸åŒæ–¹æ³•è¿è¡Œç»“æœä¸åŒã€‚ã€æ ¹æ®æŒ‡å‘å…·ä½“ç±»å‹ï¼Œè°ƒç”¨å…¶å¯¹åº”çš„æ–¹æ³•å®ç°ã€‘ æ¥å£å’Œå®ç° æ¥å£ä¸»è¦ç”¨æ¥å®šä¹‰è¡Œä¸ºï¼Œå³å®šä¹‰ç±»éœ€è¦å®ç°çš„æ–¹æ³•(æŠ½è±¡æ–¹æ³•çš„é›†åˆ)ã€‚ æ¥å£å¯ä»¥ç»§æ‰¿å…¶ä»–å¤šä¸ªæ¥å£ï¼Œæ¯ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£(å…·æœ‰ä¸åŒçš„è¡Œä¸º)ã€‚ æ¥å£ä¸­å¯ä»¥å®šä¹‰(é»˜è®¤ä¿®é¥°ç¬¦æ˜¯public static final) å˜é‡ï¼Œä»¥åŠæŠ½è±¡æ–¹æ³•(é»˜è®¤ä½¿ç”¨public abstractä¿®é¥°)ï¼›å¯ä»¥å®šä¹‰æ–¹æ³•çš„é»˜è®¤å®ç°(æ–¹æ³•å‰æ·»åŠ defaultå…³é”®å­—)ã€‚ é™¤éå®ç°æ¥å£çš„ç±»æ˜¯æŠ½è±¡ç±»ï¼Œå¦åˆ™è¯¥ç±»è¦å®šä¹‰/å®ç°æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•(é»˜è®¤æ–¹æ³•å¯ä»¥ä¸ç”¨)ï¼› æ¥å£æ— æ³•è¢«å®ä¾‹åŒ–ï¼Œä½†æ˜¯å¯ä»¥è¢«å®ç°ï¼› æ¥å£ç±»å‹å¯ç”¨æ¥å£°æ˜ä¸€ä¸ªå˜é‡ï¼Œå¯ä»¥æ˜¯nullï¼Œæˆ–æ˜¯è¢«ç»‘å®šåœ¨å®ç°æ¥å£çš„ç±»å¯¹è±¡ã€‚ ğŸŒˆ æ ‡è®°æ¥å£:æ²¡æœ‰åŒ…å«ä»»ä½•æ–¹æ³•çš„æ¥å£ï¼Œä»…è¡¨æ˜å®ƒçš„ç±»å±äºä¸€ä¸ªç‰¹å®šçš„ç±»å‹ã€‚ä½œç”¨åœ¨äºå‘ç±»æ·»åŠ æ•°æ®ç±»å‹(æ·»åŠ è¯¥æ¥å£ç±»å‹)ä»¥åŠå»ºç«‹å…¬å…±çš„çˆ¶æ¥å£ã€‚ å®ä¾‹ï¼š // æ¥å£å®šä¹‰ interface Role { public void greet(); // public abstract } // æ¥å£çš„ç»§æ‰¿ï¼Œå¯ä»¥ç»§æ‰¿å¤šä¸ª interface Hero extends Role { public void attack(); } // æ¥å£çš„å®ç° class Zeus implements Hero { private final String name = &quot;Zeus&quot;; public void attack() { System.out.println(name + &quot;: attack!&quot;); } public void greet() { System.out.println(name + &quot;: Hi!&quot;); } } // æ¥å£çš„å¤šæ€ class Athena implements Hero { private final String name = &quot;Athena&quot;; public void attack() { System.out.println(name + &quot;: attack!&quot;); } public void greet() { System.out.println(name + &quot;: Hi!&quot;); } } // ------------------------------------------------- public class Main { public static void main(String[] args) { Hero[] heros = {new Zeus(), new Athena()}; for (Hero hero: heros) { hero.greet(); } } } æ³›å‹ Javaçš„ç±»å’Œæ¥å£ä¹Ÿå¯ä»¥å®šä¹‰æ³›å‹ï¼Œå³åŒä¸€å¥—å‡½æ•°å¯ä»¥ä½œç”¨äºä¸åŒçš„å¯¹è±¡ç±»å‹ã€‚ æ³¨æ„ï¼šJava æ³›å‹åªèƒ½ä½¿ç”¨å¯¹è±¡ç±»å‹ï¼Œä¸èƒ½ç”¨äºåŸºæœ¬å˜é‡ç±»å‹ã€‚å¹¶ä¸”åªæ˜¯ç¼–è¯‘æœŸæ³›å‹ï¼Œè¿è¡Œæ—¶ä¼šæ“¦é™¤ã€‚ å…¶å®ƒ é›†åˆæ¡†æ¶ï½œæ³›å‹ IOå’Œåå°„æœºåˆ¶ æ³¨è§£ å¤šçº¿ç¨‹ ç½‘ç»œç¼–ç¨‹ XML ","tags":[{"name":"Java","slug":"java","used":true,"link":"https://blog.qxxiao.eu.org/tag/java/"}],"title":"Java SEåŸºç¡€","feature":"https://pic.qxxiao.cn/java-logo.png","link":"https://blog.qxxiao.eu.org/post/Java SEåŸºç¡€/","stats":{"text":"12 min read","time":664000,"words":2731,"minutes":12},"date":"2022-09-04 12:27:00","dateFormat":"2022-09-04","isTop":false},{"content":"åŸºäºå®˜æ–¹æ–‡æ¡£æ€»ç»“ [TOC] é˜…è¯» ç®€ä»‹ | Vue.jsVue.js - æ¸è¿›å¼çš„ JavaScript æ¡†æ¶ https://staging-cn.vuejs.org/guide/introduction.html æ¨¡ç‰ˆè¯­æ³• Vueå…è®¸å£°æ˜å¼åœ°å°† DOM ç»‘å®šè‡³åº•å±‚ç»„ä»¶å®ä¾‹çš„æ•°æ®ã€‚ æ’å€¼ æ–‡æœ¬æ’å€¼ ä½¿ç”¨&lt;span&gt;Message: {{ msg }}&lt;/span&gt;è¯­æ³•ç»‘å®šç»„ä»¶å®ä¾‹ä¸­çš„å¯¹åº”çš„ property çš„å€¼ã€‚ ä½¿ç”¨v-onceæŒ‡ä»¤è¿›è¡Œä¸€æ¬¡æ€§æ’å€¼ åŸå§‹ HTML æ–‡æœ¬æ’å€¼ä¼šè§£é‡Šä¸ºæ™®é€šæ–‡æœ¬ï¼Œå¦‚æœéœ€è¦è¾“å‡º HTMLï¼Œä½¿ç”¨v-html æŒ‡ä»¤: &lt;p&gt;Using mustaches: {{ rawHtml }}&lt;/p&gt; &lt;p&gt;Using v-html directive: &lt;span v-html=&quot;rawHtml&quot;&gt;&lt;/span&gt;&lt;/p&gt; &lt;!--å°†æ•´ä¸ªv-htmlä½œç”¨çš„æ ‡ç­¾ æ›¿æ¢ä½œä¸ºhtmlå†…å®¹--&gt; å±æ€§ Attribute ç”¨äºåŠ¨æ€ä¿®æ”¹æ ‡ç­¾å±æ€§çš„å€¼ï¼Œä½¿ç”¨v-bind æŒ‡ä»¤ï¼š &lt;img v-bind:src=&quot;img&quot; alt=&quot;img&quot; /&gt; &lt;img :src=&quot;img&quot; alt=&quot;img&quot; /&gt; è¯´æ˜ï¼šå¦‚æœç»‘å®šçš„å€¼æ˜¯nullæˆ–undefinedï¼Œé‚£ä¹ˆè¯¥ attribute å°†ä¸ä¼šè¢«åŒ…å«åœ¨æ¸²æŸ“çš„å…ƒç´ ä¸Šã€‚ï¼ˆbool å±æ€§æœ‰æ‰€åŒºåˆ«ï¼‰ ä½¿ç”¨JSè¡¨è¾¾å¼ å¯¹äºæ‰€æœ‰çš„æ•°æ®ç»‘å®šï¼ŒVue éƒ½æä¾›äº†å®Œå…¨çš„ JavaScript è¡¨è¾¾å¼æ”¯æŒï¼ˆå•ä¸ªè¡¨è¾¾å¼ï¼‰ {{ number + 1 }} {{ ok ? 'YES' : 'NO' }} {{ message.split('').reverse().join('') }} &lt;div v-bind:id=&quot;'list-' + id&quot;&gt;&lt;/div&gt; äº‹ä»¶ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨JSè¡¨è¾¾å¼ æŒ‡ä»¤ å¸¸è§æŒ‡ä»¤å¦‚ä¸‹ï¼Œæœ‰çš„æŒ‡ä»¤å¯ä»¥æ¥æ”¶å‚æ•°ï¼ˆå†’å·åï¼‰ v-html v-bindï¼ˆå¯ä»¥ç¼©å†™:ï¼‰ v-model åœ¨è¡¨å•&lt;input&gt;ã€&lt;textarea&gt;åŠ&lt;select&gt;ç­‰å…ƒç´ ä¸Šåˆ›å»ºåŒå‘æ•°æ®ç»‘å®šã€‚ v-if v-for v-onï¼ˆå¯ä»¥ç¼©å†™@ï¼‰ æŒ‡ä»¤å‚æ•°ä¹Ÿæ˜¯æ”¯æŒ JS è¡¨è¾¾å¼ï¼Œè¯­æ³•ï¼š &lt;a v-bind:[attributeName]=&quot;url&quot;&gt; ... &lt;/a&gt; data å’Œ methods ç»„ä»¶çš„dataé€‰é¡¹æ˜¯å‡½æ•°ï¼Œåˆ›å»ºç»„ä»¶å®ä¾‹æ—¶è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä»¥$dataå­˜å‚¨åœ¨ç»„ä»¶å®ä¾‹ä¸­ã€‚ åŒæ—¶è¯¥å¯¹è±¡çš„é¡¶çº§å±æ€§ property ä¼šç›´æ¥é€šè¿‡ç»„ä»¶ç¤ºä¾‹æš´éœ²å¤„ç†ã€‚ ç»„ä»¶çš„methodsé€‰é¡¹ä¸ºåŒ…å«ç»„ä»¶æ‰€éœ€è¦çš„æ–¹æ³•çš„å¯¹è±¡ï¼ŒVue è‡ªåŠ¨ä¸ºå…¶ç»‘å®šäº†thisï¼Œå§‹ç»ˆæŒ‡å‘ç»„ä»¶å®ä¾‹ã€‚å®šä¹‰æ–¹æ³•æ—¶é¿å…ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚ const app = Vue.createApp({ data() { return { count: 4 } }, methods: { increment() { // `this` æŒ‡å‘è¯¥ç»„ä»¶å®ä¾‹ this.count++ } } }) const vm = app.mount('#app') console.log(vm.count) // =&gt; 4 vm.increment() console.log(vm.count) // =&gt; 5 data è¿”å›å¯¹è±¡çš„åŸå› ï¼š ç»„ä»¶æ˜¯å¯å¤ç”¨çš„ï¼Œé€šè¿‡å‡½æ•°å±€éƒ¨ä½œç”¨åŸŸåˆ›å»ºå¹¶è¿”å›çš„å¯¹è±¡ï¼Œæ¯ä¸ªç»„ä»¶å®ä¾‹æ˜¯ä¸åŒçš„ï¼Œå¦åˆ™ç»„ä»¶ä¹‹é—´çš„æ•°æ®å¯èƒ½å¹²æ‰°ã€‚ è®¡ç®—å±æ€§å’Œä¾¦å¬å™¨ è®¡ç®—å±æ€§ computed ğŸ’¡ å¯¹äºåŒ…å«å“åº”å¼æ•°æ®çš„å¤æ‚é€»è¾‘ï¼Œåº”è¯¥ä½¿ç”¨è®¡ç®—å±æ€§ åœ¨é…ç½®å¯¹åƒä¸­çš„computedå¯¹è±¡ä¸­å®šä¹‰è®¡ç®—å±æ€§ï¼ˆå…¶å®æ˜¯ä¸€ä¸ªå‡½æ•°å¹¶è¿”å›ç»“æœï¼‰ã€‚ä½¿ç”¨æ—¶å¯ä»¥åƒæ™®é€šå±æ€§ä¸€æ ·å°†æ•°æ®(è®¡ç®—å±æ€§çš„ç»“æœ)ç»‘å®šåˆ°æ¨¡ç‰ˆä¸­çš„è®¡ç®—å±æ€§ã€‚ å¥½å¤„ï¼šä¸€æ¬¡å£°æ˜Vueå¯ä»¥çŸ¥é“è¯¥è®¡ç®—å±æ€§ä¾èµ–çš„çœŸå®å±æ€§ï¼Œå½“ä¾èµ–å±æ€§å‘é€æ”¹å˜æ—¶ï¼Œä¾èµ–è¯¥è®¡ç®—å±æ€§çš„ç»‘å®šéƒ½ä¼šæ›´æ–°ã€‚ä¸ä½¿ç”¨æ–¹æ³•ç›¸æ¯”ï¼Œè®¡ç®—å±æ€§å¯ä»¥ç¼“å­˜ç»“æœã€‚ &lt;div id=&quot;computed-basics&quot;&gt; &lt;span&gt;{{ computedMsg }}&lt;/span&gt; &lt;/div&gt; Vue.createApp({ data(){...} computed: { // è®¡ç®—å±æ€§ computedMsg() { return this.msg.split('').reverse().join(''); }, }, }).mount('#computed-basics') ä¾¦å¬å™¨ watch watché€‰é¡¹æä¾›ç±»ä¸€ä¸ªæ›´åŠ é€šç”¨æ–¹å¼æ¥å“åº”æ•°æ®çš„å˜åŒ–ã€‚ç”¨äºæ‰§è¡Œå¼‚æ­¥æ“ä½œï¼Œæˆ–è€…å¼€é”€æ¯”è¾ƒå¤§çš„æ“ä½œã€‚ ... watch: { // æ¯å½“ message å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¯¥å‡½æ•°å°†ä¼šæ‰§è¡Œ message(newValue, oldValue) { if(newValue.length()&gt;oldValue.length()){ this.getNewMessage() } } }, ... æ·±åº¦ä¾¦å¬ ... watch: { &quot;user.name&quot;: { // ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œä»…ä»…å•ç‹¬ä¾¦å¬è¯¥å¯¹è±¡çš„æŸä¸ªå±æ€§ immediate: true, // åˆå§‹åŒ–æ—¶ä¹Ÿä¼šè°ƒç”¨å‡½æ•° deep: true, // æ·±åº¦ä¾¦å¬ï¼Œç”¨äºä¾¦å¬å¯¹è±¡ä¸­çš„å±æ€§å˜åŒ– handler: function(newValue){ console.log(newValue); } } }, ... æ ·å¼ç»‘å®š æ“ä½œå…ƒç´ çš„ class åˆ—è¡¨å’Œå†…è”æ ·å¼å…¶å®ä¹Ÿæ˜¯ä¸€ç§æ•°æ®ç»‘å®šï¼Œç»‘å®šå…ƒç´ çš„ attributeã€‚ ä½¿ç”¨ v-bind ç»‘å®šclass ï½œ styleï¼Œè¡¨è¾¾å¼ç»“æœå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€å¯¹è±¡ä»¥åŠæ•°ç»„ã€‚ ä¾‹å¦‚ä½¿ç”¨ data property ä¸­çš„å¯¹è±¡è¿›è¡Œç»‘å®šï¼š &lt;div :class=&quot;classObject&quot;&gt;&lt;/div&gt; &lt;!-- v-bind:class ç®€å†™ --&gt; data() { return { classObject: { // ä½œä¸ºç»‘å®šçš„å¯¹è±¡ active: true, 'text-danger': false } } } æˆ–è€…å¯ä»¥ç»‘å®šä¸€ä¸ªè¿”å›å¯¹è±¡çš„è®¡ç®—å±æ€§ï¼›æ•°ç»„å’Œå¯¹è±¡ä¹Ÿå¯ä»¥ç»“åˆä½¿ç”¨ã€‚ å†…è”æ ·å¼ç»‘å®šä¸ä¹‹ç±»ä¼¼ã€‚CSS property åç”¨é©¼å³°å¼æˆ–çŸ­æ¨ªçº¿åˆ†éš” (ç”¨å¼•å·æ‹¬èµ·æ¥) æ¥å‘½åã€‚ æ¸²æŸ“ æ¡ä»¶æ¸²æŸ“ v-if/v-else/v-else-ifæœ‰æ¡ä»¶çš„æ¸²æŸ“å…ƒç´ /åˆ†ç»„(ä½¿ç”¨&lt;template&gt;æ ‡ç­¾åŒ…è£¹) v-show ä½¿ç”¨v-if/v-elseï¼Œv-if ä¸­è¡¨è¾¾å¼è¿”å› truthy å€¼çš„æ—¶å€™è¢«æ¸²æŸ“ï¼Œå¦åˆ™æ¸²æŸ“ v-else å…ƒç´  &lt;h1 v-if=&quot;awesome&quot;&gt;Vue is awesome!&lt;/h1&gt; &lt;h1 v-else&gt;Oh no ğŸ˜¢&lt;/h1&gt; v-showçš„å…ƒç´ å§‹ç»ˆä¼šè¢«æ¸²æŸ“å¹¶ä¿ç•™åœ¨ DOM ä¸­ã€‚v-showåªæ˜¯ç®€å•åœ°åˆ‡æ¢å…ƒç´ çš„displayCSS propertyã€‚å®ƒä¸æ”¯æŒ&lt;template&gt;å…ƒç´ ï¼Œä¹Ÿä¸æ”¯æŒv-else ğŸ’¡ v-ifæ›´å¤šé€‚ç”¨ä¸ä¸€æ¬¡æ¸²æŸ“æˆ–è€…æ¡ä»¶æ”¹å˜ä¸é¢‘ç¹çš„åœºæ™¯ï¼Œv-showå¯ç”¨äºæ¡ä»¶é¢‘ç¹æ”¹å˜åœºæ™¯ åˆ—è¡¨æ¸²æŸ“ ä½¿ç”¨v-forè¿›è¡Œåˆ—è¡¨æ¸²æŸ“æ•°ç»„ &lt;ul id=&quot;array-with-index&quot;&gt; &lt;!--(item, index) of items--&gt; &lt;li v-for=&quot;(item, index) in items&quot; :key=&quot;item.id&quot;&gt; {{ index }} - {{ item.message }} &lt;/li&gt; &lt;/ul&gt; ä¹Ÿå¯ä»¥æ¸²æŸ“ä¸€ä¸ªå¯¹è±¡ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯¹è±¡é”®å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯é”®åï¼ˆå¯é€‰çš„ç¬¬ä¸‰ä¸ªå‚æ•° indexï¼‰ã€‚æ³¨æ„éå†å¯¹è±¡æ—¶ä½¿ç”¨çš„Object.keys()ç»“æœéå†ã€‚ æ³¨æ„ï¼šVue é»˜è®¤ä½¿ç”¨å°±åœ°æ›´æ–°çš„ç­–ç•¥ï¼Œå¦‚æœæ•°æ®é¡¹é¡ºåºå‘ç”Ÿæ”¹å˜ï¼Œå¹¶ä¸ä¼šç§»åŠ¨ DOM å…ƒç´ æ¥åŒ¹é…æ•°æ®é¡¹çš„ä½ç½®é¡ºåºï¼Œåªæ˜¯å°±åœ°æ›´æ–°æ¯ä¸ªå…ƒç´ ã€‚å› æ­¤åº”è¯¥å°½å¯èƒ½åœ¨ä½¿ç”¨v-foræ—¶æä¾›:keyä½œä¸ºæ ‡è¯†æ¥è¿½è¸ªè¯¥èŠ‚ç‚¹çš„èº«ä»½(åº”è¯¥åº”ç”¨å“ªä¸ªæ•°æ®é¡¹)ã€‚ Vue å°†ä¾¦å¬çš„æ•°ç»„çš„å˜æ›´æ–¹æ³•è¿›è¡Œäº†åŒ…è£¹ï¼Œä½¿ç”¨ä¼šè‡ªåŠ¨è§¦å‘è§†å›¾çš„æ›´æ–°ã€‚ æ˜¾ç¤ºè¿‡æ»¤/æ’åºåçš„ç»“æœï¼Ÿ å¯ä»¥ä½¿ç”¨è®¡ç®—å±æ€§ï¼Œä¸å®é™…å˜æ›´æˆ–é‡ç½®åŸå§‹æ•°æ®ï¼Œåªæ˜¯è¿”å›è¿‡æ»¤/æ’åºåçš„æ•°ç»„ã€‚æˆ–è€…åœ¨åµŒå¥—çš„ v-for å¾ªç¯ä¸­ä½¿ç”¨ methods ã€‚ v-for ä¸­å¯ä»¥ä½¿ç”¨æ•´æ•°ï¼Œ&lt;span v-for=&quot;n in 10&quot; :key=&quot;n&quot;&gt;{{ n }} &lt;/span&gt;é‡å¤æ¨¡ç‰ˆ 10æ¬¡ åˆ©ç”¨&lt;template&gt;å’Œv-forå¾ªç¯æ¸²æŸ“ä¸€æ®µåŒ…å«å¤šä¸ªå…ƒç´ çš„å†…å®¹ v-for ä¸ v-if ä¸æ¨èåœ¨åŒä¸€å…ƒç´ ä¸Šä½¿ç”¨v-ifå’Œv-forã€‚å½“å®ƒä»¬å¤„äºåŒä¸€èŠ‚ç‚¹ï¼Œv-ifçš„ä¼˜å…ˆçº§æ¯”v-foræ›´é«˜ï¼Œè¿™æ„å‘³ç€v-ifå°†æ²¡æœ‰æƒé™è®¿é—®v-foré‡Œçš„å˜é‡ã€‚ æ¨èå†™æ³•ï¼šä½¿ç”¨&lt;template&gt; &lt;template v-for=&quot;todo in todos&quot; :key=&quot;todo.name&quot;&gt; &lt;li v-if=&quot;!todo.isComplete&quot;&gt; {{ todo.name }} &lt;/li&gt; &lt;/template&gt; äº‹ä»¶å¤„ç† ä½¿ç”¨v-onæŒ‡ä»¤ (é€šå¸¸ç¼©å†™ä¸º@ç¬¦å·) æ¥ç›‘å¬ DOM äº‹ä»¶ï¼Œå¹¶åœ¨è§¦å‘äº‹ä»¶æ—¶æ‰§è¡Œä¸€äº› JavaScriptã€‚ç”¨æ³•ä¸ºv-on:click=&quot;methodName&quot;æˆ–ä½¿ç”¨å¿«æ·æ–¹å¼@click=&quot;methodName&quot; äº‹ä»¶å¤„ç†å†™æ³•ï¼š ç›´æ¥å†…è” JS ä»£ç  å®šä¹‰ Methods ä¸­çš„(äº‹ä»¶å¤„ç†)æ–¹æ³•ï¼Œç›´æ¥ç»‘å®šä¸€ä¸ªæ–¹æ³•çš„åç§° åœ¨å†…è” JavaScript è¯­å¥ä¸­è°ƒç”¨æ–¹æ³•ï¼ˆ12ç»“åˆï¼‰ï¼›ç”¨ç‰¹æ®Šå˜é‡$eventè¡¨ç¤ºåŸå§‹ DOM eventå¯¹è±¡ äº‹ä»¶ä¿®é¥°ç¬¦ï¼š .stopé˜»æ­¢äº‹ä»¶ç»§ç»­å†’æ³¡ .preventé˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œä¾‹å¦‚æäº¤äº‹ä»¶ä¼šé‡è½½é¡µé¢ .onceåªèƒ½è§¦å‘ä¸€æ¬¡å¤„ç†å‡½æ•° .selfåªå½“åœ¨ event.target æ˜¯å½“å‰å…ƒç´ è‡ªèº«æ—¶è§¦å‘å¤„ç†å‡½æ•° .captureå†…éƒ¨å…ƒç´ è§¦å‘çš„äº‹ä»¶å…ˆåœ¨æ­¤å¤„ç† è¡¨å•è¾“å…¥ç»‘å®š ç”¨v-modelæŒ‡ä»¤åœ¨è¡¨å•&lt;input&gt;ã€&lt;textarea&gt;åŠ&lt;select&gt;å…ƒç´ ä¸Šåˆ›å»ºåŒå‘æ•°æ®ç»‘å®šã€‚ æœ¬è´¨å°±æ˜¯ï¼šç»‘å®šæ•°æ®ï¼Œå¹¶ä¸”ç›‘å¬ç”¨æˆ·çš„è¾“å…¥æ•°æ®æ¥æ›´æ–°å¯¹åº”çš„æ•°æ®ã€‚ v-modelä¸ä¼šåœ¨è¾“å…¥æ³•ç»„ç»‡æ–‡å­—è¿‡ç¨‹ä¸­å¾—åˆ°æ›´æ–°ã€‚ä½¿ç”¨inputäº‹ä»¶ç›‘å¬å™¨å’Œvalueç»‘å®šæ¥æ›¿ä»£v-modelå¯ä»¥å“åº”ã€‚ ã€ä¼šå¿½ç•¥è¡¨å•å…ƒç´  attr ä¸Šçš„åˆå§‹å€¼ï¼Œå¯ä»¥åœ¨ç»„ä»¶çš„ data é€‰é¡¹ä¸­å£°æ˜å…¶åˆå§‹å€¼ã€‘ &lt;input v-model=&quot;message&quot; placeholder=&quot;edit me&quot; /&gt; &lt;p&gt;Message is: {{ message }}&lt;/p&gt; å¸¸è§è¡¨å•ç”¨æ³•ï¼š https://v3.cn.vuejs.org/guide/forms.html#æ–‡æœ¬-text v-model ä¿®é¥°ç¬¦ .lazy v-model é»˜è®¤æ¯æ¬¡inputäº‹ä»¶è§¦å‘åå°†è¾“å…¥æ¡†çš„å€¼ä¸æ•°æ®è¿›è¡ŒåŒæ­¥ï¼›ä½¿ç”¨ .lazy ä¿®é¥°è½¬ä¸ºåœ¨changeäº‹ä»¶ä¹‹åè¿›è¡ŒåŒæ­¥ .number å°†ç”¨æˆ·çš„è¾“å…¥å€¼è½¬ä¸ºæ•°å€¼ç±»å‹ï¼›å½“è¾“å…¥ç±»å‹ä¸ºtextæ—¶è¿™é€šå¸¸å¾ˆæœ‰ç”¨ï¼Œå¦‚æœå€¼æ— æ³•è¢«parseFloat()è§£æï¼Œåˆ™è¿”å›åŸå§‹å€¼ .trim è‡ªåŠ¨è¿‡æ»¤ç”¨æˆ·è¾“å…¥çš„é¦–å°¾ç©ºç™½å­—ç¬¦ ç»„ä»¶ ç»„ä»¶æ˜¯å¸¦åç§°çš„å¯å¤ç”¨çš„å®ä¾‹ã€‚éƒ½æ¥æ”¶ç›¸åŒçš„é€‰é¡¹ï¼Œä¾‹å¦‚dataã€computedã€watchã€methodsä»¥åŠç”Ÿå‘½å‘¨æœŸé’©å­ç­‰ã€‚ è¯´æ˜ï¼šä¸ºäº†èƒ½åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ï¼Œè¿™äº›ç»„ä»¶å¿…é¡»å…ˆæ³¨å†Œä»¥ä¾¿ Vue èƒ½å¤Ÿè¯†åˆ«ã€‚è¿™é‡Œæœ‰ä¸¤ç§ç»„ä»¶çš„æ³¨å†Œç±»å‹ï¼šå…¨å±€æ³¨å†Œå’Œå±€éƒ¨æ³¨å†Œã€‚ å‘å­ç»„ä»¶ä¼ é€’æ•°æ® ä½¿ç”¨ Prop åœ¨ç»„ä»¶ä¸Šæ³¨å†Œä¸€äº›è‡ªå®šä¹‰ attribute å³ Propï¼Œä½¿ç”¨propsé€‰é¡¹æ¥å®šä¹‰è¯¥ç»„ä»¶å¯æ¥å—çš„ prop åˆ—è¡¨ã€‚çˆ¶ç»„ä»¶é€šè¿‡è¯¥ prop æ¥å‘è¯¥å­ç»„ä»¶ä¼ å€¼ï¼Œè¯¥ property çš„å€¼å¯ä»¥åœ¨è¯¥ç»„ä»¶çš„æ¨¡æ¿ä¸­è®¿é—®ã€‚ ä¼ å€¼ï¼Œå¯ä»¥ä½¿ç”¨v-bindæˆ–:æ¥åŠ¨æ€ä¼ å€¼ï¼š &lt;div id=&quot;blog-posts-demo&quot;&gt; &lt;blog-post v-for=&quot;post in posts&quot; :key=&quot;post.id&quot; :title=&quot;post.title&quot;&gt; &lt;/blog-post&gt; &lt;/div&gt; å®šä¹‰propsç®€å•æ–¹å¼æ˜¯å®šä¹‰ prop æ•°ç»„ï¼Œä¹Ÿå¯ä»¥å®šå¯¹è±¡æ¥ä¸º prop æŒ‡å®šéªŒè¯è¦æ±‚ï¼š export default { props: { title: { type: String, default: 'Hello !!!', required: true, } } } æ³¨æ„ï¼šå¯¹è±¡/æ•°ç»„çš„é»˜è®¤å€¼ï¼Œå¿…é¡»ä»ä¸€ä¸ªå·¥å‚å‡½æ•°è¿”å›ã€‚ å•å‘æ•°æ®æµ å•å‘ä¸‹è¡Œç»‘å®šï¼Œçˆ¶çº§ prop çš„æ›´æ–°ä¼šå‘ä¸‹æµåŠ¨åˆ°å­ç»„ä»¶ä¸­ï¼Œä½†æ˜¯åè¿‡æ¥åˆ™ä¸è¡Œ å‘çˆ¶ç»„ä»¶ä¼ é€’æ•°æ® ä¸èƒ½ç›´æ¥ä½¿ç”¨ Prop æ–¹å¼ä¼ é€’ï¼Œçˆ¶ç»„ä»¶å¯ä»¥ç›‘å¬å­ç»„ä»¶è‡ªå®šä¹‰çš„äº‹ä»¶æ¥æ¥æ”¶ä¼ é€’çš„æ•°æ®ã€‚ å­ç»„ä»¶ä¸­ï¼š // åœ¨æ–¹æ³•ä¸­å®šä¹‰è§¦å‘çš„äº‹ä»¶ methods:{ sendParent(){ // $emit æ¥è§¦å‘äº‹ä»¶ this.$emit(&quot;sendMsg&quot;, this.msg); } }, ... çˆ¶ç»„ä»¶ä¸­ï¼š // åœ¨å­ç»„ä»¶å…ƒç´ ä¸Šç›‘å¬äº‹ä»¶ &lt;template&gt; &lt;ChildComponent @sendMsg=&quot;getChildMsg&quot;&gt;&lt;/ChildComponent&gt; &lt;/template&gt; æ¨¡ç‰ˆå¼•ç”¨ï¼ˆè®¿é—®ç»„ä»¶ï¼‰ åœ¨ JavaScript ä¸­ç›´æ¥è®¿é—®å­ç»„ä»¶ï¼Œå¯ä»¥ä½¿ç”¨refattribute ä¸ºå­ç»„ä»¶æˆ– HTML å…ƒç´ æŒ‡å®šå¼•ç”¨ IDï¼š &lt;base-input ref=&quot;usernameInput&quot;&gt;&lt;/base-input&gt; ä»¥ JS æ–¹å¼è®¿é—®å…ƒç´ (DOM)ï¼Œä¾‹å¦‚ä»¥ç¼–ç¨‹çš„æ–¹å¼ focus åˆ°è¿™ä¸ª input ã€‚ çˆ¶ç»„ä»¶ç›´æ¥è®¿é—®å­ç»„ä»¶ï¼š$refs çˆ¶ç»„ä»¶ä¸­å®šä¹‰çš„(å­ç»„ä»¶)å…ƒç´ ä¸Šä½¿ç”¨ref=&quot;usernameInput&quot;æ·»åŠ å¼•ç”¨åç§°åï¼Œå¯ä»¥ä½¿ç”¨$refs.usernameInputæ¥è·å–å¼•ç”¨å…ƒç´ . $refsåªä¼šåœ¨ç»„ä»¶æ¸²æŸ“å®Œæˆä¹‹åç”Ÿæ•ˆï¼Œé¿å…åœ¨æ¨¡æ¿æˆ–è®¡ç®—å±æ€§ä¸­è®¿é—® å­ç»„ä»¶è®¿é—®çˆ¶ç»„ä»¶ï¼š$parent å­ç»„ä»¶ä¸­ä½¿ç”¨$parentå¯ä»¥è·å–çˆ¶ç»„ä»¶å¯¹è±¡ä¿¡æ¯ã€‚ ç”±äºç»„ä»¶æ˜¯å¤ç”¨çš„ï¼Œä»è€Œçˆ¶ç»„ä»¶å¯èƒ½æ˜¯ä¸åŒçš„ï¼Œä¸å»ºè®®ä½¿ç”¨è¯¥æ–¹å¼è·å–æ•°æ®ã€‚è€Œå»ºè®®ä½¿ç”¨ Prop æ¥ä¼ é€’æ•°æ®ã€‚ è®¿é—®æ ¹ç»„ä»¶ï¼š$root æ’æ§½ ç±»ä¼¼ä¸ HTML ä¸­å‘ä¸€ä¸ªæ ‡ç­¾ä¼ é€’å€¼ï¼š &lt;alert-box&gt;Something bad happened.&lt;/alert-box&gt; åœ¨ç»„ä»¶ä¸­å¯ä»¥åˆ©ç”¨**&lt;slot&gt;&lt;/slot&gt;**æ¥ä½œä¸ºæ’å…¥å†…å®¹çš„å ä½ç¬¦ï¼Œåœ¨ä½¿ç”¨è¯¥ç»„ä»¶å…ƒç´ æ—¶(ä½¿ç”¨åŒæ ‡ç­¾è¯­æ³•)å¯ä»¥è¿›è¡Œå¡«å……ã€‚ &lt;Component1&gt;&lt;button&gt;111&lt;/button&gt;&lt;/Component1&gt; &lt;Component1&gt;&lt;p&gt;hello world!&lt;/p&gt;&lt;/Component1&gt; å¦‚ä½•å®šä¹‰å¤šä¸ªæ’æ§½ï¼Ÿ å…·åæ’æ§½ï¼Œå®šä¹‰ slot æ—¶æ·»åŠ  name å±æ€§ï¼Œä½¿ç”¨ç»„ä»¶å…ƒç´ æ—¶ä½¿ç”¨&lt;templat&gt; å’Œ v-slotæŒ‡ä»¤åŒ…è£¹æ¯ä¸ªæ’æ§½å¯¹åº”çš„å†…å®¹ï¼š &lt;template v-slot:header&gt; &lt;h1&gt;Here might be a page title&lt;/h1&gt; &lt;/template&gt; ä½œç”¨åŸŸæ’æ§½ ä¸ºäº†æŸäº›åœºæ™¯(è‡ªå®šä¹‰æ¸²æŸ“åˆ—è¡¨çš„æ–¹å¼)ï¼Œæ’æ§½çš„ä¸­æ•°æ®å†…å®¹å¯ä»¥ç”±å­ç»„ä»¶æä¾›ï¼Œä½¿ç”¨**v-slot:default=&quot;slotProps&quot;** æ¥æ¥æ”¶å­ç»„ä»¶å®šä¹‰æ’æ§½æ—¶ä¼ é€’çš„æ‰€æœ‰æ•°æ®å¯¹è±¡ slotProps &lt;template v-slot:default=&quot;slotProps&quot;&gt; &lt;ul&gt; &lt;li v-for=&quot;item in slotProps.list&quot; :key=&quot;item&quot;&gt;{{item}}&lt;/li&gt; &lt;/ul&gt; &lt;/template&gt; è·¨çº§é€šä¿¡ å¦‚æœç»„ä»¶å±‚æ¬¡ç»“æ„è¾ƒæ·±ï¼Œä½¿ç”¨provide, injectï¼Œçˆ¶ç»„ä»¶å¯ä»¥ä½œä¸ºå…¶æ‰€æœ‰å­ç»„ä»¶çš„ä¾èµ–æä¾›è€…ã€‚ çˆ¶ç»„ä»¶æœ‰ä¸€ä¸ªprovide é€‰é¡¹æ¥æä¾›æ•°æ®ï¼Œå­ç»„ä»¶æœ‰ä¸€ä¸ªinject é€‰é¡¹æ¥å¼€å§‹ä½¿ç”¨è¿™äº›æ•°æ®ã€‚ä½œç”¨ç±»ä¼¼äº Prop æ•°æ®çš„ä¼ é€’ã€‚ // ç¥–å…ˆç»„ä»¶çš„ provide é€‰é¡¹ provide: { user: 'John Doe' }, // å­ç»„ä»¶ä½¿ç”¨ inject é€‰é¡¹ inject: ['user'], æ³¨æ„ï¼šå¦‚æœ provide é€‰é¡¹æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™ä¸èƒ½ç›´æ¥è®¿é—®ç»„ä»¶å®ä¾‹çš„ propertyã€‚ ä¸ºäº†ä½¿ç”¨ç»„ä»¶å®ä¾‹çš„ propertyï¼Œåˆ™ provide é€‰é¡¹éœ€è¦æ”¹ä¸ºè¿”å›å¯¹è±¡çš„å‡½æ•°ã€‚ å“åº”æ€§é—®é¢˜ å³ä½¿è¿™æ ·ï¼Œè®¿é—®çš„ property ä¹Ÿä¸æ˜¯å“åº”æ€§ç»‘å®šï¼Œå³ç¥–å…ˆæ•°æ®çš„å˜åŒ–ä¸ä¼šåæ˜ åœ¨å­ç»„ä»¶ inject ä¸­çš„ propertyã€‚é»˜è®¤çš„ provide/inject ç»‘å®šä¸æ˜¯å“åº”å¼çš„ã€‚ resolve: å¯ä»¥é€šè¿‡ä¼ é€’ä¸€ä¸ªrefproperty æˆ–reactiveå¯¹è±¡ç»™provideæ¥æ”¹å˜è¿™ç§è¡Œä¸º å“åº”å¼å¯¹è±¡ provide(){ return{ obj: this.obj, // æ¥æ”¶çš„æ˜¯åŒ…å«æ•°æ®çš„å¯¹è±¡(ä¿®æ”¹ä¹Ÿæ˜¯ä¿®æ”¹è¯¥å¯¹è±¡ä¸­çš„æ•°æ®) } }, ç®­å¤´å‡½æ•°ï¼ˆå“åº”å¼æ•°æ®ï¼‰ provide(){ return{ message: ()=&gt;this.message, // æ¥æ”¶çš„æ˜¯å‡½æ•°ï¼Œè°ƒç”¨æ‰è¿”å›å“åº”å¼æ•°æ® } }, å­ç»„ä»¶å¤šæ¬¡è°ƒç”¨ä¸­ï¼Œå¯ä»¥ä½¿ç”¨è®¡ç®—å±æ€§æ¥ç¼“å­˜è¯¥ç»“æœã€‚ ç»„åˆå¼ APIcomputed ç”Ÿå‘½å‘¨æœŸ ç”Ÿå‘½å‘¨æœŸå›¾ç¤º ä½¿ç”¨ï¼š ç»„ä»¶è§†å›¾æ›´æ–°ï¼ˆç»‘å®šæ•°æ®æ›´æ–°ï¼‰ä¼šæ‰§è¡Œå¯¹åº”çš„beforeUpdateï¼Œupdatedå‡½æ•° ç»„ä»¶çš„é”€æ¯å’Œåˆ›å»ºï¼Œä¼šæ‰§è¡ŒbeforeUnmountï¼Œunmountedå‡½æ•°ï¼Œä¾‹å¦‚ä½¿ç”¨ v-if è¿›è¡Œæ¡ä»¶æ¸²æŸ“ã€‚ ç»„åˆå¼API ä½œç”¨ï¼šå°†åŒä¸€ä¸ªé€»è¾‘å…³æ³¨ç‚¹ç›¸å…³ä»£ç æ”¶é›†åœ¨ä¸€èµ·ã€‚ setupé€‰é¡¹æ˜¯ä¸€ä¸ªæ¥æ”¶props/contextçš„å‡½æ•°ï¼Œåœ¨ç»„ä»¶åˆ›å»ºä¹‹å‰æ‰§è¡Œï¼ˆå¯ä»¥ä»£æ›¿ beforeCreate, created ç”Ÿå‘½å‘¨æœŸé’©å­ï¼‰ã€‚å¹¶ä¸”ä¸èƒ½ä½¿ç”¨ this æ¥è®¿é—®ç»„ä»¶å®ä¾‹ã€‚ setup è¿”å›çš„æ‰€æœ‰å†…å®¹éƒ½æš´éœ²ç»™ç»„ä»¶çš„å…¶ä½™éƒ¨åˆ† (è®¡ç®—å±æ€§ã€æ–¹æ³•ã€ç”Ÿå‘½å‘¨æœŸé’©å­ç­‰ç­‰) ä»¥åŠç»„ä»¶çš„æ¨¡æ¿(æ¨¡ç‰ˆä¸­ä½¿ç”¨çš„å¼•ç”¨å˜é‡ä¼šè‡ªåŠ¨æµ…è§£åŒ…)ã€‚ setup é€‰é¡¹ä¸­å®šä¹‰çš„å˜é‡é»˜è®¤æ˜¯éå“åº”å¼çš„(ä¿®æ”¹ä¸ä¼šå½±å“è§†å›¾)ï¼Œä½¿ç”¨refå‡½æ•°æ¥æ”¶å‚æ•°å¹¶å°†å…¶åŒ…è£¹åœ¨ä¸€ä¸ªå¸¦æœ‰valueproperty çš„å¯¹è±¡ä¸­è¿”å›ï¼Œä½¿ç”¨è¯¥ property å¯ä»¥è®¿é—®/ä¿®æ”¹è¯¥å“åº”å¼å˜é‡å€¼ã€‚å› ä¸ºJSä¸­Numberæˆ–Stringç­‰åŸºæœ¬ç±»å‹æ˜¯é€šè¿‡å€¼è€Œéå¼•ç”¨ä¼ é€’ï¼Œè¿™æ ·å°è£…ä¹Ÿæ˜¯ä¸ºäº†ä¸åŒæ•°æ®ç±»å‹çš„è¡Œä¸ºç»Ÿä¸€ã€‚ ref()å“åº”å¼å˜é‡ å¯¹Number, Stringä½¿ç”¨ ref() ï¼Œè¿”å›å“åº”å¼å¯¹è±¡ï¼Œé€šè¿‡valueå±æ€§è®¿é—®å€¼ã€‚ æ•°ç»„å¯¹è±¡ä¹Ÿé€šå¸¸ä½¿ç”¨ ref() å¯¹äºå¯¹è±¡ï¼Œä½¿ç”¨reactive()å’ŒtoRefs() å¯¹è±¡ä½¿ç”¨ reactive() è¿”å›ä»£ç†å¯¹è±¡ï¼ˆå“åº”å¼ï¼‰ ä¸ºäº†ç›´æ¥æš´éœ²å¯¹è±¡çš„å±æ€§åç§°(æ¥è®¿é—®å€¼)ï¼Œä½¿å¾—é€šè¿‡è¯¥å±æ€§åç§°è®¿é—®ä¹Ÿæ˜¯å“åº”å¼çš„ï¼Œä½¿ç”¨ toRefs() ä¸å¯¹è±¡è§£æ„ç”¨æ³•ï¼štoRefs() è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œæ¯ä¸ªå±æ€§å€¼éƒ½æ˜¯åŸå±æ€§çš„å“åº”å¼å¯¹è±¡ ObjectRefImpl (æ–¹æ³•éœ€è¦ä¸€ä¸ªå“åº”å¼å¯¹è±¡å‚æ•°) ğŸ’¡ ref() è¿”å›çš„æ˜¯ RefImplï¼Œå¦‚æœå‚æ•°æ˜¯å¯¹è±¡ï¼Œå…¶valueå°±æ˜¯è¯¥å¯¹è±¡çš„ä»£ç†å¯¹è±¡ã€‚reactive()ç›´æ¥è¿”å›å¯¹è±¡çš„ä»£ç†å¯¹è±¡Proxyã€‚ä¸€èˆ¬å¯¹è±¡ä½¿ç”¨ reactive æ›´åŠ æ–¹ä¾¿ã€‚ // setup() ... const user = reactive({ name: 'xiaoming', age: 20, }); const { name, age } = toRefs(user); function changName() { // console.log(name.value); name.value = 'zhou123'; } function changAge() { age.value = 22; } return{ name, age, changeName, changeAge} watch ç»„åˆå¼ APIï¼Œä» vue å¯¼å…¥watchå‡½æ•°æ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚ ä¸€ä¸ªæƒ³è¦ä¾¦å¬çš„å“åº”å¼å¼•ç”¨æˆ– getter å‡½æ•° ä¸€ä¸ªå›è°ƒ å¯é€‰çš„é…ç½®é€‰é¡¹ æ³¨æ„ watch å‡½æ•°åªèƒ½ç›‘å¬getter å‡½æ•°/ ref / reactive å¯¹è±¡ï¼Œå“åº”å¼å¯¹è±¡ä¸­çš„å±æ€§æ”¹å˜ä¼šè°ƒç”¨å›è°ƒå‡½æ•°(ä½†ä¸èƒ½è·å–å±æ€§æ—§å€¼)ã€‚ å¦ä¸€ä¸ªæ˜¯ watchEffect() ï¼Œè‡ªåŠ¨åˆ†æä¾èµ–ï¼Œå‘ç”Ÿæ”¹å˜åè§¦å‘ï¼Œä¸èƒ½è·å–æ—§å€¼ã€‚ //setup() const user = reactive({ name: 'aaa', age: 18, }); changeUserName(){ user.name = 'bbb'; } watch(user, (newVal, oldVal)=&gt;{ ... }); watchEffect(()=&gt;{ console.log(user.name); }); computed ç»„åˆå¼ APIï¼Œä» vue å¯¼å…¥computedå‡½æ•°æ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚ è¿”å›ä¸€ä¸ªå¸¦æœ‰ value å±æ€§çš„å¯¹è±¡ã€‚æ¨¡ç‰ˆä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥åç§°ã€‚ // setup() const reverseMsg = computed(()=&gt;{ return msg.value.split('').reverse().join('') }) setup è·å–å€¼ setup() ä¸­ä¸èƒ½ä½¿ç”¨ thisï¼Œsetup(props, context) æœ‰ setupå‡½æ•°ä¸­çš„propsä¹Ÿæ˜¯å“åº”å¼çš„ï¼Œå½“ä¼ å…¥æ–°çš„ prop æ—¶ï¼Œå®ƒå°†è¢«æ›´æ–°ã€‚ä¸ºç»„ä»¶æ¥æ”¶çš„å‚æ•°ã€‚å› ä¸ºpropsæ˜¯å“åº”å¼çš„ï¼Œä¸èƒ½ä½¿ç”¨ ES6 è§£æ„ï¼Œå®ƒä¼šæ¶ˆé™¤ prop çš„å“åº”æ€§ï¼Œä½¿ç”¨toRefs å‡½æ•°å®Œæˆã€‚ contextæ˜¯ä¸€ä¸ªæ™®é€š JavaScript å¯¹è±¡ï¼Œæš´éœ²äº†å…¶å®ƒå¯èƒ½åœ¨setupä¸­æœ‰ç”¨çš„å€¼ï¼š context.attrs ç­‰åŒäº $attrsï¼Œè·å–ç»„ä»¶æ ‡ç­¾ä¸Šå®šä¹‰çš„å±æ€§ context.slots éå“åº”å¼å¯¹è±¡ï¼Œç­‰åŒäº $slots context.emit æ–¹æ³•ï¼Œç­‰åŒäº $emitï¼Œç”¨æ¥è§¦å‘äº‹ä»¶ context.expose å‡½æ•°ï¼Œæš´éœ²å…¬å…± property ã€‚å¦‚æœç»„ä»¶çš„ setup() è¿”å›æ¸²æŸ“å‡½æ•°(æ›¿ä»£template)ï¼Œå®ƒç”¨æ¥æš´éœ²ç»„ä»¶çš„å…¬å…± propertyã€‚ç»„ä»¶å…ƒç´ ä¸Šå®šä¹‰ref=&quot;refName&quot;ï¼Œå¤–éƒ¨ç»„ä»¶ä½¿ç”¨ $refs æ¥è®¿é—®(æ¨¡æ¿ ref)ã€‚ ç”Ÿå‘½å‘¨æœŸé’©å­ https://v3.cn.vuejs.org/guide/composition-api-lifecycle-hooks.html Provide / Inject åœ¨setup()ä¸­ä½¿ç”¨provideï¼Œå¯¼å…¥è¯¥æ–¹æ³•å³å¯ã€‚ åœ¨setup()ä¸­ä½¿ç”¨injectæ—¶ï¼Œä¹Ÿéœ€è¦ä»vueæ˜¾å¼å¯¼å…¥ã€‚ å¯ä»¥åœ¨ provide å€¼æ—¶ä½¿ç”¨ref æˆ–reactiveå¢åŠ å€¼ä¹‹é—´çš„å“åº”æ€§ã€‚ ref å±æ€§ reactive å¯¹è±¡ ç»„åˆå¼ APIcomputed // ref let counter = ref(0) // let user = reactive({ name: 'abc', age: 20, }) let len = Vue.computed(() =&gt; this.todos.length) provide('counter', counter) provide('user', user) provide('len', len) SFC å•æ–‡ä»¶ç»„ä»¶ &lt;script setup&gt;è¯­æ³•ç³–ï¼Œç›¸å½“äº set() å‡½æ•°çš„å®šä¹‰ï¼Œç‰¹æ®Šç‚¹ï¼š å¯¼å…¥çš„å­æ¨¡å—ä¸éœ€è¦æ³¨å†Œï¼Œå¯ä»¥ç›´æ¥åœ¨æ¨¡ç‰ˆä¸­ä½¿ç”¨ é¡¶å±‚çš„ç»‘å®šï¼ˆå˜é‡/å‡½æ•°ï¼Œå¯¼å…¥çš„å‡½æ•°ç­‰ï¼‰ä¼šç›´æ¥æš´éœ²ç»™æ¨¡ç‰ˆä½¿ç”¨ï¼ˆå³å®šä¹‰çš„å˜é‡ä¸éœ€è¦é€šè¿‡ return æš´éœ²ï¼‰ å®šä¹‰å“åº”å¼å˜é‡ï¼Œä¹Ÿéœ€è¦ä»vueä¸­å¯¼å…¥ prop å¯ä»¥ä½¿ç”¨defineProps()å®æ¥å®šä¹‰ ","tags":[{"name":"Vue","slug":"vue","used":true,"link":"https://blog.qxxiao.eu.org/tag/vue/"}],"title":"Vue åŸºç¡€","feature":"https://pic.qxxiao.cn/vuejs.png","link":"https://blog.qxxiao.eu.org/post/Vue åŸºç¡€/","stats":{"text":"19 min read","time":1095000,"words":4547,"minutes":19},"date":"2022-06-09 03:00:00","dateFormat":"2022-06-09","isTop":false},{"content":"å¤š package çš„ Rust Workspace ç»„ç»‡å’Œé…ç½®ã€‚ [TOC] Cargo å·¥ä½œç©ºé—´ï¼Œå¯ä»¥ç®¡ç†ç›¸äº’å…³è”éœ€è¦ååŒå¼€å‘çš„çš„ crateã€‚å…±äº«åŒä¸€ä¸ª Cargo.lock å’Œ è¾“å‡ºæ–‡ä»¶å¤¹ã€‚ åˆ›å»ºå·¥ä½œç©ºé—´ åœ¨å·¥ä½œåŒºç›®å½•åˆ›å»ºCargo.lockï¼Œå¹¶ä½¿ç”¨cargo new packageName [â€”lib]åˆ›å»ºéœ€è¦çš„å¤šä¸ª Packageã€‚æ‰€å¾—å·¥ä½œç©ºé—´ç›®å½•ç»“æ„ï¼š ws â”œâ”€â”€ adder â”‚ â”œâ”€â”€ Cargo.toml â”‚ â””â”€â”€ src â”œâ”€â”€ add-one â”‚ â”œâ”€â”€ Cargo.toml â”‚ â””â”€â”€ src â”œâ”€â”€ add-two â”‚ â”œâ”€â”€ Cargo.toml â”‚ â””â”€â”€ src â”œâ”€â”€ target â”‚ â”œâ”€â”€ CACHEDIR.TAG â”‚ â”œâ”€â”€ debug â”‚ â””â”€â”€ tmp â”œâ”€â”€ Cargo.lock â””â”€â”€ Cargo.toml å°† package æ·»åŠ åˆ°å·¥ä½œç©ºé—´çš„æˆå‘˜é…ç½®ä¸‹ï¼š # å·¥ä½œç©ºé—´ä¸‹çš„ Cargo.toml [workspace] members=[ 'add-one', 'add-two', 'adder', ] exclude=[] æ³¨æ„çš„é—®é¢˜ï¼š ä¸åŒ package ä¸­ä½¿ç”¨çš„ä¾èµ–ç‰ˆæœ¬ä¼šä¿æŒä¸€è‡´ï¼Œé…ç½®åœ¨å·¥ä½œç©ºé—´çš„Cargo.lockä¸­ ä¸åŒçš„ package ä¸­çš„ crate çš„ä¾èµ–å…³ç³»éœ€è¦æ˜¾ç¤ºåœ¨ package çš„ Cargo.toml ä¸­é…ç½®ï¼š # Cargo.toml [package] name = &quot;add-two&quot; version = &quot;0.1.0&quot; edition = &quot;2021&quot; # See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html [dependencies] add-one = { path = &quot;../add-one&quot; } # relative path ğŸ’¡ å¼•ç”¨add-twocrate æ—¶ï¼Œrs æºæ–‡ä»¶ä½¿ç”¨ add_two ä»£æ›¿ï¼ˆä¸‹åˆ’çº¿ï¼‰use add_two::add_fun æ„å»ºå’Œå‘å¸ƒ æ„å»ºæŒ‡å®šçš„ crateï¼Œå¯ä»¥åˆ°è¯¥ package ä¸‹è¿è¡Œæˆ–è€…æŒ‡å®šè·¯å¾„cargo run -p adder crate å‘å¸ƒæ—¶ï¼Œéœ€è¦åˆ‡æ¢æŒ‡å®šçš„ package æ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œcargo publishï¼›å¹¶ä¸”ä¾èµ–ä¸­pathè¯´æ˜ä¼šè¢«ç§»é™¤ï¼Œä½¿ç”¨crates.ioä¸­çš„ç‰ˆæœ¬ã€‚ [dependencies] add-two = { path = &quot;../add-two&quot;, version = &quot;0.1.0&quot; } ","tags":[{"name":"Rust","slug":"rust","used":true,"link":"https://blog.qxxiao.eu.org/tag/rust/"}],"title":"Rust Workspace","feature":"https://pic.qxxiao.cn/20220530212851.png","link":"https://blog.qxxiao.eu.org/post/Rust Workspace/","stats":{"text":"2 min read","time":92000,"words":345,"minutes":2},"date":"2022-06-02 20:42:00","dateFormat":"2022-06-02","isTop":false},{"content":" Youtube IPFS More Bilibili Gride Markdown This is a notion2md page. ğŸ˜ƒ Youtube å¸¦ä½ è®¤è¯† CPU IPFS ğŸŒˆ ä½¿ç”¨notionè½¬mdæ—¶ï¼Œå¯ä»¥ç”¨æ¥å­˜å‚¨ä¸€äº›å¤§æ–‡ä»¶ã€‚ video hosted by IPFS gateway: nftstorage.link More ä¸Šä¼ æ–‡ä»¶ï¼š https://gh.qxxiao.cn/IPFS-File-Uploader/ ã€å½“å‰å…è´¹ç©ºé—´æœ‰é™ï¼Œå·²è¢«é”å®šã€‘ https://qxxiao.gitlab.io/IPFS-File-Uploader/ https://nft.storage/files/ ã€å½“å‰æ¨èæ–¹å¼ã€‘ ç½‘å…³ï¼š checker: https://ipfs.github.io/public-gateway-checker/ https://ipfs.io | https://dweb.link | https://w3s.link/ ï½œhttps://nftstorage.link https://ipfs.io/ipns/ipnso.com/ ä¸‹è½½ IPFSï¼Œæœ¬åœ°æ­å»ºèŠ‚ç‚¹ Bilibili bilibili video Gride Markdown ğŸ‘‰ Hello World! Download File[ipfs.pdf] ","tags":[{"name":"Markdown","slug":"markdown","used":true,"link":"https://blog.qxxiao.eu.org/tag/markdown/"}],"title":"notion2md","feature":"https://www.notion.so/images/page-cover/met_vincent_van_gogh_irises.jpg","link":"https://blog.qxxiao.eu.org/post/notion2md/","stats":{"text":"1 min read","time":39000,"words":130,"minutes":1},"date":"2022-06-01 12:15:00","dateFormat":"2022-06-01","isTop":false},{"content":"Hello Rust. [TOC] Rust å¿«é€Ÿå…¥é—¨ç³»åˆ—çš„ç¬¬äºŒç¯‡ã€‚ é—­åŒ…ï½œè¿­ä»£å™¨ é—­åŒ… é—­åŒ…ï¼šå¯ä»¥æ•è·å…¶æ‰€åœ¨ç¯å¢ƒçš„åŒ¿åå‡½æ•°ã€‚ï¼ˆC++ç±»ä¼¼lambdaï¼Œå¯ä»¥ä»å…¶å®šä¹‰çš„ä½œç”¨åŸŸæ•è·å€¼ï¼‰ é—­åŒ…å¯ä»¥ä¿å­˜ä¸ºå˜é‡ï¼Œä½œä¸ºå‡½æ•°å‚æ•°ï¼Œæˆ–è€…å‡½æ•°è¿”å›å€¼ã€‚ fn main(){ let closure = |x| x; // let closure = |x: String| -&gt; String {x}; let s = closure(String::from(&quot;hello&quot;)); // let n = closure(5); // error ä¸Šä¸€å¥å·²ç»æ¨æ–­å‡ºclosureä¸­çš„å…·ä½“ç±»å‹ } é—­åŒ…ä¸è¦æ±‚æ ‡æ³¨å‚æ•°å’Œè¿”å›å€¼çš„ç±»å‹ï¼› é—­åŒ…çš„å®šä¹‰ï¼Œæœ€ç»ˆåªä¼šè¢«æ¨æ–­å‡ºå”¯ä¸€çš„å…·ä½“ç±»å‹ï¼ˆæˆ–è€…æ˜¾ç¤ºæ ‡æ³¨ç±»å‹ï¼‰ æ¯ä¸ªé—­åŒ…å®ä¾‹éƒ½å¯¹åº”ä¸€ä¸ªå”¯ä¸€åŒ¿åç±»å‹ï¼Œå¹¶ä¸”é—­åŒ…éƒ½å®ç°äº†ä»¥ä¸‹Fn Traitä¹‹ä¸€ï¼š Fn ä¸å¯å˜å€Ÿç”¨ç¯å¢ƒå€¼ FnMut å¯å˜å€Ÿç”¨ç¯å¢ƒå€¼ FnOnce å–å¾—æ‰€æœ‰æƒ åˆ©ç”¨é—­åŒ…å®ç° Cacher ç¼“å­˜å™¨ï¼Œå®ç°å»¶è¿Ÿè®¡ç®—/æƒ°æ€§æ±‚å€¼ use std::collections; struct Cacher&lt;T&gt; where T: Fn(u32) -&gt; u32, { calculation: T, value: collections::HashMap&lt;u32, u32&gt;, } impl&lt;T&gt; Cacher&lt;T&gt; where T: Fn(u32) -&gt; u32, { fn new(calculation: T) -&gt; Cacher&lt;T&gt; { Cacher { calculation, value: collections::HashMap::new(), } } fn value(&amp;mut self, arg: u32) -&gt; u32 { match self.value.get(&amp;arg) { Some(v) =&gt; *v, None =&gt; { let v = (self.calculation)(arg); self.value.insert(arg, v); v } } } } ã€é—­åŒ…è¿˜ä¸æ”¯æŒæ³›å‹ã€‘ æ•è·å˜é‡ æ™®é€šå‡½æ•°ä¸èƒ½æ•è·ä¸Šä¸‹æ–‡å˜é‡ï¼Œè€Œé—­åŒ…å¯ä»¥ã€‚ç»“åˆä¸Šè¿°3ç§Fn Traitï¼ŒRustå¯ä»¥æ ¹æ®ç¯å¢ƒå€¼çš„ä½¿ç”¨æƒ…å†µæ¨æ–­å‡ºå…·ä½“çš„é—­åŒ…ç±»å‹ï¼š é»˜è®¤åªæ•è·å€¼çš„ä¸å¯å˜å¼•ç”¨ï¼Œå®ç° Fn ï¼ˆä¸å¯å˜å€Ÿç”¨ï¼Œåªèƒ½è¯»ï¼‰ è·å–å€¼çš„å¯å˜å¼•ç”¨ï¼Œå®ç° FnMutï¼ˆå¯å˜å€Ÿç”¨ï¼Œå¯ä»¥ä¿®æ”¹å€¼ï¼‰ è·å–å€¼çš„æ‰€æœ‰æƒï¼Œå®ç° FnOnceï¼Œåªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼ˆå› ä¸ºè·å–äº†æ‰€æœ‰æƒï¼‰ ğŸ’¡ æ³¨æ„ï¼š3ç§Traitå­˜åœ¨å±‚çº§å…³ç³»ï¼›å®ç°äº†Fnçš„é—­åŒ…éƒ½å®ç°äº†FnMutï¼Œè€Œå®ç°äº†FnMutçš„é—­åŒ…éƒ½å®ç°äº†FnOnceï¼Œå› æ­¤æ‰€æœ‰çš„é—­åŒ…éƒ½å®ç°äº†FnOnce. ä½¿ç”¨moveå…³é”®å­—ï¼š å¯ä»¥åœ¨å®šä¹‰é—­åŒ…çš„å‚æ•°åˆ—è¡¨å‰ä½¿ç”¨ moveï¼Œå¼ºåˆ¶é—­åŒ…è·å–å€¼çš„æ‰€æœ‰æƒã€‚ å°†é—­åŒ…ä¼ é€’ç»™æ–°çº¿ç¨‹ä»¥ç§»åŠ¨æ•°æ®æ—¶ï¼Œéå¸¸æœ‰ç”¨ã€‚ let x = vec![1, 2, 3]; let equal_to_x = move |z: i32| z == x[0]; // println!(&quot;{:#?}&quot;, x); // error [E0382]: use of moved value: `x` å¯¹äºåŸºæœ¬ç±»å‹ä»¥åŠå¼•ç”¨ç±»å‹ï¼Œæ²¡æœ‰æ‰€æœ‰æƒçš„å˜é‡ä¸å½±å“ã€‚ è¿­ä»£å™¨ Rust è¿­ä»£å™¨æ˜¯æƒ°æ€§è¿­ä»£å™¨ï¼Œç”¨äºéå†ï¼š let v = vec![1, 2, 3]; // for val in v // è°ƒç”¨ into_iter() moved for val:&amp;i32 in v.iter() { // borrow println!(&quot;{}&quot;, val); } å®ç°ï¼š è¿­ä»£å™¨éƒ½å®ç°äº†trait Iteratorï¼Œéœ€è¦å®ç°nextæ–¹æ³•ï¼›è¯¥ trait ä¹Ÿæä¾›äº†ä¸€äº›é»˜è®¤å®ç°æ–¹æ³•ã€‚ pub trait Iterator{ type Item; fn next(&amp;mut self)-&gt;Option&lt;Self::Item&gt;; // default methods elided } äº§ç”Ÿè¿­ä»£å™¨çš„è¿­ä»£æ–¹æ³•ï¼š iter() åˆ›å»ºè¿­ä»£å™¨ï¼Œç”¨äºè¿­ä»£å…ƒç´ çš„ä¸å¯å˜å¼•ç”¨ï¼› iter_mut() åˆ›å»ºè¿­ä»£å™¨ï¼Œç”¨äºè¿­ä»£å…ƒç´ çš„å¯å˜å¼•ç”¨ï¼› **into_iter()**è·å–æ‰€æœ‰æƒï¼Œåˆ›å»ºè¿­ä»£å™¨ç”¨äºè¿­ä»£å…ƒç´ æœ¬èº«ï¼› è¿­ä»£å™¨é€‚é…å™¨ Iterator trait æä¾›äº†è¿­ä»£å™¨é€‚é…å™¨æ–¹æ³•ï¼Œç”¨æ¥å°†è¿­ä»£å™¨è½¬æ¢ä¸ºä¸åŒç§ç±»çš„è¿­ä»£å™¨ã€‚ ä¾‹å¦‚ map, filter let v = vec![1, 2, 3]; let iter = v.iter().map(|x: &amp;i32| x * 2); let iter2 = v.iter().map(|x| x * 2).filter(|x| x &gt; &amp;3); // ä½¿ç”¨æ¶ˆè€—å‹é€‚é…å™¨æ–¹æ³•ï¼ˆè·å–è¿­ä»£å™¨æ‰€æœ‰æƒï¼Œå¹¶ä¼šä½¿ç”¨nextæ–¹æ³•ï¼‰ // collect æ”¶é›†å…ƒç´ åˆ°é›†åˆç±»å‹ let v2:Vec[i32] = iter.collect(); ä½¿ç”¨ zip æ“ä½œä¸¤ä¸ªè¿­ä»£å™¨ï¼Œè½¬æ¢ä¸ºæ–°çš„è¿­ä»£å™¨ï¼ˆå…ƒç»„ç±»å‹ï¼‰ é‡åˆ°å…¶ä¸­ä¸€ä¸ªå€¼æ˜¯ Noneï¼Œè¿­ä»£ä¼šåœæ­¢ã€‚ ç¤ºä¾‹ struct Counter { count: u32, } impl Counter { fn new() -&gt; Counter { Counter { count: 0 } } } impl Iterator for Counter { type Item = u32; fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; { self.count += 1; if self.count &lt; 6 { Some(self.count) } else { None } } } let sum: u32 = Counter::new().take(5) .zip(Counter::new().skip(1).take(4)) .map(|(a,b)| a*b) .filter(|x| x%3==0) .sum(); assert_eq!(18, sum); æ™ºèƒ½æŒ‡é’ˆ Rust ä¸­çš„å¼•ç”¨(ä½¿ç”¨&amp;)å°±æ˜¯æŒ‡é’ˆç±»å‹ï¼Œåªå€Ÿç”¨æŒ‡å‘çš„å€¼ï¼Œæ˜¯æœ€å¸¸è§çš„æŒ‡é’ˆç±»å‹ã€‚ï¼ˆåˆ‡ç‰‡ä¹Ÿæ˜¯å¼•ç”¨ç±»å‹ï¼Œä¼šæœ‰é•¿åº¦ä¿¡æ¯ï¼‰ ğŸ’¡ æ™ºèƒ½æŒ‡é’ˆçš„è¡Œä¸ºç±»ä¼¼æŒ‡é’ˆï¼Œå…·æœ‰é¢å¤–çš„å…ƒæ•°æ®å’ŒåŠŸèƒ½ï¼›å¹¶ä¸”ä¸€èˆ¬ä¼šæ‹¥æœ‰æŒ‡å‘ æ•°æ®çš„æ‰€æœ‰æƒ ä¾‹å¦‚String | Vec&lt;T&gt;ï¼Œæ‹¥æœ‰ä¸€ç‰‡å†…å­˜åŒºåŸŸä»¥åŠå…ƒæ•°æ®å’Œç›¸å…³åŠŸèƒ½ã€‚ æ™ºèƒ½æŒ‡é’ˆï¼Œè¯­ä¹‰ä¸Šåº”è¯¥å®ç°Deref trait å’Œ Drop traitï¼š Deref Trait: å®ç° deref() æ–¹æ³• //å…è®¸æ™ºèƒ½æŒ‡é’ˆ è‡ªå®šä¹‰è§£å¼•ç”¨è¿ç®—ç¬¦ * çš„è¡Œä¸º Drop Trait: å®ç° drop() æ–¹æ³• // è‡ªå®šä¹‰å½“æŒ‡é’ˆæŒ‡é’ˆå®ä¾‹ç¦»å¼€ä½œç”¨åŸŸæ—¶è¿è¡Œçš„ä»£ç  å³å®ç°äº† Deref Trait (è¿”å›å¼•ç”¨ç±»å‹)ï¼Œä½¿å¾—å®ç°è¯¥ trait ç±»å‹çš„å˜é‡å¯ä»¥ä½¿ç”¨*varæ“ä½œ *var // &lt;==&gt; *(var.deref()) ä¸å…è®¸æ˜¾ç¤ºè°ƒç”¨ drop æ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨std::mem::dropå‡½æ•°ï¼› è§£å¼•ç”¨è½¬æ¢ Deref tait å°†&amp;T â‡’ &amp;Uå¹¶ä¸”ç±»å‹ T éšå¼å®ç°äº†ç±»å‹ U çš„æ‰€æœ‰(ä¸å¯å˜)æ–¹æ³•ã€‚(éšå¼)è§£å¼•ç”¨å¼ºåˆ¶è½¬æ¢ deref coercionï¼Œå®ç°äº† Deref trait çš„ç±»å‹å¯ä»¥å°†å…¶å¼•ç”¨é“¾å¼è°ƒç”¨ deref è½¬æ¢ä¸ºå…¶ä»–ç±»å‹çš„å¼•ç”¨ã€‚ ä¾‹å¦‚ï¼ŒString å®ç°äº† Derefï¼Œå¯ä»¥è‡ªåŠ¨å°†&amp;Stringè½¬æ¢ä¸º&amp;str ç¤ºä¾‹ä»£ç  MyBox use std::ops::Deref; struct MyBox&lt;T&gt;(T); impl&lt;T&gt; MyBox&lt;T&gt; { fn new(x: T) -&gt; MyBox&lt;T&gt; { MyBox(x) } } impl&lt;T&gt; Deref for MyBox&lt;T&gt; { type Target = T; // å…³è”ç±»å‹ï¼Œå¿…é¡»å®šä¹‰ fn deref(&amp;self) -&gt; &amp;T { &amp;self.0 } } fn main(){ let m = MyBox::new(String::from(&quot;Rust&quot;)); hello(&quot;hello Rust&quot;); hello(&amp;m); hello(&amp;String::from(&quot;Rust&quot;)); hello(&amp;(*m)[..]) } å…è®¸ä½¿ç”¨DerefMut traitæ¥é‡è½½å¯å˜å¼•ç”¨çš„*è¿ç®—ç¬¦ï¼› ğŸ’¡ Deref traitå¯ä»¥å°†å¯å˜å¼•ç”¨å¯ä»¥è½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹ä¸å¯å˜å¼•ç”¨ï¼›DerefMut traitå°†å¯å˜å¼•ç”¨å¯ä»¥è½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹çš„å¯å˜å¼•ç”¨ã€‚ å¸¸è§ç±»å‹ Box æœ€ç®€å•çš„æ™ºèƒ½æŒ‡é’ˆï¼Œåœ¨å †å†…å­˜ä¸Šåˆ†é…å€¼ï¼Œæ ˆç©ºé—´æœ‰æŒ‡å‘æ•°æ®çš„æŒ‡é’ˆã€‚å…¶æ‹¥æœ‰æ•°æ®æ‰€æœ‰æƒã€‚ Rc å¤šé‡æ‰€æœ‰æƒçš„å¼•ç”¨è®¡æ•°æ™ºèƒ½æŒ‡é’ˆRc(Reference counting)ï¼Œä½¿å¾—ä¸€ä»½æ•°æ®è¢«å¤šä¸ªæ‰€æœ‰è€…æŒæœ‰ï¼Œå¼•ç”¨è®¡æ•°ä¸º0æ‰æ¸…ç†æ•°æ®ã€‚é€šè¿‡ä¸å¯å˜å¼•ç”¨åªæä¾›å¯¹æ•°æ®çš„ä¸å¯å˜è®¿é—®ã€‚ åœºæ™¯ï¼š å †ä¸Šæ•°æ®è¢«å¤šä¸ªéƒ¨åˆ†è¯»å–ï¼ˆä¸å¯å˜å€Ÿç”¨ï¼‰ï¼Œä½†æ˜¯ç¼–è¯‘å™¨æ— æ³•ç¡®å®šå“ªä¸ªéƒ¨åˆ†æœ€åä½¿ç”¨å®Œæ•°æ®ï¼ˆå¦åˆ™å°†æœ€åä½¿ç”¨çš„éƒ¨åˆ†è®¾ç½®ä¸ºå€¼çš„æ‰€æœ‰è€…å³å¯ï¼‰ï¼› åªèƒ½ç”¨äºå•çº¿ç¨‹ï¼› Rc::new()ç”¨æ¥ç”Ÿæˆå¯¹åº”ç±»å‹çš„å¼•ç”¨è®¡æ•°æ™ºèƒ½æŒ‡é’ˆï¼Œä½¿ç”¨Rc::clone(&amp;rc)æ¥è·å–ç›¸åŒå€¼çš„å¼•ç”¨è®¡æ•°æ™ºèƒ½æŒ‡é’ˆï¼ˆå¼•ç”¨è®¡æ•°+1ï¼‰ enum å’Œ Rc ç¤ºä¾‹ use crate::List::{Cons, Nil}; use std::rc::Rc; // List ä¸­å…ƒç´ å­˜æ´»æ—¶é—´è‡³å°‘æ¯” List çš„ç”Ÿå‘½å‘¨æœŸç›¸åŒ #[derive(Debug)] enum List { Cons(i32, Rc&lt;List&gt;), Nil, } fn main() { let a = Rc::new(Cons(5, Rc::new(Cons(10, Rc::new(Nil))))); let b = Cons(3, Rc::clone(&amp;a)); // å¤åˆ¶ï¼Œå¢åŠ å¼•ç”¨è®¡æ•° let c = Cons(4, Rc::clone(&amp;a)); // print strong_count println!(&quot;strong_count: {}&quot;, Rc::strong_count(&amp;a)); // è·å–å¼ºå¼•ç”¨è®¡æ•° println!(&quot;a = {:#?}&quot;, b); println!(&quot;b = {:#?}&quot;, c); } RefCell ç”¨äºå®ç°å†…éƒ¨æ•°æ®çš„å¯å˜æ€§ï¼Œå…è®¸ä½ åœ¨åªæŒæœ‰ä¸å¯å˜å¼•ç”¨çš„å‰æä¸‹å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚ å¯¼å…¥std::cell::RefCell ä»£è¡¨æŒæœ‰æ•°æ®çš„å”¯ä¸€æ‰€æœ‰æƒï¼Œå…¶å¯å˜æ€§å’Œå€Ÿç”¨è§„åˆ™æ˜¯è¿è¡Œæ—¶æœŸæ£€æŸ¥ã€‚ ç”¨äºå•çº¿ç¨‹ç¯å¢ƒ æ™ºèƒ½æŒ‡é’ˆæ¯”è¾ƒï¼š ä½¿ç”¨åœºæ™¯ï¼šéœ€è¦åœ¨ä¸å¯å˜ç¯å¢ƒä¸­ä¿®æ”¹è‡ªèº«çš„æ•°æ®ï¼Œå°†æ•°æ®ä½¿ç”¨RefCell&lt;T&gt;åŒ…è£…ï¼Œå¯ä»¥åœ¨è¿è¡ŒæœŸè·å–å¯å˜å¼•ç”¨æ¥ä¿®æ”¹æ•°æ®ã€‚ç”¨äºå®ç°å†…éƒ¨å¯å˜æ€§ã€‚ è·å–å†…éƒ¨å€¼çš„ä¸å¯å˜å¼•ç”¨borrow()æ–¹æ³•ï¼Œè¿”å›Ref&lt;T&gt;å…¶å®ç°äº† Deref è·å–å†…éƒ¨å€¼çš„å¯å˜å¼•ç”¨borrow_mut()æ–¹æ³•ï¼Œè¿”å›RefMut&lt;T&gt;å…¶å®ç°äº† Deref use std::cell::RefCell struct MockMes{ sent_messages: RefCell&lt;Vec&lt;String&gt;&gt;, } impl MockMes{ fn send(&amp;self, message: &amp;str){ self.sent_messages.borrow_mut().push(String::from(message)); } } Ref&lt;T&gt; ï½œRefMut&lt;T&gt;ï¼ˆRefCellæ–¹æ³•ï¼‰è®¿é—®æ•°æ®ä¸å¯å˜å¼•ç”¨å’Œå¯å˜å¼•ç”¨ã€‚ RefCell ä¼šè®°å½•è¿™ä¸¤ç§æŒ‡é’ˆä¸ªæ•°ï¼Œæ¥ç»´æŠ¤è¿è¡Œæ—¶çš„å€Ÿç”¨æ£€æŸ¥è§„åˆ™ï¼Œç»™å®šæ—¶é—´åªå…è®¸æ‹¥æœ‰å¤šä¸ªä¸å¯å˜å€Ÿç”¨æˆ–è€…ä¸€ä¸ªå¯å˜å€Ÿç”¨ã€‚ é€šå¸¸ä¼šå°† Rc å’Œ RefCell ç»“åˆä½¿ç”¨ï¼Œå®ç°ä¸€ä¸ªæ‹¥æœ‰å¤šé‡æ‰€æœ‰æƒçš„å¯å˜æ•°æ®ã€‚ å¾ªç¯å¼•ç”¨ ä½¿ç”¨ Weak æ¥é¿å…å¾ªç¯å¼•ç”¨ï¼Œå¹¶ä¸åˆ†äº«å®ä¾‹çš„æ‰€æœ‰æƒï¼Œå½“ Strong_Reference æ•°é‡ä¸º0æ—¶ï¼Œå€¼ä¼šè¢«æ¸…ç†ã€‚ç›¸å…³å‡½æ•°ï¼š è°ƒç”¨Rc::downgrade(&amp;rc)ï¼Œè¿”å›Weak&lt;T&gt;ï¼Œå¹¶ä¸”å¼±å¼•ç”¨è®¡æ•°weak_countåŠ 1 è°ƒç”¨Weak&lt;T&gt;çš„ upgrade() æ–¹æ³•ï¼Œè¿”å›Option&lt;Rc&lt;T&gt;&gt;ï¼ˆéœ€è¦ä¿è¯æŒ‡å‘çš„å€¼ä»ç„¶å­˜åœ¨ï¼‰ ","tags":[{"name":"Rust","slug":"rust","used":true,"link":"https://blog.qxxiao.eu.org/tag/rust/"}],"title":"RuståŸºç¡€ï¼ˆäºŒï¼‰","feature":"https://pic.qxxiao.cn/20220530212851.png","link":"https://blog.qxxiao.eu.org/post/RuståŸºç¡€ï¼ˆäºŒï¼‰/","stats":{"text":"10 min read","time":548000,"words":2186,"minutes":10},"date":"2022-05-30 17:37:00","dateFormat":"2022-05-30","isTop":false},{"content":"hello rust. [TOC] Rust å¿«é€Ÿå…¥é—¨ï¼Œå‚è€ƒ ã€ŠRustç¨‹åºè®¾è®¡è¯­è¨€ã€‹ç®€è¦å½’çº³ Rust çš„åŸºç¡€ï¼Œå°½é‡ç®€çº¦è€Œä¸å¤±é‡ç‚¹ï¼Œæ–¹ä¾¿æŸ¥é˜…ã€‚ å˜é‡ä¸ç±»å‹ å˜é‡ åŸºç¡€ç±»å‹ æ ‡é‡ç±»å‹ å¤åˆç±»å‹ å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡ ç»å¸¸ä½¿ç”¨çš„å­—ç¬¦ä¸²ç±»å‹æœ‰ï¼š&amp;strï¼ŒStringï¼Œ&amp;Stringã€‚ strç³»ç»Ÿç±»å‹ï¼Œå…·æœ‰åŠ¨æ€å¤§å°ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥ç”¨æ¥å£°æ˜å˜é‡ã€‚å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªå­—èŠ‚æ•°ç»„åŒºåŸŸï¼Œå¹¶ä¸”ç¬¦åˆutf-8å­—ç¬¦è¾¹ç•Œã€‚ StringåŠ¨æ€å¤§å°å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç”¨æ¥å£°æ˜(æ ˆ)å˜é‡æŒ‡å‘å †ä¸Šåˆ†é…çš„æ•°æ®ï¼ˆä½¿ç”¨èµ·å§‹åœ°å€¼+é•¿åº¦+å®¹é‡å®ç°ï¼‰ã€‚&amp;Stringæ˜¯å…¶å¼•ç”¨ç±»å‹ï¼Œå€Ÿç”¨è€Œä¸è·å–æ‰€æœ‰æƒã€‚ &amp;strå­—ç¬¦ä¸²åˆ‡ç‰‡ï¼Œå¯ä»¥ç”¨æ¥å£°æ˜å˜é‡ï¼Œä¹Ÿæ˜¯ä¸€ç§å¼•ç”¨ç±»å‹ï¼ŒæŒ‡å‘ä¸€å—å­—ç¬¦ä¸²å­—èŠ‚æ•°ç»„ã€‚ï¼ˆèµ·å§‹åœ°å€¼+é•¿åº¦å®ç°ï¼Œæ²¡æœ‰æ‰€æœ‰æƒï¼‰ã€‚å­—ç¬¦ä¸²å­—é¢é‡åˆ›å»ºçš„å˜é‡é»˜è®¤å£°æ˜ä¸º&amp;strï¼Œå³å¼•ç”¨åˆ†é…åœ¨é™æ€å­˜å‚¨åŒºçš„å¸¸é‡å­—ç¬¦ä¸²ã€‚å¿…é¡»ç¬¦åˆutf-8å­—ç¬¦çš„è¾¹ç•Œã€‚ ç¤ºä¾‹ï¼š fn main() { let s = &quot;Hello, world!&quot;; let ss = String::from(&quot;Hello, world!&quot;); println!(&quot;{}&quot;, first_word(s)); println!(&quot;{}&quot;, first_word(&amp;ss)); // &amp;String } fn first_word(s: &amp;str) -&gt; &amp;str { let bytes = s.as_bytes(); for (i, &amp;item) in bytes.iter().enumerate() { if item == b' ' { return &amp;s[0..i]; } } &amp;s[..] } å‡½æ•°å‚æ•°å¦‚æœæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œå°½é‡ä½¿ç”¨&amp;strï¼Œæ›´åŠ é€šç”¨(Stringç±»å‹å®¹æ˜“è½¬æ¢ä¸ºåˆ‡ç‰‡ï¼Œ&amp;String å¯é€šè¿‡è§£å¼•ç”¨å¼ºåˆ¶è½¬æ¢ä¸º &amp;strï¼Œæˆ–è€…ä½¿ç”¨åˆ‡ç‰‡) å­—ç¬¦ä¸²åˆ‡ç‰‡ä½¿ç”¨ï¼š let s = &quot;hello world&quot;; let s1 = &amp;s[0..5]; // &amp;s[..5] let s2 = &amp;s[6..11];// &amp;s[6..] let s3 = &amp;s[0..11];// &amp;s[..] å…¶ä»–ç±»å‹çš„åˆ‡ç‰‡åŸç†ç±»ä¼¼ï¼Œä¾‹å¦‚ æ•´å½¢åˆ‡ç‰‡&amp;[i32]ç­‰ æ³¨ï¼šæ•´å½¢åˆ‡ç‰‡å¯ä»¥ç”±æ•°ç»„ï¼ŒVecæ¥æ„é€ ã€‚ struct ä¸ enum è‡ªå®šä¹‰ç±»å‹ï¼Œå°è£…å¤šä¸ªå­—æ®µã€‚ å¦‚æœå®šä¹‰ struct æ˜¯å¯å˜çš„ï¼Œå…¶æ‰€æœ‰çš„å­—æ®µéƒ½æ˜¯å¯å˜çš„ï¼› å‡½æ•°ä¸­å­—æ®µåˆå§‹åŒ–ç®€å†™ï¼Œå¦‚æœå‡½æ•°å‚æ•°ä¸å­—æ®µååŒåï¼Œå¯å¿½ç•¥èµ‹å€¼æ“ä½œåªå†™å­—æ®µåï¼› åŸºäºåŸ struct çš„æ›´æ–°è¯­æ³•ï¼š struct User{ name: String, active: bool, } let user2 = User{ active = false, // ä¸åŒçš„å­—æ®µ ..user1 // å…¶ä»–å­—æ®µä¸user1ç›¸åŒ }; tuple struct ç±»ä¼¼ä¸å…ƒç»„å¹¶ä¸”å¯ä»¥ç»“æ„ï¼Œå…¶å…ƒç´ æ²¡æœ‰åç§°ï¼Œä½†æ˜¯æ•´ä¸ªç±»å‹æ˜¯å…·åç±»å‹ã€‚ struct Point(i32, i32, i32); let origin = Point(0, 0, 0); // unit-like structæ²¡æœ‰å­—æ®µçš„ç»“æ„ä½“ struct AlwaysEqual; å®šä¹‰æ–¹æ³•å’Œå…³è”å‡½æ•° #[derive(Debug)] struct Rectangle { width: i32, height: i32, } impl Rectangle { //æ„é€ å‡½æ•° pub fn new(width: i32, height: i32) -&gt; Self { Rectangle { //åŒåå¯ä»¥çœç•¥ width, height, } } //æ–¹æ³•ï¼Œ&amp;selfå‚æ•° fn erea(&amp;self) -&gt; i32 { self.width * self.height } //å…³è”å‡½æ•° fn erea2(width: i32, height: i32) -&gt; i32 { width * height } fn drop(mut self) { println!(&quot;drop myself&quot;); } } ä½¿ç”¨impleå—æ¥å®šä¹‰æ–¹æ³•å’Œå…³è”å‡½æ•°ï¼Œå¯ä»¥æœ‰å¤šä¸ªå—ï¼› å¦‚æœå…¶ä¸­å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°ä¸º&amp;self | &amp;mut selfä¸ºè¯¥ç±»å‹çš„æ–¹æ³•ï¼Œself å³ä¸ºè¯¥ç±»å‹çš„å®ä¾‹æœ¬èº«ï¼›å…¶ä»–æ–¹æ³•å°±æ˜¯å…³è”æ–¹æ³•ï¼Œä½¿ç”¨ structName::funcName() è°ƒç”¨ï¼› æšä¸¾ç±»å‹ï¼Œå«æœ‰ç±»å‹çš„å¤šä¸ªå˜ä½“ï¼Œrust æšä¸¾å˜ä½“å¯ä»¥å…³è”ä¸€ç»„ä¸åŒç±»å‹çš„æ•°æ®ï¼Œå…³è”çš„æ•°æ®å¯ä»¥é€šè¿‡ä¸‹é¢ä¸­çš„matchæ¨¡å¼åŒ¹é…æ¥è·å–: enum IpAddrKind { V4(u32,u32,u32,u32), V6(String), } æ ‡å‡†åº“æšä¸¾Option&lt;T&gt;ç”¨æ¥è§£å†³ç©ºå€¼é—®é¢˜ï¼Œå…¶2ä¸ªå˜ä½“Some&lt;T&gt;, Noneå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ let some_num = Some(5); let absent_num: Option&lt;i32&gt; = None; å‡½æ•°ä¸æ§åˆ¶æµ å‡½æ•°ä½¿ç”¨ fn å£°æ˜ï¼Œä½¿ç”¨å°¾ç½®å½¢å¼è¿”å›ç±»å‹ï¼š fn add(a: i32, b: i32) -&gt; i32{ a+b } å‡½æ•°åªè¦åœ¨æ¨¡å—ä½œç”¨åŸŸèŒƒå›´å¯è§å°±å¯ä»¥ä½¿ç”¨ï¼Œä¸éœ€è¦å…ˆå£°æ˜åä½¿ç”¨ã€‚ if/else æ¡ä»¶è¡¨è¾¾å¼å¿…é¡»æ˜¯ bool ç±»å‹ï¼Œä¸ä½¿ç”¨å°æ‹¬å·ã€‚ for/while/loop for i in 0..10{ println!(&quot;{}&quot;, i); } while number &gt; 0 { println!(&quot;{}&quot;, number); number -= 1; } loop { println!(&quot;{}&quot;, number); number -= 1; if number == 0 { break; } } matchæ¨¡å¼åŒ¹é… matchç±»ä¼¼ä¼ ç»Ÿçš„switchè¯­æ³•ï¼Œå½“æ˜¯æ”¯æŒæ›´å¤šç‰¹æ€§ã€‚åŒ¹é…çš„æ¨¡å¼æ”¯æŒå­—é¢é‡ã€å˜é‡æˆ–è€…é€šé…ç¬¦ï¼›æ”¯æŒç»‘å®šå€¼çš„æ¨¡å¼ï¼Œç”¨æ¥æå–å˜é‡ä¸­çš„å€¼ï¼š let some_num = Some(5); let some_num_value = match some_num { Some(i) =&gt; i, None =&gt; 0, }; println!(&quot;some_num_value is {}&quot;, some_num_value); match åŒ¹é…å¿…é¡»ç©·ä¸¾æ‰€æœ‰å¯èƒ½æ¨¡å¼ï¼Œå¯ä»¥ä½¿ç”¨_é€šé…ç¬¦è¡¨ç¤ºå‰©ä½™å…¶ä»–å€¼ã€‚ if letå¯ä»¥åªåŒ¹é…ä¸€ç§æ¨¡å¼ï¼š // if let pattern = var if let Some(5)=some_num{ println!(&quot;some_num is 5&quot;); }else{ println!(&quot;other&quot;); } æ‰€æœ‰æƒæœºåˆ¶ å¼•ç”¨ç±»å‹ï¼Œä¾‹å¦‚ &amp;String æ˜¯ä¸æ‹¥æœ‰æ‰€æœ‰æƒçš„ç±»å‹/å€Ÿç”¨ç±»å‹ã€‚ å¼•ç”¨ç±»å‹ï¼Œå¯ç›´æ¥è°ƒç”¨è¯¥ç±»å‹çš„æ–¹æ³•(è¯­æ³•ç³–)ï¼Œç±»å‹æ–¹æ³•ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯è¯¥ç±»å‹çš„å¼•ç”¨/ä¸å¯å˜ç±»å‹ã€‚ å¸¸ç”¨é›†åˆ Vec å¤§å°å¯å˜çš„åŠ¨æ€æ•°ç»„ï¼ŒåŸºæœ¬ç”¨æ³•ï¼š let mut v = vec![1, 2, 3, 4, 5]; // let mut mv: Vec&lt;i32&gt; = Vec::new(); let first = &amp;v[0]; // ref println!(&quot;{}&quot;, first); match v.get(2) { Some(x) =&gt; println!(&quot;{}&quot;, x), None =&gt; println!(&quot;None&quot;), } // éå† for i in &amp;mut v { *i += 10; } for i in v { println!(&quot;{}&quot;, i); } ç”±äºæšä¸¾ç±»å‹çš„çµæ´»æ€§-å¯ä»¥é™„åŠ æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ Vec+enum ç»„åˆï¼Œä»è€Œå¯ä»¥å­˜å‚¨æšä¸¾çš„ä¸åŒå˜ä½“ä»¥åŠä¸åŒç±»å‹çš„å…³è”æ•°æ®ï¼› String å­—ç¬¦ä¸²Stringç±»å‹åº•å±‚å°±æ˜¯Vec&lt;u8&gt;å­—èŠ‚æ•°ç»„ï¼Œå­—ç¬¦ä¸²ä½¿ç”¨ UTF-8 ç¼–ç ï¼Œå¹¶æä¾›å­—èŠ‚-æ–‡æœ¬è§£ææ–¹æ³•ã€‚String ç±»å‹æ¥è‡ªæ ‡å‡†åº“è€Œéæ ¸å¿ƒè¯­è¨€ï¼Œå¯å¢é•¿ï¼Œå¯ä¿®æ”¹å’Œè·å¾—æ‰€æœ‰æƒçš„ç±»å‹ã€‚ ğŸ’¡ åœ¨æ ¸å¿ƒè¯­è¨€å±‚é¢ï¼ŒRuståªæœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹ str (å¤§å°å¯å˜çš„å­—ç¬¦ä¸²)ï¼Œé€šå¸¸ä½¿ç”¨ &str æ¥è¡¨ç¤ºå­—ç¬¦ä¸²åˆ‡ç‰‡ã€‚å­—ç¬¦ä¸²åˆ‡ç‰‡ï¼šå¼•ç”¨ç±»å‹ï¼Œå¯¹å­˜å‚¨åœ¨å…¶å®ƒåœ°æ–¹çš„utf-8ç¼–ç å­—ç¬¦ä¸²çš„å¼•ç”¨ã€‚ å¸¸ç”¨æ–¹æ³•ï¼š // åˆ›å»ºString let s = String::from(&quot;hello&quot;); let s = String::new(); let s = &quot;hello&quot;.to_string(); // æ·»åŠ å­—ç¬¦/å­—ç¬¦ä¸² s.push_str(&quot;, world!&quot;); s.push('!'); // æ‹¼æ¥å­—ç¬¦ä¸² let s3 = s1 + &amp;s2; // fn add(self, s: &amp;str) -&gt; String let s3 = format!(&quot;{}-{}&quot;, &quot;hello&quot;, s); // format! æ‹¼æ¥å­—ç¬¦ä¸²çš„+æ“ä½œï¼Œæ³¨æ„è·å–äº†s1çš„æ‰€æœ‰æƒ/åç»­å¤±æ•ˆï¼Œå‚æ•°æ˜¯&amp;str;è§£å¼•ç”¨å¼ºåˆ¶è½¬æ¢(deref coercion)å¯ä»¥å°† &amp;String è½¬æ¢ä¸º &amp;str ç±»å‹ã€‚ ä½¿ç”¨format!å®æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œä¸ä¼šè·å–æ‰€æœ‰æƒï¼Œæ–¹ä¾¿äºå¤šä¸ªå­—ç¬¦ä¸²çš„æ‹¼æ¥ã€‚ å†…éƒ¨è¡¨ç¤ºï¼š String åº•éƒ¨æ˜¯u8å­—èŠ‚æ•°ç»„ï¼Œä½¿ç”¨ UTF-8 ç¼–ç å­˜å‚¨ Unicode æ ‡é‡å€¼ï¼Œä¸»è¦ç‰¹æ€§ï¼š ä¸æ”¯æŒæ•´å½¢ä¸‹æ ‡ç´¢å¼•(ä¿è¯å­—ç¬¦ç´¢å¼•å®‰å…¨)ï¼› ä½¿ç”¨ [..] åˆ›å»ºå­—ç¬¦ä¸²åˆ‡ç‰‡æ—¶ï¼Œä¹Ÿå¿…é¡»ç¬¦åˆ utf-8 å­—ç¬¦è¾¹ç•Œï¼Œå¦åˆ™å‡ºç°è¿è¡Œæ—¶é”™è¯¯ï¼› HashMap ä¸åœ¨ prelude ä¸­ï¼Œéœ€è¦æ˜¾ç¤ºå¯¼å…¥use std::collections::HashMap;åˆ›å»ºå’Œä½¿ç”¨ï¼š // åˆ›å»ºHashMap let mut scores: HashMap&lt;String, i32&gt; = HashMap::new(); scores.insert(String::from(&quot;Blue&quot;), 10); scores.insert(String::from(&quot;Yellow&quot;), 50); println!(&quot;{:#?}&quot;, scores); // collect let teams = vec![String::from(&quot;Blue&quot;), String::from(&quot;Yellow&quot;)]; let initial_scores = vec![10, 50]; let scores: HashMap&lt;_, _&gt; = teams.iter().zip(initial_scores.iter()).collect(); println!(&quot;{:#?}&quot;, scores); let vec = vec![(String::from(&quot;Blue&quot;), 10), (String::from(&quot;Yellow&quot;), 50)]; let scores: HashMap&lt;_, _&gt; = vec.into_iter().collect(); println!(&quot;{:#?}&quot;, scores); æ‰€æœ‰æƒé—®é¢˜ï¼š å¯¹äºå®ç°äº† Copy traitç±»å‹ä¾‹å¦‚i32ï¼Œä¼šå¤åˆ¶åˆ° HashMapä¸­ï¼›å¯¹äºæ‹¥æœ‰æ‰€æœ‰æƒçš„ç±»å‹ä¼šè¢«ç§»åŠ¨ï¼ˆä¸Šè¿°into_iter()æ–¹æ³•ä¼šç§»åŠ¨åŸæ¥çš„vecä¸­å…ƒç´ ï¼‰ å¦‚æœå°†å¼•ç”¨æ’å…¥åˆ°HashMapä¸­ï¼Œå€¼ä¸ä¼šç§»åŠ¨ï¼Œä½†æ˜¯è¦ä¿è¯è¢«å¼•ç”¨å€¼çš„æœ‰æ•ˆæ€§ï¼› ä½¿ç”¨ï¼š å¸¸ç”¨çš„æ“ä½œæœ‰ï¼šæ’å…¥é”®å€¼å¯¹ã€è·å–keyå¯¹äºçš„å€¼ã€éå†ä»¥åŠä¿®æ”¹ã€‚ // get è·å–å€¼ let score = scores.get(&quot;Blue&quot;); match score { Some(score) =&gt; println!(&quot;{}&quot;, score), None =&gt; println!(&quot;No score&quot;), } // ä¸æ£€æŸ¥ let score = scores[&quot;Blue&quot;]; // å€Ÿç”¨ä½¿ç”¨ &amp;scores[&quot;Blue&quot;] // éå† for (k,v) in &amp;scores{ println!(&quot;{}:{}&quot;, k, v); } æ›´æ–°æ“ä½œï¼š ä½¿ç”¨insert()å¦‚æœå­˜åœ¨æ—§å€¼ä¼šæ›¿æ¢ ä½¿ç”¨ entry()è¿”å› Option ç±»å‹ï¼Œä½¿ç”¨å˜ä½“çš„ or_insert() æ–¹æ³•åœ¨ä¸å­˜åœ¨æ—¶æ’å…¥ï¼›å¦‚æœå­˜åœ¨ä¼šè¿”å›è¯¥å€¼çš„å¯å˜å¼•ç”¨ï¼Œé€šè¿‡è§£å¼•ç”¨æ¥æ›´æ–°ã€‚ // æ·»åŠ å€¼ï¼Œinsertæ–¹æ³•æ›¿æ¢æ—§å€¼ let words = &quot;hello world wonderful world&quot;; let mut map = HashMap::new(); for word in words.split_whitespace() { let count = map.entry(word).or_insert(0); *count += 1; } æ³›å‹ å¯¹äº structï¼Œenumï¼Œæ–¹æ³•/æ™®é€šå‡½æ•°éƒ½å¯ä»¥å®šä¹‰ä¸ºæ³›å‹ï¼š struct Point&lt;T&gt; { x: T, y: T, } impl&lt;T&gt; Point&lt;T&gt; { fn x(&amp;self) -&gt; &amp;T { &amp;self.x } } impl Point&lt;i32&gt; { fn origin() -&gt; Point&lt;i32&gt; { Point { x: 0, y: 0 } } } Rustæ³›å‹å®ç°ä¸ C++ç±»å‹ï¼Œç¼–è¯‘æ—¶éƒ½ä¼šè¿›è¡Œå…·ä½“ç±»å‹æ›¿æ¢-å•æ€åŒ–; struct æ–¹æ³•å¯ä»¥å®šä¹‰å…¶ä»–çš„ç±»å‹å‚æ•°ï¼Œä¸structæ˜¯å¦ä¸ºæ³›å‹æ— å…³; å¯¹æ³›å‹structçš„æŸä¸ªå…·ä½“ç±»å‹ï¼Œä¾‹å¦‚Point&lt;i32&gt;å®šä¹‰æ–¹æ³•æ˜¯å¯¹è¯¥ç±»å‹æ·»åŠ çš„ï¼Œå…¶ä»–ç±»å‹å‚æ•°çš„Pointä¸å…·æœ‰ï¼ˆä¸C++åç‰¹åŒ–/ç‰¹åŒ–ä¸åŒï¼‰ æ³›å‹å¯ä»¥æ‰©å±•ä»£ç çš„é€šç”¨æ€§ï¼Œå¸¸è§ç±»å‹éƒ½å®šä¹‰ä¸ºæ³›å‹ï¼ŒOption&lt;T&gt;, Result&lt;T, E&gt;ç­‰ Trait ç±»ä¼¼ä¸æ¥å£æ¦‚å¿µï¼Œå‘Šè¯‰ç¼–è¯‘å™¨æŸç§ç±»å‹å…·æœ‰å“ªäº›ç‰¹å®šè¡Œä¸º/åŠŸèƒ½ï¼Œç”¨æ¥æŠ½è±¡åœ°å®šä¹‰å…±äº«/å…¬å…±è¡Œä¸ºã€‚ ä¸€ä¸ªä¸»è¦ä½œç”¨å°±æ˜¯ä¸ºæ³›å‹ç±»å‹å‚æ•°è¿›è¡Œçº¦æŸTrait boundsï¼ŒæŒ‡å®šä¸ºå®ç°ç‰¹å®šè¡Œä¸ºçš„ç±»å‹ã€‚ å®šä¹‰ä¸ä¸ºç±»å‹å®ç°Traitï¼š pub trait Summary { fn summarize(&amp;self) -&gt; String; } pub struct Tweet { pub username: String, pub content: String, } // impl impl Summary for Tweet { fn summarize(&amp;self) -&gt; String { format!(&quot;{}: {}&quot;, self.username, self.content) } } Traitå¯ä»¥å®šä¹‰é»˜è®¤å®ç°ã€‚ ç±»å‹å®ç°Traitå¿…é¡»å®ç° trait å®šä¹‰çš„æ‰€æœ‰æ²¡æœ‰é»˜è®¤å®ç°çš„æ–¹æ³•ï¼Œå¯¹äºæœ‰é»˜è®¤å®ç°çš„ï¼Œå¯ä»¥é€‰æ‹©é‡å†™è¯¥æ–¹æ³•ï¼›trait å®šä¹‰ä¸­ï¼Œ(é»˜è®¤)æ–¹æ³•å¯ä»¥è°ƒç”¨æ²¡æœ‰é»˜è®¤å®ç°çš„æ–¹æ³•ï¼Œç±»å‹ä¼šä¿è¯å®ç°è¿™äº›æ–¹æ³•ã€‚ ç±»å‹å®ç°Traitçš„æ¡ä»¶ï¼š ç±»å‹æˆ–è€…è¯¥ Trait æ˜¯åœ¨æœ¬åœ° crateå®šä¹‰çš„; å³æ— æ³•ä¸ºå¤–éƒ¨ç±»å‹å®ç°å¤–éƒ¨çš„ traitï¼ˆå­¤å„¿è§„åˆ™ï¼‰ Traitä½œä¸ºå‚æ•° ä½¿ç”¨impl Traitæˆ–è€…Trait boundè¯­æ³•ï¼š // impl Trait ä¿®é¥°å‚æ•° pub fn notify(item: impl Summary+Display) { println!(&quot;Breaking news! {}&quot;, item.summarize()); } // ä½¿ç”¨æ³›å‹ + traitçº¦æŸ pub fn notify&lt;T: Summary+Display&gt;(item: T) { println!(&quot;Breaking news! {}&quot;, item.summarize()); } // where pub fn notify2&lt;T, U&gt;(a: T, b: U) where T: Summary + Display, U: Clone + Debug, { println!(&quot;Breaking news! {}&quot;, a.summarize()); } Traitä½œä¸ºè¿”å›ç±»å‹ ä½¿ç”¨impl traitè¯­æ³•ï¼š pub fn news() -&gt; impl Summary { Tweet { username: String::from(&quot;ebooks&quot;), content: String::from(&quot;people&quot;), } } é™åˆ¶ï¼š éœ€è¦ä¿è¯å‡½æ•°è¿”å›çš„ç±»å‹éœ€è¦ä¸€è‡´ï¼Œè¿”å›ç¡®å®šçš„åŒä¸€ç§ç±»å‹ï¼› ğŸ’¡ Trait ä¸»è¦ç”¨æ¥è¡¨ç¤ºç±»å‹çº¦æŸï¼Œå…¶ä»–ç”¨æ³•ï¼š åœ¨æ³›å‹ç±»å‹çš„ impl å—ä¸Šä½¿ç”¨ Trait boundï¼Œå¯ä»¥ä¸ºç±»å‹å‚æ•°å®ç°äº†ç‰¹å®š Trait çš„æ³›å‹ç±»å‹æœ‰æ¡ä»¶åœ°å®ç°æŸäº›æ–¹æ³•ï¼› ä¸ºå®ç°ç‰¹å®š Trait çš„ä»»æ„ç±»å‹æœ‰æ¡ä»¶åœ°å®ç°å¦ä¸€ä¸ª Trait (è¦†ç›–å®ç°) ç¤ºä¾‹ä»£ç  // 1. æœ‰æ¡ä»¶åœ°å®ç°æŸäº›æ–¹æ³• impl&lt;T: Display+PartialOrd&gt; Pair&lt;T&gt;{ fn cmp_display(&amp;self){ ... } } // 2. æœ‰æ¡ä»¶å®ç°å¦ä¸€ä¸ª Trait impl&lt;T: fmt::Display+?Sized&gt; ToString for T{ ... } ç”Ÿå‘½å‘¨æœŸ ç”Ÿå‘½å‘¨æœŸç›®çš„ï¼šé¿å…æ‚¬å‚å¼•ç”¨ dangling reference. Rustä¸­æ¯ä¸ªå¼•ç”¨éƒ½æœ‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸï¼ˆä¿æŒæœ‰æ•ˆçš„ä½œç”¨åŸŸï¼‰ï¼Œå½“ç”Ÿå‘½å‘¨æœŸä»¥ä¸åŒçš„æ–¹å¼äº’ç›¸å…³è”ï¼Œéœ€è¦æ‰‹åŠ¨æ ‡æ³¨ç”Ÿå‘½å‘¨æœŸï¼Œä½¿ç”¨æ³›å‹å£°æ˜æ¥è§„èŒƒç”Ÿå‘½å‘¨æœŸçš„åç§°ã€‚ ä¾‹å¦‚å‡½æ•°ç­¾åä¸­ä½¿ç”¨æ³›å‹ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼š å¯ä»¥ç†è§£ä¸ºè¿”å›å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸè‡³å°‘æ˜¯x,yä¸­è¾ƒçŸ­çš„ç”Ÿå‘½å‘¨æœŸï¼ˆäº¤é›†ï¼‰ fn long_str&lt;'a&gt;(x: &amp;'a str, y: &amp;'a str) -&gt; &amp;'a str { if x.len() &gt; y.len() { x } else { y } } ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨ä¸ä¼šå®é™…æ”¹å˜å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸé•¿åº¦ï¼› åªæ˜¯æè¿°äº†å¤šä¸ªå¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸçš„å…³ç³»ï¼Œä¸å½±å“å…¶ç”Ÿå‘½å‘¨æœŸï¼›å› æ­¤å•ä¸ªç”Ÿå‘½å‘¨æœŸçš„æ ‡æ³¨æ²¡æœ‰æ„ä¹‰ï¼› 'staticç‰¹æ®Šç”Ÿå‘½å‘¨æœŸæ ‡è¯†ï¼Œæ•´ä¸ªç¨‹åºçš„è¿è¡Œæ—¶é—´ï¼ˆä¾‹å¦‚å­—ç¬¦ä¸²å­—é¢é‡ï¼‰ ğŸ’¡ æ³¨æ„ï¼šå‡½æ•°è¿”å›å¼•ç”¨ç±»å‹ï¼Œè¿”å›ç±»å‹çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°éœ€è¦ä¸ä¸€ä¸ªå‚æ•°çš„ç”Ÿå‘½å‘¨æœŸåŒ¹é…ï¼ˆå³è·Ÿè¾“å…¥å‚æ•°ç›¸å…³ï¼Œå¦åˆ™å°±æ˜¯æ‚¬å‚å¼•ç”¨ï¼‰ çœç•¥è§„åˆ™ Rustå¼•ç”¨åˆ†æä¸­è€ƒè™‘äº†ä¸€äº›ç‰¹å®šæ¨¡å¼/ç”Ÿå‘½å‘¨æœŸçœç•¥è§„åˆ™ï¼Œç¬¦åˆè¯¥æ¨¡å¼çš„ä»£ç æ— éœ€æ˜¾ç¤ºæ ‡æ³¨ç”Ÿå‘½å‘¨æœŸã€‚ï¼ˆè¾“å…¥ç”Ÿå‘½å‘¨æœŸ: å‚æ•°ä¸ºå¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸï¼›è¾“å‡ºç”Ÿå‘½å‘¨æœŸï¼šè¿”å›å€¼æ˜¯å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸï¼‰ è§„åˆ™å¦‚ä¸‹ï¼š æ¯ä¸ªè¾“å…¥**å‚æ•°(å¼•ç”¨ç±»å‹)**å¦‚æœçœç•¥ç”Ÿå‘½å‘¨æœŸï¼Œåˆ™å…·æœ‰ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼ˆä¾‹å¦‚'a,'b,'cï¼‰ï¼› å¦‚æœåªæœ‰ä¸€ä¸ªè¾“å…¥ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼Œè¯¥ç”Ÿå‘½å‘¨æœŸè¢«èµ‹ç»™æ‰€æœ‰çš„è¾“å‡ºç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼› å¦‚æœæœ‰å¤šä¸ªè¾“å…¥ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼Œä½†æ˜¯å…¶ä¸­æœ‰ä¸€ä¸ªæ˜¯&amp;selfï¼Œ&amp;mut selfï¼ˆé€‚ç”¨äºæ–¹æ³•ä¸­ï¼‰ï¼Œé‚£ä¹ˆ self çš„ç”Ÿå‘½å‘¨æœŸè¢«èµ‹ç»™æ‰€æœ‰çš„è¾“å‡ºç”Ÿå‘½å‘¨æœŸå‚æ•°ã€‚ åº”ç”¨ä¸Šè¿°è§„åˆ™åå¦‚æœä¸èƒ½ç¡®å®šç­¾åä¸­æ‰€æœ‰å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚æˆ–è€…å‡ºç°ä¸åŒ¹é…ï¼Œä¾‹å¦‚è¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸä¸è¿”å›ç±»å‹ç”Ÿå‘½å‘¨æœŸä¸åŒï¼ˆç¤ºä¾‹è§implå—å’Œæ–¹æ³•ï¼‰ã€‚ struct struct å®šä¹‰ä¸­å­—æ®µé™¤äº†åŸºæœ¬ç±»å‹å’Œè‡ªæ‹¥æœ‰ç±»å‹ï¼Œå…¶å¼•ç”¨ç±»å‹éœ€è¦ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨ï¼š struct Stu&lt;'a&gt; { name: &amp;'a str, // è‡³å°‘æ¯”Stuå®ä¾‹ç”Ÿå‘½å‘¨æœŸé•¿ age: u8, } // main fn main(){ let name = String::from(&quot;xiaoming&quot;); let stu = Stu { name: name.as_str(), age: 18, }; println!(&quot;{:#?}&quot;, stu); } implå—å’Œæ–¹æ³• å¯¹äºå­—æ®µçš„ç”Ÿå‘½å‘¨æœŸéœ€è¦åœ¨ imp å—ä¸­æ˜¾ç¤ºæ ‡æ³¨ï¼š struct Stu&lt;'a&gt; { name: &amp;'a str, age: u8, } // å¯¹äºstruct å­—æ®µçš„ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨æ˜¾ç¤ºæŒ‡æ˜/è¯­æ³•ç±»ä¼¼æ³›å‹ // æ–¹æ³•ä¸­çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°å¯ä»¥ä½¿ç”¨å­—æ®µå£°æ˜çš„ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ // &amp;self æ–¹æ³•å¯ä»¥æœ‰é»˜è®¤è§„åˆ™ impl&lt;'a&gt; Stu&lt;'a&gt; { fn get_age(&amp;self) -&gt; u8 { self.age } fn get_name(&amp;self) -&gt; &amp;str { self.name } //fn get_name2(&amp;self, other: &amp;str) -&gt; &amp;str{ // other // error å¼•ç”¨è§„åˆ™3è¿”å›ç±»å‹çš„å£°æ˜å‘¨æœŸä¸ selfç›¸åŒ //} } é˜…è¯» Rust ç¨‹åºè®¾è®¡è¯­è¨€ - Rust ç¨‹åºè®¾è®¡è¯­è¨€ ç®€ä½“ä¸­æ–‡ç‰ˆRust ç¨‹åºè®¾è®¡è¯­è¨€ ç®€ä½“ä¸­æ–‡ç‰ˆ https://kaisery.github.io/trpl-zh-cn/title-page.html Rust ç¿»è¯‘è®¡åˆ’( ä»£å· Rustt ) - Rustè¯­è¨€åœ£ç»(Rust Course)https://course.rs/rustt.html Rust Language Cheat Sheethttps://cheats.rs/ rust_cheat_sheet.pdf ","tags":[{"name":"Rust","slug":"rust","used":true,"link":"https://blog.qxxiao.eu.org/tag/rust/"}],"title":"RuståŸºç¡€ï¼ˆä¸€ï¼‰","feature":"https://pic.qxxiao.cn/20220530212851.png","link":"https://blog.qxxiao.eu.org/post/RuståŸºç¡€ï¼ˆä¸€ï¼‰/","stats":{"text":"16 min read","time":911000,"words":3614,"minutes":16},"date":"2022-05-28 02:59:00","dateFormat":"2022-05-28","isTop":false},{"content":"ç‰ˆæœ¬æ§åˆ¶ æ¦‚å¿µï¼š ä¸»å‰¯æœ¬å­˜å‚¨åœ¨ç‰ˆæœ¬åº“ä¸­ æ¯ä¸ªç‰ˆæœ¬éƒ½æ˜¯å¯ç”¨çš„ å¤šå¼€å‘åˆ†æ”¯ å¹¶è¡Œå¼€å‘ æ„å»ºå·¥å…·å’Œè‡ªåŠ¨åŒ– æ›´å®¹æ˜“æ„å»ºæ„å‘³ç€æ›´å®¹æ˜“æµ‹è¯•å’Œä¿®æ”¹ï¼›æ›´å®¹æ˜“æµ‹è¯•å’Œä¿®æ”¹æ„å‘³ç€æ›´å¿«ä¹çš„ç¨‹åºå’Œæ›´å¿«ä¹çš„ç¨‹åºå‘˜ã€‚ Makefiles Makeçš„å‡ ä¸ªé‡è¦åŠŸèƒ½: é»˜è®¤æ˜¯ç¬¬ä¸€ä¸ªç›®æ ‡target éšå¼ç¼–è¯‘è§„åˆ™ ä¾‹å¦‚ï¼Œå°†.cæ–‡ä»¶ç¼–è¯‘æˆ.oæ–‡ä»¶ã€‚æ ¹æ®æƒ¯ä¾‹ï¼Œè¯¥éšå«è§„åˆ™ä½¿ç”¨å˜é‡CFLAGSæ¥å®šä¹‰Cç¼–è¯‘æ ‡å¿—ã€‚ å˜é‡ CFLAGS=-Wall -gï¼ŒCC ç‰¹æ®Šå˜é‡ makeï¬leä½¿ç”¨ç‰¹æ®Šå˜é‡$@ï¼Œè¿™ä¸ªç‰¹æ®Šå˜é‡è¡¨ç¤º &quot;ç›®æ ‡&quot;ã€‚ç‰¹æ®Šå˜é‡å¯ä»¥é¿å…ä¸å¿…è¦çš„è¾“å…¥ï¼Œå¹¶ä½¿è§„åˆ™æ›´å®¹æ˜“æ”¹å˜å’Œé‡å¤ä½¿ç”¨ã€‚ Example åŒ…å«ä¸€ä¸ªmainç¨‹åºå’Œ2ä¸ªlibé¡¹ç›®çš„Makefile: prog.c: The main program ï¬le lib.c: Lib#1 c file lib.h: Lib#1 header file lib_test.c: a set of tests for Library #1 lib2.c: Lib#2 c file lib2.h: Lib#2 header file lib2_test.c: a set of tests for Library #2 tests.h: A header ï¬le for some common test functions tests.c: A library with some useful test routines CC=gcc CFLAGS=-Wall -g LIBS=lib.o lib2.o HEADERS=lib.h lib2.h BINS=prog lib_test lib2_test all: ${BINS} prog: prog.o ${LIBS} ${HEADERS} ${CC} -o $@ ${CFLAGS} prog.o ${LIBS} lib_test: lib.o lib_test.o lib.h tests.o tests.h ${CC} -o $@ ${CFLAGS} lib_test.o lib.o tests.o lib2_test: lib2.o lib2_test.o lib2.h tests.o tests.h ${CC} -o $@ ${CFLAGS} lib2_test.o lib2.o tests.o test: ./lib_test ./lib2_test clean: rm -rf ${BINS} *.o core *.core å·¥å…· ä»£ç æ£€æŸ¥ ç¼–è¯‘å™¨æ£€æŸ¥ æ€»æ˜¯ä½¿ç”¨gcc -Wall ç”¨**-D_FORTIFY_SOURCE**åŠæ—©å‘ç°é”™è¯¯ ç”¨-D_FORTIFY_SOURCE=2ç¼–è¯‘ç¨‹åºå°†åŒ…æ‹¬å¯¹ç³»ç»Ÿè°ƒç”¨ï¼ˆå¦‚printfï¼‰çš„ç¼“å†²åŒºå¯¹é½çš„é¢å¤–æ£€æŸ¥ã€‚è¿™äº›æ£€æŸ¥å†³å®šäº†ä½ æ˜¯å¦å‘sprintfç­‰å‡½æ•°ä¼ é€’äº†ä¸€ä¸ªå¤ªå°çš„ç¼“å†²åŒºã€‚ ä½¿ç”¨glibcå˜é‡åŠæ—©å‘ç°é”™è¯¯ è®¾ç½®ç¯å¢ƒå˜é‡ MALLOC_CHECK_ æ¥è¯†åˆ« malloc ç›¸å…³çš„é—®é¢˜ï¼Œå¦‚æœè®¾ç½®ä¸º1ä¼šè®°å½•é”™è¯¯ï¼Œè®¾ç½®ä¸º2ä¼šå¯¼è‡´ç«‹å³ç»ˆæ­¢ã€‚ è°ƒè¯• è°ƒè¯•æ€ç»´æ¨¡å¼ ä¸€äº›æœ‰ç”¨çš„è°ƒè¯•æ­¥éª¤ï¼š ä½¿ç”¨å †æ ˆè·Ÿè¸ª æ£€æŸ¥æœ€è¿‘çš„ä¿®æ”¹ ä»”ç»†é˜…è¯»ä»£ç  å‘åˆ«äººè§£é‡Šä½ çš„ä»£ç  è®©é”™è¯¯å¯ä»¥é‡ç° å¢åŠ ä¸€è‡´æ€§æ£€æŸ¥ï¼Œæ‰¾å‡ºä½ å¯¹ç¨‹åºçŠ¶æ€çš„å‡è®¾å‡ºé”™çš„åœ°æ–¹ï¼› å¢åŠ è°ƒè¯•è¾“å‡ºï¼Œä»¥æ˜¾ç¤ºç¨‹åºçš„ç‰¹å®šä½çš„çŠ¶æ€ï¼Œæˆ–ç¡®å®šç¨‹åºçš„å“ªäº›éƒ¨åˆ†åœ¨å´©æºƒå‰è¢«åˆ°è¾¾ï¼› åˆ é™¤å¯èƒ½å¯¼è‡´é”™è¯¯/å´©æºƒ/ç­‰çš„éƒ¨åˆ†ä»£ç ï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯å¦çœŸçš„æœ‰è´£ä»»ï¼› å‘ç°bugåéœ€è¦æ€è€ƒçš„æ˜¯ï¼š æ˜¯å¦åœ¨ä»£ç çš„å…¶ä»–åœ°æ–¹çŠ¯äº†è¿™ä¸ªé”™è¯¯ï¼Ÿç”±äºå¯¹æ¥å£çš„è¯¯è§£è€Œäº§ç”Ÿçš„bugï¼Œå¾ˆå¯èƒ½ä¼šåœ¨å¤šä¸ªåœ°æ–¹å‡ºç°ã€‚åšä¸€æ¬¡å¿«é€Ÿæ£€æŸ¥ï¼Œä»¥ä¸»åŠ¨æ¶ˆé™¤å…¶ä»–bugã€‚ æ€æ ·æ‰èƒ½é¿å…åœ¨å°†æ¥çŠ¯è¿™ä¸ªé”™è¯¯ï¼Ÿä½ ä¹Ÿè®¸å¯ä»¥æ·»åŠ æµ‹è¯•ç”¨ä¾‹æ¥è‡ªåŠ¨å‘ç°å®ƒä»¬ï¼Œåœ¨ä»£ç ä¸­æ·»åŠ æ–­è¨€æ¥æ£€æµ‹è¯¥é”™è¯¯æ˜¯å¦å†æ¬¡å‘ç”Ÿï¼Œä½¿ç”¨ç¼–è¯‘å™¨è­¦å‘Šæ¥è‡ªåŠ¨æ£€æµ‹å®ƒä»¬ï¼Œæˆ–è€…æ”¹å˜ä½ å†™ä»£ç çš„æ–¹å¼ï¼Œä½¿å…¶ä¸å¯èƒ½çŠ¯é”™ã€‚ Printfï¼šè°ƒè¯•å® è°ƒè¯•å®å¯ä»¥åœ¨ç¨‹åºä¸­å¢åŠ è°ƒè¯•printfsè€Œä¸ç”¨ç§»é™¤ã€‚ä¸€ç»„å¥½çš„è°ƒè¯•å®å¯ä»¥æœ‰é€‰æ‹©çš„å¯ç”¨å’Œå…³é—­ä¸åŒçº§åˆ«çš„è°ƒè¯•çº§åˆ«ã€‚é€šå¸¸æŒ‡å®šè¾“å‡ºä¿¡æ¯çš„æ–¹å¼æœ‰ä¸¤ç§ï¼šè°ƒè¯•çº§åˆ«å’ŒæŒ‡å®šè°ƒè¯•çš„åŠŸèƒ½ï¼ˆsocket æ“ä½œï¼Œè¿›ç¨‹ç›¸å…³ï¼‰ã€‚ debug.h #ifndef _DEBUG_H_ #define _DEBUG_H_ #include &lt;stdio.h&gt; /* for perror */ #include &quot;err.h&quot; #ifdef DEBUG extern unsigned int debug; #define DPRINTF(level, fmt, args...) \\ do { \\ if ((debug) &amp; (level)) fprintf(stderr, fmt, ##args); \\ } while (0) #define DEBUG_PERROR(errmsg) \\ do { \\ if ((debug)&amp;DEBUG_ERRS) perror(errmsg); \\ } while (0) #define DEBUGDO(level, args) \\ do { \\ if ((debug) &amp; (level)) { \\ args; \\ } \\ } while (0) #else #define DPRINTF(args...) #define DEBUG_PERROR(args...) #define DEBUGDO(args...) #endif /* * Debug levels */ #define DEBUG_NONE 0x00 // DBTEXT: No debugging #define DEBUG_ERRS 0x01 // DBTEXT: Verbose error reporting #define DEBUG_INIT 0x02 // DBTEXT: Debug Initialization #define DEBUG_SOCKETS 0x04 // DBTEXT: Debug sockets operations #define DEBUG_PROCESSES 0x08 // DBTEXT: Debug processes operations fork/reap #define DEBUG_ALL 0xffffffff // DBTEXT: All debugging #ifdef __cplusplus extern &quot;C&quot; { #endif int set_debug(char *arg); /* returns 0 on success, -1 on failure */ #ifdef __cplusplus } #endif #endif /* _DEBUG_H_ */ è°ƒè¯•å·¥å…· gdb å·¥ä½œæ–¹å¼ï¼š gdb binary è°ƒè¯•äºŒè¿›åˆ¶ç¨‹åº gdb binary core è°ƒè¯•å´©æºƒç¨‹åºçš„coreæ–‡ä»¶ gdb binary PID é™„åŠ åˆ°ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ å¸¸è§åŠŸèƒ½ï¼š è¯´æ˜ï¼š æ²¡æœ‰coreæ–‡ä»¶ï¼Ÿ ä½¿ç”¨ ulimit -a æŸ¥çœ‹èµ„æºé™åˆ¶ï¼Œå¦‚æœ coredumpsize çš„å€¼è¢«è®¾ç½®ä¸ºé›¶ï¼Œæ ¸å¿ƒè½¬å‚¨å°†è¢«ç¦ç”¨ã€‚å¯ä»¥ä½¿ç”¨ï¼šulimit -c unlimited å¯ç”¨ï¼Œéå¿…è¦æ—¶å¯ä»¥ä½¿ç”¨ ulimit -c 0 ç¦ç”¨ã€‚ Linuxä¸‹core dumpæ–‡ä»¶é€šå¸¸å‘½åä¸º core/core.PIDï¼›Macä¸‹ä¼šå­˜å‚¨åœ¨ /cores ç›®å½•ã€‚ è¿½è¸ªç³»ç»Ÿè°ƒç”¨ ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨è¿½è¸ªå·¥å…· ktrace(BSD)ã€strace(Linux). strace [args] straceäº§ç”Ÿçš„è¾“å‡ºåˆ—å‡ºäº†æ¯ä¸ªç³»ç»Ÿè°ƒç”¨ã€å…¶å‚æ•°å’Œç»“æœã€‚straceè¾“å‡ºå¯¹äºè§‚å¯Ÿç¨‹åºå´©æºƒå‰çš„æœ€åå‡ ä¸ªç³»ç»Ÿè°ƒç”¨æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ ä½¿ç”¨Valgrindå†…å­˜è°ƒè¯• Valgrindæ˜¯ä¸€ä¸ªåŠ¨æ€åˆ†æå·¥å…·ï¼ˆå®ƒåœ¨ä½ çš„ä»£ç è¿è¡Œæ—¶æµ‹è¯•ä½ çš„ä»£ç ï¼‰ã€‚å®ƒæä¾›çš„å·¥å…·å¯ä»¥æ£€æŸ¥æ— æ•ˆæˆ–æœªåˆå§‹åŒ–çš„å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œåœ¨å†…å­˜è¢«é‡Šæ”¾åè¿›è¡Œå†™å…¥ï¼Œä»¥åŠå†…å­˜æ³„æ¼ã€‚ç”±äºå®ƒåœ¨è™šæ‹Ÿæœºä¸­è¿è¡Œç¨‹åºï¼Œç¨‹åºåœ¨Valgrindä¸‹çš„è¿è¡Œé€Ÿåº¦è¦æ…¢10å€å·¦å³ã€‚Valgrindåªåœ¨Linuxä¸Šå¯ç”¨ã€‚ valgrind [args] ä½¿ç”¨Electric Fenceå†…å­˜è°ƒè¯• è°ƒè¯•ç¼“å†²åŒºè¶Šç•Œçš„å·¥å…·ã€‚å®ƒç›‘æ§å¯¹mallocç”Ÿæˆçš„ç¼“å†²åŒºçš„è®¿é—®ï¼Œä»¥æ£€æµ‹ä½ çš„ä»£ç æ˜¯å¦å†™è¿‡äº†ç¼“å†²åŒºçš„æœ«ç«¯ï¼ˆæˆ–å¼€å§‹ï¼‰ã€‚ ef [args] æˆ–è€…å¯ä»¥ä½¿ç”¨é“¾æ¥ -lefence æ¥ä½¿ç”¨ã€‚ä½¿ç”¨electricfenceï¼Œè¯•å›¾è®¿é—®åˆ†é…å†…å­˜å¤–çš„éƒ¨åˆ†å°†å¯¼è‡´ç¨‹åºå‡ºç°segæ•…éšœï¼Œè€Œä¸æ˜¯å¼•èµ·å¥‡æ€ªçš„ã€ä¸å¯é¢„çŸ¥çš„è¡Œä¸ºã€‚ ä½¿ç”¨tcpdump/Wiresharkè¿½è¸ªç½‘ç»œåŒ… å¯¹äºç½‘ç»œé¡¹ç›®å’Œåˆ†å¸ƒå¼ç³»ç»Ÿçš„è°ƒè¯•ï¼Œæ•°æ®åŒ…å—…æ¢å™¨å¦‚tcpdumpå’ŒWiresharkå¯ä»¥è¯´æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚è¿™äº›å·¥å…·å¯ä»¥è®°å½•è¿›å‡ºæœºå™¨çš„æ•°æ®åŒ…ï¼Œå¹¶å¯ä»¥è§£ç å„ç§åè®®ã€‚ tcpdumpæ˜¯ä¸€ä¸ªæ›´ä½çº§çš„åŸå§‹æ•°æ®åŒ…æ¥å£ï¼›å®ƒå¾ˆå®¹æ˜“ä»å‘½ä»¤è¡Œä½¿ç”¨ï¼Œå¹¶äº§ç”Ÿæœ‰ç”¨çš„è¾“å‡ºï¼› Wiresharkèƒ½è§£ææ›´å¤šçš„åè®®ï¼Œæœ‰æ›´å¼ºå¤§çš„åŠŸèƒ½ï¼ˆå¦‚é‡æ–°ç»„åˆTCPæµï¼‰ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªæ–¹ä¾¿çš„GUI æµ‹è¯•è¾“å‡º å¯¹è¾“å‡ºè¿›è¡Œ &quot;æ¯”è¾ƒ &quot;å¾€å¾€æ˜¯æœ‰å¸®åŠ©ï¼ˆä¾‹å¦‚æ–‡ä»¶ä¼ è¾“ï¼Œç»“æœæ¯”è¾ƒï¼‰ åªæ˜¯ä¼ è¾“æ–‡æœ¬æ•°æ® ç”¨ä¼ ç»Ÿçš„UNIXå‘½ä»¤è¡Œå·¥å…·ï¼Œå¦‚wcã€diffå’Œgrepï¼Œæ›´å®¹æ˜“åœ°æ£€æŸ¥å®ƒ ä½¿ç”¨ cmp å‘½ä»¤å·¥å…· å¯è§†åŒ–å·¥å…· http://home.comcast.net/~chris-madsen/vbindiff/ æ–‡æ¡£å’Œé£æ ¼ è®©ä»£ç åŠŸèƒ½æ˜¾è€Œæ˜“è§/æ˜æ˜¾ï¼Œä¸è¦æ³¨é‡Šæ˜æ˜¾çš„ä»£ç ï¼Œå°½é‡ä¿æŒå¹²å‡€ã€‚ é£æ ¼ é‡è¦çš„æ˜¯é€‰æ‹©ä¸€ç§é£æ ¼ï¼Œå¹¶ä¸€è‡´åœ°ä½¿ç”¨å®ƒã€‚å¹¶ä¸”æ»¡è¶³ï¼š ä½¿ä»£ç å¯è¯»æ€§å¼º èƒ½åŒºåˆ†é‡è¦çš„ä¸œè¥¿ï¼Œå¦‚C++ä¸­çš„ç±»åã€å˜é‡ã€å…¨å±€å˜é‡ç­‰ å‘½åä¸è¦è¿‡åˆ†å†—é•¿å’Œç—›è‹¦ ç»Ÿä¸€ä½¿ç”¨é£æ ¼æ¯”ç»†èŠ‚è¦é‡è¦å¾—å¤šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œä¸€äº›çº¦å®šä¿—æˆçš„ä¸œè¥¿å·²ç»å‡ºç°äº†ï¼Œå®ƒä»¬å¯ä»¥æå¤§åœ°å¸®åŠ©ä½¿ä»£ç æ›´åŠ å¯è¯»ã€‚ä¾‹å¦‚ï¼š IsValid()æ˜¯ä¸€ä¸ªæ¯”checkValid()æ›´å¥½çš„åå­—ï¼Œå› ä¸ºå…¶è¯­ä¹‰æ›´æ¸…æ™° åœ¨ä»‹ç»å‡½æ•°æ—¶è¦æœ‰ç®€çŸ­çš„æ³¨é‡Šï¼Œè§£é‡Šå…¶è¯­ä¹‰å’Œä»»ä½•è°ƒç”¨è€…çœŸæ­£éœ€è¦çŸ¥é“çš„å…³äºä½¿ç”¨å®ƒçš„ä¿¡æ¯ é˜…è¯»å…¶ä»–ä»£ç  æ„Ÿå—ç¼–ç é£æ ¼å’ŒæŠ€å·§çš„ä¸€ä¸ªå¥½æ–¹æ³•æ˜¯é˜…è¯»ä¸€äº›å…¶ä»–ä»£ç ã€‚å»ºè®®é˜…è¯»BSDæºä»£ç ä¸­çš„ä¸€äº›ç³»ç»Ÿå®ç”¨ç¨‹åºã€‚æ€»çš„æ¥è¯´ï¼Œå®ƒç»„ç»‡å¾—å¾ˆå¥½ï¼Œå¾ˆä¸€è‡´ï¼Œè€Œä¸”ç»å¾—èµ·æ—¶é—´çš„è€ƒéªŒã€‚ä¸€äº›å»ºè®®ï¼š ed æµ‹è¯•ä»£ç  å¾ˆå¤šå†…æ ¸ä»£ç å¾ˆæœ‰è¶£ï¼Œä½†å¾ˆå¯†é›† ä½¿ç”¨è„šæœ¬ æ—¶é—´æ˜¯å®è´µçš„ï¼Œå°†é‡å¤æ€§æ— æ„ä¹‰çš„å·¥ä½œè‡ªåŠ¨åŒ–çš„æœ€å¥½æ–¹æ³•æ˜¯ä½¿ç”¨è„šæœ¬è¯­è¨€ï¼Œå¦‚Perlã€Pythonå’ŒRubyã€‚ å•è¡Œä»£ç  å¤§å¤šæ•°è„šæœ¬è¯­è¨€éƒ½æœ‰å¯¹ &quot;å•è¡Œ &quot;çš„æŸç§æ”¯æŒï¼Œå¯ä»¥å®Œæˆç‰¹å®šçš„ä»»åŠ¡ï¼Œä¾‹å¦‚å°†ä¸€ç»„æ–‡ä»¶ä¸­å‡ºç°çš„ &quot;foo &quot;æ”¹ä¸º &quot;bar&quot;ï¼š perl: perl -pi.bak -e &quot;s/foo/bar/gâ€ ruby: ruby -pi.bak -e &quot;gsub(â€™fooâ€™, â€™barâ€™)â€ https://wiki.python.org/moin/Powerful Python One-Liners https://www.bashoneliners.com/oneliners/popular/ shell æŒæ¡shellå¸¸è§åŠŸèƒ½ï¼Œé€šé…ç¬¦ï¼Œå¾ªç¯ï¼Œé‡å®šå‘ç­‰ç­‰ã€‚ ä»¥åŠå‘½ä»¤è¡Œã€é¢å‘ç®¡é“çš„å·¥å…·ï¼Œå¦‚ &quot;awk &quot;å’Œ &quot;sed&quot;ã€‚ ç¨‹åºè®¾è®¡ ç¨‹åºè®¾è®¡æœ‰ä¸¤ä¸ªå…³é”®çš„æ–¹é¢æ˜¯éœ€è¦è§£å†³çš„ï¼š æ•°æ®ç»“æ„ã€‚è¯¥ç¨‹åºå¯¹ä»€ä¹ˆæ•°æ®è¿›è¡Œæ“ä½œï¼Ÿå®ƒæ˜¯å¦‚ä½•å­˜å‚¨çš„ æ¨¡å—ã€‚ç¨‹åºæ˜¯å¦‚ä½•è¢«åˆ’åˆ†ä¸ºå„ä¸ªç»„ä»¶çš„ï¼Ÿè¿™äº›ç»„ä»¶æ˜¯å¦‚ä½•äº¤äº’çš„ï¼Ÿ å¦‚ä½•å°†ç¨‹åºä¸­çš„åŠŸèƒ½åˆ†è§£æˆå•ä¸ªçš„æºä»£ç ç‰‡æ®µï¼Œä¾‹å¦‚ï¼š ä¸è¦é‡å¤è‡ªå·±çš„å·¥ä½œDRY DRYæ˜¯å†³å®šå“ªäº›ä»£ç åº”è¯¥è¢«æ‹‰å…¥æ¨¡å—çš„ç»éªŒæ³•åˆ™ã€‚å¦‚æœä½ å‘ç°è‡ªå·±ä¸æ–­é‡å¤ç›¸åŒæˆ–å‡ ä¹ç›¸åŒçš„ä»£ç ï¼Œæˆ–è€…æ›´ç³Ÿç³•çš„æ˜¯å¤åˆ¶å’Œç²˜è´´å®ƒï¼é‚£ä¹ˆæ˜¯æ—¶å€™è€ƒè™‘æŠŠå®ƒåˆ†ç¦»æˆä¸€ä¸ªæ¼‚äº®ã€å¹²å‡€çš„æ¨¡å—ï¼Œå¯ä»¥åœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨ã€‚ éšè—ä¸å¿…è¦çš„å®ç°ç»†èŠ‚ ä¼šä½¿ä»¥åæ”¹å˜è¿™äº›ç»†èŠ‚æ›´å®¹æ˜“ï¼Œè€Œä¸éœ€è¦æ”¹å˜æ‰€æœ‰ä½¿ç”¨æ¨¡å—çš„ä»£ç ã€‚ ä¿æŒç®€å•! ä¸è¦è¿‡æ—©åœ°è¿›è¡Œä¼˜åŒ–ï¼Œä¸è¦æ·»åŠ ä¸å¿…è¦çš„åŠŸèƒ½ï¼Œè®¾è®¡å¯é‡ç”¨çš„ä¸œè¥¿ã€‚ ä¸ºæ¸è¿›å¼çš„å¿«ä¹è€Œè®¾è®¡ æä¸å¯èƒ½åä¸‹æ¥ï¼Œåœ¨ä¸€æ¬¡ä¸é—´æ–­çš„ç‹‚æ¬¢ä¸­ï¼Œå®Œæˆæ•´ä¸ªå·¥ä½œé¡¹ç›®ã€‚ ç›¸åï¼Œåœ¨å¼€å§‹ç¼–ç ä¹‹å‰ï¼Œåä¸‹æ¥æ€è€ƒä¸€ä¸‹ä½ å¯ä»¥æ²¿é€”é‡‡å–çš„æ¸è¿›æ­¥éª¤ã€‚åœ¨å¼€å‘æ—¶ï¼Œä»¥è¿™äº›æ¸è¿›çš„æ­¥éª¤ä¸ºç›®æ ‡ï¼Œè¿™æ ·ä½ å°±å¯ä»¥æŠŠé—®é¢˜åˆ†è§£æˆå°çš„ã€å¯ç®¡ç†çš„å—çŠ¶ã€‚ä½ çš„ç›®æ ‡åº”è¯¥æ˜¯ï¼Œä¸€æ—¦ä½ å¼€å‘äº†ä¸€ä¸ªç‰¹å®šçš„ &quot;å—&quot;ï¼Œä½ å°±å¯ä»¥ç›¸ä¿¡å®ƒæ­¤åä¼šç»§ç»­åšå®ƒçš„å·¥ä½œã€‚é€šè¿‡å¦‚ä¸‹æ–¹æ³•è¿›è¡Œåˆ†è§£ï¼š è¯†åˆ«å•ç‹¬çš„æ„ä»¶ï¼ˆåˆ—è¡¨ã€å“ˆå¸Œã€ç®—æ³•ç­‰ï¼‰ è¯†åˆ« ç‰¹å¾/åŸºæœ¬æœ¬è´¨ å¯æµ‹è¯•æ€§è®¾è®¡ åœ¨è®¾è®¡å’Œç¼–ç è¿‡ç¨‹ä¸­æµ‹è¯•çš„ç¬¬ä¸€ä¸ªç›®æ ‡æ˜¯ç¡®ä¿ä¸€æ—¦ä½ å»ºç«‹äº†ä¸€ä¸ªç‰¹å®šçš„ç»„ä»¶æˆ–æ¨¡å—ï¼Œä½ å¯ä»¥ä¾é è¿™ä¸ªç»„ä»¶æ¥å·¥ä½œï¼Œå¹¶ä¿æŒå·¥ä½œã€‚åæ¥ï¼Œå½“ä½ çš„ç¨‹åºå‡ºç°é”™è¯¯æ—¶ï¼Œä½ å°±å¯ä»¥ä¸“æ³¨äºè¾ƒæ–°çš„ä»£ç ï¼Œå‡å°‘äº†è°ƒè¯•å’ŒåæœŸç¼–ç çš„å¤æ‚æ€§ã€‚ å•å…ƒæµ‹è¯•æ˜¯æµ‹è¯•çš„æœ€åŸºæœ¬å…ƒç´ ã€‚å®ƒä»¬ç‰¹åˆ«é€‚åˆäºä½ åœ¨å‰é¢å°†ä»£ç åˆ†è§£æˆæ­¥éª¤æ—¶ç¡®å®šçš„é‚£ç§å®Œå–„çš„æ¨¡å—-å®ç”¨ç¨‹åºã€å®¹å™¨ç­‰ã€‚å¯¹äºè¿™äº›æ¨¡å—ä¸­çš„æ¯ä¸€ä¸ªï¼Œæˆ‘ä»¬å»ºè®®å†™ä¸€å¥—ä¸“é—¨é’ˆå¯¹è¯¥æ¨¡å—çš„æµ‹è¯•ã€‚ç¼–å†™æµ‹è¯•ç”¨ä¾‹å¯ä»¥ä½¿ä½ æ›´åŠªåŠ›åœ°æ€è€ƒä½ æ‰€æš´éœ²çš„æ¥å£å’Œä½ å¿…é¡»å®ç°çš„è¡Œä¸ºã€‚ ç³»ç»Ÿæµ‹è¯•æ˜¯å¯¹å¤§å±€çš„æµ‹è¯•ï¼Œæ³¨æ„ï¼Œå³ä½¿åœ¨è¿™é‡Œï¼Œä½ ä¹Ÿå¯ä»¥ä»é¡¹ç›®çš„å¼€å§‹å°±å¼€å§‹å†™æœ‰ç”¨çš„æµ‹è¯•ã€‚ å¯¹æŠ—çš„å¿ƒæ€ åœ¨è®¾è®¡æµ‹è¯•çš„æ—¶å€™ï¼Œè¦æŠŠè‡ªå·±æ”¾åœ¨çœŸæ­£çš„ã€çœŸæ­£çš„è¯•å›¾ç ´è§£ä»£ç çš„å¿ƒæ€ä¸Šã€‚ä¸è¦åªæµ‹è¯•ç®€å•çš„æƒ…å†µï¼Œè¦æµ‹è¯•è¾¹ç•Œæƒ…å†µã€‚ å…ˆæ˜¯ç®€å•çš„æµ‹è¯•ï¼Œç„¶åæ˜¯å¤æ‚çš„æµ‹è¯•ã€‚å¾ˆå¯èƒ½åœ¨ä½ ç¬¬ä¸€æ¬¡å°è¯•ç®€å•çš„æµ‹è¯•æ—¶ï¼Œä½ ä¼šå‘ç°ä¸€äº›é”™è¯¯ã€‚ä¸€æ—¦ä½ è§£å†³äº†è¿™äº›é—®é¢˜ï¼Œå°±å¯ä»¥ç»§ç»­è¿›è¡Œæ›´å¤æ‚çš„æµ‹è¯•ï¼Œä»¥å‘ç°æ›´éš¾è§£å†³çš„é—®é¢˜ã€‚ æµ‹è¯•è‡ªåŠ¨åŒ– é€šè¿‡è¿™æ ·åšï¼Œä½ å°†æ›´ç»å¸¸åœ°è¿è¡Œå®ƒä»¬ï¼Œå°†å¯¹ä½ æ›´æœ‰ç”¨ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥èƒ½å¤Ÿç±»ä¼¼ä½¿ç”¨ make test è®©ä½ çš„æ‰€æœ‰æµ‹è¯•è¿è¡Œã€‚ ç¼–è¾‘å™¨ äº†è§£ä½ çš„ç¼–è¾‘å™¨å¹¶å¯¹å…¶äº†å¦‚æŒ‡æŒï¼Œå¯ä»¥ä¸ºä½ èŠ‚çœæ— æ•°çš„æŒ‰é”®å’Œé›¶æ˜Ÿçš„æ—¶é—´ã€‚å¸¸è§ç‰¹ç‚¹ï¼š è¯­æ³•é«˜äº®ã€‚å¯¹è¿ç®—ç¬¦ã€å‡½æ•°è°ƒç”¨ã€æ³¨é‡Šç­‰è¿›è¡Œç€è‰²ï¼Œå¯ä»¥ä½¿ä½ æ›´å®¹æ˜“æ‰«æä»£ç ï¼Œæ‰¾åˆ°ä½ è¦æ‰¾çš„ä¸œè¥¿ æ ‡ç­¾ã€‚ä¸€äº›ç¼–è¾‘å™¨å’Œé›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰æä¾›äº†å•æ¬¡ç‚¹å‡»æˆ–æŒ‰é”®å‘½ä»¤ï¼Œè®©ä½ å¿«é€Ÿè·³è½¬åˆ°å£°æ˜æˆ–å®ç°æŸä¸ªå‡½æ•°çš„æ–‡ä»¶ä¸­ã€‚ è‡ªåŠ¨è¡¥å…¨ã€‚ç¼–è¾‘å™¨æä¾›ä¸åŒç±»å‹çš„è‡ªåŠ¨å®ŒæˆåŠŸèƒ½ï¼Œä»æ‹¬å·åŒ¹é…åˆ°å‡½æ•°åç§°è‡ªåŠ¨å®Œæˆï¼Œç­‰ç­‰ã€‚ è¯·æ³¨æ„ï¼Œå½“è°ƒè¯•æ¶‰åŠå¤šä¸ªè¿›ç¨‹æˆ–æœºå™¨æˆ–æ“ä½œç³»ç»Ÿå†…æ ¸ä»£ç æ—¶ï¼Œä¸€äº›IDEçš„é›†æˆç‰¹æ€§åœ¨ç³»ç»Ÿç¼–ç¨‹çš„èƒŒæ™¯ä¸‹å¯èƒ½å¯¹ä½ ä¸åˆ©ã€‚ é˜…è¯» https://www.cs.cmu.edu/~dga/systems-se.pdf ","tags":[{"name":"Article","slug":"article","used":true,"link":"https://blog.qxxiao.eu.org/tag/article/"},{"name":"C++","slug":"c","used":true,"link":"https://blog.qxxiao.eu.org/tag/c/"}],"title":"Software Engineering for Systems Hackers","feature":"","link":"https://blog.qxxiao.eu.org/post/software-engineering-for-systems-hackers/","stats":{"text":"12 min read","time":710000,"words":3145,"minutes":12},"date":"2022-04-30 09:25:28","dateFormat":"2022-04-30","isTop":false},{"content":" è™šå‡½æ•°å®ç°åŸç† RTTI (run time type identification) å‚è€ƒ ğŸ”– Reversing C++ Virtual Functions: Part 1There are a few posts in various parts of the internet discussing reverse engineering C++, and these https://alschwalm.com/blog/static/2016/12/17/reversing-c-virtual-functions/ è™šå‡½æ•°å®ç°åŸç† åŸºæœ¬çš„å®ç°åŸç†å¯ä»¥å‚è€ƒé“¾æ¥ï¼Œä¸åŒç¼–è¯‘å™¨å®ç°å¯ä»¥ä¸åŒã€‚ gcc version 11.2.0 (Homebrew GCC 11.2.0)æµ‹è¯• å¤šé‡ç»§æ‰¿å¹¶ä¸”æ”¹å†™çˆ¶ç±»ä¸­çš„è™šå‡½æ•° æµ‹è¯•ä»£ç  #include &lt;iostream&gt; class A1 { public: virtual void a() { std::cout &lt;&lt; &quot;A1::a&quot; &lt;&lt; std::endl; } virtual void b() { std::cout &lt;&lt; &quot;A1::b&quot; &lt;&lt; std::endl; } virtual void c() { std::cout &lt;&lt; &quot;A1::c&quot; &lt;&lt; std::endl; } int a1 = 1; }; class A2 { public: virtual void d() { std::cout &lt;&lt; &quot;A2::d&quot; &lt;&lt; std::endl; } virtual void e() { std::cout &lt;&lt; &quot;A2::e&quot; &lt;&lt; std::endl; } int a2 = 2; }; // A1::a B::b A1::c [[B::f B::g]] // B::d A2::e // ==&gt; // A1::a [B::b] A1::c [B:d B:e] [[B:f B:g]] // thunk:B:d thunk:B:e class B : public A1, public A2 { public: virtual void b() { std::cout &lt;&lt; &quot;B::b&quot; &lt;&lt; std::endl; } virtual void d() { std::cout &lt;&lt; &quot;B::d&quot; &lt;&lt; std::endl; } virtual void e() { std::cout &lt;&lt; &quot;B::e&quot; &lt;&lt; std::endl; } virtual void f() { std::cout &lt;&lt; &quot;B::f&quot; &lt;&lt; std::endl; } virtual void g() { std::cout &lt;&lt; &quot;B::g&quot; &lt;&lt; std::endl; } int b3 = 3; }; int main() { B b; long *pvptr = (long *)&amp;b; long *vptr = (long *)*pvptr; typedef void (*pfunc)(); for (unsigned i = 0; i &lt; 7; ++i) { std::cout &lt;&lt; std::hex &lt;&lt; vptr + i &lt;&lt; &quot; &quot; &lt;&lt; vptr[i] &lt;&lt; std::endl; pfunc pfun = pfunc(vptr[i]); pfun(); } std::cout &lt;&lt; &quot;---------------------&quot; &lt;&lt; std::endl; long *vptr2 = (long *)*(long *)((char *)&amp;b + sizeof(A1)); for (unsigned i = 0; i &lt; 2; ++i) { std::cout &lt;&lt; std::hex &lt;&lt; vptr2 + i &lt;&lt; &quot; &quot; &lt;&lt; vptr2[i] &lt;&lt; std::endl; pfunc pfun = pfunc(vptr2[i]); pfun(); } return 0; } æ±‡ç¼–åï¼Œç±»Bçš„è™šå‡½æ•°è¡¨ç»“æ„ï¼š vtable for B: .quad 0 .quad typeinfo for B .quad A1::a() .quad B::b() .quad A1::c() .quad B::d() .quad B::e() .quad B::f() .quad B::g() .quad -16 .quad typeinfo for B .quad non-virtual thunk to B::d() .quad non-virtual thunk to B::e() å…¶ä¸­è™šå‡½æ•°è¡¨ä¸­æŒ‡å‘çš„Bç±» typeinfo ç»“æ„ï¼š typeinfo for B: .quad vtable for __cxxabiv1::__vmi_class_type_info+16 .quad typeinfo name for B .long 0 .long 2 .quad typeinfo for A1 .quad 2 .quad typeinfo for A2 .quad 4098 åœ¨ GCC å®ç°ä¸­ï¼š ç»§æ‰¿å¤šä¸ªæœ‰è™šå‡½æ•°çš„çˆ¶ç±»ï¼Œæ´¾ç”Ÿç±»å°±æœ‰å¤šä¸ªè™šè¡¨æŒ‡é’ˆï¼Œæ¯ä¸ªè™šå‡½æ•°æŒ‡é’ˆéƒ½ä½äºåŸºç±»å­˜å‚¨ä½ç½®ä¸­çš„èµ·å§‹åœ°å€(æ´¾ç”Ÿç±»å¯¹è±¡ä¸­)ã€‚æ‰€ä»¥ä½¿ç”¨æ´¾ç”Ÿç±»å¯¹è±¡å‘ä¸Šè½¬å‹çš„åŸºç±»æŒ‡é’ˆå¯ä»¥æ–¹ä¾¿åœ°è°ƒç”¨è™šå‡½æ•°-æ‰¾åˆ°å¯¹åº”çš„è™šæŒ‡é’ˆã€‚ è™šè¡¨æŒ‡é’ˆæŒ‡å‘çš„è™šå‡½æ•°è¡¨å¤§è‡´æ˜¯è¿ç»­çš„ï¼Œæ¯ä¸ªè™šè¡¨æŒ‡é’ˆæŒ‡å‘çš„å‰ä¸€ä¸ªå…ƒç´ æ˜¯type_infoç»“æ„ä½“æŒ‡é’ˆï¼Œç”¨äºå®ç°RTTI(ç±»åå’Œå­ç±»ä¿¡æ¯)ï¼Œä¸¤ä¸ªè¡¨ä¹‹é—´æ˜¯åˆ†éš”å…ƒç´ (ç¼–è¯‘å™¨å†³å®š)è¿™é‡Œæ˜¯-16ã€‚ ç¬¬ä¸€ä¸ªè™šè¡¨æŒ‡é’ˆæŒ‡å‘çš„è™šå‡½æ•°è¡¨å¾ˆé‡è¦ å­˜å‚¨å¯¹åº”åŸºç±»(ç¬¬ä¸€ä¸ªåŸºç±»)çš„è™šå‡½æ•°ï¼Œå¦‚æœå­ç±»æ”¹å†™ç¬¬ä¸€ä¸ªåŸºç±»çš„è™šå‡½æ•°åˆ™ä»£æ›¿å¯¹åº”çš„æ§½ä½ç½®(ä»£æ›¿ä¸ºæ”¹å†™çš„è™šå‡½æ•°åœ°å€)ï¼› æ­¤å¤–ï¼Œæ”¹å†™å…¶ä»–åŸºç±»çš„è™šå‡½æ•°ä¹Ÿä¼šæ·»åŠ åœ¨ç¬¬ä¸€ä¸ªè™šè¡¨ï¼Œæ´¾ç”Ÿç±»æ–°æ·»åŠ çš„è™šå‡½æ•°ä¹Ÿä¼šæ·»åŠ åˆ°ç¬¬ä¸€ä¸ªè™šè¡¨ä¸­ã€‚ å…¶ä½™è™šè¡¨ç±»ä¼¼ï¼ŒåŒ…å«æ²¡æœ‰è¢«è¦†ç›–çš„è™šå‡½æ•°ï¼Œå¦‚æœå…¶è™šå‡½æ•°è¢«æ”¹å†™äº†ï¼Œå¯¹åº”æ§½ä½ç½®æ˜¯ä¸€ä¸ª thunk å‡½æ•°ï¼Œä½œç”¨æ˜¯è·³è½¬åˆ°æ”¹å†™çš„è™šå‡½æ•°åœ°å€æ‰§è¡Œï¼› æƒ³ä¸€æƒ³ä¸ºä»€ä¹ˆè¿™ä¹ˆå®ç°ï¼š å¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨åŸºç±»çš„æŒ‡é’ˆæ¥è°ƒç”¨è™šå‡½æ•°ï¼Œåœ¨æ´¾ç”Ÿç±»è¢«å†æ¬¡ç»§æ‰¿æ—¶ï¼Œåªéœ€è¦ä¿®æ”¹å®ƒçš„ç¬¬ä¸€ä¸ªè™šè¡¨çš„å†…å®¹å°±ä½œä¸ºæ–°çš„æ´¾ç”Ÿç±»çš„è™šè¡¨ï¼Œå®ç°æ›´åŠ æ–¹ä¾¿ã€‚ æ³¨æ„ï¼š å­˜åœ¨å¤šä¸ªåŸºç±»æ—¶ï¼Œç›´æ¥ä½¿ç”¨æ´¾ç”Ÿç±»æŒ‡é’ˆå‘ä¸Šè½¬å‹æ—¶ï¼ŒæŒ‡é’ˆä¼šèµ‹å€¼åˆ°è¯¥æ´¾ç”Ÿå¯¹è±¡ä¸­è¯¥åŸºç±»çš„èµ·å§‹åœ°å€ï¼Œå› æ­¤è°ƒç”¨è™šå‡½æ•°æ—¶ï¼Œä¼šæ‰¾åˆ°å®ƒçš„è™šè¡¨æŒ‡é’ˆå¯¹åº”çš„è™šè¡¨ä¸­çš„å¯¹åº”ä½ç½®ï¼Œå¦‚æœè¢«overrideæ”¹å†™ä¼šè·³è½¬åˆ°çœŸå®çš„å‡½æ•°åœ°å€å®ç°å¤šæ€æ•ˆæœã€‚è¿™é‡Œçš„å¤šä¸ªè™šè¡¨æŒ‡é’ˆå¯ä»¥ä¾¿æ·ç¼–è¯‘å™¨ç¡®å®šåœ¨è¯¥åŸºç±»æŒ‡é’ˆä¸‹æ‰¾åˆ°å¯¹åº”å‡½æ•°çš„ä¸‹æ ‡ä½ç½®(ç”Ÿæˆè™šè¡¨æ—¶å°±å¯ä»¥ç¡®å®š)ï¼Œè¿›è€Œå¯ä»¥è°ƒç”¨åˆ°å®é™…çš„å‡½æ•°ã€‚ ç”±æ´¾ç”Ÿç±»å¯¹è±¡åœ°å€å‘ä¸Šè½¬å‹å¯ä»¥ç¡®å®šåŸºç±»çš„èµ·å§‹åœ°å€ï¼Œä»è€Œå¯ä»¥è°ƒç”¨å¯¹åº”çš„è™šå‡½æ•°ã€‚å¦‚æœä½¿ç”¨ï¼š void* p = &amp;b; // æ´¾ç”Ÿç±»åœ°å€èµ‹å€¼ç»™void* A1* pa = p; // å†èµ‹å€¼ç»™åŸºç±»æŒ‡é’ˆ è¿™æ ·ä¼šä½¿å¾—åŸºç±»æŒ‡é’ˆæŒ‡å‘çš„ä½ç½®ç›´æ¥å˜æˆæ´¾ç”Ÿç±»çš„èµ·å§‹åœ°å€ï¼Œå¦‚æœä¸æ˜¯å•ç»§æ‰¿æˆ–è€…ç¬¬ä¸€ä¸ªåŸºç±»ä¼šå‡ºç°é—®é¢˜ï¼Œå¿…é¡»ç›´æ¥ä½¿ç”¨æ´¾ç”Ÿç±»åœ°å€å‘ä¸Šè½¬å‹å¾—åˆ°å¯¹åº”åŸºç±»åœ°å€æŒ‡é’ˆã€‚ å†…å­˜å¯¹é½é—®é¢˜ åœ¨ç»§æ‰¿ä½“ç³»ä¸­ï¼Œæ´¾ç”Ÿç±»ä¼šä¿å­˜åŸºç±»çš„åŸå§‹å¸ƒå±€(åŒ…æ‹¬å¤§å°)ï¼›å¦‚æœåœ¨æ»¡è¶³æ¯ä¸ªåŸºç±»çš„å†…å­˜å¯¹é½æƒ…å†µä¸‹gccå…è®¸ç´§å¯†å¸ƒå±€ï¼Œä¾‹å¦‚ä¸Šè¿°ç±»Bå ç”¨32ä¸ªå­—èŠ‚ã€‚ // A1: vptr:8B + sizeof(a1):4B + padding:4B total:16B // A2: vptr:8B + sizeof(a2):4B + [sizeof(b3)] total:16B // B: total:32B (b3ç›´æ¥å’ŒA2ä¸­çš„æ•°æ®ç´§å¯†å¸ƒå±€) å“ªäº›å‡½æ•°ä¸èƒ½å®šä¹‰ä¸ºè™šå‡½æ•°ï¼Ÿ å‹å…ƒå‡½æ•°ï¼Œå®ƒä¸æ˜¯ç±»çš„æˆå‘˜å‡½æ•° å…¨å±€å‡½æ•° é™æ€æˆå‘˜å‡½æ•°ï¼Œå®ƒæ²¡æœ‰thisæŒ‡é’ˆ æ„é€ å‡½æ•°ï¼Œæ‹·è´æ„é€ å‡½æ•°ä»¥åŠèµ‹å€¼è¿ç®—ç¬¦é‡è½½ï¼ˆå¯ä»¥ä½†æ˜¯ä¸€èˆ¬ä¸å»ºè®®ä½œä¸ºè™šå‡½æ•°ï¼‰ æ„é€ å‡½æ•°/ææ„å‡½æ•°ä¸­å¯ä»¥è°ƒç”¨è™šå‡½æ•°å—ï¼Ÿ ğŸ’¡ ä¸èƒ½ï¼›æ„é€ æ´¾ç”Ÿç±»å¯¹è±¡æ—¶ï¼Œé¦–å…ˆè°ƒç”¨åŸºç±»æ„é€ å‡½æ•°åˆå§‹åŒ–å¯¹è±¡çš„åŸºç±»éƒ¨åˆ†ã€‚åœ¨æ‰§è¡ŒåŸºç±»æ„é€ å‡½æ•°æ—¶ï¼Œå¯¹è±¡çš„æ´¾ç”Ÿç±»éƒ¨åˆ†æ˜¯æœªåˆå§‹åŒ–çš„ã€‚ææ„æ´¾ç”Ÿç±»å¯¹è±¡æ—¶ï¼Œé¦–å…ˆææ„ä»–çš„æ´¾ç”Ÿç±»éƒ¨åˆ†ï¼Œç„¶åæŒ‰ç…§ä¸æ„é€ é¡ºåºçš„é€†åºææ„ä»–çš„åŸºç±»éƒ¨åˆ†ã€‚ åœ¨è¿è¡Œæ„é€ å‡½æ•°æˆ–è€…ææ„å‡½æ•°æ—¶ï¼Œå¯¹è±¡éƒ½æ˜¯ä¸å®Œæ•´çš„ã€‚ä¸ºäº†é€‚åº”è¿™ç§ä¸å®Œæ•´ï¼Œç¼–è¯‘å™¨å°†å¯¹è±¡çš„ç±»å‹è§†ä¸ºåœ¨è°ƒç”¨æ„é€ /ææ„å‡½æ•°æ—¶å‘ç”Ÿäº†å˜æ¢ï¼Œå³ï¼šè§†å¯¹è±¡çš„ç±»å‹ä¸ºå½“å‰æ„é€ å‡½æ•°/ææ„å‡½æ•°æ‰€åœ¨çš„ç±»çš„ç±»ç±»å‹ã€‚ç”±æ­¤é€ æˆçš„ç»“æœæ˜¯ï¼šåœ¨åŸºç±»æ„é€ å‡½æ•°æˆ–è€…ææ„å‡½æ•°ä¸­ï¼Œä¼šå°†æ´¾ç”Ÿç±»å¯¹è±¡å½“åšåŸºç±»ç±»å‹å¯¹è±¡å¯¹å¾…ã€‚ å³å¦‚æœåœ¨æ„é€ å‡½æ•°æˆ–è€…ææ„å‡½æ•°ä¸­è°ƒç”¨è™šå‡½æ•°ï¼Œè¿è¡Œçš„éƒ½å°†æ˜¯ä¸ºæ„é€ å‡½æ•°æˆ–è€…ææ„å‡½æ•°è‡ªèº«ç±»ç±»å‹å®šä¹‰çš„è™šå‡½æ•°ç‰ˆæœ¬ã€‚å¯¹è±¡çš„è™šå‡½æ•°è¡¨åœ°å€åœ¨å¯¹è±¡çš„æ„é€ å’Œææ„è¿‡ç¨‹ä¸­ä¼šéšç€éƒ¨åˆ†ç±»çš„æ„é€ å’Œææ„è€Œå‘ç”Ÿå˜åŒ–ï¼Œè¿™ä¸€ç‚¹åº”è¯¥æ˜¯ç¼–è¯‘å™¨å®ç°ç›¸å…³çš„ã€‚ RTTI (run time type identification) RTTIï¼Œå³è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ï¼Œå…¶ä¸»è¦ä½œç”¨ï¼š å‘ä¸‹ç±»å‹è½¬æ¢ï¼šå°†çˆ¶ç±»æŒ‡é’ˆè½¬æ¢ä¸ºå­ç±»æŒ‡é’ˆ å¼‚å¸¸å¤„ç† æ•°æ®å­˜å‚¨ ç›¸å…³çš„è¿ç®—ç¬¦ï¼š typeid: è¿”å›type_infoç»“æ„ä½“çš„å¯¹è±¡ï¼ˆå¦‚æœæ²¡æœ‰è™šå‡½æ•°å®ç°å¤šæ€ï¼Œè¿”å›çš„æ˜¯é™æ€ç±»å‹è€Œä¸æ˜¯è¿è¡Œæ—¶ç±»å‹çš„type_infoç»“æ„ä½“ï¼‰ dynamic_cast: å‘ä¸‹ç±»å‹è½¬æ¢ï¼ŒæˆåŠŸè¿”å›å­ç±»æŒ‡é’ˆï¼Œå¤±è´¥è¿”å›nullptrï¼ˆå¦‚æœæ²¡æœ‰å®ç°å¤šæ€ï¼Œç¼–è¯‘å™¨æŠ¥é”™ï¼‰ ä»£ç ç¤ºä¾‹ #include &lt;iostream&gt; class Base { public: virtual ~Base() {} }; class Derive : public Base {}; int main() { Base* pBase = new Derive(); std::cout &lt;&lt; typeid(*pBase).name() &lt;&lt; std::endl; Derive* pDerive = nullptr; if ((pDerive = dynamic_cast&lt;Derive*&gt;(pBase)) != nullptr) { std::cout &lt;&lt; &quot;dynamic_cast success&quot; &lt;&lt; std::endl; } else { std::cout &lt;&lt; &quot;dynamic_cast failed&quot; &lt;&lt; std::endl; } return 0; } RTTIçš„å®ç°åŸç† è™šå‡½æ•°è¡¨ä¸­vptr[-1]æ˜¯type_infoç»“æ„ä½“æŒ‡é’ˆï¼Œdynamic_castä¹Ÿè¦ä¾æ®type_infoè¿è¡Œï¼Œæ‰€ä»¥ä½¿ç”¨typeidå’Œdynamic_castéƒ½è¦æœ‰è™šå‡½æ•°è¡¨ï¼Œä¹Ÿå°±æ˜¯è™šå‡½æ•°ã€‚ å‚è€ƒ ğŸ”– book.douban.comhttps://book.douban.com/subject/1091086/ ğŸ”– C++è™šå‡½æ•°è¡¨æ·±å…¥æ¢ç´¢(è¯¦ç»†å…¨é¢)-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ è¿™ç¯‡åšå®¢å¯èƒ½æœ‰ä¸€ç‚¹ç‚¹é•¿ï¼Œä»£ç ä¹Ÿæœ‰ä¸€ç‚¹ç‚¹å¤šï¼Œä½†æ˜¯ä»”ç»†é˜…è¯»åˆ†æå®Œï¼Œä¼šå¯¹è™šå‡½æ•°è¡¨æœ‰ä¸€ä¸ªæ·±åˆ»çš„è®¤è¯†ã€‚ https://cloud.tencent.com/developer/article/1599283 C++åœ¨gccä¸‹çš„å•ç»§æ‰¿ï¼Œå¤šç»§æ‰¿ï¼Œè™šç»§æ‰¿çš„å†…å­˜å¸ƒå±€_LupinLeoçš„åšå®¢-CSDNåšå®¢ä¸€è§ˆæœ¬æ–‡ç›®çš„gccä¸‹ä¸åŒç»§æ‰¿æ–¹å¼çš„å­˜å‚¨æ¨¡å‹å•ç»§æ‰¿å•ç»§æ‰¿æ— é‡å†™ï¼šå•ç»§æ‰¿é‡å†™å¤šé‡ç»§æ‰¿å¤šç»§æ‰¿æ— é‡å†™ï¼šå¤šç»§æ‰¿é‡å†™ï¼šè™šç»§æ‰¿å¤šé‡ç»§æ‰¿æ— æ³•è§£å†³çš„æ¨¡å‹çœŸæ­£çš„è±å½¢ç»§æ‰¿å°¾è¯­æœ¬æ–‡ç›®çš„&nbsp; æœ€è¿‘çœ‹äº†ã€Šæ·±å…¥æ¢ç´¢c++ https://blog.csdn.net/shichao1470/article/details/91563282 ","tags":[{"name":"C++","slug":"c","used":true,"link":"https://blog.qxxiao.eu.org/tag/c/"}],"title":"C++å¯¹è±¡æ¨¡å‹-è™šå‡½æ•°","feature":"","link":"https://blog.qxxiao.eu.org/post/C++å¯¹è±¡æ¨¡å‹-è™šå‡½æ•°/","stats":{"text":"9 min read","time":540000,"words":2168,"minutes":9},"date":"2022-04-19 20:08:00","dateFormat":"2022-04-19","isTop":false},{"content":"B+ æ ‘ B+ æ ‘æ˜¯ä¸€ç§å¤šå‰æ’åºæ ‘ï¼Œå³æ¯ä¸ªèŠ‚ç‚¹é€šå¸¸æœ‰å¤šä¸ªå­©å­ã€‚ä¸€æ£µ B+ æ ‘åŒ…å«æ ¹èŠ‚ç‚¹ã€å†…éƒ¨èŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹ã€‚æ ¹èŠ‚ç‚¹å¯èƒ½æ˜¯ä¸€ä¸ªå¶å­èŠ‚ç‚¹ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šå­©å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚ B+ æ ‘çš„ç‰¹ç‚¹æ˜¯èƒ½å¤Ÿä¿æŒæ•°æ®ç¨³å®šæœ‰åºï¼Œå…¶æ’å…¥ä¸ä¿®æ”¹æ‹¥æœ‰è¾ƒç¨³å®šçš„å¯¹æ•°æ—¶é—´å¤æ‚åº¦ã€‚B+ æ ‘å…ƒç´ è‡ªåº•å‘ä¸Šæ’å…¥ï¼Œè¿™ä¸äºŒå‰æ ‘æ°å¥½ç›¸åã€‚ ç»“æ„ç¤ºä¾‹ï¼š å®šä¹‰æ–¹å¼é‡‡å–å’Œ wikipedia ä¸Šä¿æŒä¸€è‡´ã€‚ä¸€é¢— b é˜¶çš„ B+ æ ‘ï¼Œå…¶ä¸­ b è¡¨ç¤ºæ ‘çš„æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šå¯ä»¥æ‹¥æœ‰çš„å­èŠ‚ç‚¹ä¸ªæ•°ï¼Œç‰¹æ€§æœ‰ï¼š B+ æ ‘çš„é˜¶æˆ–åˆ†æ”¯å› å­ b å®šä¹‰ä¸ºï¼šå†…éƒ¨èŠ‚ç‚¹å…è®¸çš„æœ€å¤§çš„å­æ ‘èŠ‚ç‚¹æ•°é‡/æŒ‡é’ˆçš„æ•°é‡ï¼› å†…éƒ¨èŠ‚ç‚¹çš„å®é™…å­æ ‘èŠ‚ç‚¹/æŒ‡é’ˆçš„æ•°é‡ m é™åˆ¶ï¼šâŒˆb2âŒ‰â‰¤mâ‰¤b\\lceil \\frac{b}{2} \\rceil \\le m \\le bâŒˆ2bâ€‹âŒ‰â‰¤mâ‰¤b ï¼›æ ¹èŠ‚ç‚¹å­æ ‘èŠ‚ç‚¹çš„æ•°é‡ä¸ºï¼š2â‰¤mâ‰¤b2 \\le m \\le b2â‰¤mâ‰¤b å¦‚æœå†…éƒ¨èŠ‚ç‚¹åŒ…å« m ä¸ªå­æ ‘èŠ‚ç‚¹/æŒ‡é’ˆï¼Œé‚£ä¹ˆè¯¥èŠ‚ç‚¹åŒ…å« m-1 ä¸ªå…³é”®å­— key (ä¸åŒå®šä¹‰æ­¤å¤„æœ‰å·®åˆ«) å¶å­èŠ‚ç‚¹éƒ½åœ¨åŒä¸€é«˜åº¦ä¸Š ç‰¹åˆ«çš„ï¼Œå½“åˆå§‹åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œæ ¹èŠ‚ç‚¹æœ¬èº«å°±æ˜¯å¶å­èŠ‚ç‚¹ï¼Œå…¶è®°å½•çš„ä¸ªæ•°ï¼š0â‰¤nâ‰¤bâˆ’10\\le n \\le b-10â‰¤nâ‰¤bâˆ’1 æ‰€æœ‰å¶å­èŠ‚ç‚¹ä¸­åŒ…å«äº†å…¨éƒ¨å…³é”®å­—çš„ä¿¡æ¯ï¼ŒåŠæŒ‡å‘å«è¿™äº›å…³é”®å­—è®°å½•çš„æŒ‡é’ˆï¼Œä¸”å¶å­èŠ‚ç‚¹æœ¬èº«ä¾å…³é”®å­—çš„å¤§å°è‡ªå°è€Œå¤§é¡ºåºé“¾æ¥ï¼› B+æ ‘çš„æŸ¥æ‰¾æ“ä½œï¼Œæ— è®ºæŸ¥æ‰¾æˆåŠŸä¸å¦ï¼Œæ¯æ¬¡æŸ¥æ‰¾æ“ä½œéƒ½æ˜¯èµ°äº†ä¸€æ¡ä»æ ¹ç»“ç‚¹åˆ°å¶å­ç»“ç‚¹çš„è·¯å¾„ã€‚ æŸ¥æ‰¾æ’å…¥åˆ é™¤æ“ä½œ å‚è€ƒé“¾æ¥ï¼šhttps://zhuanlan.zhihu.com/p/149287061 ç”¨é€” B+æ ‘ ä¸»è¦é€‚ç”¨äºç´¢å¼•æ“ä½œã€‚ä¸ºä»€ä¹ˆè¯´ B+æ ‘ æ¯” B-æ ‘ æ›´é€‚åˆå®é™…åº”ç”¨äºæ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç´¢å¼•å’Œæ•°æ®åº“ç´¢å¼•ï¼Ÿ B+æ ‘çš„å†…éƒ¨èŠ‚ç‚¹åªå­˜å‚¨ç´¢å¼•ä¿¡æ¯ï¼Œè€Œä¸å­˜å‚¨å®é™…æ•°æ®ï¼Œå› æ­¤å¯ä»¥å­˜å‚¨æ›´å¤šçš„ç´¢å¼•ä¿¡æ¯ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚ B+æ ‘çš„å¶å­èŠ‚ç‚¹å½¢æˆä¸€ä¸ªæœ‰åºé“¾è¡¨ï¼Œå¯ä»¥æ–¹ä¾¿åœ°è¿›è¡ŒèŒƒå›´æŸ¥è¯¢å’Œæ’åºæ“ä½œã€‚ B+æ ‘çš„æŸ¥è¯¢æ•ˆç‡æ›´åŠ ç¨³å®š: ç”±äºéç»ˆèŠ‚ç‚¹å¹¶ä¸æ˜¯æœ€ç»ˆæŒ‡å‘æ–‡ä»¶å†…å®¹çš„èŠ‚ç‚¹ï¼Œè€Œåªæ˜¯å¶å­èŠ‚ç‚¹ä¸­å…³é”®å­—çš„ç´¢å¼•ã€‚æ‰€ä»¥ä»»ä½•å…³é”®å­—çš„æŸ¥æ‰¾å¿…é¡»èµ°ä¸€æ¡ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„è·¯ã€‚æ‰€æœ‰å…³é”®å­—æŸ¥è¯¢çš„è·¯å¾„é•¿åº¦ç›¸åŒï¼Œå¯¼è‡´æ¯ä¸€ä¸ªæ•°æ®çš„æŸ¥è¯¢æ•ˆç‡ç›¸å½“ã€‚ MySQL ä¸­çš„åº”ç”¨ ä¸ºäº†æŸ¥è¯¢æ›´åŠ é«˜æ•ˆï¼Œé‡‡ç”¨ B+æ ‘ ä½œä¸ºæ•°æ®åº“ç´¢å¼•ã€‚åœ¨ MySQL ä¸­ï¼Œç´¢å¼•å±äºå­˜å‚¨å¼•æ“çº§åˆ«çš„æ¦‚å¿µï¼Œä¸åŒå­˜å‚¨å¼•æ“å¯¹ç´¢å¼•çš„å®ç°æ–¹å¼æ˜¯ä¸åŒçš„ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥è®¨è®ºä¸¤ä¸ªå¼•æ“ï¼šMyISAM å’Œ InnoDB è¿™ä¸¤ç§å¼•æ“ã€‚ MyISAM MyISAM ä¸­æœ‰ä¸¤ç§ç´¢å¼•ï¼Œåˆ†åˆ«æ˜¯ä¸»ç´¢å¼•å’Œè¾…åŠ©ç´¢å¼•ï¼Œåœ¨è¿™é‡Œé¢çš„ä¸»ç´¢å¼•ä½¿ç”¨å…·æœ‰å”¯ä¸€æ€§çš„é”®å€¼è¿›è¡Œåˆ›å»ºï¼Œè€Œè¾…åŠ©ç´¢å¼•ä¸­é”®å€¼å¯ä»¥æ˜¯ç›¸åŒçš„ã€‚MyISAM åˆ†åˆ«ä¼šå­˜åœ¨ä¸€ä¸ªç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶ï¼Œå®ƒçš„ä¸»ç´¢å¼•æ˜¯éèšé›†ç´¢å¼•ã€‚å½“æˆ‘ä»¬æŸ¥è¯¢çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰¾åˆ°å¶å­èŠ‚ç‚¹ä¸­ä¿å­˜çš„åœ°å€ï¼Œç„¶åé€šè¿‡åœ°å€æˆ‘ä»¬æ‰¾åˆ°å¯¹åº”çš„ä¿¡æ¯ã€‚ InnoDB InnoDB ç´¢å¼•å’Œ MyISAM çš„æœ€å¤§åŒºåˆ«æ˜¯å®ƒåªæœ‰ä¸€ä¸ªæ•°æ®æ–‡ä»¶ã€‚åœ¨ InnoDB å­˜å‚¨å¼•æ“ä¸­ï¼Œè¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯æŒ‰ B+æ ‘ ç»„ç»‡çš„ä¸€ä¸ªç´¢å¼•ç»“æ„ï¼Œè¿™æ£µæ ‘çš„å¶èŠ‚ç‚¹æ•°æ®ä¿å­˜äº†å®Œæ•´çš„æ•°æ®è®°å½•ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠå®ƒçš„ä¸»ç´¢å¼•å«åšèšé›†ç´¢å¼•ã€‚è€Œå®ƒçš„è¾…åŠ©ç´¢å¼•å’Œ MyISAM ä¹Ÿä¼šæœ‰æ‰€ä¸åŒï¼Œå®ƒçš„è¾…åŠ©ç´¢å¼•éƒ½æ˜¯å°†ä¸»é”®ä½œä¸ºæ•°æ®åŸŸï¼Œæ‰€ä»¥è¿™æ ·å½“æˆ‘ä»¬æŸ¥æ‰¾çš„æ—¶å€™é€šè¿‡è¾…åŠ©ç´¢å¼•å…ˆæ‰¾åˆ°ä¸»é”®ï¼Œç„¶åé€šè¿‡ä¸»ç´¢å¼•æ‰¾åˆ°å¯¹åº”çš„ä¸»é”®ï¼Œä»è€Œå¾—åˆ°ç›¸åº”çš„æ•°æ®ä¿¡æ¯ã€‚ é“¾æ¥ è¯´æ˜ï¼šä¸åŒçš„ç‰ˆæœ¬åœ¨å®šä¹‰ä¸Šå¯èƒ½æœ‰å·®åˆ«ã€‚ https://oi-wiki.org/ds/bplus-tree/ https://www.cnblogs.com/nullzx/p/8729425.html https://zhuanlan.zhihu.com/p/149287061 B+æ ‘åŠæ’å…¥å’Œåˆ é™¤æ“ä½œè¯¦è§£(æ³¨: keyæ•°é‡ç­‰äºæŒ‡é’ˆæ•°é‡) C++ç®€å•å®ç° ","tags":[{"name":"Algorithm","slug":"algorithm","used":true,"link":"https://blog.qxxiao.eu.org/tag/algorithm/"},{"name":"MySQL","slug":"mysql","used":true,"link":"https://blog.qxxiao.eu.org/tag/mysql/"}],"title":"B+ æ ‘","feature":"https://pic.qxxiao.cn/algorithm.png","link":"https://blog.qxxiao.eu.org/post/b+tree/","stats":{"text":"5 min read","time":240000,"words":1113,"minutes":5},"date":"2022-04-13 20:25:49","dateFormat":"2022-04-13","isTop":false},{"content":"C++å€¼çš„ç±»å‹è¯´æ˜ C++è¡¨è¾¾å¼(æ“ä½œç¬¦è¡¨è¾¾å¼ï¼Œå­—é¢é‡ï¼Œå˜é‡åç­‰)éƒ½æœ‰å€¼ç±»å‹ï¼Œé€šå¸¸å°†å€¼çš„ç±»å‹åˆ’åˆ†ä¸ºå·¦å€¼å’Œå³å€¼ï¼š ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå¦‚æœèƒ½å¯¹å®ƒè¿›è¡Œå–åœ°å€è¿ç®—/ç¡®å®šçš„å†…å­˜åœ°å€ï¼Œåˆ™å®ƒæ˜¯å·¦å€¼ï¼›ï¼ˆåŒ…æ‹¬å·¦å€¼çš„å¼•ç”¨ï¼‰ å¦åˆ™ï¼Œå®ƒå°±æ˜¯å³å€¼ C++11åå‡ºç°äº†5ç§å€¼çš„ç±»å‹ï¼Œç®€å•è§£é‡Šï¼š glvalue å¹¿ä¹‰å·¦å€¼ï¼Œï¼ˆè¿ç®—ç»“æœï¼‰æ˜¯å…·æœ‰èº«ä»½/å†…å­˜åœ°å€çš„å¯¹è±¡/å‡½æ•°çš„è¡¨è¾¾å¼ï¼ŒåŒ…æ‹¬xvalueå’Œlvalue xvalue å³å°†è¿‡æœŸå€¼/äº¡å€¼ï¼Œå±äºglvalueå¹¿ä¹‰å·¦å€¼ï¼Œè¡¨ç¤ºå…¶èµ„æºå¯ä»¥è¢«é‡å¤ä½¿ç”¨/ç§»åŠ¨çš„å¯¹è±¡ è¿”å›ç±»å‹æ˜¯å³å€¼å¼•ç”¨çš„å‡½æ•°è°ƒç”¨ï¼Œå¦‚std::move(x)ï¼› a[n]ï¼Œa.mï¼Œa.*mpè¡¨è¾¾å¼(å…¶ä¸­aæ˜¯rvalueï¼Œmæ˜¯éå¼•ç”¨ç±»å‹çš„éé™æ€æˆå‘˜ï¼Œmpæ˜¯æŒ‡é’ˆ) è½¬æ¢ä¸ºå¯¹è±¡ç±»å‹çš„å³å€¼å¼•ç”¨çš„castè¡¨è¾¾å¼ï¼Œå¦‚static_cast&lt;int&amp;&amp;&gt;(x) lvalue å†å²ä¸Šå«æ³•(å¯ä»¥å‡ºç°åœ¨èµ‹å€¼è¿ç®—ç¬¦çš„å·¦è¾¹)ï¼Œå±äºglvalueä½†ä¸æ˜¯xvalue prvalue çº¯å³å€¼ï¼Œä¾‹å¦‚å­—é¢é‡(å­—ç¬¦ä¸²é™¤å¤–)ã€ç®—æœ¯è¡¨è¾¾å¼(a+b, &amp;a, åç½®åŠ åŠ ç­‰)ã€ä¸´æ—¶å¯¹è±¡ã€lamdaè¡¨è¾¾å¼ç­‰ã€‚ rvalue å†å²å«æ³•(å¯ä»¥å‡ºç°åœ¨èµ‹å€¼è¿ç®—ç¬¦çš„å³è¾¹)ï¼ŒåŒ…æ‹¬prvalueå’Œxvalue å¯ä»¥å°†å€¼å¤§æ¦‚åˆ†ä¸º3ç§ï¼š xvalue å¹¿ä¹‰å·¦å€¼ï¼Œä½†æ˜¯å…¶èµ„æºå¯ä»¥é‡å¤ä½¿ç”¨/ç§»åŠ¨ã€æœ‰èº«ä»½ï¼Œå¯ä»¥ç§»åŠ¨ã€‘ lvalue ä¼ ç»Ÿå·¦å€¼ï¼Œèµ„æºä¸èƒ½ç§»åŠ¨ã€æœ‰èº«ä»½ï¼Œä¸å¯ä»¥ç§»åŠ¨ã€‘ prvalue ä¼ ç»Ÿå³å€¼ï¼Œèµ„æºå¯ä»¥ç§»åŠ¨ã€æ²¡æœ‰èº«ä»½ï¼Œå¯ä»¥ç§»åŠ¨ã€‘ åœ¨C++ä¸­å³å€¼rvalueçš„è¯­ä¹‰å°±æ˜¯å¯ç§»åŠ¨çš„ã€‚ åªéœ€è¦è®°ä½ç‰¹æ®Šçš„å¹¿ä¹‰å·¦å€¼xvalueï¼Œå®ƒæ˜¯æœ‰èº«ä»½çš„ä½†æ˜¯å…¶èµ„æºå¯ä»¥ç§»åŠ¨ï¼Œå¸¸è§æƒ…å½¢ï¼š // 1. è¿”å›å³å€¼å¼•ç”¨çš„å‡½æ•°è°ƒç”¨ std::move(x); func(); //funcçš„å£°æ˜ï¼šFoo&amp;&amp; func(); // 2. è½¬æ¢ä¸ºå³å€¼å¼•ç”¨çš„cast static_cast&lt;int&amp;&amp;&gt;(x); // 3. rvalueçš„æˆå‘˜ std::move(x).m_data; // éå¼•ç”¨ç±»å‹çš„éé™æ€æˆå‘˜ func().m_data; //funcçš„å£°æ˜ï¼šFoo&amp;&amp; func(); static_cast&lt;Foo&amp;&amp;&gt;(x).m_data; ","tags":[{"name":"C++","slug":"c","used":true,"link":"https://blog.qxxiao.eu.org/tag/c/"}],"title":"C++å€¼çš„ç±»å‹","feature":"https://pic.qxxiao.cn/cpp-logo.png","link":"https://blog.qxxiao.eu.org/post/C++å€¼çš„ç±»å‹/","stats":{"text":"2 min read","time":119000,"words":521,"minutes":2},"date":"2022-04-10 23:22:18","dateFormat":"2022-04-10","isTop":false},{"content":"MySQLå­¦ä¹ ç¬”è®° è½¬è½½ï¼šhttps://shockerli.net/post/1000-line-mysql-note/ /* æ•°æ®åº“æ“ä½œ */ ------------------ -- æŸ¥çœ‹å½“å‰æ•°æ®åº“ SELECT DATABASE(); -- æ˜¾ç¤ºå½“å‰æ—¶é—´ã€ç”¨æˆ·åã€æ•°æ®åº“ç‰ˆæœ¬ SELECT now(), user(), version(); -- åˆ›å»ºåº“ CREATE DATABASE[ IF NOT EXISTS] æ•°æ®åº“å æ•°æ®åº“é€‰é¡¹ æ•°æ®åº“é€‰é¡¹ï¼š CHARACTER SET charset_name COLLATE collation_name -- æŸ¥çœ‹å·²æœ‰åº“ SHOW DATABASES[ LIKE 'PATTERN'] -- æŸ¥çœ‹å½“å‰åº“ä¿¡æ¯ SHOW CREATE DATABASE æ•°æ®åº“å -- ä¿®æ”¹åº“çš„é€‰é¡¹ä¿¡æ¯ ALTER DATABASE åº“å é€‰é¡¹ä¿¡æ¯ -- åˆ é™¤åº“ DROP DATABASE[ IF EXISTS] æ•°æ®åº“å åŒæ—¶åˆ é™¤è¯¥æ•°æ®åº“ç›¸å…³çš„ç›®å½•åŠå…¶ç›®å½•å†…å®¹ /* è¡¨çš„æ“ä½œ */ ------------------ -- åˆ›å»ºè¡¨ CREATE [TEMPORARY] TABLE[ IF NOT EXISTS] [åº“å.]è¡¨å ( è¡¨çš„ç»“æ„å®šä¹‰ )[ è¡¨é€‰é¡¹] æ¯ä¸ªå­—æ®µå¿…é¡»æœ‰æ•°æ®ç±»å‹ æœ€åä¸€ä¸ªå­—æ®µåä¸èƒ½æœ‰é€—å· TEMPORARY ä¸´æ—¶è¡¨ï¼Œä¼šè¯ç»“æŸæ—¶è¡¨è‡ªåŠ¨æ¶ˆå¤± å¯¹äºå­—æ®µçš„å®šä¹‰ï¼š å­—æ®µå æ•°æ®ç±»å‹ [NOT NULL | NULL] [DEFAULT default_value] [AUTO_INCREMENT] [UNIQUE [KEY] | [PRIMARY] KEY] [COMMENT 'string'] -- è¡¨é€‰é¡¹ -- å­—ç¬¦é›† CHARSET = charset_name å¦‚æœè¡¨æ²¡æœ‰è®¾å®šï¼Œåˆ™ä½¿ç”¨æ•°æ®åº“å­—ç¬¦é›† -- å­˜å‚¨å¼•æ“ ENGINE = engine_name è¡¨åœ¨ç®¡ç†æ•°æ®æ—¶é‡‡ç”¨çš„ä¸åŒçš„æ•°æ®ç»“æ„ï¼Œç»“æ„ä¸åŒä¼šå¯¼è‡´å¤„ç†æ–¹å¼ã€æä¾›çš„ç‰¹æ€§æ“ä½œç­‰ä¸åŒ å¸¸è§çš„å¼•æ“ï¼šInnoDB MyISAM Memory/Heap BDB Merge Example CSV MaxDB Archive ä¸åŒçš„å¼•æ“åœ¨ä¿å­˜è¡¨çš„ç»“æ„å’Œæ•°æ®æ—¶é‡‡ç”¨ä¸åŒçš„æ–¹å¼ MyISAMè¡¨æ–‡ä»¶å«ä¹‰ï¼š.frmè¡¨å®šä¹‰ï¼Œ.MYDè¡¨æ•°æ®ï¼Œ.MYIè¡¨ç´¢å¼• InnoDBè¡¨æ–‡ä»¶å«ä¹‰ï¼š.frmè¡¨å®šä¹‰ï¼Œè¡¨ç©ºé—´æ•°æ®å’Œæ—¥å¿—æ–‡ä»¶ SHOW ENGINES -- æ˜¾ç¤ºå­˜å‚¨å¼•æ“çš„çŠ¶æ€ä¿¡æ¯ SHOW ENGINE å¼•æ“å {LOGS|STATUS} -- æ˜¾ç¤ºå­˜å‚¨å¼•æ“çš„æ—¥å¿—æˆ–çŠ¶æ€ä¿¡æ¯ -- è‡ªå¢èµ·å§‹æ•° AUTO_INCREMENT = è¡Œæ•° -- æ•°æ®æ–‡ä»¶ç›®å½• DATA DIRECTORY = 'ç›®å½•' -- ç´¢å¼•æ–‡ä»¶ç›®å½• INDEX DIRECTORY = 'ç›®å½•' -- è¡¨æ³¨é‡Š COMMENT = 'string' -- åˆ†åŒºé€‰é¡¹ PARTITION BY ... (è¯¦ç»†è§æ‰‹å†Œ) -- æŸ¥çœ‹æ‰€æœ‰è¡¨ SHOW TABLES[ LIKE 'pattern'] SHOW TABLES FROM è¡¨å -- æŸ¥çœ‹è¡¨æœºæ„ SHOW CREATE TABLE è¡¨å ï¼ˆä¿¡æ¯æ›´è¯¦ç»†ï¼‰ DESC è¡¨å / DESCRIBE è¡¨å / EXPLAIN è¡¨å / SHOW COLUMNS FROM è¡¨å [LIKE 'PATTERN'] SHOW TABLE STATUS [FROM db_name] [LIKE 'pattern'] -- ä¿®æ”¹è¡¨ -- ä¿®æ”¹è¡¨æœ¬èº«çš„é€‰é¡¹ ALTER TABLE è¡¨å è¡¨çš„é€‰é¡¹ eg: ALTER TABLE è¡¨å ENGINE=MYISAM; -- å¯¹è¡¨è¿›è¡Œé‡å‘½å RENAME TABLE åŸè¡¨å TO æ–°è¡¨å RENAME TABLE åŸè¡¨å TO åº“å.è¡¨å ï¼ˆå¯å°†è¡¨ç§»åŠ¨åˆ°å¦ä¸€ä¸ªæ•°æ®åº“ï¼‰ -- RENAMEå¯ä»¥äº¤æ¢ä¸¤ä¸ªè¡¨å -- ä¿®æ”¹è¡¨çš„å­—æ®µæœºæ„ï¼ˆ13.1.2. ALTER TABLEè¯­æ³•ï¼‰ ALTER TABLE è¡¨å æ“ä½œå -- æ“ä½œå ADD[ COLUMN] å­—æ®µå®šä¹‰ -- å¢åŠ å­—æ®µ AFTER å­—æ®µå -- è¡¨ç¤ºå¢åŠ åœ¨è¯¥å­—æ®µååé¢ FIRST -- è¡¨ç¤ºå¢åŠ åœ¨ç¬¬ä¸€ä¸ª ADD PRIMARY KEY(å­—æ®µå) -- åˆ›å»ºä¸»é”® ADD UNIQUE [ç´¢å¼•å] (å­—æ®µå)-- åˆ›å»ºå”¯ä¸€ç´¢å¼• ADD INDEX [ç´¢å¼•å] (å­—æ®µå) -- åˆ›å»ºæ™®é€šç´¢å¼• DROP[ COLUMN] å­—æ®µå -- åˆ é™¤å­—æ®µ MODIFY[ COLUMN] å­—æ®µå å­—æ®µå±æ€§ -- æ”¯æŒå¯¹å­—æ®µå±æ€§è¿›è¡Œä¿®æ”¹ï¼Œä¸èƒ½ä¿®æ”¹å­—æ®µå(æ‰€æœ‰åŸæœ‰å±æ€§ä¹Ÿéœ€å†™ä¸Š) CHANGE[ COLUMN] åŸå­—æ®µå æ–°å­—æ®µå å­—æ®µå±æ€§ -- æ”¯æŒå¯¹å­—æ®µåä¿®æ”¹ DROP PRIMARY KEY -- åˆ é™¤ä¸»é”®(åˆ é™¤ä¸»é”®å‰éœ€åˆ é™¤å…¶AUTO_INCREMENTå±æ€§) DROP INDEX ç´¢å¼•å -- åˆ é™¤ç´¢å¼• DROP FOREIGN KEY å¤–é”® -- åˆ é™¤å¤–é”® -- åˆ é™¤è¡¨ DROP TABLE[ IF EXISTS] è¡¨å ... -- æ¸…ç©ºè¡¨æ•°æ® TRUNCATE [TABLE] è¡¨å -- å¤åˆ¶è¡¨ç»“æ„ CREATE TABLE è¡¨å LIKE è¦å¤åˆ¶çš„è¡¨å -- å¤åˆ¶è¡¨ç»“æ„å’Œæ•°æ® CREATE TABLE è¡¨å [AS] SELECT * FROM è¦å¤åˆ¶çš„è¡¨å -- æ£€æŸ¥è¡¨æ˜¯å¦æœ‰é”™è¯¯ CHECK TABLE tbl_name [, tbl_name] ... [option] ... -- ä¼˜åŒ–è¡¨ OPTIMIZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ... -- ä¿®å¤è¡¨ REPAIR [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ... [QUICK] [EXTENDED] [USE_FRM] -- åˆ†æè¡¨ ANALYZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ... /* æ•°æ®æ“ä½œ */ ------------------ -- å¢ INSERT [INTO] è¡¨å [(å­—æ®µåˆ—è¡¨)] VALUES (å€¼åˆ—è¡¨)[, (å€¼åˆ—è¡¨), ...] -- å¦‚æœè¦æ’å…¥çš„å€¼åˆ—è¡¨åŒ…å«æ‰€æœ‰å­—æ®µå¹¶ä¸”é¡ºåºä¸€è‡´ï¼Œåˆ™å¯ä»¥çœç•¥å­—æ®µåˆ—è¡¨ã€‚ -- å¯åŒæ—¶æ’å…¥å¤šæ¡æ•°æ®è®°å½•ï¼ REPLACE ä¸ INSERT å®Œå…¨ä¸€æ ·ï¼Œå¯äº’æ¢ã€‚ INSERT [INTO] è¡¨å SET å­—æ®µå=å€¼[, å­—æ®µå=å€¼, ...] -- æŸ¥ SELECT å­—æ®µåˆ—è¡¨ FROM è¡¨å[ å…¶ä»–å­å¥] -- å¯æ¥è‡ªå¤šä¸ªè¡¨çš„å¤šä¸ªå­—æ®µ -- å…¶ä»–å­å¥å¯ä»¥ä¸ä½¿ç”¨ -- å­—æ®µåˆ—è¡¨å¯ä»¥ç”¨*ä»£æ›¿ï¼Œè¡¨ç¤ºæ‰€æœ‰å­—æ®µ -- åˆ  DELETE FROM è¡¨å[ åˆ é™¤æ¡ä»¶å­å¥] æ²¡æœ‰æ¡ä»¶å­å¥ï¼Œåˆ™ä¼šåˆ é™¤å…¨éƒ¨ -- æ”¹ UPDATE è¡¨å SET å­—æ®µå=æ–°å€¼[, å­—æ®µå=æ–°å€¼] [æ›´æ–°æ¡ä»¶] /* å­—ç¬¦é›†ç¼–ç  */ ------------------ -- MySQLã€æ•°æ®åº“ã€è¡¨ã€å­—æ®µå‡å¯è®¾ç½®ç¼–ç  -- æ•°æ®ç¼–ç ä¸å®¢æˆ·ç«¯ç¼–ç ä¸éœ€ä¸€è‡´ SHOW VARIABLES LIKE 'character_set_%' -- æŸ¥çœ‹æ‰€æœ‰å­—ç¬¦é›†ç¼–ç é¡¹ character_set_client å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€æ•°æ®æ—¶ä½¿ç”¨çš„ç¼–ç  character_set_results æœåŠ¡å™¨ç«¯å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯æ‰€ä½¿ç”¨çš„ç¼–ç  character_set_connection è¿æ¥å±‚ç¼–ç  SET å˜é‡å = å˜é‡å€¼ SET character_set_client = gbk; SET character_set_results = gbk; SET character_set_connection = gbk; SET NAMES GBK; -- ç›¸å½“äºå®Œæˆä»¥ä¸Šä¸‰ä¸ªè®¾ç½® -- æ ¡å¯¹é›† æ ¡å¯¹é›†ç”¨ä»¥æ’åº SHOW CHARACTER SET [LIKE 'pattern']/SHOW CHARSET [LIKE 'pattern'] æŸ¥çœ‹æ‰€æœ‰å­—ç¬¦é›† SHOW COLLATION [LIKE 'pattern'] æŸ¥çœ‹æ‰€æœ‰æ ¡å¯¹é›† CHARSET å­—ç¬¦é›†ç¼–ç  è®¾ç½®å­—ç¬¦é›†ç¼–ç  COLLATE æ ¡å¯¹é›†ç¼–ç  è®¾ç½®æ ¡å¯¹é›†ç¼–ç  /* æ•°æ®ç±»å‹ï¼ˆåˆ—ç±»å‹ï¼‰ */ ------------------ 1. æ•°å€¼ç±»å‹ -- a. æ•´å‹ ---------- ç±»å‹ å­—èŠ‚ èŒƒå›´ï¼ˆæœ‰ç¬¦å·ä½ï¼‰ tinyint 1å­—èŠ‚ -128 ~ 127 æ— ç¬¦å·ä½ï¼š0 ~ 255 smallint 2å­—èŠ‚ -32768 ~ 32767 mediumint 3å­—èŠ‚ -8388608 ~ 8388607 int 4å­—èŠ‚ bigint 8å­—èŠ‚ int(M) Mè¡¨ç¤ºæ€»ä½æ•° - é»˜è®¤å­˜åœ¨ç¬¦å·ä½ï¼Œunsigned å±æ€§ä¿®æ”¹ - æ˜¾ç¤ºå®½åº¦ï¼Œå¦‚æœæŸä¸ªæ•°ä¸å¤Ÿå®šä¹‰å­—æ®µæ—¶è®¾ç½®çš„ä½æ•°ï¼Œåˆ™å‰é¢ä»¥0è¡¥å¡«ï¼Œzerofill å±æ€§ä¿®æ”¹ ä¾‹ï¼šint(5) æ’å…¥ä¸€ä¸ªæ•°'123'ï¼Œè¡¥å¡«åä¸º'00123' - åœ¨æ»¡è¶³è¦æ±‚çš„æƒ…å†µä¸‹ï¼Œè¶Šå°è¶Šå¥½ã€‚ - 1è¡¨ç¤ºboolå€¼çœŸï¼Œ0è¡¨ç¤ºboolå€¼å‡ã€‚MySQLæ²¡æœ‰å¸ƒå°”ç±»å‹ï¼Œé€šè¿‡æ•´å‹0å’Œ1è¡¨ç¤ºã€‚å¸¸ç”¨tinyint(1)è¡¨ç¤ºå¸ƒå°”å‹ã€‚ -- b. æµ®ç‚¹å‹ ---------- ç±»å‹ å­—èŠ‚ èŒƒå›´ float(å•ç²¾åº¦) 4å­—èŠ‚ double(åŒç²¾åº¦) 8å­—èŠ‚ æµ®ç‚¹å‹æ—¢æ”¯æŒç¬¦å·ä½ unsigned å±æ€§ï¼Œä¹Ÿæ”¯æŒæ˜¾ç¤ºå®½åº¦ zerofill å±æ€§ã€‚ ä¸åŒäºæ•´å‹ï¼Œå‰åå‡ä¼šè¡¥å¡«0. å®šä¹‰æµ®ç‚¹å‹æ—¶ï¼Œéœ€æŒ‡å®šæ€»ä½æ•°å’Œå°æ•°ä½æ•°ã€‚ float(M, D) double(M, D) Mè¡¨ç¤ºæ€»ä½æ•°ï¼ŒDè¡¨ç¤ºå°æ•°ä½æ•°ã€‚ Må’ŒDçš„å¤§å°ä¼šå†³å®šæµ®ç‚¹æ•°çš„èŒƒå›´ã€‚ä¸åŒäºæ•´å‹çš„å›ºå®šèŒƒå›´ã€‚ Mæ—¢è¡¨ç¤ºæ€»ä½æ•°ï¼ˆä¸åŒ…æ‹¬å°æ•°ç‚¹å’Œæ­£è´Ÿå·ï¼‰ï¼Œä¹Ÿè¡¨ç¤ºæ˜¾ç¤ºå®½åº¦ï¼ˆæ‰€æœ‰æ˜¾ç¤ºç¬¦å·å‡åŒ…æ‹¬ï¼‰ã€‚ æ”¯æŒç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºã€‚ æµ®ç‚¹æ•°è¡¨ç¤ºè¿‘ä¼¼å€¼ã€‚ -- c. å®šç‚¹æ•° ---------- decimal -- å¯å˜é•¿åº¦ decimal(M, D) Mä¹Ÿè¡¨ç¤ºæ€»ä½æ•°ï¼ŒDè¡¨ç¤ºå°æ•°ä½æ•°ã€‚ ä¿å­˜ä¸€ä¸ªç²¾ç¡®çš„æ•°å€¼ï¼Œä¸ä¼šå‘ç”Ÿæ•°æ®çš„æ”¹å˜ï¼Œä¸åŒäºæµ®ç‚¹æ•°çš„å››èˆäº”å…¥ã€‚ å°†æµ®ç‚¹æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ¥ä¿å­˜ï¼Œæ¯9ä½æ•°å­—ä¿å­˜ä¸º4ä¸ªå­—èŠ‚ã€‚ 2. å­—ç¬¦ä¸²ç±»å‹ -- a. char, varchar ---------- char å®šé•¿å­—ç¬¦ä¸²ï¼Œé€Ÿåº¦å¿«ï¼Œä½†æµªè´¹ç©ºé—´ varchar å˜é•¿å­—ç¬¦ä¸²ï¼Œé€Ÿåº¦æ…¢ï¼Œä½†èŠ‚çœç©ºé—´ Mè¡¨ç¤ºèƒ½å­˜å‚¨çš„æœ€å¤§é•¿åº¦ï¼Œæ­¤é•¿åº¦æ˜¯å­—ç¬¦æ•°ï¼Œéå­—èŠ‚æ•°ã€‚ ä¸åŒçš„ç¼–ç ï¼Œæ‰€å ç”¨çš„ç©ºé—´ä¸åŒã€‚ char,æœ€å¤š255ä¸ªå­—ç¬¦ï¼Œä¸ç¼–ç æ— å…³ã€‚ varchar,æœ€å¤š65535å­—ç¬¦ï¼Œä¸ç¼–ç æœ‰å…³ã€‚ ä¸€æ¡æœ‰æ•ˆè®°å½•æœ€å¤§ä¸èƒ½è¶…è¿‡65535ä¸ªå­—èŠ‚ã€‚ utf8 æœ€å¤§ä¸º21844ä¸ªå­—ç¬¦ï¼Œgbk æœ€å¤§ä¸º32766ä¸ªå­—ç¬¦ï¼Œlatin1 æœ€å¤§ä¸º65532ä¸ªå­—ç¬¦ varchar æ˜¯å˜é•¿çš„ï¼Œéœ€è¦åˆ©ç”¨å­˜å‚¨ç©ºé—´ä¿å­˜ varchar çš„é•¿åº¦ï¼Œå¦‚æœæ•°æ®å°äº255ä¸ªå­—èŠ‚ï¼Œåˆ™é‡‡ç”¨ä¸€ä¸ªå­—èŠ‚æ¥ä¿å­˜é•¿åº¦ï¼Œåä¹‹éœ€è¦ä¸¤ä¸ªå­—èŠ‚æ¥ä¿å­˜ã€‚ varchar çš„æœ€å¤§æœ‰æ•ˆé•¿åº¦ç”±æœ€å¤§è¡Œå¤§å°å’Œä½¿ç”¨çš„å­—ç¬¦é›†ç¡®å®šã€‚ æœ€å¤§æœ‰æ•ˆé•¿åº¦æ˜¯65532å­—èŠ‚ï¼Œå› ä¸ºåœ¨varcharå­˜å­—ç¬¦ä¸²æ—¶ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ç©ºçš„ï¼Œä¸å­˜åœ¨ä»»ä½•æ•°æ®ï¼Œç„¶åè¿˜éœ€ä¸¤ä¸ªå­—èŠ‚æ¥å­˜æ”¾å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œæ‰€ä»¥æœ‰æ•ˆé•¿åº¦æ˜¯64432-1-2=65532å­—èŠ‚ã€‚ ä¾‹ï¼šè‹¥ä¸€ä¸ªè¡¨å®šä¹‰ä¸º CREATE TABLE tb(c1 int, c2 char(30), c3 varchar(N)) charset=utf8; é—®Nçš„æœ€å¤§å€¼æ˜¯å¤šå°‘ï¼Ÿ ç­”ï¼š(65535-1-2-4-30*3)/3 -- b. blob, text ---------- blob äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼ˆå­—èŠ‚å­—ç¬¦ä¸²ï¼‰ tinyblob, blob, mediumblob, longblob text éäºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼ˆå­—ç¬¦å­—ç¬¦ä¸²ï¼‰ tinytext, text, mediumtext, longtext text åœ¨å®šä¹‰æ—¶ï¼Œä¸éœ€è¦å®šä¹‰é•¿åº¦ï¼Œä¹Ÿä¸ä¼šè®¡ç®—æ€»é•¿åº¦ã€‚ text ç±»å‹åœ¨å®šä¹‰æ—¶ï¼Œä¸å¯ç»™defaultå€¼ -- c. binary, varbinary ---------- ç±»ä¼¼äºcharå’Œvarcharï¼Œç”¨äºä¿å­˜äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯ä¿å­˜å­—èŠ‚å­—ç¬¦ä¸²è€Œéå­—ç¬¦å­—ç¬¦ä¸²ã€‚ char, varchar, text å¯¹åº” binary, varbinary, blob. 3. æ—¥æœŸæ—¶é—´ç±»å‹ ä¸€èˆ¬ç”¨æ•´å‹ä¿å­˜æ—¶é—´æˆ³ï¼Œå› ä¸ºPHPå¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†æ—¶é—´æˆ³è¿›è¡Œæ ¼å¼åŒ–ã€‚ datetime 8å­—èŠ‚ æ—¥æœŸåŠæ—¶é—´ 1000-01-01 00:00:00 åˆ° 9999-12-31 23:59:59 date 3å­—èŠ‚ æ—¥æœŸ 1000-01-01 åˆ° 9999-12-31 timestamp 4å­—èŠ‚ æ—¶é—´æˆ³ 19700101000000 åˆ° 2038-01-19 03:14:07 time 3å­—èŠ‚ æ—¶é—´ -838:59:59 åˆ° 838:59:59 year 1å­—èŠ‚ å¹´ä»½ 1901 - 2155 datetime YYYY-MM-DD hh:mm:ss timestamp YY-MM-DD hh:mm:ss YYYYMMDDhhmmss YYMMDDhhmmss YYYYMMDDhhmmss YYMMDDhhmmss date YYYY-MM-DD YY-MM-DD YYYYMMDD YYMMDD YYYYMMDD YYMMDD time hh:mm:ss hhmmss hhmmss year YYYY YY YYYY YY 4. æšä¸¾å’Œé›†åˆ -- æšä¸¾(enum) ---------- enum(val1, val2, val3...) åœ¨å·²çŸ¥çš„å€¼ä¸­è¿›è¡Œå•é€‰ã€‚æœ€å¤§æ•°é‡ä¸º65535. æšä¸¾å€¼åœ¨ä¿å­˜æ—¶ï¼Œä»¥2ä¸ªå­—èŠ‚çš„æ•´å‹(smallint)ä¿å­˜ã€‚æ¯ä¸ªæšä¸¾å€¼ï¼ŒæŒ‰ä¿å­˜çš„ä½ç½®é¡ºåºï¼Œä»1å¼€å§‹é€ä¸€é€’å¢ã€‚ è¡¨ç°ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œå­˜å‚¨å´æ˜¯æ•´å‹ã€‚ NULLå€¼çš„ç´¢å¼•æ˜¯NULLã€‚ ç©ºå­—ç¬¦ä¸²é”™è¯¯å€¼çš„ç´¢å¼•å€¼æ˜¯0ã€‚ -- é›†åˆï¼ˆsetï¼‰ ---------- set(val1, val2, val3...) create table tab ( gender set('ç”·', 'å¥³', 'æ— ') ); insert into tab values ('ç”·, å¥³'); æœ€å¤šå¯ä»¥æœ‰64ä¸ªä¸åŒçš„æˆå‘˜ã€‚ä»¥bigintå­˜å‚¨ï¼Œå…±8ä¸ªå­—èŠ‚ã€‚é‡‡å–ä½è¿ç®—çš„å½¢å¼ã€‚ å½“åˆ›å»ºè¡¨æ—¶ï¼ŒSETæˆå‘˜å€¼çš„å°¾éƒ¨ç©ºæ ¼å°†è‡ªåŠ¨è¢«åˆ é™¤ã€‚ /* é€‰æ‹©ç±»å‹ */ -- PHPè§’åº¦ 1. åŠŸèƒ½æ»¡è¶³ 2. å­˜å‚¨ç©ºé—´å°½é‡å°ï¼Œå¤„ç†æ•ˆç‡æ›´é«˜ 3. è€ƒè™‘å…¼å®¹é—®é¢˜ -- IPå­˜å‚¨ ---------- 1. åªéœ€å­˜å‚¨ï¼Œå¯ç”¨å­—ç¬¦ä¸² 2. å¦‚æœéœ€è®¡ç®—ï¼ŒæŸ¥æ‰¾ç­‰ï¼Œå¯å­˜å‚¨ä¸º4ä¸ªå­—èŠ‚çš„æ— ç¬¦å·intï¼Œå³unsigned 1) PHPå‡½æ•°è½¬æ¢ ip2longå¯è½¬æ¢ä¸ºæ•´å‹ï¼Œä½†ä¼šå‡ºç°æºå¸¦ç¬¦å·é—®é¢˜ã€‚éœ€æ ¼å¼åŒ–ä¸ºæ— ç¬¦å·çš„æ•´å‹ã€‚ åˆ©ç”¨sprintfå‡½æ•°æ ¼å¼åŒ–å­—ç¬¦ä¸² sprintf(&quot;%u&quot;, ip2long('192.168.3.134')); ç„¶åç”¨long2ipå°†æ•´å‹è½¬å›IPå­—ç¬¦ä¸² 2) MySQLå‡½æ•°è½¬æ¢(æ— ç¬¦å·æ•´å‹ï¼ŒUNSIGNED) INET_ATON('127.0.0.1') å°†IPè½¬ä¸ºæ•´å‹ INET_NTOA(2130706433) å°†æ•´å‹è½¬ä¸ºIP /* åˆ—å±æ€§ï¼ˆåˆ—çº¦æŸï¼‰ */ ------------------ 1. PRIMARY ä¸»é”® - èƒ½å”¯ä¸€æ ‡è¯†è®°å½•çš„å­—æ®µï¼Œå¯ä»¥ä½œä¸ºä¸»é”®ã€‚ - ä¸€ä¸ªè¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ã€‚ - ä¸»é”®å…·æœ‰å”¯ä¸€æ€§ã€‚ - å£°æ˜å­—æ®µæ—¶ï¼Œç”¨ primary key æ ‡è¯†ã€‚ ä¹Ÿå¯ä»¥åœ¨å­—æ®µåˆ—è¡¨ä¹‹åå£°æ˜ ä¾‹ï¼šcreate table tab ( id int, stu varchar(10), primary key (id)); - ä¸»é”®å­—æ®µçš„å€¼ä¸èƒ½ä¸ºnullã€‚ - ä¸»é”®å¯ä»¥ç”±å¤šä¸ªå­—æ®µå…±åŒç»„æˆã€‚æ­¤æ—¶éœ€è¦åœ¨å­—æ®µåˆ—è¡¨åå£°æ˜çš„æ–¹æ³•ã€‚ ä¾‹ï¼šcreate table tab ( id int, stu varchar(10), age int, primary key (stu, age)); 2. UNIQUE å”¯ä¸€ç´¢å¼•ï¼ˆå”¯ä¸€çº¦æŸï¼‰ ä½¿å¾—æŸå­—æ®µçš„å€¼ä¹Ÿä¸èƒ½é‡å¤ã€‚ 3. NULL çº¦æŸ nullä¸æ˜¯æ•°æ®ç±»å‹ï¼Œæ˜¯åˆ—çš„ä¸€ä¸ªå±æ€§ã€‚ è¡¨ç¤ºå½“å‰åˆ—æ˜¯å¦å¯ä»¥ä¸ºnullï¼Œè¡¨ç¤ºä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚ null, å…è®¸ä¸ºç©ºã€‚é»˜è®¤ã€‚ not null, ä¸å…è®¸ä¸ºç©ºã€‚ insert into tab values (null, 'val'); -- æ­¤æ—¶è¡¨ç¤ºå°†ç¬¬ä¸€ä¸ªå­—æ®µçš„å€¼è®¾ä¸ºnull, å–å†³äºè¯¥å­—æ®µæ˜¯å¦å…è®¸ä¸ºnull 4. DEFAULT é»˜è®¤å€¼å±æ€§ å½“å‰å­—æ®µçš„é»˜è®¤å€¼ã€‚ insert into tab values (default, 'val'); -- æ­¤æ—¶è¡¨ç¤ºå¼ºåˆ¶ä½¿ç”¨é»˜è®¤å€¼ã€‚ create table tab ( add_time timestamp default current_timestamp ); -- è¡¨ç¤ºå°†å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³è®¾ä¸ºé»˜è®¤å€¼ã€‚ current_date, current_time 5. AUTO_INCREMENT è‡ªåŠ¨å¢é•¿çº¦æŸ è‡ªåŠ¨å¢é•¿å¿…é¡»ä¸ºç´¢å¼•ï¼ˆä¸»é”®æˆ–uniqueï¼‰ åªèƒ½å­˜åœ¨ä¸€ä¸ªå­—æ®µä¸ºè‡ªåŠ¨å¢é•¿ã€‚ é»˜è®¤ä¸º1å¼€å§‹è‡ªåŠ¨å¢é•¿ã€‚å¯ä»¥é€šè¿‡è¡¨å±æ€§ auto_increment = xè¿›è¡Œè®¾ç½®ï¼Œæˆ– alter table tbl auto_increment = x; 6. COMMENT æ³¨é‡Š ä¾‹ï¼šcreate table tab ( id int ) comment 'æ³¨é‡Šå†…å®¹'; 7. FOREIGN KEY å¤–é”®çº¦æŸ ç”¨äºé™åˆ¶ä¸»è¡¨ä¸ä»è¡¨æ•°æ®å®Œæ•´æ€§ã€‚ alter table t1 add constraint `t1_t2_fk` foreign key (t1_id) references t2(id); -- å°†è¡¨t1çš„t1_idå¤–é”®å…³è”åˆ°è¡¨t2çš„idå­—æ®µã€‚ -- æ¯ä¸ªå¤–é”®éƒ½æœ‰ä¸€ä¸ªåå­—ï¼Œå¯ä»¥é€šè¿‡ constraint æŒ‡å®š å­˜åœ¨å¤–é”®çš„è¡¨ï¼Œç§°ä¹‹ä¸ºä»è¡¨ï¼ˆå­è¡¨ï¼‰ï¼Œå¤–é”®æŒ‡å‘çš„è¡¨ï¼Œç§°ä¹‹ä¸ºä¸»è¡¨ï¼ˆçˆ¶è¡¨ï¼‰ã€‚ ä½œç”¨ï¼šä¿æŒæ•°æ®ä¸€è‡´æ€§ï¼Œå®Œæ•´æ€§ï¼Œä¸»è¦ç›®çš„æ˜¯æ§åˆ¶å­˜å‚¨åœ¨å¤–é”®è¡¨ï¼ˆä»è¡¨ï¼‰ä¸­çš„æ•°æ®ã€‚ MySQLä¸­ï¼Œå¯ä»¥å¯¹InnoDBå¼•æ“ä½¿ç”¨å¤–é”®çº¦æŸï¼š è¯­æ³•ï¼š foreign key (å¤–é”®å­—æ®µï¼‰ references ä¸»è¡¨å (å…³è”å­—æ®µ) [ä¸»è¡¨è®°å½•åˆ é™¤æ—¶çš„åŠ¨ä½œ] [ä¸»è¡¨è®°å½•æ›´æ–°æ—¶çš„åŠ¨ä½œ] æ­¤æ—¶éœ€è¦æ£€æµ‹ä¸€ä¸ªä»è¡¨çš„å¤–é”®éœ€è¦çº¦æŸä¸ºä¸»è¡¨çš„å·²å­˜åœ¨çš„å€¼ã€‚å¤–é”®åœ¨æ²¡æœ‰å…³è”çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è®¾ç½®ä¸ºnull.å‰ææ˜¯è¯¥å¤–é”®åˆ—ï¼Œæ²¡æœ‰not nullã€‚ å¯ä»¥ä¸æŒ‡å®šä¸»è¡¨è®°å½•æ›´æ”¹æˆ–æ›´æ–°æ—¶çš„åŠ¨ä½œï¼Œé‚£ä¹ˆæ­¤æ—¶ä¸»è¡¨çš„æ“ä½œè¢«æ‹’ç»ã€‚ å¦‚æœæŒ‡å®šäº† on update æˆ– on deleteï¼šåœ¨åˆ é™¤æˆ–æ›´æ–°æ—¶ï¼Œæœ‰å¦‚ä¸‹å‡ ä¸ªæ“ä½œå¯ä»¥é€‰æ‹©ï¼š 1. cascadeï¼Œçº§è”æ“ä½œã€‚ä¸»è¡¨æ•°æ®è¢«æ›´æ–°ï¼ˆä¸»é”®å€¼æ›´æ–°ï¼‰ï¼Œä»è¡¨ä¹Ÿè¢«æ›´æ–°ï¼ˆå¤–é”®å€¼æ›´æ–°ï¼‰ã€‚ä¸»è¡¨è®°å½•è¢«åˆ é™¤ï¼Œä»è¡¨ç›¸å…³è®°å½•ä¹Ÿè¢«åˆ é™¤ã€‚ 2. set nullï¼Œè®¾ç½®ä¸ºnullã€‚ä¸»è¡¨æ•°æ®è¢«æ›´æ–°ï¼ˆä¸»é”®å€¼æ›´æ–°ï¼‰ï¼Œä»è¡¨çš„å¤–é”®è¢«è®¾ç½®ä¸ºnullã€‚ä¸»è¡¨è®°å½•è¢«åˆ é™¤ï¼Œä»è¡¨ç›¸å…³è®°å½•å¤–é”®è¢«è®¾ç½®æˆnullã€‚ä½†æ³¨æ„ï¼Œè¦æ±‚è¯¥å¤–é”®åˆ—ï¼Œæ²¡æœ‰not nullå±æ€§çº¦æŸã€‚ 3. restrictï¼Œæ‹’ç»çˆ¶è¡¨åˆ é™¤å’Œæ›´æ–°ã€‚ æ³¨æ„ï¼Œå¤–é”®åªè¢«InnoDBå­˜å‚¨å¼•æ“æ‰€æ”¯æŒã€‚å…¶ä»–å¼•æ“æ˜¯ä¸æ”¯æŒçš„ã€‚ /* å»ºè¡¨è§„èŒƒ */ ------------------ -- Normal Format, NF - æ¯ä¸ªè¡¨ä¿å­˜ä¸€ä¸ªå®ä½“ä¿¡æ¯ - æ¯ä¸ªå…·æœ‰ä¸€ä¸ªIDå­—æ®µä½œä¸ºä¸»é”® - IDä¸»é”® + åŸå­è¡¨ -- 1NF, ç¬¬ä¸€èŒƒå¼ å­—æ®µä¸èƒ½å†åˆ†ï¼Œå°±æ»¡è¶³ç¬¬ä¸€èŒƒå¼ã€‚ -- 2NF, ç¬¬äºŒèŒƒå¼ æ»¡è¶³ç¬¬ä¸€èŒƒå¼çš„å‰æä¸‹ï¼Œä¸èƒ½å‡ºç°éƒ¨åˆ†ä¾èµ–ã€‚ æ¶ˆé™¤ç¬¦åˆä¸»é”®å°±å¯ä»¥é¿å…éƒ¨åˆ†ä¾èµ–ã€‚å¢åŠ å•åˆ—å…³é”®å­—ã€‚ -- 3NF, ç¬¬ä¸‰èŒƒå¼ æ»¡è¶³ç¬¬äºŒèŒƒå¼çš„å‰æä¸‹ï¼Œä¸èƒ½å‡ºç°ä¼ é€’ä¾èµ–ã€‚ æŸä¸ªå­—æ®µä¾èµ–äºä¸»é”®ï¼Œè€Œæœ‰å…¶ä»–å­—æ®µä¾èµ–äºè¯¥å­—æ®µã€‚è¿™å°±æ˜¯ä¼ é€’ä¾èµ–ã€‚ å°†ä¸€ä¸ªå®ä½“ä¿¡æ¯çš„æ•°æ®æ”¾åœ¨ä¸€ä¸ªè¡¨å†…å®ç°ã€‚ /* SELECT */ ------------------ SELECT [ALL|DISTINCT] select_expr FROM -&gt; WHERE -&gt; GROUP BY [åˆè®¡å‡½æ•°] -&gt; HAVING -&gt; ORDER BY -&gt; LIMIT a. select_expr -- å¯ä»¥ç”¨ * è¡¨ç¤ºæ‰€æœ‰å­—æ®µã€‚ select * from tb; -- å¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼ï¼ˆè®¡ç®—å…¬å¼ã€å‡½æ•°è°ƒç”¨ã€å­—æ®µä¹Ÿæ˜¯ä¸ªè¡¨è¾¾å¼ï¼‰ select stu, 29+25, now() from tb; -- å¯ä»¥ä¸ºæ¯ä¸ªåˆ—ä½¿ç”¨åˆ«åã€‚é€‚ç”¨äºç®€åŒ–åˆ—æ ‡è¯†ï¼Œé¿å…å¤šä¸ªåˆ—æ ‡è¯†ç¬¦é‡å¤ã€‚ - ä½¿ç”¨ as å…³é”®å­—ï¼Œä¹Ÿå¯çœç•¥ as. select stu+10 as add10 from tb; b. FROM å­å¥ ç”¨äºæ ‡è¯†æŸ¥è¯¢æ¥æºã€‚ -- å¯ä»¥ä¸ºè¡¨èµ·åˆ«åã€‚ä½¿ç”¨aså…³é”®å­—ã€‚ SELECT * FROM tb1 AS tt, tb2 AS bb; -- fromå­å¥åï¼Œå¯ä»¥åŒæ—¶å‡ºç°å¤šä¸ªè¡¨ã€‚ -- å¤šä¸ªè¡¨ä¼šæ¨ªå‘å åŠ åˆ°ä¸€èµ·ï¼Œè€Œæ•°æ®ä¼šå½¢æˆä¸€ä¸ªç¬›å¡å°”ç§¯ã€‚ SELECT * FROM tb1, tb2; -- å‘ä¼˜åŒ–ç¬¦æç¤ºå¦‚ä½•é€‰æ‹©ç´¢å¼• USE INDEXã€IGNORE INDEXã€FORCE INDEX SELECT * FROM table1 USE INDEX (key1,key2) WHERE key1=1 AND key2=2 AND key3=3; SELECT * FROM table1 IGNORE INDEX (key3) WHERE key1=1 AND key2=2 AND key3=3; c. WHERE å­å¥ -- ä»fromè·å¾—çš„æ•°æ®æºä¸­è¿›è¡Œç­›é€‰ã€‚ -- æ•´å‹1è¡¨ç¤ºçœŸï¼Œ0è¡¨ç¤ºå‡ã€‚ -- è¡¨è¾¾å¼ç”±è¿ç®—ç¬¦å’Œè¿ç®—æ•°ç»„æˆã€‚ -- è¿ç®—æ•°ï¼šå˜é‡ï¼ˆå­—æ®µï¼‰ã€å€¼ã€å‡½æ•°è¿”å›å€¼ -- è¿ç®—ç¬¦ï¼š =, &lt;=&gt;, &lt;&gt;, !=, &lt;=, &lt;, &gt;=, &gt;, !, &amp;&amp;, ||, in (not) null, (not) like, (not) in, (not) between and, is (not), and, or, not, xor is/is not åŠ ä¸Šture/false/unknownï¼Œæ£€éªŒæŸä¸ªå€¼çš„çœŸå‡ &lt;=&gt;ä¸&lt;&gt;åŠŸèƒ½ç›¸åŒï¼Œ&lt;=&gt;å¯ç”¨äºnullæ¯”è¾ƒ d. GROUP BY å­å¥, åˆ†ç»„å­å¥ GROUP BY å­—æ®µ/åˆ«å [æ’åºæ–¹å¼] åˆ†ç»„åä¼šè¿›è¡Œæ’åºã€‚å‡åºï¼šASCï¼Œé™åºï¼šDESC ä»¥ä¸‹[åˆè®¡å‡½æ•°]éœ€é…åˆ GROUP BY ä½¿ç”¨ï¼š count è¿”å›ä¸åŒçš„éNULLå€¼æ•°ç›® count(*)ã€count(å­—æ®µ) sum æ±‚å’Œ max æ±‚æœ€å¤§å€¼ min æ±‚æœ€å°å€¼ avg æ±‚å¹³å‡å€¼ group_concat è¿”å›å¸¦æœ‰æ¥è‡ªä¸€ä¸ªç»„çš„è¿æ¥çš„éNULLå€¼çš„å­—ç¬¦ä¸²ç»“æœã€‚ç»„å†…å­—ç¬¦ä¸²è¿æ¥ã€‚ e. HAVING å­å¥ï¼Œæ¡ä»¶å­å¥ ä¸ where åŠŸèƒ½ã€ç”¨æ³•ç›¸åŒï¼Œæ‰§è¡Œæ—¶æœºä¸åŒã€‚ where åœ¨å¼€å§‹æ—¶æ‰§è¡Œæ£€æµ‹æ•°æ®ï¼Œå¯¹åŸæ•°æ®è¿›è¡Œè¿‡æ»¤ã€‚ having å¯¹ç­›é€‰å‡ºçš„ç»“æœå†æ¬¡è¿›è¡Œè¿‡æ»¤ã€‚ having å­—æ®µå¿…é¡»æ˜¯æŸ¥è¯¢å‡ºæ¥çš„ï¼Œwhere å­—æ®µå¿…é¡»æ˜¯æ•°æ®è¡¨å­˜åœ¨çš„ã€‚ where ä¸å¯ä»¥ä½¿ç”¨å­—æ®µçš„åˆ«åï¼Œhaving å¯ä»¥ã€‚å› ä¸ºæ‰§è¡ŒWHEREä»£ç æ—¶ï¼Œå¯èƒ½å°šæœªç¡®å®šåˆ—å€¼ã€‚ where ä¸å¯ä»¥ä½¿ç”¨åˆè®¡å‡½æ•°ã€‚ä¸€èˆ¬éœ€ç”¨åˆè®¡å‡½æ•°æ‰ä¼šç”¨ having SQLæ ‡å‡†è¦æ±‚HAVINGå¿…é¡»å¼•ç”¨GROUP BYå­å¥ä¸­çš„åˆ—æˆ–ç”¨äºåˆè®¡å‡½æ•°ä¸­çš„åˆ—ã€‚ f. ORDER BY å­å¥ï¼Œæ’åºå­å¥ order by æ’åºå­—æ®µ/åˆ«å æ’åºæ–¹å¼ [,æ’åºå­—æ®µ/åˆ«å æ’åºæ–¹å¼]... å‡åºï¼šASCï¼Œé™åºï¼šDESC æ”¯æŒå¤šä¸ªå­—æ®µçš„æ’åºã€‚ g. LIMIT å­å¥ï¼Œé™åˆ¶ç»“æœæ•°é‡å­å¥ ä»…å¯¹å¤„ç†å¥½çš„ç»“æœè¿›è¡Œæ•°é‡é™åˆ¶ã€‚å°†å¤„ç†å¥½çš„ç»“æœçš„çœ‹ä½œæ˜¯ä¸€ä¸ªé›†åˆï¼ŒæŒ‰ç…§è®°å½•å‡ºç°çš„é¡ºåºï¼Œç´¢å¼•ä»0å¼€å§‹ã€‚ limit èµ·å§‹ä½ç½®, è·å–æ¡æ•° çœç•¥ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºä»ç´¢å¼•0å¼€å§‹ã€‚limit è·å–æ¡æ•° h. DISTINCT, ALL é€‰é¡¹ distinct å»é™¤é‡å¤è®°å½• é»˜è®¤ä¸º all, å…¨éƒ¨è®°å½• /* UNION */ ------------------ å°†å¤šä¸ªselectæŸ¥è¯¢çš„ç»“æœç»„åˆæˆä¸€ä¸ªç»“æœé›†åˆã€‚ SELECT ... UNION [ALL|DISTINCT] SELECT ... é»˜è®¤ DISTINCT æ–¹å¼ï¼Œå³æ‰€æœ‰è¿”å›çš„è¡Œéƒ½æ˜¯å”¯ä¸€çš„ å»ºè®®ï¼Œå¯¹æ¯ä¸ªSELECTæŸ¥è¯¢åŠ ä¸Šå°æ‹¬å·åŒ…è£¹ã€‚ ORDER BY æ’åºæ—¶ï¼Œéœ€åŠ ä¸Š LIMIT è¿›è¡Œç»“åˆã€‚ éœ€è¦å„selectæŸ¥è¯¢çš„å­—æ®µæ•°é‡ä¸€æ ·ã€‚ æ¯ä¸ªselectæŸ¥è¯¢çš„å­—æ®µåˆ—è¡¨(æ•°é‡ã€ç±»å‹)åº”ä¸€è‡´ï¼Œå› ä¸ºç»“æœä¸­çš„å­—æ®µåä»¥ç¬¬ä¸€æ¡selectè¯­å¥ä¸ºå‡†ã€‚ /* å­æŸ¥è¯¢ */ ------------------ - å­æŸ¥è¯¢éœ€ç”¨æ‹¬å·åŒ…è£¹ã€‚ -- fromå‹ fromåè¦æ±‚æ˜¯ä¸€ä¸ªè¡¨ï¼Œå¿…é¡»ç»™å­æŸ¥è¯¢ç»“æœå–ä¸ªåˆ«åã€‚ - ç®€åŒ–æ¯ä¸ªæŸ¥è¯¢å†…çš„æ¡ä»¶ã€‚ - fromå‹éœ€å°†ç»“æœç”Ÿæˆä¸€ä¸ªä¸´æ—¶è¡¨æ ¼ï¼Œå¯ç”¨ä»¥åŸè¡¨çš„é”å®šçš„é‡Šæ”¾ã€‚ - å­æŸ¥è¯¢è¿”å›ä¸€ä¸ªè¡¨ï¼Œè¡¨å‹å­æŸ¥è¯¢ã€‚ select * from (select * from tb where id&gt;0) as subfrom where id&gt;1; -- whereå‹ - å­æŸ¥è¯¢è¿”å›ä¸€ä¸ªå€¼ï¼Œæ ‡é‡å­æŸ¥è¯¢ã€‚ - ä¸éœ€è¦ç»™å­æŸ¥è¯¢å–åˆ«åã€‚ - whereå­æŸ¥è¯¢å†…çš„è¡¨ï¼Œä¸èƒ½ç›´æ¥ç”¨ä»¥æ›´æ–°ã€‚ select * from tb where money = (select max(money) from tb); -- åˆ—å­æŸ¥è¯¢ å¦‚æœå­æŸ¥è¯¢ç»“æœè¿”å›çš„æ˜¯ä¸€åˆ—ã€‚ ä½¿ç”¨ in æˆ– not in å®ŒæˆæŸ¥è¯¢ exists å’Œ not exists æ¡ä»¶ å¦‚æœå­æŸ¥è¯¢è¿”å›æ•°æ®ï¼Œåˆ™è¿”å›1æˆ–0ã€‚å¸¸ç”¨äºåˆ¤æ–­æ¡ä»¶ã€‚ select column1 from t1 where exists (select * from t2); -- è¡Œå­æŸ¥è¯¢ æŸ¥è¯¢æ¡ä»¶æ˜¯ä¸€ä¸ªè¡Œã€‚ select * from t1 where (id, gender) in (select id, gender from t2); è¡Œæ„é€ ç¬¦ï¼š(col1, col2, ...) æˆ– ROW(col1, col2, ...) è¡Œæ„é€ ç¬¦é€šå¸¸ç”¨äºä¸å¯¹èƒ½è¿”å›ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šåˆ—çš„å­æŸ¥è¯¢è¿›è¡Œæ¯”è¾ƒã€‚ -- ç‰¹æ®Šè¿ç®—ç¬¦ != all() ç›¸å½“äº not in = some() ç›¸å½“äº inã€‚any æ˜¯ some çš„åˆ«å != some() ä¸ç­‰åŒäº not inï¼Œä¸ç­‰äºå…¶ä¸­æŸä¸€ä¸ªã€‚ all, some å¯ä»¥é…åˆå…¶ä»–è¿ç®—ç¬¦ä¸€èµ·ä½¿ç”¨ã€‚ /* è¿æ¥æŸ¥è¯¢(join) */ ------------------ å°†å¤šä¸ªè¡¨çš„å­—æ®µè¿›è¡Œè¿æ¥ï¼Œå¯ä»¥æŒ‡å®šè¿æ¥æ¡ä»¶ã€‚ -- å†…è¿æ¥(inner join) - é»˜è®¤å°±æ˜¯å†…è¿æ¥ï¼Œå¯çœç•¥innerã€‚ - åªæœ‰æ•°æ®å­˜åœ¨æ—¶æ‰èƒ½å‘é€è¿æ¥ã€‚å³è¿æ¥ç»“æœä¸èƒ½å‡ºç°ç©ºè¡Œã€‚ on è¡¨ç¤ºè¿æ¥æ¡ä»¶ã€‚å…¶æ¡ä»¶è¡¨è¾¾å¼ä¸whereç±»ä¼¼ã€‚ä¹Ÿå¯ä»¥çœç•¥æ¡ä»¶ï¼ˆè¡¨ç¤ºæ¡ä»¶æ°¸è¿œä¸ºçœŸï¼‰ ä¹Ÿå¯ç”¨whereè¡¨ç¤ºè¿æ¥æ¡ä»¶ã€‚ è¿˜æœ‰ using, ä½†éœ€å­—æ®µåç›¸åŒã€‚ using(å­—æ®µå) -- äº¤å‰è¿æ¥ cross join å³ï¼Œæ²¡æœ‰æ¡ä»¶çš„å†…è¿æ¥ã€‚ select * from tb1 cross join tb2; -- å¤–è¿æ¥(outer join) - å¦‚æœæ•°æ®ä¸å­˜åœ¨ï¼Œä¹Ÿä¼šå‡ºç°åœ¨è¿æ¥ç»“æœä¸­ã€‚ -- å·¦å¤–è¿æ¥ left join å¦‚æœæ•°æ®ä¸å­˜åœ¨ï¼Œå·¦è¡¨è®°å½•ä¼šå‡ºç°ï¼Œè€Œå³è¡¨ä¸ºnullå¡«å…… -- å³å¤–è¿æ¥ right join å¦‚æœæ•°æ®ä¸å­˜åœ¨ï¼Œå³è¡¨è®°å½•ä¼šå‡ºç°ï¼Œè€Œå·¦è¡¨ä¸ºnullå¡«å…… -- è‡ªç„¶è¿æ¥(natural join) è‡ªåŠ¨åˆ¤æ–­è¿æ¥æ¡ä»¶å®Œæˆè¿æ¥ã€‚ ç›¸å½“äºçœç•¥äº†usingï¼Œä¼šè‡ªåŠ¨æŸ¥æ‰¾ç›¸åŒå­—æ®µåã€‚ natural join natural left join natural right join select info.id, info.name, info.stu_num, extra_info.hobby, extra_info.sex from info, extra_info where info.stu_num = extra_info.stu_id; /* å¯¼å…¥å¯¼å‡º */ ------------------ select * into outfile æ–‡ä»¶åœ°å€ [æ§åˆ¶æ ¼å¼] from è¡¨å; -- å¯¼å‡ºè¡¨æ•°æ® load data [local] infile æ–‡ä»¶åœ°å€ [replace|ignore] into table è¡¨å [æ§åˆ¶æ ¼å¼]; -- å¯¼å…¥æ•°æ® ç”Ÿæˆçš„æ•°æ®é»˜è®¤çš„åˆ†éš”ç¬¦æ˜¯åˆ¶è¡¨ç¬¦ localæœªæŒ‡å®šï¼Œåˆ™æ•°æ®æ–‡ä»¶å¿…é¡»åœ¨æœåŠ¡å™¨ä¸Š replace å’Œ ignore å…³é”®è¯æ§åˆ¶å¯¹ç°æœ‰çš„å”¯ä¸€é”®è®°å½•çš„é‡å¤çš„å¤„ç† -- æ§åˆ¶æ ¼å¼ fields æ§åˆ¶å­—æ®µæ ¼å¼ é»˜è®¤ï¼šfields terminated by '\\t' enclosed by '' escaped by '\\\\' terminated by 'string' -- ç»ˆæ­¢ enclosed by 'char' -- åŒ…è£¹ escaped by 'char' -- è½¬ä¹‰ -- ç¤ºä¾‹ï¼š SELECT a,b,a+b INTO OUTFILE '/tmp/result.text' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '&quot;' LINES TERMINATED BY '\\n' FROM test_table; lines æ§åˆ¶è¡Œæ ¼å¼ é»˜è®¤ï¼šlines terminated by '\\n' terminated by 'string' -- ç»ˆæ­¢ /* INSERT */ ------------------ selectè¯­å¥è·å¾—çš„æ•°æ®å¯ä»¥ç”¨insertæ’å…¥ã€‚ å¯ä»¥çœç•¥å¯¹åˆ—çš„æŒ‡å®šï¼Œè¦æ±‚ values () æ‹¬å·å†…ï¼Œæä¾›ç»™äº†æŒ‰ç…§åˆ—é¡ºåºå‡ºç°çš„æ‰€æœ‰å­—æ®µçš„å€¼ã€‚ æˆ–è€…ä½¿ç”¨setè¯­æ³•ã€‚ INSERT INTO tbl_name SET field=value,...ï¼› å¯ä»¥ä¸€æ¬¡æ€§ä½¿ç”¨å¤šä¸ªå€¼ï¼Œé‡‡ç”¨(), (), ();çš„å½¢å¼ã€‚ INSERT INTO tbl_name VALUES (), (), (); å¯ä»¥åœ¨åˆ—å€¼æŒ‡å®šæ—¶ï¼Œä½¿ç”¨è¡¨è¾¾å¼ã€‚ INSERT INTO tbl_name VALUES (field_value, 10+10, now()); å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šå€¼ DEFAULTï¼Œè¡¨ç¤ºè¯¥åˆ—ä½¿ç”¨é»˜è®¤å€¼ã€‚ INSERT INTO tbl_name VALUES (field_value, DEFAULT); å¯ä»¥é€šè¿‡ä¸€ä¸ªæŸ¥è¯¢çš„ç»“æœï¼Œä½œä¸ºéœ€è¦æ’å…¥çš„å€¼ã€‚ INSERT INTO tbl_name SELECT ...; å¯ä»¥æŒ‡å®šåœ¨æ’å…¥çš„å€¼å‡ºç°ä¸»é”®ï¼ˆæˆ–å”¯ä¸€ç´¢å¼•ï¼‰å†²çªæ—¶ï¼Œæ›´æ–°å…¶ä»–éä¸»é”®åˆ—çš„ä¿¡æ¯ã€‚ INSERT INTO tbl_name VALUES/SET/SELECT ON DUPLICATE KEY UPDATE å­—æ®µ=å€¼, â€¦; /* DELETE */ ------------------ DELETE FROM tbl_name [WHERE where_definition] [ORDER BY ...] [LIMIT row_count] æŒ‰ç…§æ¡ä»¶åˆ é™¤ã€‚where æŒ‡å®šåˆ é™¤çš„æœ€å¤šè®°å½•æ•°ã€‚limit å¯ä»¥é€šè¿‡æ’åºæ¡ä»¶åˆ é™¤ã€‚order by + limit æ”¯æŒå¤šè¡¨åˆ é™¤ï¼Œä½¿ç”¨ç±»ä¼¼è¿æ¥è¯­æ³•ã€‚ delete from éœ€è¦åˆ é™¤æ•°æ®å¤šè¡¨1ï¼Œè¡¨2 using è¡¨è¿æ¥æ“ä½œ æ¡ä»¶ã€‚ /* TRUNCATE */ ------------------ TRUNCATE [TABLE] tbl_name æ¸…ç©ºæ•°æ® åˆ é™¤é‡å»ºè¡¨ åŒºåˆ«ï¼š 1ï¼Œtruncate æ˜¯åˆ é™¤è¡¨å†åˆ›å»ºï¼Œdelete æ˜¯é€æ¡åˆ é™¤ 2ï¼Œtruncate é‡ç½®auto_incrementçš„å€¼ã€‚è€Œdeleteä¸ä¼š 3ï¼Œtruncate ä¸çŸ¥é“åˆ é™¤äº†å‡ æ¡ï¼Œè€ŒdeleteçŸ¥é“ã€‚ 4ï¼Œå½“è¢«ç”¨äºå¸¦åˆ†åŒºçš„è¡¨æ—¶ï¼Œtruncate ä¼šä¿ç•™åˆ†åŒº /* å¤‡ä»½ä¸è¿˜åŸ */ ------------------ å¤‡ä»½ï¼Œå°†æ•°æ®çš„ç»“æ„ä¸è¡¨å†…æ•°æ®ä¿å­˜èµ·æ¥ã€‚ åˆ©ç”¨ mysqldump æŒ‡ä»¤å®Œæˆã€‚ -- å¯¼å‡º mysqldump [options] db_name [tables] mysqldump [options] ---database DB1 [DB2 DB3...] mysqldump [options] --all--database 1. å¯¼å‡ºä¸€å¼ è¡¨ mysqldump -uç”¨æˆ·å -på¯†ç  åº“å è¡¨å &gt; æ–‡ä»¶å(D:/a.sql) 2. å¯¼å‡ºå¤šå¼ è¡¨ mysqldump -uç”¨æˆ·å -på¯†ç  åº“å è¡¨1 è¡¨2 è¡¨3 &gt; æ–‡ä»¶å(D:/a.sql) 3. å¯¼å‡ºæ‰€æœ‰è¡¨ mysqldump -uç”¨æˆ·å -på¯†ç  åº“å &gt; æ–‡ä»¶å(D:/a.sql) 4. å¯¼å‡ºä¸€ä¸ªåº“ mysqldump -uç”¨æˆ·å -på¯†ç  --lock-all-tables --database åº“å &gt; æ–‡ä»¶å(D:/a.sql) å¯ä»¥-wæºå¸¦WHEREæ¡ä»¶ -- å¯¼å…¥ 1. åœ¨ç™»å½•mysqlçš„æƒ…å†µä¸‹ï¼š source å¤‡ä»½æ–‡ä»¶ 2. åœ¨ä¸ç™»å½•çš„æƒ…å†µä¸‹ mysql -uç”¨æˆ·å -på¯†ç  åº“å &lt; å¤‡ä»½æ–‡ä»¶ /* è§†å›¾ */ ------------------ ä»€ä¹ˆæ˜¯è§†å›¾ï¼š è§†å›¾æ˜¯ä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼Œå…¶å†…å®¹ç”±æŸ¥è¯¢å®šä¹‰ã€‚åŒçœŸå®çš„è¡¨ä¸€æ ·ï¼Œè§†å›¾åŒ…å«ä¸€ç³»åˆ—å¸¦æœ‰åç§°çš„åˆ—å’Œè¡Œæ•°æ®ã€‚ä½†æ˜¯ï¼Œè§†å›¾å¹¶ä¸åœ¨æ•°æ®åº“ä¸­ä»¥å­˜å‚¨çš„æ•°æ®å€¼é›†å½¢å¼å­˜åœ¨ã€‚è¡Œå’Œåˆ—æ•°æ®æ¥è‡ªç”±å®šä¹‰è§†å›¾çš„æŸ¥è¯¢æ‰€å¼•ç”¨çš„è¡¨ï¼Œå¹¶ä¸”åœ¨å¼•ç”¨è§†å›¾æ—¶åŠ¨æ€ç”Ÿæˆã€‚ è§†å›¾å…·æœ‰è¡¨ç»“æ„æ–‡ä»¶ï¼Œä½†ä¸å­˜åœ¨æ•°æ®æ–‡ä»¶ã€‚ å¯¹å…¶ä¸­æ‰€å¼•ç”¨çš„åŸºç¡€è¡¨æ¥è¯´ï¼Œè§†å›¾çš„ä½œç”¨ç±»ä¼¼äºç­›é€‰ã€‚å®šä¹‰è§†å›¾çš„ç­›é€‰å¯ä»¥æ¥è‡ªå½“å‰æˆ–å…¶å®ƒæ•°æ®åº“çš„ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨ï¼Œæˆ–è€…å…¶å®ƒè§†å›¾ã€‚é€šè¿‡è§†å›¾è¿›è¡ŒæŸ¥è¯¢æ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œé€šè¿‡å®ƒä»¬è¿›è¡Œæ•°æ®ä¿®æ”¹æ—¶çš„é™åˆ¶ä¹Ÿå¾ˆå°‘ã€‚ è§†å›¾æ˜¯å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æŸ¥è¯¢çš„sqlè¯­å¥ï¼Œå®ƒä¸»è¦å‡ºäºä¸¤ç§åŸå› ï¼šå®‰å…¨åŸå› ï¼Œè§†å›¾å¯ä»¥éšè—ä¸€äº›æ•°æ®ï¼Œå¦‚ï¼šç¤¾ä¼šä¿é™©åŸºé‡‘è¡¨ï¼Œå¯ä»¥ç”¨è§†å›¾åªæ˜¾ç¤ºå§“åï¼Œåœ°å€ï¼Œè€Œä¸æ˜¾ç¤ºç¤¾ä¼šä¿é™©å·å’Œå·¥èµ„æ•°ç­‰ï¼Œå¦ä¸€åŸå› æ˜¯å¯ä½¿å¤æ‚çš„æŸ¥è¯¢æ˜“äºç†è§£å’Œä½¿ç”¨ã€‚ -- åˆ›å»ºè§†å›¾ CREATE [OR REPLACE] [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}] VIEW view_name [(column_list)] AS select_statement - è§†å›¾åå¿…é¡»å”¯ä¸€ï¼ŒåŒæ—¶ä¸èƒ½ä¸è¡¨é‡åã€‚ - è§†å›¾å¯ä»¥ä½¿ç”¨selectè¯­å¥æŸ¥è¯¢åˆ°çš„åˆ—åï¼Œä¹Ÿå¯ä»¥è‡ªå·±æŒ‡å®šç›¸åº”çš„åˆ—åã€‚ - å¯ä»¥æŒ‡å®šè§†å›¾æ‰§è¡Œçš„ç®—æ³•ï¼Œé€šè¿‡ALGORITHMæŒ‡å®šã€‚ - column_listå¦‚æœå­˜åœ¨ï¼Œåˆ™æ•°ç›®å¿…é¡»ç­‰äºSELECTè¯­å¥æ£€ç´¢çš„åˆ—æ•° -- æŸ¥çœ‹ç»“æ„ SHOW CREATE VIEW view_name -- åˆ é™¤è§†å›¾ - åˆ é™¤è§†å›¾åï¼Œæ•°æ®ä¾ç„¶å­˜åœ¨ã€‚ - å¯åŒæ—¶åˆ é™¤å¤šä¸ªè§†å›¾ã€‚ DROP VIEW [IF EXISTS] view_name ... -- ä¿®æ”¹è§†å›¾ç»“æ„ - ä¸€èˆ¬ä¸ä¿®æ”¹è§†å›¾ï¼Œå› ä¸ºä¸æ˜¯æ‰€æœ‰çš„æ›´æ–°è§†å›¾éƒ½ä¼šæ˜ å°„åˆ°è¡¨ä¸Šã€‚ ALTER VIEW view_name [(column_list)] AS select_statement -- è§†å›¾ä½œç”¨ 1. ç®€åŒ–ä¸šåŠ¡é€»è¾‘ 2. å¯¹å®¢æˆ·ç«¯éšè—çœŸå®çš„è¡¨ç»“æ„ -- è§†å›¾ç®—æ³•(ALGORITHM) MERGE åˆå¹¶ å°†è§†å›¾çš„æŸ¥è¯¢è¯­å¥ï¼Œä¸å¤–éƒ¨æŸ¥è¯¢éœ€è¦å…ˆåˆå¹¶å†æ‰§è¡Œï¼ TEMPTABLE ä¸´æ—¶è¡¨ å°†è§†å›¾æ‰§è¡Œå®Œæ¯•åï¼Œå½¢æˆä¸´æ—¶è¡¨ï¼Œå†åšå¤–å±‚æŸ¥è¯¢ï¼ UNDEFINED æœªå®šä¹‰(é»˜è®¤)ï¼ŒæŒ‡çš„æ˜¯MySQLè‡ªä¸»å»é€‰æ‹©ç›¸åº”çš„ç®—æ³•ã€‚ /* äº‹åŠ¡(transaction) */ ------------------ äº‹åŠ¡æ˜¯æŒ‡é€»è¾‘ä¸Šçš„ä¸€ç»„æ“ä½œï¼Œç»„æˆè¿™ç»„æ“ä½œçš„å„ä¸ªå•å…ƒï¼Œè¦ä¸å…¨æˆåŠŸè¦ä¸å…¨å¤±è´¥ã€‚ - æ”¯æŒè¿ç»­SQLçš„é›†ä½“æˆåŠŸæˆ–é›†ä½“æ’¤é”€ã€‚ - äº‹åŠ¡æ˜¯æ•°æ®åº“åœ¨æ•°æ®æ™šè‡ªä¹ æ–¹é¢çš„ä¸€ä¸ªåŠŸèƒ½ã€‚ - éœ€è¦åˆ©ç”¨ InnoDB æˆ– BDB å­˜å‚¨å¼•æ“ï¼Œå¯¹è‡ªåŠ¨æäº¤çš„ç‰¹æ€§æ”¯æŒå®Œæˆã€‚ - InnoDBè¢«ç§°ä¸ºäº‹åŠ¡å®‰å…¨å‹å¼•æ“ã€‚ -- äº‹åŠ¡å¼€å¯ START TRANSACTION; æˆ–è€… BEGIN; å¼€å¯äº‹åŠ¡åï¼Œæ‰€æœ‰è¢«æ‰§è¡Œçš„SQLè¯­å¥å‡è¢«è®¤ä½œå½“å‰äº‹åŠ¡å†…çš„SQLè¯­å¥ã€‚ -- äº‹åŠ¡æäº¤ COMMIT; -- äº‹åŠ¡å›æ»š ROLLBACK; å¦‚æœéƒ¨åˆ†æ“ä½œå‘ç”Ÿé—®é¢˜ï¼Œæ˜ å°„åˆ°äº‹åŠ¡å¼€å¯å‰ã€‚ -- äº‹åŠ¡çš„ç‰¹æ€§ 1. åŸå­æ€§ï¼ˆAtomicityï¼‰ äº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆéƒ½å‘ç”Ÿï¼Œè¦ä¹ˆéƒ½ä¸å‘ç”Ÿã€‚ 2. ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ äº‹åŠ¡å‰åæ•°æ®çš„å®Œæ•´æ€§å¿…é¡»ä¿æŒä¸€è‡´ã€‚ - äº‹åŠ¡å¼€å§‹å’Œç»“æŸæ—¶ï¼Œå¤–éƒ¨æ•°æ®ä¸€è‡´ - åœ¨æ•´ä¸ªäº‹åŠ¡è¿‡ç¨‹ä¸­ï¼Œæ“ä½œæ˜¯è¿ç»­çš„ 3. éš”ç¦»æ€§ï¼ˆIsolationï¼‰ å¤šä¸ªç”¨æˆ·å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œä¸€ä¸ªç”¨æˆ·çš„äº‹åŠ¡ä¸èƒ½è¢«å…¶å®ƒç”¨æˆ·çš„äº‹ç‰©æ‰€å¹²æ‰°ï¼Œå¤šä¸ªå¹¶å‘äº‹åŠ¡ä¹‹é—´çš„æ•°æ®è¦ç›¸äº’éš”ç¦»ã€‚ 4. æŒä¹…æ€§ï¼ˆDurabilityï¼‰ ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦è¢«æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„ã€‚ -- äº‹åŠ¡çš„å®ç° 1. è¦æ±‚æ˜¯äº‹åŠ¡æ”¯æŒçš„è¡¨ç±»å‹ 2. æ‰§è¡Œä¸€ç»„ç›¸å…³çš„æ“ä½œå‰å¼€å¯äº‹åŠ¡ 3. æ•´ç»„æ“ä½œå®Œæˆåï¼Œéƒ½æˆåŠŸï¼Œåˆ™æäº¤ï¼›å¦‚æœå­˜åœ¨å¤±è´¥ï¼Œé€‰æ‹©å›æ»šï¼Œåˆ™ä¼šå›åˆ°äº‹åŠ¡å¼€å§‹çš„å¤‡ä»½ç‚¹ã€‚ -- äº‹åŠ¡çš„åŸç† åˆ©ç”¨InnoDBçš„è‡ªåŠ¨æäº¤(autocommit)ç‰¹æ€§å®Œæˆã€‚ æ™®é€šçš„MySQLæ‰§è¡Œè¯­å¥åï¼Œå½“å‰çš„æ•°æ®æäº¤æ“ä½œå‡å¯è¢«å…¶ä»–å®¢æˆ·ç«¯å¯è§ã€‚ è€Œäº‹åŠ¡æ˜¯æš‚æ—¶å…³é—­â€œè‡ªåŠ¨æäº¤â€æœºåˆ¶ï¼Œéœ€è¦commitæäº¤æŒä¹…åŒ–æ•°æ®æ“ä½œã€‚ -- æ³¨æ„ 1. æ•°æ®å®šä¹‰è¯­è¨€ï¼ˆDDLï¼‰è¯­å¥ä¸èƒ½è¢«å›æ»šï¼Œæ¯”å¦‚åˆ›å»ºæˆ–å–æ¶ˆæ•°æ®åº“çš„è¯­å¥ï¼Œå’Œåˆ›å»ºã€å–æ¶ˆæˆ–æ›´æ”¹è¡¨æˆ–å­˜å‚¨çš„å­ç¨‹åºçš„è¯­å¥ã€‚ 2. äº‹åŠ¡ä¸èƒ½è¢«åµŒå¥— -- ä¿å­˜ç‚¹ SAVEPOINT ä¿å­˜ç‚¹åç§° -- è®¾ç½®ä¸€ä¸ªäº‹åŠ¡ä¿å­˜ç‚¹ ROLLBACK TO SAVEPOINT ä¿å­˜ç‚¹åç§° -- å›æ»šåˆ°ä¿å­˜ç‚¹ RELEASE SAVEPOINT ä¿å­˜ç‚¹åç§° -- åˆ é™¤ä¿å­˜ç‚¹ -- InnoDBè‡ªåŠ¨æäº¤ç‰¹æ€§è®¾ç½® SET autocommit = 0|1; 0è¡¨ç¤ºå…³é—­è‡ªåŠ¨æäº¤ï¼Œ1è¡¨ç¤ºå¼€å¯è‡ªåŠ¨æäº¤ã€‚ - å¦‚æœå…³é—­äº†ï¼Œé‚£æ™®é€šæ“ä½œçš„ç»“æœå¯¹å…¶ä»–å®¢æˆ·ç«¯ä¹Ÿä¸å¯è§ï¼Œéœ€è¦commitæäº¤åæ‰èƒ½æŒä¹…åŒ–æ•°æ®æ“ä½œã€‚ - ä¹Ÿå¯ä»¥å…³é—­è‡ªåŠ¨æäº¤æ¥å¼€å¯äº‹åŠ¡ã€‚ä½†ä¸START TRANSACTIONä¸åŒçš„æ˜¯ï¼Œ SET autocommitæ˜¯æ°¸ä¹…æ”¹å˜æœåŠ¡å™¨çš„è®¾ç½®ï¼Œç›´åˆ°ä¸‹æ¬¡å†æ¬¡ä¿®æ”¹è¯¥è®¾ç½®ã€‚(é’ˆå¯¹å½“å‰è¿æ¥) è€ŒSTART TRANSACTIONè®°å½•å¼€å¯å‰çš„çŠ¶æ€ï¼Œè€Œä¸€æ—¦äº‹åŠ¡æäº¤æˆ–å›æ»šåå°±éœ€è¦å†æ¬¡å¼€å¯äº‹åŠ¡ã€‚(é’ˆå¯¹å½“å‰äº‹åŠ¡) /* é”è¡¨ */ è¡¨é”å®šåªç”¨äºé˜²æ­¢å…¶å®ƒå®¢æˆ·ç«¯è¿›è¡Œä¸æ­£å½“åœ°è¯»å–å’Œå†™å…¥ MyISAM æ”¯æŒè¡¨é”ï¼ŒInnoDB æ”¯æŒè¡Œé” -- é”å®š LOCK TABLES tbl_name [AS alias] -- è§£é” UNLOCK TABLES /* è§¦å‘å™¨ */ ------------------ è§¦å‘ç¨‹åºæ˜¯ä¸è¡¨æœ‰å…³çš„å‘½åæ•°æ®åº“å¯¹è±¡ï¼Œå½“è¯¥è¡¨å‡ºç°ç‰¹å®šäº‹ä»¶æ—¶ï¼Œå°†æ¿€æ´»è¯¥å¯¹è±¡ ç›‘å¬ï¼šè®°å½•çš„å¢åŠ ã€ä¿®æ”¹ã€åˆ é™¤ã€‚ -- åˆ›å»ºè§¦å‘å™¨ CREATE TRIGGER trigger_name trigger_time trigger_event ON tbl_name FOR EACH ROW trigger_stmt å‚æ•°ï¼š trigger_timeæ˜¯è§¦å‘ç¨‹åºçš„åŠ¨ä½œæ—¶é—´ã€‚å®ƒå¯ä»¥æ˜¯ before æˆ– afterï¼Œä»¥æŒ‡æ˜è§¦å‘ç¨‹åºæ˜¯åœ¨æ¿€æ´»å®ƒçš„è¯­å¥ä¹‹å‰æˆ–ä¹‹åè§¦å‘ã€‚ trigger_eventæŒ‡æ˜äº†æ¿€æ´»è§¦å‘ç¨‹åºçš„è¯­å¥çš„ç±»å‹ INSERTï¼šå°†æ–°è¡Œæ’å…¥è¡¨æ—¶æ¿€æ´»è§¦å‘ç¨‹åº UPDATEï¼šæ›´æ”¹æŸä¸€è¡Œæ—¶æ¿€æ´»è§¦å‘ç¨‹åº DELETEï¼šä»è¡¨ä¸­åˆ é™¤æŸä¸€è¡Œæ—¶æ¿€æ´»è§¦å‘ç¨‹åº tbl_nameï¼šç›‘å¬çš„è¡¨ï¼Œå¿…é¡»æ˜¯æ°¸ä¹…æ€§çš„è¡¨ï¼Œä¸èƒ½å°†è§¦å‘ç¨‹åºä¸TEMPORARYè¡¨æˆ–è§†å›¾å…³è”èµ·æ¥ã€‚ trigger_stmtï¼šå½“è§¦å‘ç¨‹åºæ¿€æ´»æ—¶æ‰§è¡Œçš„è¯­å¥ã€‚æ‰§è¡Œå¤šä¸ªè¯­å¥ï¼Œå¯ä½¿ç”¨BEGIN...ENDå¤åˆè¯­å¥ç»“æ„ -- åˆ é™¤ DROP TRIGGER [schema_name.]trigger_name å¯ä»¥ä½¿ç”¨oldå’Œnewä»£æ›¿æ—§çš„å’Œæ–°çš„æ•°æ® æ›´æ–°æ“ä½œï¼Œæ›´æ–°å‰æ˜¯oldï¼Œæ›´æ–°åæ˜¯new. åˆ é™¤æ“ä½œï¼Œåªæœ‰old. å¢åŠ æ“ä½œï¼Œåªæœ‰new. -- æ³¨æ„ 1. å¯¹äºå…·æœ‰ç›¸åŒè§¦å‘ç¨‹åºåŠ¨ä½œæ—¶é—´å’Œäº‹ä»¶çš„ç»™å®šè¡¨ï¼Œä¸èƒ½æœ‰ä¸¤ä¸ªè§¦å‘ç¨‹åºã€‚ -- å­—ç¬¦è¿æ¥å‡½æ•° concat(str1,str2,...]) concat_ws(separator,str1,str2,...) -- åˆ†æ”¯è¯­å¥ if æ¡ä»¶ then æ‰§è¡Œè¯­å¥ elseif æ¡ä»¶ then æ‰§è¡Œè¯­å¥ else æ‰§è¡Œè¯­å¥ end if; -- ä¿®æ”¹æœ€å¤–å±‚è¯­å¥ç»“æŸç¬¦ delimiter è‡ªå®šä¹‰ç»“æŸç¬¦å· SQLè¯­å¥ è‡ªå®šä¹‰ç»“æŸç¬¦å· delimiter ; -- ä¿®æ”¹å›åŸæ¥çš„åˆ†å· -- è¯­å¥å—åŒ…è£¹ begin è¯­å¥å— end -- ç‰¹æ®Šçš„æ‰§è¡Œ 1. åªè¦æ·»åŠ è®°å½•ï¼Œå°±ä¼šè§¦å‘ç¨‹åºã€‚ 2. Insert into on duplicate key update è¯­æ³•ä¼šè§¦å‘ï¼š å¦‚æœæ²¡æœ‰é‡å¤è®°å½•ï¼Œä¼šè§¦å‘ before insert, after insert; å¦‚æœæœ‰é‡å¤è®°å½•å¹¶æ›´æ–°ï¼Œä¼šè§¦å‘ before insert, before update, after update; å¦‚æœæœ‰é‡å¤è®°å½•ä½†æ˜¯æ²¡æœ‰å‘ç”Ÿæ›´æ–°ï¼Œåˆ™è§¦å‘ before insert, before update 3. Replace è¯­æ³• å¦‚æœæœ‰è®°å½•ï¼Œåˆ™æ‰§è¡Œ before insert, before delete, after delete, after insert /* SQLç¼–ç¨‹ */ ------------------ --// å±€éƒ¨å˜é‡ ---------- -- å˜é‡å£°æ˜ declare var_name[,...] type [default value] è¿™ä¸ªè¯­å¥è¢«ç”¨æ¥å£°æ˜å±€éƒ¨å˜é‡ã€‚è¦ç»™å˜é‡æä¾›ä¸€ä¸ªé»˜è®¤å€¼ï¼Œè¯·åŒ…å«ä¸€ä¸ªdefaultå­å¥ã€‚å€¼å¯ä»¥è¢«æŒ‡å®šä¸ºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¸éœ€è¦ä¸ºä¸€ä¸ªå¸¸æ•°ã€‚å¦‚æœæ²¡æœ‰defaultå­å¥ï¼Œåˆå§‹å€¼ä¸ºnullã€‚ -- èµ‹å€¼ ä½¿ç”¨ set å’Œ select into è¯­å¥ä¸ºå˜é‡èµ‹å€¼ã€‚ - æ³¨æ„ï¼šåœ¨å‡½æ•°å†…æ˜¯å¯ä»¥ä½¿ç”¨å…¨å±€å˜é‡ï¼ˆç”¨æˆ·è‡ªå®šä¹‰çš„å˜é‡ï¼‰ --// å…¨å±€å˜é‡ ---------- -- å®šä¹‰ã€èµ‹å€¼ set è¯­å¥å¯ä»¥å®šä¹‰å¹¶ä¸ºå˜é‡èµ‹å€¼ã€‚ set @var = value; ä¹Ÿå¯ä»¥ä½¿ç”¨select intoè¯­å¥ä¸ºå˜é‡åˆå§‹åŒ–å¹¶èµ‹å€¼ã€‚è¿™æ ·è¦æ±‚selectè¯­å¥åªèƒ½è¿”å›ä¸€è¡Œï¼Œä½†æ˜¯å¯ä»¥æ˜¯å¤šä¸ªå­—æ®µï¼Œå°±æ„å‘³ç€åŒæ—¶ä¸ºå¤šä¸ªå˜é‡è¿›è¡Œèµ‹å€¼ï¼Œå˜é‡çš„æ•°é‡éœ€è¦ä¸æŸ¥è¯¢çš„åˆ—æ•°ä¸€è‡´ã€‚ è¿˜å¯ä»¥æŠŠèµ‹å€¼è¯­å¥çœ‹ä½œä¸€ä¸ªè¡¨è¾¾å¼ï¼Œé€šè¿‡selectæ‰§è¡Œå®Œæˆã€‚æ­¤æ—¶ä¸ºäº†é¿å…=è¢«å½“ä½œå…³ç³»è¿ç®—ç¬¦çœ‹å¾…ï¼Œä½¿ç”¨:=ä»£æ›¿ã€‚ï¼ˆsetè¯­å¥å¯ä»¥ä½¿ç”¨= å’Œ :=ï¼‰ã€‚ select @var:=20; select @v1:=id, @v2=name from t1 limit 1; select * from tbl_name where @var:=30; select into å¯ä»¥å°†è¡¨ä¸­æŸ¥è¯¢è·å¾—çš„æ•°æ®èµ‹ç»™å˜é‡ã€‚ -| select max(height) into @max_height from tb; -- è‡ªå®šä¹‰å˜é‡å ä¸ºäº†é¿å…selectè¯­å¥ä¸­ï¼Œç”¨æˆ·è‡ªå®šä¹‰çš„å˜é‡ä¸ç³»ç»Ÿæ ‡è¯†ç¬¦ï¼ˆé€šå¸¸æ˜¯å­—æ®µåï¼‰å†²çªï¼Œç”¨æˆ·è‡ªå®šä¹‰å˜é‡åœ¨å˜é‡åå‰ä½¿ç”¨@ä½œä¸ºå¼€å§‹ç¬¦å·ã€‚ @var=10; - å˜é‡è¢«å®šä¹‰åï¼Œåœ¨æ•´ä¸ªä¼šè¯å‘¨æœŸéƒ½æœ‰æ•ˆï¼ˆç™»å½•åˆ°é€€å‡ºï¼‰ --// æ§åˆ¶ç»“æ„ ---------- -- ifè¯­å¥ if search_condition then statement_list [elseif search_condition then statement_list] ... [else statement_list] end if; -- caseè¯­å¥ CASE value WHEN [compare-value] THEN result [WHEN [compare-value] THEN result ...] [ELSE result] END -- whileå¾ªç¯ [begin_label:] while search_condition do statement_list end while [end_label]; - å¦‚æœéœ€è¦åœ¨å¾ªç¯å†…æå‰ç»ˆæ­¢ whileå¾ªç¯ï¼Œåˆ™éœ€è¦ä½¿ç”¨æ ‡ç­¾ï¼›æ ‡ç­¾éœ€è¦æˆå¯¹å‡ºç°ã€‚ -- é€€å‡ºå¾ªç¯ é€€å‡ºæ•´ä¸ªå¾ªç¯ leave é€€å‡ºå½“å‰å¾ªç¯ iterate é€šè¿‡é€€å‡ºçš„æ ‡ç­¾å†³å®šé€€å‡ºå“ªä¸ªå¾ªç¯ --// å†…ç½®å‡½æ•° ---------- -- æ•°å€¼å‡½æ•° abs(x) -- ç»å¯¹å€¼ abs(-10.9) = 10 format(x, d) -- æ ¼å¼åŒ–åƒåˆ†ä½æ•°å€¼ format(1234567.456, 2) = 1,234,567.46 ceil(x) -- å‘ä¸Šå–æ•´ ceil(10.1) = 11 floor(x) -- å‘ä¸‹å–æ•´ floor (10.1) = 10 round(x) -- å››èˆäº”å…¥å»æ•´ mod(m, n) -- m%n m mod n æ±‚ä½™ 10%3=1 pi() -- è·å¾—åœ†å‘¨ç‡ pow(m, n) -- m^n sqrt(x) -- ç®—æœ¯å¹³æ–¹æ ¹ rand() -- éšæœºæ•° truncate(x, d) -- æˆªå–dä½å°æ•° -- æ—¶é—´æ—¥æœŸå‡½æ•° now(), current_timestamp(); -- å½“å‰æ—¥æœŸæ—¶é—´ current_date(); -- å½“å‰æ—¥æœŸ current_time(); -- å½“å‰æ—¶é—´ date('yyyy-mm-dd hh:ii:ss'); -- è·å–æ—¥æœŸéƒ¨åˆ† time('yyyy-mm-dd hh:ii:ss'); -- è·å–æ—¶é—´éƒ¨åˆ† date_format('yyyy-mm-dd hh:ii:ss', '%d %y %a %d %m %b %j'); -- æ ¼å¼åŒ–æ—¶é—´ unix_timestamp(); -- è·å¾—unixæ—¶é—´æˆ³ from_unixtime(); -- ä»æ—¶é—´æˆ³è·å¾—æ—¶é—´ -- å­—ç¬¦ä¸²å‡½æ•° length(string) -- stringé•¿åº¦ï¼Œå­—èŠ‚ char_length(string) -- stringçš„å­—ç¬¦ä¸ªæ•° substring(str, position [,length]) -- ä»strçš„positionå¼€å§‹,å–lengthä¸ªå­—ç¬¦ replace(str ,search_str ,replace_str) -- åœ¨strä¸­ç”¨replace_stræ›¿æ¢search_str instr(string ,substring) -- è¿”å›substringé¦–æ¬¡åœ¨stringä¸­å‡ºç°çš„ä½ç½® concat(string [,...]) -- è¿æ¥å­—ä¸² charset(str) -- è¿”å›å­—ä¸²å­—ç¬¦é›† lcase(string) -- è½¬æ¢æˆå°å†™ left(string, length) -- ä»string2ä¸­çš„å·¦è¾¹èµ·å–lengthä¸ªå­—ç¬¦ load_file(file_name) -- ä»æ–‡ä»¶è¯»å–å†…å®¹ locate(substring, string [,start_position]) -- åŒinstr,ä½†å¯æŒ‡å®šå¼€å§‹ä½ç½® lpad(string, length, pad) -- é‡å¤ç”¨padåŠ åœ¨stringå¼€å¤´,ç›´åˆ°å­—ä¸²é•¿åº¦ä¸ºlength ltrim(string) -- å»é™¤å‰ç«¯ç©ºæ ¼ repeat(string, count) -- é‡å¤countæ¬¡ rpad(string, length, pad) --åœ¨stråç”¨padè¡¥å……,ç›´åˆ°é•¿åº¦ä¸ºlength rtrim(string) -- å»é™¤åç«¯ç©ºæ ¼ strcmp(string1 ,string2) -- é€å­—ç¬¦æ¯”è¾ƒä¸¤å­—ä¸²å¤§å° -- æµç¨‹å‡½æ•° case when [condition] then result [when [condition] then result ...] [else result] end å¤šåˆ†æ”¯ if(expr1,expr2,expr3) åŒåˆ†æ”¯ã€‚ -- èšåˆå‡½æ•° count() sum(); max(); min(); avg(); group_concat() -- å…¶ä»–å¸¸ç”¨å‡½æ•° md5(); default(); --// å­˜å‚¨å‡½æ•°ï¼Œè‡ªå®šä¹‰å‡½æ•° ---------- -- æ–°å»º CREATE FUNCTION function_name (å‚æ•°åˆ—è¡¨) RETURNS è¿”å›å€¼ç±»å‹ å‡½æ•°ä½“ - å‡½æ•°åï¼Œåº”è¯¥åˆæ³•çš„æ ‡è¯†ç¬¦ï¼Œå¹¶ä¸”ä¸åº”è¯¥ä¸å·²æœ‰çš„å…³é”®å­—å†²çªã€‚ - ä¸€ä¸ªå‡½æ•°åº”è¯¥å±äºæŸä¸ªæ•°æ®åº“ï¼Œå¯ä»¥ä½¿ç”¨db_name.funciton_nameçš„å½¢å¼æ‰§è¡Œå½“å‰å‡½æ•°æ‰€å±æ•°æ®åº“ï¼Œå¦åˆ™ä¸ºå½“å‰æ•°æ®åº“ã€‚ - å‚æ•°éƒ¨åˆ†ï¼Œç”±&quot;å‚æ•°å&quot;å’Œ&quot;å‚æ•°ç±»å‹&quot;ç»„æˆã€‚å¤šä¸ªå‚æ•°ç”¨é€—å·éš”å¼€ã€‚ - å‡½æ•°ä½“ç”±å¤šæ¡å¯ç”¨çš„mysqlè¯­å¥ï¼Œæµç¨‹æ§åˆ¶ï¼Œå˜é‡å£°æ˜ç­‰è¯­å¥æ„æˆã€‚ - å¤šæ¡è¯­å¥åº”è¯¥ä½¿ç”¨ begin...end è¯­å¥å—åŒ…å«ã€‚ - ä¸€å®šè¦æœ‰ return è¿”å›å€¼è¯­å¥ã€‚ -- åˆ é™¤ DROP FUNCTION [IF EXISTS] function_name; -- æŸ¥çœ‹ SHOW FUNCTION STATUS LIKE 'partten' SHOW CREATE FUNCTION function_name; -- ä¿®æ”¹ ALTER FUNCTION function_name å‡½æ•°é€‰é¡¹ --// å­˜å‚¨è¿‡ç¨‹ï¼Œè‡ªå®šä¹‰åŠŸèƒ½ ---------- -- å®šä¹‰ å­˜å‚¨å­˜å‚¨è¿‡ç¨‹ æ˜¯ä¸€æ®µä»£ç ï¼ˆè¿‡ç¨‹ï¼‰ï¼Œå­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„sqlç»„æˆã€‚ ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹é€šå¸¸ç”¨äºå®Œæˆä¸€æ®µä¸šåŠ¡é€»è¾‘ï¼Œä¾‹å¦‚æŠ¥åï¼Œäº¤ç­è´¹ï¼Œè®¢å•å…¥åº“ç­‰ã€‚ è€Œä¸€ä¸ªå‡½æ•°é€šå¸¸ä¸“æ³¨ä¸æŸä¸ªåŠŸèƒ½ï¼Œè§†ä¸ºå…¶ä»–ç¨‹åºæœåŠ¡çš„ï¼Œéœ€è¦åœ¨å…¶ä»–è¯­å¥ä¸­è°ƒç”¨å‡½æ•°æ‰å¯ä»¥ï¼Œè€Œå­˜å‚¨è¿‡ç¨‹ä¸èƒ½è¢«å…¶ä»–è°ƒç”¨ï¼Œæ˜¯è‡ªå·±æ‰§è¡Œ é€šè¿‡callæ‰§è¡Œã€‚ -- åˆ›å»º CREATE PROCEDURE sp_name (å‚æ•°åˆ—è¡¨) è¿‡ç¨‹ä½“ å‚æ•°åˆ—è¡¨ï¼šä¸åŒäºå‡½æ•°çš„å‚æ•°åˆ—è¡¨ï¼Œéœ€è¦æŒ‡æ˜å‚æ•°ç±»å‹ INï¼Œè¡¨ç¤ºè¾“å…¥å‹ OUTï¼Œè¡¨ç¤ºè¾“å‡ºå‹ INOUTï¼Œè¡¨ç¤ºæ··åˆå‹ æ³¨æ„ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚ /* å­˜å‚¨è¿‡ç¨‹ */ ------------------ å­˜å‚¨è¿‡ç¨‹æ˜¯ä¸€æ®µå¯æ‰§è¡Œæ€§ä»£ç çš„é›†åˆã€‚ç›¸æ¯”å‡½æ•°ï¼Œæ›´åå‘äºä¸šåŠ¡é€»è¾‘ã€‚ è°ƒç”¨ï¼šCALL è¿‡ç¨‹å -- æ³¨æ„ - æ²¡æœ‰è¿”å›å€¼ã€‚ - åªèƒ½å•ç‹¬è°ƒç”¨ï¼Œä¸å¯å¤¹æ‚åœ¨å…¶ä»–è¯­å¥ä¸­ -- å‚æ•° IN|OUT|INOUT å‚æ•°å æ•°æ®ç±»å‹ IN è¾“å…¥ï¼šåœ¨è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œå°†æ•°æ®è¾“å…¥åˆ°è¿‡ç¨‹ä½“å†…éƒ¨çš„å‚æ•° OUT è¾“å‡ºï¼šåœ¨è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œå°†è¿‡ç¨‹ä½“å¤„ç†å®Œçš„ç»“æœè¿”å›åˆ°å®¢æˆ·ç«¯ INOUT è¾“å…¥è¾“å‡ºï¼šæ—¢å¯è¾“å…¥ï¼Œä¹Ÿå¯è¾“å‡º -- è¯­æ³• CREATE PROCEDURE è¿‡ç¨‹å (å‚æ•°åˆ—è¡¨) BEGIN è¿‡ç¨‹ä½“ END /* ç”¨æˆ·å’Œæƒé™ç®¡ç† */ ------------------ -- rootå¯†ç é‡ç½® 1. åœæ­¢MySQLæœåŠ¡ 2. [Linux] /usr/local/mysql/bin/safe_mysqld --skip-grant-tables &amp; [Windows] mysqld --skip-grant-tables 3. use mysql; 4. UPDATE `user` SET PASSWORD=PASSWORD(&quot;å¯†ç &quot;) WHERE `user` = &quot;root&quot;; 5. FLUSH PRIVILEGES; ç”¨æˆ·ä¿¡æ¯è¡¨ï¼šmysql.user -- åˆ·æ–°æƒé™ FLUSH PRIVILEGES; -- å¢åŠ ç”¨æˆ· CREATE USER ç”¨æˆ·å IDENTIFIED BY [PASSWORD] å¯†ç (å­—ç¬¦ä¸²) - å¿…é¡»æ‹¥æœ‰mysqlæ•°æ®åº“çš„å…¨å±€CREATE USERæƒé™ï¼Œæˆ–æ‹¥æœ‰INSERTæƒé™ã€‚ - åªèƒ½åˆ›å»ºç”¨æˆ·ï¼Œä¸èƒ½èµ‹äºˆæƒé™ã€‚ - ç”¨æˆ·åï¼Œæ³¨æ„å¼•å·ï¼šå¦‚ 'user_name'@'192.168.1.1' - å¯†ç ä¹Ÿéœ€å¼•å·ï¼Œçº¯æ•°å­—å¯†ç ä¹Ÿè¦åŠ å¼•å· - è¦åœ¨çº¯æ–‡æœ¬ä¸­æŒ‡å®šå¯†ç ï¼Œéœ€å¿½ç•¥PASSWORDå…³é”®è¯ã€‚è¦æŠŠå¯†ç æŒ‡å®šä¸ºç”±PASSWORD()å‡½æ•°è¿”å›çš„æ··ç¼–å€¼ï¼Œéœ€åŒ…å«å…³é”®å­—PASSWORD -- é‡å‘½åç”¨æˆ· RENAME USER old_user TO new_user -- è®¾ç½®å¯†ç  SET PASSWORD = PASSWORD('å¯†ç ') -- ä¸ºå½“å‰ç”¨æˆ·è®¾ç½®å¯†ç  SET PASSWORD FOR ç”¨æˆ·å = PASSWORD('å¯†ç ') -- ä¸ºæŒ‡å®šç”¨æˆ·è®¾ç½®å¯†ç  -- åˆ é™¤ç”¨æˆ· DROP USER ç”¨æˆ·å -- åˆ†é…æƒé™/æ·»åŠ ç”¨æˆ· GRANT æƒé™åˆ—è¡¨ ON è¡¨å TO ç”¨æˆ·å [IDENTIFIED BY [PASSWORD] 'password'] - all privileges è¡¨ç¤ºæ‰€æœ‰æƒé™ - *.* è¡¨ç¤ºæ‰€æœ‰åº“çš„æ‰€æœ‰è¡¨ - åº“å.è¡¨å è¡¨ç¤ºæŸåº“ä¸‹é¢çš„æŸè¡¨ GRANT ALL PRIVILEGES ON `pms`.* TO 'pms'@'%' IDENTIFIED BY 'pms0817'; -- æŸ¥çœ‹æƒé™ SHOW GRANTS FOR ç”¨æˆ·å -- æŸ¥çœ‹å½“å‰ç”¨æˆ·æƒé™ SHOW GRANTS; æˆ– SHOW GRANTS FOR CURRENT_USER; æˆ– SHOW GRANTS FOR CURRENT_USER(); -- æ’¤æ¶ˆæƒé™ REVOKE æƒé™åˆ—è¡¨ ON è¡¨å FROM ç”¨æˆ·å REVOKE ALL PRIVILEGES, GRANT OPTION FROM ç”¨æˆ·å -- æ’¤é”€æ‰€æœ‰æƒé™ -- æƒé™å±‚çº§ -- è¦ä½¿ç”¨GRANTæˆ–REVOKEï¼Œæ‚¨å¿…é¡»æ‹¥æœ‰GRANT OPTIONæƒé™ï¼Œå¹¶ä¸”æ‚¨å¿…é¡»ç”¨äºæ‚¨æ­£åœ¨æˆäºˆæˆ–æ’¤é”€çš„æƒé™ã€‚ å…¨å±€å±‚çº§ï¼šå…¨å±€æƒé™é€‚ç”¨äºä¸€ä¸ªç»™å®šæœåŠ¡å™¨ä¸­çš„æ‰€æœ‰æ•°æ®åº“ï¼Œmysql.user GRANT ALL ON *.*å’Œ REVOKE ALL ON *.*åªæˆäºˆå’Œæ’¤é”€å…¨å±€æƒé™ã€‚ æ•°æ®åº“å±‚çº§ï¼šæ•°æ®åº“æƒé™é€‚ç”¨äºä¸€ä¸ªç»™å®šæ•°æ®åº“ä¸­çš„æ‰€æœ‰ç›®æ ‡ï¼Œmysql.db, mysql.host GRANT ALL ON db_name.*å’ŒREVOKE ALL ON db_name.*åªæˆäºˆå’Œæ’¤é”€æ•°æ®åº“æƒé™ã€‚ è¡¨å±‚çº§ï¼šè¡¨æƒé™é€‚ç”¨äºä¸€ä¸ªç»™å®šè¡¨ä¸­çš„æ‰€æœ‰åˆ—ï¼Œmysql.talbes_priv GRANT ALL ON db_name.tbl_nameå’ŒREVOKE ALL ON db_name.tbl_nameåªæˆäºˆå’Œæ’¤é”€è¡¨æƒé™ã€‚ åˆ—å±‚çº§ï¼šåˆ—æƒé™é€‚ç”¨äºä¸€ä¸ªç»™å®šè¡¨ä¸­çš„å•ä¸€åˆ—ï¼Œmysql.columns_priv å½“ä½¿ç”¨REVOKEæ—¶ï¼Œæ‚¨å¿…é¡»æŒ‡å®šä¸è¢«æˆæƒåˆ—ç›¸åŒçš„åˆ—ã€‚ -- æƒé™åˆ—è¡¨ ALL [PRIVILEGES] -- è®¾ç½®é™¤GRANT OPTIONä¹‹å¤–çš„æ‰€æœ‰ç®€å•æƒé™ ALTER -- å…è®¸ä½¿ç”¨ALTER TABLE ALTER ROUTINE -- æ›´æ”¹æˆ–å–æ¶ˆå·²å­˜å‚¨çš„å­ç¨‹åº CREATE -- å…è®¸ä½¿ç”¨CREATE TABLE CREATE ROUTINE -- åˆ›å»ºå·²å­˜å‚¨çš„å­ç¨‹åº CREATE TEMPORARY TABLES -- å…è®¸ä½¿ç”¨CREATE TEMPORARY TABLE CREATE USER -- å…è®¸ä½¿ç”¨CREATE USER, DROP USER, RENAME USERå’ŒREVOKE ALL PRIVILEGESã€‚ CREATE VIEW -- å…è®¸ä½¿ç”¨CREATE VIEW DELETE -- å…è®¸ä½¿ç”¨DELETE DROP -- å…è®¸ä½¿ç”¨DROP TABLE EXECUTE -- å…è®¸ç”¨æˆ·è¿è¡Œå·²å­˜å‚¨çš„å­ç¨‹åº FILE -- å…è®¸ä½¿ç”¨SELECT...INTO OUTFILEå’ŒLOAD DATA INFILE INDEX -- å…è®¸ä½¿ç”¨CREATE INDEXå’ŒDROP INDEX INSERT -- å…è®¸ä½¿ç”¨INSERT LOCK TABLES -- å…è®¸å¯¹æ‚¨æ‹¥æœ‰SELECTæƒé™çš„è¡¨ä½¿ç”¨LOCK TABLES PROCESS -- å…è®¸ä½¿ç”¨SHOW FULL PROCESSLIST REFERENCES -- æœªè¢«å®æ–½ RELOAD -- å…è®¸ä½¿ç”¨FLUSH REPLICATION CLIENT -- å…è®¸ç”¨æˆ·è¯¢é—®ä»å±æœåŠ¡å™¨æˆ–ä¸»æœåŠ¡å™¨çš„åœ°å€ REPLICATION SLAVE -- ç”¨äºå¤åˆ¶å‹ä»å±æœåŠ¡å™¨ï¼ˆä»ä¸»æœåŠ¡å™¨ä¸­è¯»å–äºŒè¿›åˆ¶æ—¥å¿—äº‹ä»¶ï¼‰ SELECT -- å…è®¸ä½¿ç”¨SELECT SHOW DATABASES -- æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“ SHOW VIEW -- å…è®¸ä½¿ç”¨SHOW CREATE VIEW SHUTDOWN -- å…è®¸ä½¿ç”¨mysqladmin shutdown SUPER -- å…è®¸ä½¿ç”¨CHANGE MASTER, KILL, PURGE MASTER LOGSå’ŒSET GLOBALè¯­å¥ï¼Œmysqladmin debugå‘½ä»¤ï¼›å…è®¸æ‚¨è¿æ¥ï¼ˆä¸€æ¬¡ï¼‰ï¼Œå³ä½¿å·²è¾¾åˆ°max_connectionsã€‚ UPDATE -- å…è®¸ä½¿ç”¨UPDATE USAGE -- â€œæ— æƒé™â€çš„åŒä¹‰è¯ GRANT OPTION -- å…è®¸æˆäºˆæƒé™ /* è¡¨ç»´æŠ¤ */ -- åˆ†æå’Œå­˜å‚¨è¡¨çš„å…³é”®å­—åˆ†å¸ƒ ANALYZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE è¡¨å ... -- æ£€æŸ¥ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨æ˜¯å¦æœ‰é”™è¯¯ CHECK TABLE tbl_name [, tbl_name] ... [option] ... option = {QUICK | FAST | MEDIUM | EXTENDED | CHANGED} -- æ•´ç†æ•°æ®æ–‡ä»¶çš„ç¢ç‰‡ OPTIMIZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ... /* æ‚é¡¹ */ ------------------ 1. å¯ç”¨åå¼•å·ï¼ˆ`ï¼‰ä¸ºæ ‡è¯†ç¬¦ï¼ˆåº“åã€è¡¨åã€å­—æ®µåã€ç´¢å¼•ã€åˆ«åï¼‰åŒ…è£¹ï¼Œä»¥é¿å…ä¸å…³é”®å­—é‡åï¼ä¸­æ–‡ä¹Ÿå¯ä»¥ä½œä¸ºæ ‡è¯†ç¬¦ï¼ 2. æ¯ä¸ªåº“ç›®å½•å­˜åœ¨ä¸€ä¸ªä¿å­˜å½“å‰æ•°æ®åº“çš„é€‰é¡¹æ–‡ä»¶db.optã€‚ 3. æ³¨é‡Šï¼š å•è¡Œæ³¨é‡Š # æ³¨é‡Šå†…å®¹ å¤šè¡Œæ³¨é‡Š /* æ³¨é‡Šå†…å®¹ */ å•è¡Œæ³¨é‡Š -- æ³¨é‡Šå†…å®¹ (æ ‡å‡†SQLæ³¨é‡Šé£æ ¼ï¼Œè¦æ±‚åŒç ´æŠ˜å·ååŠ ä¸€ç©ºæ ¼ç¬¦ï¼ˆç©ºæ ¼ã€TABã€æ¢è¡Œç­‰ï¼‰) 4. æ¨¡å¼é€šé…ç¬¦ï¼š _ ä»»æ„å•ä¸ªå­—ç¬¦ % ä»»æ„å¤šä¸ªå­—ç¬¦ï¼Œç”šè‡³åŒ…æ‹¬é›¶å­—ç¬¦ å•å¼•å·éœ€è¦è¿›è¡Œè½¬ä¹‰ \\' 5. CMDå‘½ä»¤è¡Œå†…çš„è¯­å¥ç»“æŸç¬¦å¯ä»¥ä¸º &quot;;&quot;, &quot;\\G&quot;, &quot;\\g&quot;ï¼Œä»…å½±å“æ˜¾ç¤ºç»“æœã€‚å…¶ä»–åœ°æ–¹è¿˜æ˜¯ç”¨åˆ†å·ç»“æŸã€‚delimiter å¯ä¿®æ”¹å½“å‰å¯¹è¯çš„è¯­å¥ç»“æŸç¬¦ã€‚ 6. SQLå¯¹å¤§å°å†™ä¸æ•æ„Ÿ 7. æ¸…é™¤å·²æœ‰è¯­å¥ï¼š\\c ","tags":[{"name":"MySQL","slug":"mysql","used":true,"link":"https://blog.qxxiao.eu.org/tag/mysql/"}],"title":"MySQLç¬”è®°","feature":"","link":"https://blog.qxxiao.eu.org/post/mysql-notes/","stats":{"text":"40 min read","time":2391000,"words":10205,"minutes":40},"date":"2022-03-10 00:47:45","dateFormat":"2022-03-10","isTop":false},{"content":"Markdownæµ‹è¯• 1. æ’ç‰ˆ ç²—ä½“æ–‡æœ¬ æ–œä½“æ–‡æœ¬ è¿™æ˜¯ä¸€æ®µé”™è¯¯çš„æ–‡æœ¬ é«˜äº® è¡Œå†…ä»£ç  å¼•ç”¨ï¼š This is a block with tow paragraphs. This is first paragraph. æ— åºåˆ—è¡¨*/+/-ï¼š æ”¯æŒVim æ”¯æŒEmacs å…¶ä»– vscode atom æœ‰åºåˆ—è¡¨ï¼š é¡¹ç›®1 é¡¹ç›®2 å­é¡¹ç›®1 å­é¡¹ç›®2 ä»»åŠ¡æ¸…å• ä¸€é¡¹ä»»åŠ¡(ä½¿ç”¨ - [ ] ) ä¸€é¡¹å®Œæˆçš„ä»»åŠ¡ï¼ˆä½¿ç”¨ - [x] ) å„çº§æ ‡é¢˜ï¼š # æ ‡é¢˜1 ## æ ‡é¢˜2 ### æ ‡é¢˜3 #### æ ‡é¢˜4 ##### æ ‡é¢˜5 2. å›¾ç‰‡ä¸é“¾æ¥ å›¾ç‰‡: é“¾æ¥ï¼š ä¸»é¡µçš„é“¾æ¥ é”šç‚¹/å†…éƒ¨é“¾æ¥ï¼š æ ‡é¢˜1. æ’ç‰ˆ å‚è€ƒé“¾æ¥ï¼š(ä¸€ä¸ªé“¾æ¥å¤šæ¬¡ä½¿ç”¨) (è¿™é‡Œä¸æ”¯æŒ) æ–‡ä¸­å†™æ³•[é“¾æ¥æ–‡å­—][é“¾æ¥æ ‡è®°]ï¼Œåœ¨æ–‡æœ¬çš„ä»»æ„ä½ç½®æ·»åŠ [é“¾æ¥æ ‡è®°]:é“¾æ¥åœ°å€ &quot;é“¾æ¥æ ‡é¢˜&quot;ã€‚ This is [a link to Google][1] by using reference link. [1]:https://www.google.com &quot;Google&quot; 3. ä»£ç é«˜äº® ç¤ºä¾‹ï¼š #include &lt;iostream&gt; using namespace std; int main() { cout &lt;&lt; &quot;hello world!&quot; &lt;&lt; endl; return 0; } class Employee: empCount = 0 def __init__(self, name, salary): self.name = name self.salary = salary Employee.empCount += 1 4. Markdown æ‰©å±• è¡¨æ ¼ å¯ä»¥æŒ‡å®šå¯¹é½æ–¹å¼, å¦‚Itemåˆ—å·¦å¯¹é½, Valueåˆ—å³å¯¹é½, Qtyåˆ—å±…ä¸­å¯¹é½ Item Value Qty Computer $1600 5 Phone $12 12 Pipe $1 234 htmlæ ‡ç­¾ &lt;font color=&quot;red&quot;&gt;è¿™æ˜¯ä¸€æ®µæ–‡å­—ã€‚&lt;/font&gt; &lt;span style=&quot;background-color: skyblue&quot;&gt;è¿™æ˜¯ä¸€æ®µæ–‡å­—ã€‚&lt;/span&gt; &lt;img src=&quot;https://pic.qxxiao.cn/itab.jpeg&quot; width=&quot;50px&quot; /&gt; &lt;!-- è¡¨æ ¼ --&gt; &lt;table&gt; &lt;tr&gt; &lt;th rowspan=&quot;2&quot;&gt;å€¼ç­äººå‘˜&lt;/th&gt; &lt;th&gt;æ˜ŸæœŸä¸€&lt;/th&gt; &lt;th&gt;æ˜ŸæœŸäºŒ&lt;/th&gt; &lt;th&gt;æ˜ŸæœŸä¸‰&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;æå¼º&lt;/td&gt; &lt;td&gt;å¼ æ˜&lt;/td&gt; &lt;td&gt;ç‹å¹³&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; è¿™æ˜¯ä¸€æ®µæ–‡å­—ã€‚ è¿™æ˜¯ä¸€æ®µæ–‡å­—ã€‚ å€¼ç­äººå‘˜ æ˜ŸæœŸä¸€ æ˜ŸæœŸäºŒ æ˜ŸæœŸä¸‰ æå¼º å¼ æ˜ ç‹å¹³ è„šæ³¨ Leetcode[1]åˆ›å»ºä¸€ä¸ªè„šæ³¨ã€‚ ä½¿ç”¨^nè‡ªåŠ¨å¢åŠ æ•°å­—ã€‚ä¾‹å¦‚è¿™é‡Œ[2]åˆ›å»ºä¸€ä¸ªè„šæ³¨ã€‚ å…¬å¼ ä½¿ç”¨Katexæ¸²æŸ“ è¡Œå†…å…¬å¼ï¼š E=mc2E=mc^2E=mc2 å—å…¬å¼ï¼š f(x1,xx,â€¦,xn)=x12+x22+â‹¯+xn2f(x_1,x_x,\\ldots,x_n) = x_1^2 + x_2^2 + \\cdots + x_n^2 f(x1â€‹,xxâ€‹,â€¦,xnâ€‹)=x12â€‹+x22â€‹+â‹¯+xn2â€‹ âˆ‘k=0jâˆ’1Î³^kjzk\\sum^{j-1}_{k=0}{\\widehat{\\gamma}_{kj} z_k} k=0âˆ‘jâˆ’1â€‹Î³â€‹kjâ€‹zkâ€‹ V1Ã—V2=âˆ£ijkâˆ‚Xâˆ‚uâˆ‚Yâˆ‚u0âˆ‚Xâˆ‚vâˆ‚Yâˆ‚v0âˆ£\\mathbf{V}_1 \\times \\mathbf{V}_2 = \\begin{vmatrix} \\mathbf{i} &amp; \\mathbf{j} &amp; \\mathbf{k} \\\\ \\frac{\\partial X}{\\partial u} &amp; \\frac{\\partial Y}{\\partial u} &amp; 0 \\\\ \\frac{\\partial X}{\\partial v} &amp; \\frac{\\partial Y}{\\partial v} &amp; 0 \\\\ \\end{vmatrix} V1â€‹Ã—V2â€‹=âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹iâˆ‚uâˆ‚Xâ€‹âˆ‚vâˆ‚Xâ€‹â€‹jâˆ‚uâˆ‚Yâ€‹âˆ‚vâˆ‚Yâ€‹â€‹k00â€‹âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹ or: M(e1)âˆ—M(e2)=M(e1)â‹…[V(e220)V(e221)â‹¯V(e22wâˆ’1)]=[V(e1e220)V(e1e221)â‹¯V(e1e22wâˆ’1)]=M(e1e2)\\begin{aligned} M(e_1)*M(e_2) &amp;= M(e_1) \\cdot \\begin{bmatrix} V(e_22^0) &amp; V(e_22^1) &amp; \\cdots &amp; V(e_22^{w-1}) \\end{bmatrix} \\\\ &amp;= \\begin{bmatrix} V(e_1e_22^0) &amp; V(e_1e_22^1) &amp; \\cdots &amp; V(e_1e_22^{w-1}) \\end{bmatrix} \\\\ &amp;= M(e_1e_2) \\end{aligned}M(e1â€‹)âˆ—M(e2â€‹)â€‹=M(e1â€‹)â‹…[V(e2â€‹20)â€‹V(e2â€‹21)â€‹â‹¯â€‹V(e2â€‹2wâˆ’1)â€‹]=[V(e1â€‹e2â€‹20)â€‹V(e1â€‹e2â€‹21)â€‹â‹¯â€‹V(e1â€‹e2â€‹2wâˆ’1)â€‹]=M(e1â€‹e2â€‹)â€‹ å…¶ä»– æ°´å¹³çº¿ (ä¸æ”¯æŒï¼Œä½¿ç”¨htmlæ ‡ç­¾) ä¸‹åˆ’çº¿ &lt;u&gt;abcdef&lt;/u&gt; This is a underline sentence. ä¸‹åˆ’çº¿ &lt;span style=&quot;border-bottom: 2px solid red;&quot;&gt;æ¢¯åº¦åœºå¿…æ˜¯æ— æ—‹åœº&lt;/span&gt; æ¢¯åº¦åœºå¿…æ˜¯æ— æ—‹åœº è¡¨æƒ…ç¬¦å·: :simle (ä¸æ”¯æŒ) :simle YAML Front Matter å¯ä»¥ç¼–è¾‘é¡µé¢å…ƒæ•°æ® --- title: 'Markdownä¸»é¢˜æµ‹è¯•' date: 2022-04-12 tags: [markdown] published: true hideInList: false feature: isTop: false --- Markdownæµ‹è¯• &lt;!-- more --&gt; Table of Contents(TOC) è¿™é‡Œéœ€è¦ä½¿ç”¨ @[TOC] æ¥ç”Ÿæˆ 1. æ’ç‰ˆ 2. å›¾ç‰‡ä¸é“¾æ¥ 3. ä»£ç é«˜äº® 4. Markdown æ‰©å±• è¡¨æ ¼ htmlæ ‡ç­¾ è„šæ³¨ å…¬å¼ å…¶ä»– Leetcodeæ˜¯ä¸€ä¸ªåˆ·é¢˜ç½‘ç«™ã€‚ â†©ï¸ hello world...... â†©ï¸ ","tags":[{"name":"Markdown","slug":"markdown","used":true,"link":"https://blog.qxxiao.eu.org/tag/markdown/"}],"title":"Markdownä¸»é¢˜æµ‹è¯•","feature":"","link":"https://blog.qxxiao.eu.org/post/markdown-test/","stats":{"text":"5 min read","time":269000,"words":903,"minutes":5},"date":"2022-01-06 23:22:18","dateFormat":"2022-01-06","isTop":false},{"content":"åŸºäºGrideaçš„Rockyä¸»é¢˜ä½¿ç”¨è®°å½•ï¼Œä¿®æ”¹äº†éƒ¨åˆ†æ ·å¼ï¼Œä¸»è¦å˜æ›´å¯ä»¥æŸ¥çœ‹æ›´æ–°æ—¥å¿—ã€‚éƒ¨åˆ†å‚è€ƒå¼•ç”¨åšå®¢å‚è€ƒï¼Œå‘è¿™äº›ä½œè€…è¡¨ç¤ºæ„Ÿè°¢ã€‚ æœ€è¿‘çš„æ›´æ–°ï¼šæŸ¥çœ‹æ›´æ–°æ—¥å¿— headerä¿®æ”¹ ç§»åŠ¨RSSåˆ°footer ä¿®æ”¹templates\\includes\\header.ejsï¼Œåˆ é™¤RSSå†…å®¹ &lt;a href=&quot;&lt;%= themeConfig.domain %&gt;/atom.xml&quot; target=&quot;_blank&quot; class=&quot;py-2 md:py-1 px-4 mx-4 inline-flex transition font-semibold rounded dark:hover:bg-gray-600 hover:bg-gray-200&quot;&gt; RSS &lt;/a&gt; å°†é“¾æ¥éƒ¨åˆ†æ”¾ç½®åˆ°footerä¸­å³å¯ æ·»åŠ å‹é“¾é¡µé¢ åœ¨config.jsonä¸­åŠ å…¥ { â€‹ &quot;name&quot;: &quot;friends&quot;, â€‹ &quot;label&quot;: &quot;å‹é“¾&quot;, â€‹ &quot;group&quot;: &quot;å‹é“¾&quot;, â€‹ &quot;type&quot;: &quot;array&quot;, â€‹ &quot;value&quot;: [], â€‹ &quot;arrayItems&quot;: [ â€‹ { â€‹ &quot;label&quot;: &quot;åç§°&quot;, â€‹ &quot;name&quot;: &quot;siteName&quot;, â€‹ &quot;type&quot;: &quot;input&quot;, â€‹ &quot;value&quot;: &quot;&quot; â€‹ }, â€‹ { â€‹ &quot;label&quot;: &quot;é“¾æ¥&quot;, â€‹ &quot;name&quot;: &quot;siteLink&quot;, â€‹ &quot;type&quot;: &quot;input&quot;, â€‹ &quot;value&quot;: &quot;&quot; â€‹ }, â€‹ { â€‹ &quot;label&quot;: &quot;Logo&quot;, â€‹ &quot;name&quot;: &quot;siteLogo&quot;, â€‹ &quot;type&quot;: &quot;input&quot;, â€‹ &quot;value&quot;: &quot;&quot; â€‹ }, â€‹ { â€‹ &quot;label&quot;: &quot;æè¿°&quot;, â€‹ &quot;name&quot;: &quot;siteDesc&quot;, â€‹ &quot;type&quot;: &quot;input&quot;, â€‹ &quot;value&quot;: &quot;&quot; â€‹ } â€‹ ], â€‹ &quot;note&quot;: &quot;&quot; } ç„¶ååœ¨åœ¨templatesæ–‡ä»¶å¤¹ä¸­æ–°å»ºfriends.ejs: &lt;html lang=&quot;en&quot;&gt; â€‹ &lt;head&gt; â€‹ &lt;%- include('./includes/head', { siteTitle: themeConfig.siteName }) %&gt; &lt;meta name=&quot;description&quot; content=&quot;&lt;%- themeConfig.siteDescription %&gt;&quot; /&gt; â€‹ &lt;!--&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;&lt;%= site.themeConfig.domain %&gt;/media/css/friends.css&quot;&gt;--&gt; â€‹ &lt;/head&gt; â€‹ &lt;body&gt; &lt;div class=&quot;antialiased flex flex-col min-h-screen&quot; id=&quot;app&quot;&gt; â€‹ &lt;%- include('./includes/header') %&gt; &lt;div class=&quot;max-w-4xl w-full mx-auto pt-32&quot;&gt; &lt;div class=&quot;bg-white dark:bg-gray-600 shadow-box rounded-lg text-gray-700 dark:text-gray-200&quot;&gt; &lt;div style=&quot;padding-left: 20px&quot;&gt; â€‹ &lt;br /&gt; &lt;p&gt;éœ€è¦æ·»åŠ å‹é“¾å¯åœ¨ä¸‹æ–¹ç•™è¨€&lt;/p&gt; â€‹ &lt;br /&gt; â€‹ &lt;strong&gt;æ ¼å¼:&lt;/strong&gt; â€‹ &lt;br /&gt; â€‹ &lt;ul&gt; â€‹ &lt;li style=&quot;padding-left: 2rem&quot;&gt; â€‹ &lt;b&gt;ç½‘ç«™åç§°&lt;/b&gt; â€‹ : eg. Nuo's Blog â€‹ &lt;/li&gt; â€‹ &lt;li style=&quot;padding-left: 2rem&quot;&gt; â€‹ &lt;b&gt;ç½‘ç«™é“¾æ¥&lt;/b&gt; â€‹ : eg. https://qxxiao.cn â€‹ &lt;/li&gt; â€‹ &lt;li style=&quot;padding-left: 2rem&quot;&gt; â€‹ &lt;b&gt;å¤´åƒé“¾æ¥&lt;/b&gt; â€‹ : eg. https://pic.qxxiao.cn/avatar.png â€‹ &lt;/li&gt; â€‹ &lt;li style=&quot;padding-left: 2rem&quot;&gt; â€‹ &lt;b&gt;ç½‘ç«™æè¿°&lt;/b&gt; â€‹ : eg. æ¸©æ•…è€ŒçŸ¥æ–° â€‹ &lt;span style=&quot;color: #ff6b81&quot;&gt;console.log(ğŸ˜Š);&lt;/span&gt; â€‹ &lt;/li&gt; â€‹ &lt;/ul&gt; â€‹ &lt;br /&gt; â€‹ &lt;/div&gt; â€‹ &lt;/div&gt; &lt;div class=&quot;friendbox&quot;&gt; â€‹ &lt;% if (site.customConfig.friends) { %&gt; &lt;% site.customConfig.friends.forEach(function(friend) { %&gt; &lt;div class=&quot;friend-box friendblock&quot;&gt; â€‹ &lt;img src=&quot;&lt;%= friend.siteLogo %&gt;&quot; class=&quot;friend-avatar&quot; /&gt; &lt;div class=&quot;flink-info&quot;&gt; â€‹ &lt;a href=&quot;&lt;%= friend.siteLink %&gt;&quot; target=&quot;_blank&quot;&gt;&lt;%= friend.siteName %&gt;&lt;/a&gt; â€‹ &lt;br /&gt; â€‹ &lt;%= friend.siteDesc %&gt; â€‹ &lt;/div&gt; â€‹ &lt;/div&gt; â€‹ &lt;% }); %&gt; &lt;% } %&gt; â€‹ &lt;/div&gt; â€‹ &lt;% if (typeof commentSetting !== 'undefined' &amp;&amp; commentSetting.showComment) { %&gt; &lt;% if â€‹ (commentSetting.commentPlatform === 'gitalk') { %&gt; &lt;div id=&quot;gitalk-container&quot;&gt;&lt;/div&gt; â€‹ &lt;% } %&gt; &lt;% if (commentSetting.commentPlatform === 'disqus') { %&gt; &lt;%- include('./includes/disqus') %&gt; &lt;% â€‹ } %&gt; &lt;% } %&gt; &lt;% if (site.customConfig.openValine) { %&gt; &lt;div id=&quot;vlaine-comment&quot;&gt;&lt;/div&gt; â€‹ &lt;% } %&gt; &lt;% if(site.customConfig.openTwikoo) { %&gt; &lt;div id=&quot;tcomment&quot;&gt;&lt;/div&gt; â€‹ &lt;% } %&gt; &lt;%- include('./includes/footer') %&gt; â€‹ &lt;/div&gt; â€‹ &lt;/div&gt; â€‹ &lt;% if (site.customConfig.openValine) { %&gt; &lt;%- include('./includes/valine') %&gt; &lt;% } %&gt; &lt;% if (typeof â€‹ commentSetting !== 'undefined' &amp;&amp; commentSetting.showComment) { %&gt; &lt;% if (commentSetting.commentPlatform === â€‹ 'gitalk') { %&gt; &lt;%- include('./includes/gitalk') %&gt; &lt;% } %&gt; &lt;% } %&gt; &lt;% if(site.customConfig.openTwikoo) { %&gt; &lt;script src=&quot;https://cdn.jsdelivr.net/npm/twikoo@1.2.0/dist/twikoo.all.min.js&quot;&gt;&lt;/script&gt; â€‹ &lt;link rel=&quot;stylesheet&quot; â€‹ href=&quot;https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css&quot; â€‹ integrity=&quot;sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X&quot; â€‹ crossorigin=&quot;anonymous&quot; â€‹ /&gt; â€‹ &lt;script â€‹ defer â€‹ src=&quot;https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js&quot; â€‹ integrity=&quot;sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4&quot; â€‹ crossorigin=&quot;anonymous&quot; â€‹ &gt;&lt;/script&gt; â€‹ &lt;script â€‹ defer â€‹ src=&quot;https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js&quot; â€‹ integrity=&quot;sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa&quot; â€‹ crossorigin=&quot;anonymous&quot; â€‹ &gt;&lt;/script&gt; &lt;script&gt; â€‹ twikoo.init({ â€‹ envId: '&lt;%= site.customConfig.envId %&gt;', â€‹ el: '#tcomment', â€‹ katex: { â€‹ delimiters: [ â€‹ { left: '$$', right: '$$', display: true }, â€‹ { left: '$', right: '$', display: false }, â€‹ { left: '\\(', right: '\\)', display: false }, â€‹ { left: '\\[', right: '\\]', display: true }, â€‹ ], â€‹ throwOnError: false, â€‹ }, â€‹ }); â€‹ &lt;/script&gt; â€‹ &lt;% } %&gt; â€‹ &lt;/body&gt; &lt;/html&gt; ç›¸å…³çš„css: @media screen and (min-width: 780px) { â€‹ .friendbox { â€‹ border-radius: 0.5rem; â€‹ margin: 20px 0px 50px 0px; â€‹ padding: 0px 55px 0px 55px; â€‹ } } @media (prefers-color-scheme: dark) { â€‹ .friendbox { â€‹ background-color: #444444; â€‹ } } .friend-box { â€‹ display: flex; â€‹ flex-direction: row; â€‹ justify-content: center; â€‹ width: 350px; â€‹ background-color: #faf9f7; â€‹ border: 1px solid rgba(0, 0, 0, 0.125); â€‹ border-radius: 0.25rem; â€‹ box-shadow: 0 6px 14px 0 rgb(0 0 0 / 4%); â€‹ margin: 10px 20px 10px 20px; } @media (prefers-color-scheme: dark) { â€‹ .friend-box { â€‹ background-color: #333333; â€‹ } } .friendblock { â€‹ display: inline-block; } .friend-box img.friend-avatar { â€‹ width: 70px; â€‹ height: 70px; â€‹ border-radius: 50%; â€‹ float: left; â€‹ margin: 15px; } .friend-box .flink-info { â€‹ height: auto; â€‹ overflow: hidden; â€‹ line-height: 25px; â€‹ margin: 20px; } ä»£ç æ ·å¼ å¢åŠ è¡Œå·æ˜¾ç¤ºï¼Œä»£ç è¯­è¨€æ˜¾ç¤ºï¼Œå¤åˆ¶é€‰é¡¹ï¼›åœ¨post.ejsä¸­æ·»åŠ å¯¹åº”æ–‡ä»¶ï¼š &lt;% if (site.customConfig.codeHighlight) { %&gt; â€‹ &lt;link rel=&quot;stylesheet&quot; href=&quot;&lt;%= site.themeConfig.domain %&gt;/media/css/prism&lt;%= `-${site.customConfig.hightlightTheme || 'atom-dark'}` %&gt;.css&quot;&gt; â€‹ &lt;link href=&quot;https://cdn.bootcdn.net/ajax/libs/prism/1.19.0/plugins/line-numbers/prism-line-numbers.min.css&quot; rel=&quot;stylesheet&quot;&gt; â€‹ &lt;link href=&quot;https://cdn.bootcdn.net/ajax/libs/prism/1.19.0/plugins/toolbar/prism-toolbar.min.css&quot; rel=&quot;stylesheet&quot;&gt; &lt;% } %&gt; &lt;!-- Code Highlight --&gt; &lt;% if (site.customConfig.codeHighlight) { %&gt; &lt;script src=&quot;&lt;%= site.themeConfig.domain %&gt;/media/prism.js&quot;&gt;&lt;/script&gt; &lt;script&gt; â€‹ Prism.highlightAll() â€‹ &lt;/script&gt; &lt;script defer src=&quot;https://cdn.bootcdn.net/ajax/libs/prism/1.19.0/plugins/line-numbers/prism-line-numbers.min.js&quot;&gt;&lt;/script&gt; &lt;script defer src=&quot;https://cdn.bootcdn.net/ajax/libs/prism/1.19.0/plugins/toolbar/prism-toolbar.min.js&quot;&gt;&lt;/script&gt; &lt;script defer src=&quot;https://cdn.bootcdn.net/ajax/libs/prism/1.19.0/plugins/show-language/prism-show-language.min.js&quot;&gt;&lt;/script&gt; &lt;script defer src=&quot;https://cdn.bootcdn.net/ajax/libs/prism/1.19.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js&quot;&gt;&lt;/script&gt; &lt;% } %&gt; åœ¨æœ€åæ·»åŠ  &lt;!-- line number for code block --&gt; &lt;script&gt; var pres = document.getElementsByTagName(&quot;pre&quot;); for(var i = 0; i &lt; pres.length; i++){ â€‹ var pre = pres[i]; â€‹ if(pre.childNodes[0].nodeName == &quot;CODE&quot;){ â€‹ pre.setAttribute(&quot;class&quot;,&quot;line-numbers&quot;); â€‹ } } &lt;/script&gt; å‚è€ƒ https://xyz1024.top/post/rocky/ https://vlieo.com/tag/sx7g1O9Qg/ https://yyl125.top/ ","tags":[{"name":"Gridea","slug":"gridea","used":true,"link":"https://blog.qxxiao.eu.org/tag/gridea/"}],"title":"Rockyä¸»é¢˜è®°å½•","feature":"https://pic.qxxiao.cn/20220412223634.png","link":"https://blog.qxxiao.eu.org/post/rocky-theme/","stats":{"text":"9 min read","time":515000,"words":1460,"minutes":9},"date":"2022-01-05 20:11:19","dateFormat":"2022-01-05","isTop":false},{"content":"çŸ©é˜µçš„æ•°é‡ä¹˜æ³• cA=c[a11a12a21a22]=[ca11ca12ca21ca22]cA = c\\left[\\begin{array}{lll} a_{11} &amp; a_{12} \\\\ a_{21} &amp; a_{22} \\end{array}\\right]=\\left[\\begin{array}{lll} c a_{11} &amp; c a_{12} \\\\ c a_{21} &amp; c a_{22} \\end{array}\\right] cA=c[a11â€‹a21â€‹â€‹a12â€‹a22â€‹â€‹]=[ca11â€‹ca21â€‹â€‹ca12â€‹ca22â€‹â€‹] çŸ©é˜µä¸çŸ©é˜µçš„ä¹˜æ³• ä¸¾ä¾‹çš„çŸ©é˜µ A å’ŒçŸ©é˜µ B çš„ä¹˜æ³•è¿ç®—ï¼š å·¦è¾¹çŸ©é˜µçš„åˆ—æ•°è¦å’Œå³è¾¹çŸ©é˜µçš„è¡Œæ•°ç›¸ç­‰ å·¦è¾¹çŸ©é˜µçš„è¡Œæ•°å†³å®šäº†ç»“æœçŸ©é˜µçš„è¡Œæ•°ï¼›å³è¾¹çŸ©é˜µçš„åˆ—æ•°å†³å®šäº†ç»“æœçŸ©é˜µçš„åˆ—æ•° [a11a12a21a22a31a32]Ã—[b11b12b13b21b22b23]=[a11b11+a12b21a11b12+a12b22a11b13+a12b23a21b11+a22b21a21b12+a22b22a21b13+a22b23a31b11+a32b21a31b12+a32b22a31b13+a32b23]\\begin{aligned} &amp;{\\left[\\begin{array}{ll} a_{11} &amp; a_{12} \\\\ a_{21} &amp; a_{22} \\\\ a_{31} &amp; a_{32} \\end{array}\\right] \\times\\left[\\begin{array}{lll} b_{11} &amp; b_{12} &amp; b_{13} \\\\ b_{21} &amp; b_{22} &amp; b_{23} \\end{array}\\right]} \\\\ =&amp;\\left[\\begin{array}{lll} a_{11} b_{11}+a_{12} b_{21} &amp; a_{11} b_{12}+a_{12} b_{22} &amp; a_{11} b_{13}+a_{12} b_{23} \\\\ a_{21} b_{11}+a_{22} b_{21} &amp; a_{21} b_{12}+a_{22} b_{22} &amp; a_{21} b_{13}+a_{22} b_{23} \\\\ a_{31} b_{11}+a_{32} b_{21} &amp; a_{31} b_{12}+a_{32} b_{22} &amp; a_{31} b_{13}+a_{32} b_{23} \\end{array}\\right] \\end{aligned} =â€‹â£â¡â€‹a11â€‹a21â€‹a31â€‹â€‹a12â€‹a22â€‹a32â€‹â€‹â¦â¤â€‹Ã—[b11â€‹b21â€‹â€‹b12â€‹b22â€‹â€‹b13â€‹b23â€‹â€‹]â£â¡â€‹a11â€‹b11â€‹+a12â€‹b21â€‹a21â€‹b11â€‹+a22â€‹b21â€‹a31â€‹b11â€‹+a32â€‹b21â€‹â€‹a11â€‹b12â€‹+a12â€‹b22â€‹a21â€‹b12â€‹+a22â€‹b22â€‹a31â€‹b12â€‹+a32â€‹b22â€‹â€‹a11â€‹b13â€‹+a12â€‹b23â€‹a21â€‹b13â€‹+a22â€‹b23â€‹a31â€‹b13â€‹+a32â€‹b23â€‹â€‹â¦â¤â€‹â€‹ çŸ©é˜µä¹˜ä»¥å‘é‡çš„æœ¬è´¨ çŸ©é˜µä¸å‘é‡çš„ä¹˜æ³•ï¼Œä¸€èˆ¬è€Œè¨€å†™ä½œçŸ©é˜µ AAA åœ¨å·¦ï¼Œåˆ—å‘é‡ xxx åœ¨å³çš„ AxAxAx çš„å½¢å¼ï¼Œä¾¿äºæè¿°å‘é‡ xxx çš„ä½ç½®åœ¨çŸ©é˜µ AAA çš„ä½œç”¨ä¸‹è¿›è¡Œå˜æ¢çš„è¿‡ç¨‹ã€‚ [a11a12a21a22a31a32][x11x21]=[a11x11+a12x21a21x11+a22x21a31x11+a32x21]\\left[\\begin{array}{ll} a_{11} &amp; a_{12} \\\\ a_{21} &amp; a_{22} \\\\ a_{31} &amp; a_{32} \\end{array}\\right]\\left[\\begin{array}{l} x_{11} \\\\ x_{21} \\end{array}\\right]=\\left[\\begin{array}{l} a_{11} x_{11}+a_{12} x_{21} \\\\ a_{21} x_{11}+a_{22} x_{21} \\\\ a_{31} x_{11}+a_{32} x_{21} \\end{array}\\right] â£â¡â€‹a11â€‹a21â€‹a31â€‹â€‹a12â€‹a22â€‹a32â€‹â€‹â¦â¤â€‹[x11â€‹x21â€‹â€‹]=â£â¡â€‹a11â€‹x11â€‹+a12â€‹x21â€‹a21â€‹x11â€‹+a22â€‹x21â€‹a31â€‹x11â€‹+a32â€‹x21â€‹â€‹â¦â¤â€‹ ä¾‹å­ï¼š [123456][45]=[1Ã—4+2Ã—53Ã—4+4Ã—55Ã—4+6Ã—5]=[143250]\\left[\\begin{array}{ll} 1 &amp; 2 \\\\ 3 &amp; 4 \\\\ 5 &amp; 6 \\end{array}\\right]\\left[\\begin{array}{l} 4 \\\\ 5 \\end{array}\\right]=\\left[\\begin{array}{l} 1 \\times 4+2 \\times 5 \\\\ 3 \\times 4+4 \\times 5 \\\\ 5 \\times 4+6 \\times 5 \\end{array}\\right]=\\left[\\begin{array}{l} 14 \\\\ 32 \\\\ 50 \\end{array}\\right] â£â¡â€‹135â€‹246â€‹â¦â¤â€‹[45â€‹]=â£â¡â€‹1Ã—4+2Ã—53Ã—4+4Ã—55Ã—4+6Ã—5â€‹â¦â¤â€‹=â£â¡â€‹143250â€‹â¦â¤â€‹ åŸå§‹åæ ‡/å‘é‡ (4,5)(4,5)(4,5) ç»è¿‡çŸ©é˜µçš„ä¹˜æ³•è½¬æ¢ï¼Œå˜æ¢ä¸º 3 ç»´åæ ‡/å‘é‡ (14,32,50)(14,32,50)(14,32,50) åœ¨ç‰¹å®šçŸ©é˜µçš„ä¹˜æ³•ä½œç”¨ä¸‹ï¼ŒåŸç©ºé—´ä¸­çš„å‘é‡åæ ‡ï¼Œè¢«æ˜ å°„åˆ°äº†ç›®æ ‡ç©ºé—´ä¸­çš„æ–°åæ ‡ï¼Œå‘é‡çš„ç©ºé—´ä½ç½®(ä»¥åŠæ‰€åœ¨ç©ºé—´ç»´æ•°ï¼‰å‘ç”Ÿäº†è½¬åŒ–ã€‚ è¡Œè§’åº¦ ä»è¡Œè§’åº¦çœ‹çŸ©é˜µ AAA ä¸åˆ—å‘é‡ xxx çš„ä¹˜æ³•ï¼Œä¾‹å¦‚ï¼šAx=[abcd][x1x2]=[ax1+bx2cx1+dx2]A x=\\left[\\begin{array}{ll}a &amp; b \\\\ c &amp; d\\end{array}\\right]\\left[\\begin{array}{l}x_1 \\\\ x_2\\end{array}\\right]=\\left[\\begin{array}{l}a x_1+b x_2 \\\\ c x_1+d x_2\\end{array}\\right]Ax=[acâ€‹bdâ€‹][x1â€‹x2â€‹â€‹]=[ax1â€‹+bx2â€‹cx1â€‹+dx2â€‹â€‹] æŒ‰ç…§ä¹˜æ³•çš„å®šä¹‰ï¼Œç»“æœåˆ—å‘é‡çš„æ¯ä¸€å…ƒç´ éƒ½æ˜¯çŸ©é˜µçš„è¡Œå‘é‡ç‚¹ä¹˜è¯¥åˆ—å‘é‡ï¼š Ax=[rowâ¡1rowâ¡2]x=[rowâ¡1â‹…xrowâ¡2â‹…x]A x=\\left[\\begin{array}{l}\\operatorname{row}_1 \\\\ \\operatorname{row}_2\\end{array}\\right] x=\\left[\\begin{array}{l}\\operatorname{row}_1 \\cdot x \\\\ \\operatorname{row}_2 \\cdot x\\end{array}\\right]Ax=[row1â€‹row2â€‹â€‹]x=[row1â€‹â‹…xrow2â€‹â‹…xâ€‹] åˆ—è§’åº¦ çŸ©é˜µ AAA ä¸å‘é‡ xxx çš„ä¹˜æ³•ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å¯¹çŸ©é˜µ AAA åˆ—å‘é‡è¿›è¡Œçº¿æ€§ç»„åˆçš„è¿‡ç¨‹ã€‚ å°† AAA å†™ä½œä¸€ç»„åˆ—å˜é‡å½¢å¼è®¡ç®—ï¼š Ax=[colâ¡1colâ¡2â€¦colâ¡n][x1x2â€¦xn]=x1colâ¡1+x2colâ¡2+â€¦+xncolâ¡nA x=\\left[\\begin{array}{llll} \\operatorname{col}_1 &amp; \\operatorname{col}_2 &amp; \\ldots &amp; \\operatorname{col}_n \\end{array}\\right]\\left[\\begin{array}{c} x_1 \\\\ x_2 \\\\ \\ldots \\\\ x_n \\end{array}\\right]=x_1 \\operatorname{col}_1+x_2 \\operatorname{col}_2+\\ldots+x_n \\operatorname{col}_n Ax=[col1â€‹â€‹col2â€‹â€‹â€¦â€‹colnâ€‹â€‹]â£â¢â¢â¡â€‹x1â€‹x2â€‹â€¦xnâ€‹â€‹â¦â¥â¥â¤â€‹=x1â€‹col1â€‹+x2â€‹col2â€‹+â€¦+xnâ€‹colnâ€‹ ä¾‹å­ï¼š Ax=[1234][35]=3[13]+5[24]A x=\\left[\\begin{array}{ll} 1 &amp; 2 \\\\ 3 &amp; 4 \\end{array}\\right]\\left[\\begin{array}{l} 3 \\\\ 5 \\end{array}\\right]=3\\left[\\begin{array}{l} 1 \\\\ 3 \\end{array}\\right]+5\\left[\\begin{array}{l} 2 \\\\ 4 \\end{array}\\right] Ax=[13â€‹24â€‹][35â€‹]=3[13â€‹]+5[24â€‹] æ‰€å¾—åˆ°çš„ç»“æœå°±æ˜¯çŸ©é˜µçš„ç¬¬ä¸€ä¸ªåˆ—å‘é‡ä¹˜ä»¥ x1=3x_1=3x1â€‹=3 åŠ ä¸Šç¬¬äºŒä¸ªåˆ—å‘é‡ä¹˜ä»¥ x2=5x_2=5x2â€‹=5 ä¸€ä¸ªçŸ©é˜µå’Œä¸€ä¸ªå‘é‡ç›¸ä¹˜çš„è¿‡ç¨‹ï¼Œå¯¹ä½äºåŸçŸ©é˜µå„åˆ—çš„åˆ—å‘é‡é‡æ–°è¿›è¡Œçº¿æ€§ç»„åˆçš„è¿‡ç¨‹ï¼Œè€Œçº¿æ€§ç»„åˆçš„å„ç³»æ•°å°±æ˜¯è¯¥å‘é‡çš„å¯¹åº”ä¸‹æ ‡å…ƒç´ ã€‚ åæ ‡å˜æ¢ ä»åˆ—è§’åº¦çš„å˜æ¢çš„è¿‡ç¨‹ï¼Œå°±æ˜¯åæ ‡çš„å˜æ¢ã€‚è€ƒè™‘ mÃ—nm\\times nmÃ—n çŸ©é˜µ AAA å’Œ nnn ç»´å‘é‡ xxx çš„ä¹˜æ³•ï¼š Ax=[a11a12â€¦a1na21a22â€¦a2nâ€¦â€¦am1am2â€¦amn][x1x2â€¦xn]=[a11a12â€¦a1na21a22â€¦a2nâ€¦â€¦am1am2â€¦amn](x1[10â€¦0]+x2[01â€¦0]+â‹¯+xn[00â€¦1])=x1[a11a21â€¦am1]+x2[a12a22â€¦am2]+â€¦+xn[a1na2nâ€¦amn]\\begin{aligned} A x&amp;=\\left[\\begin{array}{cccc} a_{11} &amp; a_{12} &amp; \\ldots &amp; a_{1 n} \\\\ a_{21} &amp; a_{22} &amp; \\ldots &amp; a_{2 n} \\\\ \\ldots &amp; &amp; \\ldots &amp; \\\\ a_{m 1} &amp; a_{m 2} &amp; \\ldots &amp; a_{m n} \\end{array}\\right]\\left[\\begin{array}{c} x_1 \\\\ x_2 \\\\ \\ldots \\\\ x_n \\end{array}\\right]\\\\ &amp;=\\left[\\begin{array}{cccc} a_{11} &amp; a_{12} &amp; \\ldots &amp; a_{1 n} \\\\ a_{21} &amp; a_{22} &amp; \\ldots &amp; a_{2 n} \\\\ \\ldots &amp; &amp; \\ldots &amp; \\\\ a_{m 1} &amp; a_{m 2} &amp; \\ldots &amp; a_{m n} \\end{array}\\right]\\left(x_1\\left[\\begin{array}{c} 1 \\\\ 0 \\\\ \\ldots \\\\ 0 \\end{array}\\right]+x_2\\left[\\begin{array}{c} 0 \\\\ 1 \\\\ \\ldots \\\\ 0 \\end{array}\\right]+\\cdots+x_n\\left[\\begin{array}{c} 0 \\\\ 0 \\\\ \\ldots \\\\ 1 \\end{array}\\right] \\right)\\\\ &amp;=x_1\\left[\\begin{array}{c} a_{11} \\\\ a_{21} \\\\ \\ldots \\\\ a_{m 1} \\end{array}\\right]+x_2\\left[\\begin{array}{c} a_{12} \\\\ a_{22} \\\\ \\ldots \\\\ a_{m 2} \\end{array}\\right]+\\ldots+x_n\\left[\\begin{array}{c} a_{1 n} \\\\ a_{2 n} \\\\ \\ldots \\\\ a_{m n} \\end{array}\\right] \\end{aligned} Axâ€‹=â£â¢â¢â¡â€‹a11â€‹a21â€‹â€¦am1â€‹â€‹a12â€‹a22â€‹am2â€‹â€‹â€¦â€¦â€¦â€¦â€‹a1nâ€‹a2nâ€‹amnâ€‹â€‹â¦â¥â¥â¤â€‹â£â¢â¢â¡â€‹x1â€‹x2â€‹â€¦xnâ€‹â€‹â¦â¥â¥â¤â€‹=â£â¢â¢â¡â€‹a11â€‹a21â€‹â€¦am1â€‹â€‹a12â€‹a22â€‹am2â€‹â€‹â€¦â€¦â€¦â€¦â€‹a1nâ€‹a2nâ€‹amnâ€‹â€‹â¦â¥â¥â¤â€‹ââœâœâ›â€‹x1â€‹â£â¢â¢â¡â€‹10â€¦0â€‹â¦â¥â¥â¤â€‹+x2â€‹â£â¢â¢â¡â€‹01â€¦0â€‹â¦â¥â¥â¤â€‹+â‹¯+xnâ€‹â£â¢â¢â¡â€‹00â€¦1â€‹â¦â¥â¥â¤â€‹â âŸâŸââ€‹=x1â€‹â£â¢â¢â¡â€‹a11â€‹a21â€‹â€¦am1â€‹â€‹â¦â¥â¥â¤â€‹+x2â€‹â£â¢â¢â¡â€‹a12â€‹a22â€‹â€¦am2â€‹â€‹â¦â¥â¥â¤â€‹+â€¦+xnâ€‹â£â¢â¢â¡â€‹a1nâ€‹a2nâ€‹â€¦amnâ€‹â€‹â¦â¥â¥â¤â€‹â€‹ ç»è¿‡ä¹˜æ³•å˜æ¢ï¼Œnnn ç»´åˆ—å‘é‡ xxx å˜æ¢æˆäº† nnn ä¸ª mmm ç»´åˆ—å‘é‡çº¿æ€§ç»„åˆçš„å½¢å¼ï¼Œå…¶æœ€ç»ˆç»“æœæ˜¯ä¸€ä¸ª mmm ç»´çš„åˆ—å‘é‡ã€‚ å¯ä»¥çœ‹å‡ºï¼šç»è¿‡å˜æ¢ï¼Œå°† xxx ç»´çš„å‘é‡ç©ºé—´æ˜ å°„åˆ°äº†çŸ©é˜µ AAA åˆ—å‘é‡å¼ æˆçš„ç©ºé—´ï¼ˆç§©=åˆ—å‘é‡ç»„çš„ç§©ï¼‰ è¯´æ˜ï¼š å½“ä¸”ä»…å½“ n=mn=mn=mï¼Œä¸” nnn ä¸ªåˆ—å‘é‡çº¿æ€§æ— å…³çš„æ—¶å€™ï¼Œå®ƒä»¬æ‰èƒ½ç§°ä¹‹ä¸ºä¸€ç»„æ–°çš„åŸºåº•ã€‚ é“¾æ¥ https://www.zhihu.com/question/28623194 ","tags":[{"name":"LinearAlgebra","slug":"linearalgebra","used":true,"link":"https://blog.qxxiao.eu.org/tag/linearalgebra/"},{"name":"Math","slug":"math","used":true,"link":"https://blog.qxxiao.eu.org/tag/math/"}],"title":"çŸ©é˜µçš„è¿ç®—","feature":"","link":"https://blog.qxxiao.eu.org/post/çŸ©é˜µçš„è¿ç®—/","stats":{"text":"9 min read","time":484000,"words":1544,"minutes":9},"date":"2021-05-02 13:00:11","dateFormat":"2021-05-02","isTop":false},{"content":" ç®€å•å†ç”Ÿç ï¼Œèƒ½å¤Ÿä»¥è¾ƒä½æˆæœ¬ç®€å•å¿«é€Ÿåœ°ç²¾ç¡®ä¿®å¤ï¼Œç¼–ç æ•ˆç‡æ¥è¿‘23\\frac{2}{3}32â€‹ â… . INTRODUCTION ç¼–ç çš„åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿä¸­ä¸€ä¸ªä¸­å¿ƒé—®é¢˜æ˜¯åœ¨æ•…éšœå‘ç”Ÿæ—¶ä¿æŒç³»ç»Ÿç¼–ç è¡¨ç¤ºï¼Œå³ç»´æŒç³»ç»Ÿçš„å†—ä½™ã€‚ ç½‘ç»œç¼–ç ï¼šä¿®å¤çº åˆ ç ç³»ç»Ÿä¸­çš„èŠ‚ç‚¹æ•…éšœéœ€è¦ç¼–ç åˆ†ç»„(coded packets)çš„ç½‘ç»œå†…(in-network)ç»„åˆã€‚ åœ¨ç ”ç©¶ç²¾ç¡®ä¿®å¤é—®é¢˜ä¸­ï¼Œæœ‰å‡ ä¸ªæŒ‡æ ‡å¯ä»¥ä¼˜åŒ–ï¼šä¿®å¤æœŸé—´ä»ç°æœ‰ç£ç›˜è¯»å–çš„æ€»ä¿¡æ¯é‡ã€ç½‘ç»œä¸­é€šä¿¡çš„æ€»ä¿¡æ¯é‡ï¼ˆä¿®å¤å¸¦å®½ï¼‰æˆ–æ¯æ¬¡ä¿®å¤æ‰€éœ€è®¿é—®çš„ç£ç›˜æ€»æ•°ã€‚ â…¡. SIMPLE REGENERATING CODES A. ç¼–ç æ„é€  å°†æ–‡ä»¶ f\\mathbf{f}fï¼Œå¤§å°ä¸º M=2kM=2kM=2kï¼Œåˆ’åˆ†ä¸º2éƒ¨åˆ† f=[f(1) f2], f(i)âˆˆF1Ã—k, iâˆˆ[1,2]\\mathbf{f}=[\\mathbf{f^{(1)}}\\ \\mathbf{f^{2}}],\\ \\mathbf{f}^{(i)} \\in \\mathbb{F}^{1 \\times k},\\ i \\in [1,2]f=[f(1) f2], f(i)âˆˆF1Ã—k, iâˆˆ[1,2]ã€‚ç¼–ç è¿‡ç¨‹åˆ†ä¸ºä¸¤æ­¥ï¼š ç¼–ç è¿‡ç¨‹ é€šè¿‡ä¸€ä¸ª (n,k)(n,k)(n,k) çš„MDSç¼–ç å°†æ–‡ä»¶çš„ä¸¤ä¸ªéƒ¨åˆ†ï¼ˆå³ f(1) f2\\mathbf{f^{(1)}}\\ \\mathbf{f^{2}}f(1) f2ï¼‰åˆ†åˆ«ç¼–ç ï¼ˆå› ä¸ºæ¯ä¸€ä¸ªéƒ¨åˆ†éƒ½æœ‰ kkk ä¸ªç¬¦å·ï¼‰ï¼Œè®°ç¼–ç åç¼–ç å—åˆ†åˆ«ä¸ºé•¿åº¦ä¸º nnn çš„å‘é‡ x\\mathbf{x}x å’Œ y\\mathbf{y}yï¼š (1)x=f(1)Gy=f(2)G\\mathbf{x}=\\mathbf{f}^{(1)}\\mathbf{G} \\\\ \\mathbf{y}=\\mathbf{f}^{(2)}\\mathbf{G} \\tag{1} x=f(1)Gy=f(2)G(1) å…¶ä¸­ GâˆˆFkÃ—n\\mathbf{G} \\in \\mathbb{F}^{k\\times n}GâˆˆFkÃ—n æ˜¯ (n,k)(n,k)(n,k) MDSç ç”ŸæˆçŸ©é˜µï¼Œå…¶æœ€å¤§è·ç¦»æ€§è´¨ä¿è¯äº†ä»»æ„ x\\mathbf{x}x æˆ– y\\mathbf{y}y çš„ kkk ä¸ªç¼–ç å—éƒ½å¯ä»¥åˆ†åˆ«é‡å»º f(1)\\mathbf{f^{(1)}}f(1) æˆ– f2\\mathbf{f^{2}}f2ï¼›æœ€åé€šè¿‡å¼‚æˆ–ç”Ÿæˆ s\\mathbf{s}s : (2)s=x+y\\mathbf{s}=\\mathbf{x}+\\mathbf{y} \\tag{2} s=x+y(2) ä¸Šè¿°çš„ç¼–ç è¿‡ç¨‹ä¸€å…±äº§ç”Ÿ 2n+n=3n2n+n=3n2n+n=3n ä¸ªç¼–ç å—ï¼ˆç¬¦å·ï¼‰ã€‚ å—æ”¾ç½®ç­–ç•¥ ç›®çš„ï¼šå°† 3n3n3n ä¸ªç¼–ç å—æ”¾ç½®åˆ° nnn ä¸ªèŠ‚ç‚¹ï¼Œåˆ™æ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨3ä¸ªç¼–ç å—ã€‚ æ–¹æ³•ï¼šæ¯ä¸ªèŠ‚ç‚¹åˆ†åˆ«å­˜å‚¨æ¥è‡ª x,y,s\\mathbf{x},\\mathbf{y},\\mathbf{s}x,y,s çš„ä¸€ä¸ªç¼–ç å—ï¼Œè¦æ±‚3ä¸ªç¼–ç å—ä¸‹æ ‡éƒ½äº’ä¸ç›¸åŒã€‚å¯¹äº nâ‰¥2n \\geq 2nâ‰¥2 éƒ½å¯ä»¥é‡‡ç”¨å¦‚ä¸‹çš„å¾ªç¯æ”¾ç½®æ¥å®ç°ï¼š B. çº åˆ å¼¹æ€§å’Œç ç‡ å¯ä»¥å®¹å¿ä»»æ„çš„ nâˆ’kn-knâˆ’k ä¸ªæ•…éšœï¼Œä»ä¸¤ä¸ªåˆ†åˆ«çš„ MDSç¼–ç è¿‡ç¨‹å¾—åˆ°ã€‚ (n,k)âˆ’SRC(n,k)-SRC(n,k)âˆ’SRCçš„ç¼–ç æ•ˆç‡(space efï¬ciency) RRR ç­‰äºæœ‰ç”¨çš„å­˜å‚¨ä¿¡æ¯æ€»é‡ä¸å­˜å‚¨æ•°æ®æ€»é‡ä¹‹æ¯”ï¼š (3)R=file sizestorage spent=2â‹…k3â‹…nR=\\frac{file \\ size}{storage \\ spent}=\\frac{2 \\cdot k}{3 \\cdot n} \\tag{3} R=storage spentfile sizeâ€‹=3â‹…n2â‹…kâ€‹(3) å¹¶ä¸”ä¸Šç•Œæ˜¯ 23\\frac{2}{3}32â€‹ï¼Œmmm å›ºå®šæ—¶ï¼ŒR=23kk+mâŸ¶kâ†’âˆ23R=\\frac{2}{3}\\frac{k}{k+m} \\stackrel{k \\rightarrow \\infty}{\\longrightarrow} \\frac{2}{3}R=32â€‹k+mkâ€‹âŸ¶kâ†’âˆâ€‹32â€‹ã€‚ C. ä¿®å¤ä¸¢å¤±å— ç”±äºä¸¢å¤±çš„æ¯ä¸ªå—ä¸å­˜å‚¨åœ¨2ä¸ªèŠ‚ç‚¹ä¸­çš„å¦å¤–2ä¸ªç¼–ç å—ä¸ºåŒä¸€ä¸ªç´¢å¼•ï¼Œå› æ­¤SRCèƒ½å¤Ÿè½»æ¾ä¿®å¤å•ä¸ªä¸¢å¤±çš„ç¼–ç å—æˆ–å•ä¸ªèŠ‚ç‚¹æ•…éšœï¼Œé€šè¿‡é€šä¿¡è¿™ä¸¤ä¸ªå­˜æ´»èŠ‚ç‚¹ï¼Œå¯ä»¥é€šè¿‡ç®€å•çš„å¼‚æˆ–æ“ä½œä¿®å¤ä¸¢å¤±çš„å—ã€‚ ä¿®å¤å•èŠ‚ç‚¹æ•…éšœéœ€è¦2å€ä¸¢å¤±æ•°æ®ï¼ˆ6ä¸ªå—ï¼‰çš„ä¿®å¤å¸¦å®½å’Œç£ç›˜è¯»å–ï¼Œéœ€è¦è®¿é—® d=minâ¡(nâˆ’1,4)d=\\min{(n-1,4)}d=min(nâˆ’1,4) ä¸ªç£ç›˜ã€‚ (4,2)-SRCä¸¾ä¾‹ ä¸¾ä¾‹ (n=4,k=2)âˆ’SRC(n=4,k=2)-SRC(n=4,k=2)âˆ’SRCï¼ŒåŸå§‹çš„æ•°æ®å¯¹è±¡åˆ’åˆ†ä¸º f1,f2,f3,f4f_1,f_2,f_3,f_4f1â€‹,f2â€‹,f3â€‹,f4â€‹ï¼Œåˆ†ä¸º2ç»„ï¼Œå°† [f1 f2][f_1 \\ f_2][f1â€‹ f2â€‹] ç¼–ç æˆ [x1 x2 x3 x4][x_1 \\ x_2 \\ x_3 \\ x_4][x1â€‹ x2â€‹ x3â€‹ x4â€‹]ï¼›å°† [f3 f4][f_3 \\ f_4][f3â€‹ f4â€‹] ç¼–ç æˆ [y1 y2 y3 y4][y_1 \\ y_2 \\ y_3 \\ y_4][y1â€‹ y2â€‹ y3â€‹ y4â€‹]ï¼Œæœ€åé€šè¿‡å¼‚æˆ–å¾—åˆ° [s1 s2 s3 s4][s_1 \\ s_2 \\ s_3 \\ s_4][s1â€‹ s2â€‹ s3â€‹ s4â€‹]ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š â…¢. SIMULATIONS ä½¿ç”¨äº‘å­˜å‚¨æ¨¡æ‹Ÿå™¨å°†æ‰€æå‡º SRCSRCSRC ç ä¸Replicationå’ŒReed-Solomonç è¿›è¡Œäº†æ¯”è¾ƒã€‚ ä¸»è¦çš„å®éªŒåˆ†æï¼š å­˜å‚¨å¼€é”€åˆ†æ nâˆ’k=4n-k=4nâˆ’k=4 çš„å­˜å‚¨å¼€é”€å¯¹æ¯”ï¼š ä¿®å¤æ€§èƒ½ æµ‹é‡ä¿®å¤æ•…éšœèŠ‚ç‚¹æ—¶çš„ååé‡ 3-å‰¯æœ¬çš„ä¿®å¤æ€§èƒ½æœ€å¥½ï¼Œå…¶æ¬¡æ˜¯SRCï¼Œè€ŒRSç çš„ä¿®å¤æ€§èƒ½æœ€å·®ã€‚ï¼ˆè€ƒè™‘ä¿®å¤éœ€è¦è®¿é—®çš„æ•°æ®é‡ï¼‰ åœ¨ä¸åŒçš„ (n,k)(n,k)(n,k) ä¸‹ï¼ŒSRCçš„ä¿®å¤æ€§èƒ½ä¿æŒä¸å˜ï¼Œä½†éšç€nçš„å¢åŠ ï¼ŒRSç çš„ä¿®å¤æ€§èƒ½å˜å·®ï¼›å…¶ä¸»è¦ä¼˜ç‚¹ä¹‹ä¸€ï¼šä¿®å¤æ€§èƒ½ç‹¬ç«‹äº (n,k)(n,k)(n,k)ã€‚ æ­¤å¤–ï¼ŒSRCçš„ä¿®å¤ååé‡çº¦ä¸º500MB/sï¼Œçº¦ä¸º3-å‰¯æœ¬æ€§èƒ½çš„64%ã€‚ æ•°æ®å¯é æ€§åˆ†æ ä½¿ç”¨ä¸€ä¸ªç®€å•çš„é©¬å°”å¯å¤«æ¨¡å‹[3]æ¥ä¼°è®¡å¯é æ€§ã€‚ä¸ºç®€å•èµ·è§ï¼Œæ•…éšœä»…å‘ç”Ÿåœ¨ç£ç›˜ä¸Šï¼Œå‡å®šæ•…éšœæ²¡æœ‰ç›¸å…³æ€§ã€‚ SRCsçš„å¯é æ€§è¿œè¿œé«˜äº3-å‰¯æœ¬ï¼ˆ10910^9109ï¼‰ã€‚å³ä½¿å¯¹äºé«˜ç ç‡(50ï¼Œ46)ï¼ŒSRCä¹Ÿæ¯”3-å‰¯æœ¬å¯é å‡ ä¸ªæ•°é‡çº§ã€‚å—ç›ŠäºSRCçš„é«˜ä¿®å¤é€Ÿåº¦ã€‚ RSç å‘ˆç°æ˜æ˜¾ä¸åŒè¶‹åŠ¿ã€‚è™½ç„¶(10ï¼Œ6)å’Œ(20ï¼Œ16)çš„å¯é æ€§é«˜äº3-å‰¯æœ¬ï¼Œä½†éšç€(nï¼Œk)çš„å¢é•¿ï¼ŒRSç çš„å¯é æ€§å¤§å¤§é™ä½ã€‚å› ä¸ºå®ƒä»¬çš„ä¿®å¤æ€§èƒ½éšç€kçš„å¢åŠ è€Œè¿…é€Ÿä¸‹é™ã€‚ â…£. CONCLUSIONS æå‡ºäº†ç»“æ„ç®€å•çš„SRCï¼Œä¸»è¦ç‰¹ç‚¹ï¼š (n,k)âˆ’SRC(n,k)-SRC(n,k)âˆ’SRC å¯ä»¥å®¹è®¸ä»»æ„ nâˆ’kn-knâˆ’k ä¸ªèŠ‚ç‚¹æ•…éšœï¼Œæ˜¯MDSç¼–ç ï¼› ç ç‡ï¼ˆç¼–ç æ•ˆç‡ï¼‰ä¸º 2k3n\\frac{2k}{3n}3n2kâ€‹ ï¼Œå¯ä»¥æ— é™æ¥è¿‘ 23(kâ†’âˆ)\\frac{2}{3}(k \\rightarrow \\infty)32â€‹(kâ†’âˆ) ä¿®å¤å•ä¸ªèŠ‚ç‚¹å¾ˆé«˜æ•ˆï¼Œå¾—ç›Šäºç‰¹å®šçš„å—æ”¾ç½®ç­–ç•¥å’Œç¼–ç è¿‡ç¨‹ä¸­ç¬¬äºŒæ­¥çš„å¼‚æˆ–ç¼–ç ï¼Œå¯ä»¥å®ç°ç²¾ç¡®ä¿®å¤ï¼›ä¿®å¤å•ä¸ªèŠ‚ç‚¹æœ€å¤šè®¿é—® minâ¡{nâˆ’1,4}\\min\\{n-1, 4\\}min{nâˆ’1,4} ä¸ªç£ç›˜ï¼ˆèŠ‚ç‚¹ï¼‰ï¼Œä¿®å¤å¸¦å®½å’Œè®¿é—®çš„æ•°æ®é‡éƒ½æ˜¯ä¸¢å¤±æ•°æ®çš„2å€ã€‚ æ€»ä½“ä¸Šæ˜¯ä¸€ä¸ªç»“æ„ç®€å•ï¼Œæ˜“äºå®ç°çš„ä¸€ç±»ç¼–ç ã€‚ ä¸»è¦æ€æƒ³ï¼šä¸¤ä¸ªMDSé¢„ç¼–ç ç”¨äºé’ˆå¯¹ä»»ä½• nâˆ’k=mn-k=mnâˆ’k=m æ•…éšœæä¾›å¯é æ€§ï¼Œè€Œåº”ç”¨äºMDSç¼–ç åˆ†ç»„ä¹‹ä¸Šçš„XORåœ¨å•èŠ‚ç‚¹æ•…éšœå‘ç”Ÿæ—¶æä¾›æœ‰æ•ˆç²¾ç¡®ä¿®å¤ã€‚ é™„å½•ï¼ˆæŠ˜è¡·ï¼‰ ä¸Šè¿°å°†æ–‡ä»¶ f\\mathbf{f}fï¼Œå¤§å°ä¸º M=2kM=2kM=2kï¼Œåˆ’åˆ†ä¸º2éƒ¨åˆ†ã€‚ä¸€èˆ¬ (n,k,f)âˆ’SRC(n,k,f)-SRC(n,k,f)âˆ’SRCï¼Œå°†æ•°æ®åˆ†ä¸º M=fkM=fkM=fkï¼Œåˆ’åˆ†ä¸º fff ä¸ªéƒ¨åˆ†ï¼Œç¼–ç ç­–ç•¥ä¸€æ ·ï¼Œå…±ç”Ÿæˆ (f+1)n(f+1)n(f+1)n ä¸ªç¼–ç å—ï¼Œæ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨ f+1f+1f+1 ä¸ªå—ã€‚åˆ†æï¼š ç¼–ç æ•ˆç‡(RRR) RSRC=file sizestorage spent=fâ‹…k(f+1)â‹…nR_{SRC}=\\frac{file \\ size}{storage \\ spent}=\\frac{f \\cdot k}{(f+1)\\cdot n} RSRCâ€‹=storage spentfile sizeâ€‹=(f+1)â‹…nfâ‹…kâ€‹ ç¼–ç æ•ˆç‡æ˜¯ (n,k)(n,k)(n,k) MDSç çš„ ff+1\\frac{f}{f+1}f+1fâ€‹ æ¯ä¸ªèŠ‚ç‚¹çš„å­˜å‚¨(Î±\\alphaÎ±) Î±SRC=f+1fâ‹…Mk\\alpha_{SRC}=\\frac{f+1}{f} \\cdot \\frac{M}{k} Î±SRCâ€‹=ff+1â€‹â‹…kMâ€‹ å•ä¸ªèŠ‚ç‚¹çš„ä¿®å¤å¸¦å®½(Î³\\gammaÎ³) Î³SRC=f(f+1)=(f+1)Mk\\gamma_{SRC}=f(f+1)=(f+1)\\frac{M}{k} Î³SRCâ€‹=f(f+1)=(f+1)kMâ€‹ å•èŠ‚ç‚¹ä¿®å¤çš„ç£ç›˜è®¿é—®ä¸ªæ•°(ddd) dSRC=minâ¡(nâˆ’1,2f)d_{SRC}=\\min(n-1, 2f) dSRCâ€‹=min(nâˆ’1,2f) é“¾æ¥ã€å‚è€ƒè®ºæ–‡ã€‘ A. G. Dimakis, P. G. Godfrey, Y. Wu, M. J. Wainwright, and K. Ramchandran, â€œNetwork coding for distributed storage systems,â€ in IEEE Trans. on Inform. Theory, vol. 56, pp. 4539 â€“ 4551, Sep. 2010. A. G. Dimakis, K. Ramchandran, Y. Wu, and C. Suh, â€œA survey on network codes for distributed storage,â€ in IEEE Proceedings, vol. 99, pp. 476 â€“ 489, Mar. 2011. D. Ford, F. Labelle, F. I. Popovici, M. Stokely, V.-A. T. L. Barroso, C. Grimes, and S. Quinlan, â€œAvailability in globally distributed storage systems,â€ in OSDI â€™10: Proc. of the 9th Usenix Symposium on Operating Systems Design and Implementation, 2010. ","tags":[{"name":"EC","slug":"ec","used":true,"link":"https://blog.qxxiao.eu.org/tag/ec/"},{"name":"Paper","slug":"paper","used":true,"link":"https://blog.qxxiao.eu.org/tag/paper/"}],"title":"Simple Regenerating Codes: Network Coding for Cloud Storage","feature":"https://pic.qxxiao.cn/academic_paper.png","link":"https://blog.qxxiao.eu.org/post/simple-regenerating-codes-network-coding-for-cloud-storage/","stats":{"text":"9 min read","time":513000,"words":1910,"minutes":9},"date":"2021-04-20 16:29:40","dateFormat":"2021-04-20","isTop":false},{"content":" è¯´æ˜: å¯¹Jerasure-1.2ç‰ˆæœ¬é‡ç‚¹æ¥å£å’Œç¼–ç çš„ç†è§£å’Œæ¢³ç†ï¼Œ2.0ç‰ˆæœ¬ç±»ä¼¼ã€‚ä¸»è¦å‚è€ƒæ­¤ç‰ˆæœ¬çš„è¯´æ˜æ‰‹å†Œå’Œæºä»£ç ï¼Œå¯ä»¥å† è¿™é‡Œ æ‰¾åˆ°ç›¸å…³èµ„æ–™ã€‚ ç›¸å…³èµ„æ–™è§ å‚è€ƒé“¾æ¥ åŸç†åˆ†æ ä½¿ç”¨ schedule ä»£æ›¿ bit-matrix å‚è€ƒJerasure1.2æ‰‹å†Œ$4.1ï¼›å°†ç¨€ç–ä½çŸ©é˜µä¸­çš„ 1 ç”¨ 5å…ƒç»„ æ¥è¡¨ç¤ºï¼Œé€šè¿‡ç¡®å®šçš„å¤šä¸ª 5 å…ƒç»„è¡¨è¾¾å¼è¿ç®—å®Œæˆç¼–ç å—å…± mÃ—wm \\times wmÃ—w ä¸ª packets çš„ç¼–ç è®¡ç®—ã€‚ notes: ç¼–ç æ—¶ï¼Œæ•°æ®å…ƒç´ å’Œç¼–ç å…ƒç´ ä¸ºäºŒè¿›åˆ¶å½¢å¼ï¼Œæ•°æ®å—å’Œç¼–ç å—éƒ½åˆ†æˆäº† w ä¸ª packetï¼Œæ¯æ¬¡å¯¹ packet çš„å…ƒç´ è¿›è¡Œå¹¶è¡Œæ“ä½œã€ M(e1)âˆ—V(e2)=V(e1e2)M(e_1)*V(e_2)=V(e_1e_2)M(e1â€‹)âˆ—V(e2â€‹)=V(e1â€‹e2â€‹) ã€‘ã€‚ ä»£ç åˆ†æ å¯¹ Cauthy çŸ©é˜µä½çŸ©é˜µçš„ è®¡åˆ’è¡¨ä¼˜åŒ– åšäº†åˆ†æã€‚ å›é¡¾ä¸€ä¸‹ä½çŸ©é˜µçš„è§£ç è¿‡ç¨‹ï¼Œä¸ç»å…¸çš„ RS ç­‰è§£ç ç±»ä¼¼ ä¸‹å›¾ä½¿ç”¨ç”ŸæˆçŸ©é˜µï½œåˆ†å¸ƒçŸ©é˜µç”Ÿæˆæ ¡éªŒå—çš„è¿‡ç¨‹ï¼Œçœç•¥äº†æ•°æ®å—éƒ¨åˆ†ï¼š å‡è®¾ D 1ã€C 1 å¤±æ•ˆï¼Œé€‰å–å‰ k ä¸ªæ²¡æœ‰å¤±æ•ˆçš„ç¼–ç å—å¯¹åº”çš„è¶…è¡Œä½œä¸ºæ–°çš„åˆ†å¸ƒçŸ©é˜µï¼Œå…¶é€†çŸ©é˜µé€šå¸¸ç§°ä½œä¸ºè§£ç çŸ©é˜µ decoding matrixï¼š è¯´æ˜ï¼š Jerasure ä¸­é€‰å–çš„ (kw)Ã—(kw)(kw) \\times (kw)(kw)Ã—(kw) çš„åˆ†å¸ƒå¼çŸ©é˜µçš„ ç¼–ç å—å¯¹åº”çš„è¶…è¡Œ(wè¡Œ) é¡ºåºä¸º C2ã€D2ã€D3 å¯¹åº”çš„è¶…è¡Œã€‚å‰ k ä¸ªä¸­å¤±æ•ˆçš„æ•°æ®å—ç”¨æœªå¤±æ•ˆçš„æ ¡éªŒå—æ›¿ä»£ï¼Œè€Œå°†å¤±æ•ˆçš„æ•°æ®å—å’Œå¤±æ•ˆçš„æ ¡éªŒå—æ”¾åœ¨ k ä¹‹åç”¨äºè®¡åˆ’è¡¨çš„æ“ä½œã€‚è¿™ç§æ–¹å¼èƒ½å¤ŸåŒæ—¶è§£ç å‡ºå¤±æ•ˆçš„æ£€éªŒå—ã€‚ é€šå¸¸ä½¿ç”¨ä¸Šå›¾çš„é€†çŸ©é˜µçš„éƒ¨åˆ†è¶…è¡Œæ¥è§£ç å‡ºæ•°æ®å—ï¼Œå†é‡æ–°ç¼–ç æ¢å¤æ ¡éªŒå—ä¹Ÿå¯ä»¥ã€‚ Jerasure ä½¿ç”¨ä½çŸ©é˜µç”Ÿæˆè®¡åˆ’è¡¨è¿‡ç¨‹ä¸­çš„å®Œæ•´è§£ç çŸ©é˜µçš„æ„é€ ï¼šä¸»è¦æ¥è‡ªå‡½æ•° erasure_generate_decoding_schedule æœ€åå®Œæ•´çš„è§£ç çŸ©é˜µç”±ä¸¤éƒ¨åˆ†æ„æˆï¼Œç”¨äºæ¢å¤æ•°æ®å—çš„è¶…è¡Œï¼Œå’Œç”¨äºæ¢å¤æ ¡éªŒå—çš„è¶…è¡Œï¼š æ ¹æ®å›¾ä¸­æœ€åä¸€æ­¥ï¼Œé€‰æ‹©å¤±æ•ˆçš„æ•°æ®å—å¯¹åº”çš„é€†çŸ©é˜µçš„è¶…è¡Œï¼Œä½œä¸ºè§£ç çŸ©é˜µçš„ç¬¬ä¸€éƒ¨åˆ†ï¼› ç¬¬äºŒéƒ¨åˆ†ç”±ç¼–ç çŸ©é˜µ(ç”ŸæˆçŸ©é˜µ)ä¸­å¤±æ•ˆå—å¯¹åº”çš„è¶…è¡Œè¿ç®—å¾—åˆ°ï¼š (1) å…ˆå¤åˆ¶ç¼–ç çŸ©é˜µä¸­çš„å¯¹åº”çš„è¶…è¡Œåˆ°æœ€ç»ˆçš„è§£ç çŸ©é˜µï¼Œå°†å¤±æ•ˆæ•°æ®å—å¯¹åº”çš„åˆ—ç½®ä¸º 0 (2) éå†ç¼–ç çŸ©é˜µçš„ç½®ä¸º0çš„åˆ—(å³ç½®0çš„ä½ç½®)çš„ä½ç½® iâˆˆ[0,w)i \\in [0,w)iâˆˆ[0,w)ï¼Œå¦‚æœä¸º 1ï¼Œè§£ç çŸ©é˜µçš„è¯¥è¡Œå¼‚æˆ–é€†çŸ©é˜µæˆ–è€…æœ€ç»ˆç¼–ç çŸ©é˜µè§£å‡ºæ•°æ®å—è¶…è¡Œçš„ç¬¬ i è¡Œã€‚ è¯´æ˜ï¼šå¦‚æœæ²¡æœ‰æ•°æ®å—å¤±æ•ˆï¼Œåˆ™ç›´æ¥å¤åˆ¶è§£ç çŸ©é˜µä¸­ï¼Œä¸ç¼–ç è¿‡ç¨‹ä¸€æ ·ã€‚Jerasure ä¸­çš„è§£ç éƒ½æ˜¯é€šç”¨çš„è§£ç æ–¹æ³•ï¼Œå°†å¤±æ•ˆçš„æ•°æ®å—å’Œå¤±æ•ˆçš„æ ¡éªŒå—éƒ½ä¿®å¤å¥½ã€‚ ä¾‹å¦‚ï¼šç¬¬ä¸€æ­¥åï¼Œ 0 0 0 | 1 0 0 | 1 0 0 ==&gt; (2)åªéœ€è¦å¼‚æˆ–è“è‰²è¶…è¡Œä¸­ç¬¬0è¡Œ(åªæœ‰ä¸€ä¸ª1) 0 0 0 | 0 1 0 | 0 1 0 ==&gt; (2)åªéœ€è¦å¼‚æˆ–ä¸Šå›¾ç´«è‰²è¶…è¡Œä¸­ç¬¬1è¡Œ 0 0 0 | 0 0 1 | 0 0 1 ==&gt; (2)åªéœ€è¦å¼‚æˆ–ä¸Šå›¾ç´«è‰²è¶…è¡Œä¸­ç¬¬2è¡Œ ç»è¿‡ç¬¬äºŒæ­¥åï¼š 1 0 0 | 1 0 1 | 1 1 0 0 1 0 | 1 1 1 | 0 0 1 0 0 1 | 0 1 1 | 1 0 0 å¯ä»¥å¾—åˆ° C 1 çš„ 3 ä¸ª packets è¡¨è¾¾å¼ï¼š p1=C2p1âŠ•D2p1âŠ•D2p3âŠ•D3p1âŠ•D3p2p2=C2p2âŠ•D2p1âŠ•D2p2âŠ•D2p3âŠ•D3p3p3=C2p3âŠ•D2p2âŠ•D2p3âŠ•D3p1p_1 = C_2p_1 \\oplus D_2p_1 \\oplus D_2p_3 \\oplus D_3p_1 \\oplus D_3p_2 \\\\ p_2 = C_2p_2 \\oplus D_2p_1 \\oplus D_2p_2 \\oplus D_2p_3 \\oplus D_3p_3 \\\\ p_3 = C_2p_3 \\oplus D_2p_2 \\oplus D_2p_3 \\oplus D_3p_1 p1â€‹=C2â€‹p1â€‹âŠ•D2â€‹p1â€‹âŠ•D2â€‹p3â€‹âŠ•D3â€‹p1â€‹âŠ•D3â€‹p2â€‹p2â€‹=C2â€‹p2â€‹âŠ•D2â€‹p1â€‹âŠ•D2â€‹p2â€‹âŠ•D2â€‹p3â€‹âŠ•D3â€‹p3â€‹p3â€‹=C2â€‹p3â€‹âŠ•D2â€‹p2â€‹âŠ•D2â€‹p3â€‹âŠ•D3â€‹p1â€‹ å°† C 2 æ›¿æ¢æ‰ï¼š p1=D1p1âŠ•D2p1âŠ•D3p1p2=D1p2âŠ•D2p2âŠ•D3p2p3=D1p3âŠ•D2p3âŠ•D3p3p_1 = D_1p_1 \\oplus D_2p_1 \\oplus D_3p_1 \\\\ p_2 = D_1p_2 \\oplus D_2p_2 \\oplus D_3p_2 \\\\ p_3 = D_1p_3 \\oplus D_2p_3 \\oplus D_3p_3 p1â€‹=D1â€‹p1â€‹âŠ•D2â€‹p1â€‹âŠ•D3â€‹p1â€‹p2â€‹=D1â€‹p2â€‹âŠ•D2â€‹p2â€‹âŠ•D3â€‹p2â€‹p3â€‹=D1â€‹p3â€‹âŠ•D2â€‹p3â€‹âŠ•D3â€‹p3â€‹ ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œæ¢å¤æ ¡éªŒå—çš„ç­–ç•¥æ˜¯å¯¹çš„ã€‚è¯æ˜æ€è·¯ï¼šç”±äºå®Œæ•´çš„è§£ç çŸ©é˜µç›¸ä¹˜çš„ç¼–ç å—ä¸ ç¼–ç çš„kä¸ªæ•°æ®å— æœ‰åŒºåˆ«ï¼Œæˆ‘ä»¬å–è¶…è¡Œä¸­çš„ä¸€è¡Œ 1*(kw)æ¥çœ‹ï¼Œè®°ä½œ b=(b1 b2â€¦bk)b=(b_1\\ b_2â€¦b_k)b=(b1â€‹ b2â€‹â€¦bkâ€‹) ï¼Œåˆ™æ ¹æ®ç¼–ç å¾—åˆ°è¯¥è¶…è¡Œç¼–ç å—ä¸­çš„ç¬¬ iii ä¸ª packet ä¸º pi=(b1 b2...bk)â‹…[p1 p2...pk]Tp_i = (b1\\ b_2...b_k) \\cdot [p^1\\ p^2 ... p^k]^T piâ€‹=(b1 b2â€‹...bkâ€‹)â‹…[p1 p2...pk]T å‡å¦‚ç¬¬ä¸€ä¸ªæ•°æ®å—å¤±æ•ˆï¼Œå°†å¯¹åº”çš„ packets ç”¨è§£ç çŸ©é˜µä¸­çš„è¶…è¡Œä¸å¹¸å­˜çš„å‰ k ä¸ªç¼–ç å—ç‚¹ç§¯ä»£æ›¿ã€‚è®°å¹¸å­˜çš„å‰ kkk ä¸ªç¼–ç å—ä¸º pc,p2â€¦pkp^c,p^2â€¦p^kpc,p2â€¦pk ï¼Œå³ C1,D2â€¦DkC_1,D_2â€¦D_kC1â€‹,D2â€‹â€¦Dkâ€‹ ï¼›aia_iaiâ€‹ æ˜¯ç”¨åˆ°çš„å¤±æ•ˆæ•°æ®å—å†è§£ç è§£ç çŸ©é˜µçš„è¶…è¡Œä¸­çš„ç¬¬ iii è¡Œï¼š pi=(b1 b2...bk)â‹…[(a1(pc,p2...pk)â€¦aw(pc,p2...pk));...;pk]T=b11a1(pc,p2...pk)+...+b1waw(pc,p2...pk)+b2p2+b3p3+...+bkpk=(b11a1+...+b1waw)pc+(b11a1+...+b1waw+b2)p2+...+(b11a1+...+b1waw+bk)pkp_i = (b1\\ b_2...b_k) \\cdot [(a_1(p^c,p^2...p^k) \\dots a_w(p^c,p^2...p^k));...;p^k]^T \\\\ =b_{11}a_1(p^c,p^2...p^k)+...+b_{1w}a_w(p^c,p^2...p^k)+ \\\\ b_2p^2+b_3p^3+...+b_kp^k \\\\ =(b_{11}a_1+...+b_{1w}a_w)p^c+(b_{11}a_1+...+b_{1w}a_w+b_2)p^2+...+(b_{11}a_1+...+b_{1w}a_w+b_k)p^k piâ€‹=(b1 b2â€‹...bkâ€‹)â‹…[(a1â€‹(pc,p2...pk)â€¦awâ€‹(pc,p2...pk));...;pk]T=b11â€‹a1â€‹(pc,p2...pk)+...+b1wâ€‹awâ€‹(pc,p2...pk)+b2â€‹p2+b3â€‹p3+...+bkâ€‹pk=(b11â€‹a1â€‹+...+b1wâ€‹awâ€‹)pc+(b11â€‹a1â€‹+...+b1wâ€‹awâ€‹+b2â€‹)p2+...+(b11â€‹a1â€‹+...+b1wâ€‹awâ€‹+bkâ€‹)pk å¾ˆå®¹æ˜“å¾—å‡ºç»“è®ºã€‚ ::: danger è¯´æ˜ ä¸Šè¿°è¿‡ç¨‹æ˜¯å°†ä¿®å¤æ•°æ®å—å’Œæ ¡éªŒå—åŒæ—¶ä¿®å¤ï¼Œæ¥æ„é€ å®Œæ•´çš„è§£ç çŸ©é˜µï¼Œä¸»è¦ç›®çš„æ˜¯ç”Ÿæˆç»Ÿä¸€çš„è®¡åˆ’è¡¨(éƒ½æ˜¯å¯¹åŒæ ·çš„ kkk ä¸ªç¼–ç å—çš„ kwkwkw ä¸ª packetspacketspackets åšæ“ä½œ) ::: ä½¿ç”¨ä¸æµ‹è¯• ä¸»è¦ä¾›ä¸Šå±‚è°ƒç”¨çš„ æ¥å£å‡½æ•°ï¼Œæ˜¯ MDS ç¼–ç çš„æ¥å£ï¼›éƒ¨åˆ†æºä»£ç å’Œæ³¨é‡Šåœ¨çº¿é˜…è¯»å‚è€ƒ ç¼–ç  å¸¸è§„æœ‰é™åŸŸå†…çš„ç¼–ç å‡½æ•° jerasure_matrix_encode(int k, int m, int w, int matrix, char **data_ptrs, char **coding_ptrs, int size) äºŒè¿›åˆ¶çŸ©é˜µä¸‹ç¼–ç å‡½æ•° jerasure_bitmatrix_encode(int k, int m, int w, int *bitmatrix, char **data_ptrs, char **coding_ptrs, int size, int packetsize) ä½¿ç”¨ä½çŸ©é˜µè½¬æ¢å¾—åˆ°çš„ schedule çš„ç¼–ç å‡½æ•°ï¼ˆæ•ˆç‡æ¯”ç›´æ¥ä½¿ç”¨äºŒè¿›åˆ¶çŸ©é˜µé«˜ï¼Œéœ€è¦è‡ªå·±å…ˆè°ƒç”¨ dumb æˆ– smart ä¸¤ä¸ªè®¡åˆ’è¡¨ç”Ÿæˆå‡½æ•°å°†ä½çŸ©é˜µï¼ˆé€šå¸¸æ˜¯ç¼–ç çŸ©é˜µå’Œè§£ç çŸ©é˜µï¼‰ç”Ÿæˆ scheduleï¼‰ void jerasure_schedule_encode(int k, int m, int w, int **schedule, char **data_ptrs, char **coding_ptrs, int size, int packetsize) è§£ç  å¸¸è§„æœ‰é™åŸŸå†…çš„è§£ç å‡½æ•° jerasure_matrix_decode(int k, int m, int w, int *matrix, int row_k_ones, int *erasures, char **data_ptrs, char **coding_ptrs, int size) äºŒè¿›åˆ¶çŸ©é˜µä¸‹çš„è§£ç å‡½æ•° jerasure_bitmatrix_decode(int k, int m, int w, int *bitmatrix, int row_k_ones, int *erasures,char **data_ptrs, char **coding_ptrs, int size, int packetsize) ä½¿ç”¨è§£ç çŸ©é˜µï¼ˆäºŒè¿›åˆ¶ï¼‰è½¬æ¢å¾—åˆ°çš„ schedule çš„è§£ç å‡½æ•°ï¼ˆå†…éƒ¨è‡ªåŠ¨ç”Ÿæˆè®¡åˆ’è¡¨ï¼Œä¸€æ­¥å®Œæˆæ‰€æœ‰çš„è§£ç æ“ä½œï¼Œæ‰€æœ‰ç§°ä½œ lazyï¼‰ int jerasure_schedule_decode_lazy(int k, int m, int w, int *bitmatrix, int *erasures,char **data_ptrs, char **coding_ptrs, int size, int packetsize,int smart) ä¸Šé¢ä¸€ä¸ªå‡½æ•°å…³äº m=2 çš„ä¼˜åŒ–ï¼Œéœ€è¦å…ˆç”Ÿæˆæ‰€æœ‰å¯èƒ½ï¼ˆä»»æ„çš„ 1ï½œ2 ä¸ªå¤±æ•ˆï¼‰çš„è®¡åˆ’è¡¨ int jerasure_schedule_decode_cache(int k, int m, int w, int ***scache, int *erasures,char **data_ptrs, char **coding_ptrs, int size, int packetsize) å·¥å…·å‡½æ•° ç”Ÿæˆå¥‡å¶æ ¡éªŒçš„å‡½æ•° ã€çµæ´»çš„ã€‘æœ‰é™åŸŸå‘é‡ä¸ç¼–ç å—åšç‚¹ç§¯ã€ã€çµæ´»çš„ã€‘äºŒè¿›åˆ¶è¶…è¡Œ(w*kw)ä¸ç¼–ç å—(kw ä¸ª packets)åšç‚¹ç§¯ï¼Œç”¨äºé€šå¸¸çš„ç¼–ç å‡½æ•° jerasure_matrix_encode | jerasure_bitmatrix_encode æœ‰é™åŸŸçŸ©é˜µæ±‚é€†ï½œåˆ¤æ–­å¯é€†ã€äºŒè¿›åˆ¶çŸ©é˜µæ±‚ä½ ï½œåˆ¤æ–­å¯é€†ã€çŸ©é˜µä¹˜æ³•ã€çŸ©é˜µè½¬ä½çŸ©é˜µ è¿”å›é€šå¸¸çš„ æœ‰é™åŸŸï½œäºŒè¿›åˆ¶è§£ç çŸ©é˜µï¼ˆå‰ k ä¸ªæœ‰æ•ˆå— å¯¹åº”çš„è¡Œ|è¶…è¡Œ çš„é€†çŸ©é˜µï¼‰ï¼Œç”¨äºå¸¸è§„çš„è§£ç å‡½æ•° jerasure_matrix_decode | jerasure_bitmatrix_decode è°ƒè¯•å’Œç»Ÿè®¡ æ‰“å°çŸ©é˜µ void jerasure_print_matrix(int *m, int rows, int cols, int w) void jerasure_print_bitmatrix(int *m, int rows, int cols, int w) ç»Ÿè®¡è¿ç®— void jerasure_get_stats(double *fill_in) notes jerasure_schedule_decode_lazyjerasure\\_schedule\\_decode\\_lazyjerasure_schedule_decode_lazy ç”Ÿæˆè§£ç çŸ©é˜µçš„è¿‡ç¨‹ï¼Œæ±‚é€†çŸ©é˜µæ˜¯ O(n3)O(n^3)O(n3) çº§åˆ« å‚è€ƒé“¾æ¥ Jerasure: A Library in C/C++ Facilitating Erasure Coding for Storage Applications. Version 1.2 ã€1ã€‘çš„ç¿»è¯‘ æ¢ç§˜ Jerasure åšå®¢-JErasureåº“çš„ç›¸å…³å­¦ä¹  éƒ¨åˆ†æºä»£ç å’Œæ³¨é‡Šåœ¨çº¿é˜…è¯»å‚è€ƒ ","tags":[{"name":"EC","slug":"ec","used":true,"link":"https://blog.qxxiao.eu.org/tag/ec/"}],"title":"Jerasure-1.2","feature":"","link":"https://blog.qxxiao.eu.org/post/Jerasure-1.2/","stats":{"text":"9 min read","time":535000,"words":2059,"minutes":9},"date":"2021-04-11 15:31:10","dateFormat":"2021-04-11","isTop":false}]}
      